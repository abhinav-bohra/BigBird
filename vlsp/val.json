{"input":"### Chapter 1 Introduction\n\nAfter the cosmic microwave background radiation, the study of the\nformation and evolution of the structures on the large scales of our\nUniverse forms one of the pillars of modern cosmology. These structures\ncan be mapped by galaxy surveys, and cosmological observables derived\nfrom these surveys such as the galaxy two-point correlation function or\nits Fourier transform the power spectrum are central to the field, and\nare used to contrast predictions of cosmological models to observations\n( Pope et\u00a0al. , 2004 ; Tegmark et\u00a0al. , 2006 ; Percival et\u00a0al. , 2010 )\n. Despite essential successes in the last two decades with the emergence\nan observationally very successful concordance cosmology, this\ndescription of our Universe, the @xmath CDM model, is still very\nmysterious, with only about 5% of the energy budget of the Universe\nbeing made of the matter which we have daily experience of ( Komatsu\net\u00a0al. , 2011 ) . The real nature of the two dominating components, the\ndark energy and the dark matter, remains unclear to this day and is the\nheart of a large scientific effort. Both the dark matter density field\nas well as the impact of dark energy on the geometry of the Universe can\nnow in principle both be observed with the help of weak lensing (\nBartelmann and Schneider , 2001 ; Schneider et\u00a0al. , 2006 ) . It is thus\nbelieved that large galaxy surveys able to reach for the lensing signal\nare going to play an increasingly important role towards these\nfundamental issues in cosmology ( Albrecht et\u00a0al. , 2006 ) .\nOf course, in order to assess some set of observables as valuable for\ncosmology, and to design an experiment towards its extraction, it is\nessential to understand both our capabilities to extract it, as well as\nthe robustness and pertinence of the predictions of our model. These\naspects, often of statistical nature, are the very backbones of this\nthesis. Our main aim in the present research was to try and quantify\nthese aspects in several situations relevant to cosmology, focussing on\nthe dark matter density field, or its weighted projection along the line\nof sight, the weak lensing convergence field, contributing in this way\nto our understanding of the information content of galaxy surveys. We\nreview in this introductory chapter the known tools that we have built\nupon as well as the class of observables we have focused on, putting\nthus our work in context.\n\n#### 1.1 Stochasticity in cosmological observables\n\nAll major predictions and measurements that are used to test our\nunderstanding of our cosmological model are meaningful only in a\nstatistical sense. Indeed, our inability to observe initial conditions,\nwhich we may tentatively evolve, as well as the complexity of some of\nthe physical processes involved render in general a statistical\ndescription unavoidable. For this reason, a key element that determine\nto an often decisive extent what observable will be of interest for the\npurpose of the analyst is the probability density for the realisation of\nthe fields from which the observables are derived. Typically a CMB\ntemperature map, or a galaxy density field, from which one measures for\ninstance the two-point correlation function. This element of\nstochasticity is sometimes referred to as cosmic variance , a\ndenomination that we adopt in the following. One must generically\ninclude other sort of stochasticity on top of the cosmic variance, that\nwe refer to as noise , for instance due to the specificities of the\ninstrumentation, filling another gap between model predictions and\nactual data outputs.\nWe need to introduce some notation :\nWe always write a probability density with @xmath , at times adding a\nsubscript indicating to which random variable it refers to for clarity.\nIn the case of cosmological fields, these probability densities are\ngenerically high dimensional, describing the joint occurrence of fields\nvalues at different points. Typically, when the random variable are the\nvalues @xmath of a a field @xmath at points @xmath , then @xmath is a\nfunction of @xmath variables, a @xmath -point probability density\nfunction. The position label @xmath itself can have various meanings in\ndiverse cosmologically relevant situation. It can have for instance\ndimension @xmath (Lyman- @xmath forest), @xmath (weak lensing\ntomography, projected density fields, CMB), or @xmath (redshift\nsurveys).\nThe joint density for the realisation of the field @xmath at all points\ncan be written conveniently as the functional @xmath . Expectation\nvalues of observables @xmath are given formally as\n\n  -- -------- -- -------\n     @xmath      (1.1)\n  -- -------- -- -------\n\nan infinite dimensional integral. It should be kept in mind that such\nprobability densities @xmath are however not always very well defined\nand intrinsically difficult to handle, except in some cases. Expectation\nvalues 1.1 can nevertheless be understood as the limit of a finite\ndimensional, well defined average\n\n  -- -------- -- -------\n     @xmath      (1.2)\n  -- -------- -- -------\n\nover a finite sample of the field, with large @xmath . In a harmless\nabuse of terminology we may identify at times in this work such finite\nsamples of the field with the field itself, especially when dealing with\n@xmath -body simulations, that have of course only a finite number of\nspatial resolution elements.\n\n###### Homogeneity, isotropy, ergodicity\n\nCosmic variance in the sense defined above is the stochasticity of the\ndata due to the fact that we observe one particular realisation of a\nrandom field, namely that of our own Universe (or of the observed part\nof the Universe, in which case one can also refer to a component of\nsample variance). It is a fundamental limitation in the sense that this\nvariability can never be beaten down, as this would ultimately require\nthe observation of several universes governed by the same density\nfunctions, which is a mathematical construct useless to our purposes.\nWithin this framework, one relies on several assumptions, namely that of\nstatistical homogeneity, isotropy and ergodicity. The first two express\nthe absence of preferred locations and directions in the Universe.\nMathematically speaking, all density functions are required to be\ninvariant under spatial translations and rotations,\n\n  -- -------- -- -------\n     @xmath      (1.3)\n  -- -------- -- -------\n\nfor any translation vector @xmath and rotation matrix @xmath . These two\nimportant assumptions can be tested and are confronted to observations.\nOf course, homogeneity and isotropy do not apply to fields in redshift\nspace coordinates. The third, ergodicity, states that we can reinterpret\nthe ensemble averages in equation 1.1 to be spatial averages. We expect\nthis assumption to be correct as long as the spatial averages can be\nmade over sufficiently large volumes, or using widely separated samples,\nassuming that correlations at large distances decays quickly enough to\nzero. Under these conditions, so called ergodic theorems can indeed be\nproven. However, this assumption cannot be fundamentally tested and we\nhave no choice but to take it as granted in order to obtain useful\nresults out of this mathematical approach.\nVery often of primary interest are the zero mean, dimensionless\nfluctuations @xmath of @xmath , defined as\n\n  -- -------- -- -------\n     @xmath      (1.4)\n  -- -------- -- -------\n\nwhere @xmath is the mean of the field, independent of position @xmath by\nhomogeneity.\n\n#### 1.2 Fisher information for cosmology : a first look\n\nInference on model parameters might appear extremely simple in\nprinciple. For a set of model parameters @xmath of interest, and the\nobserved field @xmath , probability theory tells us that we must update\nour knowledge of @xmath with the simple rule,\n\n  -- -------- -- -------\n     @xmath      (1.5)\n  -- -------- -- -------\n\nIn this equation, the density @xmath describes our prior state of\nknowledge on @xmath , and @xmath , viewed as function of the parameter\nis called the likelihood. On the lefthand side, @xmath is called the\nposterior. Of course, the simplicity of this formula should not hide the\nvery high complexity of its implementation for typical cosmological\ninstances. In particular, the likelihoods @xmath are in general only\npoorly known, and the very high dimensionality of this object requires\nthe compression of @xmath to some smaller subset of observables, whose\nstatistics are set by the likelihood, all carrying some of the amount of\nthe information that the likelihood carried originally. It is thus\nclearly of the uttermost interest to be able to quantify more precisely\nthis information, both that of the original likelihood as well as that\nof the different observables. This is where Fisher information comes\ninto play.\nIt seems fair to say that the use of Fisher information in cosmology\nbegins, though indirectly, with Jungman et\u00a0al. ( 1996a , b ) , two works\nin the context of CMB experiments aiming at measuring the temperature\nfluctuation spectrum @xmath . In these works, it is argued that the\nposterior for the parameters will be approximately Gaussian. Let us\nconsider for simplicity the case of a single parameter of interest,\n@xmath , as the discussion or an arbitrary number of parameters holds\nessentially unchanged. With the true value, or best fit value of the\nparameter defined as @xmath , the posterior is assumed to have the form\n\n  -- -------- -- -------\n     @xmath      (1.6)\n  -- -------- -- -------\n\nwith the number @xmath is defined as\n\n  -- -------- -- -------\n     @xmath      (1.7)\n  -- -------- -- -------\n\nIn this equation, @xmath is the variance of the estimates of @xmath ,\nincluding cosmic variance, incomplete sky coverage and detector noise.\nUnder the assumption ( 1.6 ), it is clear that @xmath is the variance\n@xmath of the parameter. Very interestingly, from its definition ( 1.7 )\nwe see that this variance can be evaluated prior obtaining data, if a\nreasonable fiducial point @xmath can be chosen and the model predictions\nof the spectrum are given. Provided the assumptions made there are\ncorrect, this is making the approach of Jungman et\u00a0al. ( 1996a , b )\nquite powerful, providing us with a rather great understanding of the\ncapabilities of the experiment.\nIt is worthwhile spending a bit more thoughts on @xmath defined in ( 1.7\n). It is a special case of an expression that weights the derivatives of\nsome set of observables @xmath according to their covariance matrix\n@xmath ,\n\n  -- -------- -- -------\n     @xmath      (1.8)\n  -- -------- -- -------\n\nWe recover ( 1.7 ) by setting the observables to be the spectrum, and\nthe covariance matrix to be diagonal, as required for a perfectly\nGaussian CMB map. The number ( 1.8 ) has an array of fundamental\nproperties, none of them being difficult to show :\n\n-   It is a non negative number, that becomes larger for a smaller\n    covariance matrix or a larger impact of @xmath on the observable,\n    and vice versa.\n\n-   @xmath corresponding to independent observables (i.e. with no\n    covariance) is simply the sum of their respective @xmath .\n\n-   Adding an observable @xmath to a set @xmath can only increase @xmath\n    , and not decrease it.\n\n-   @xmath is identical to the expected curvature of a least squares fit\n    to the observables with the given covariance matrix \u00b9 \u00b9 1 It should\n    be noted that this identification to a curvature in a least square\n    fitting procedure holds only if the covariance matrix is treated as\n    parameter independent. , provided @xmath is the parameter value that\n    gives the least squared residuals.\n\nThese properties are very consistent with what we would expect from a\nmeasure of information on the parameter @xmath and are making the number\n( 1.8 ) a promising candidate for such a measure. However, it is clearly\nnot the end of the story, since it depends only on the chosen set of\nobservables and their covariance matrix, but neglects all other aspects\nof the probability density @xmath . The link with Fisher information, a\nwell known tool in statistics, was then exposed and extended to other\nareas of cosmology in works such as Tegmark et\u00a0al. ( 1997 ); Tegmark (\n1997 ) . It was noted that the number ( 1.7 ) is identical to\n\n  -- -------- -- -------\n     @xmath      (1.9)\n  -- -------- -- -------\n\nwhere @xmath is a Gaussian likelihood for the noisy CMB temperature\nfluctuation field. The connection between equation ( 1.9 ) and\ncovariances on parameters was also used in an astrophysical context\nearlier in Amendola ( 1996 ) . Equation 1.9 is the Fisher information in\n@xmath on @xmath , a most sensible measure of information on parameters,\nwhose properties and link to ( 1.8 ) we will have the occasion to\ndiscuss extensively. For several parameters, it becomes the Fisher\ninformation matrix\n\n  -- -------- -- --------\n     @xmath      (1.10)\n  -- -------- -- --------\n\nSince then, such Fisher information matrices for Gaussian variables and\nthe assumption ( 1.6 ) have been used routinely in cosmology in order to\nassess the capabilities of some future experiments.\nTwo comments are in order at this point :\nFirst, the definition ( 1.10 ) of the Fisher information matrix is the\nmost common in cosmology. However, in this thesis, we will rather use\nthe alternative\n\n  -- -------- -- --------\n     @xmath      (1.11)\n  -- -------- -- --------\n\nas the definition of the information matrix. These two definitions can\nbe shown to be equivalent for any probability density function using the\nfact that probability densities are normalised to unity, @xmath . While\n( 1.10 ) conveniently presents the information matrix as a curvature\nmatrix, it will become clear in chapter 3 that ( 1.11 ), making a\nreference to the score function @xmath , is in fact much more\nfundamental for our purposes. This form generalises more easily to non\nnormalised density functions as well.\nSecond, as discussed above, Fisher information is often interpreted in\ncosmology as an approximation to the parameter posterior, approximated\nas a Gaussian with covariance matrix @xmath . The Gausisan\napproximation, as well as the identification of the Fisher information\nmatrix with the inverse covariance matrix are of course only assumptions\nthat can fail, at times severely. This is especially true when\nmarginalising within this approach over poorly constrained parameters,\nwhose distribution often cannot be approximated by a Gaussian shape (see\nfor example Wolz et\u00a0al. ( 2012 ) ), giving rise to results that are\ndifficult to interpret. In this thesis the focus is on the more orthodox\ninterpretation of the Fisher information matrix as a very meaningful and\nwell defined measure of information, and not as an approximation to a\nposterior. In particular, we are not going to inverse the Fisher matrix\nor marginalise over a set of parameters, except in some instances making\nconnections to results in the literature.\n\n#### 1.3 @xmath-point functions\n\nA very common class of observables, at the heart of this thesis, are the\n@xmath -point functions, that we review briefly in this section. They\nare very convenient at least for two reasons. First, for Gaussian fields\nthe mean and two-point function do contain the entire information in the\nfield : in the language of orthodox statistics, they form a set of\nsufficient statistics. Second, the measurement of a (connected)\nthree-point or higher order point function directly tests for non\nGaussianity of the field.\n\n##### 1.3.1 @xmath-point functions from the density : characteristic\nfunctional\n\nIn cosmology, the @xmath -point function @xmath is defined as the\nconnected part of the @xmath -point moment of the fluctuation field.\nThese are most easily defined using the generating function technology,\nubiquitous in any field theory. Consider first an arbitrary @xmath\n-point moment of the field,\n\n  -- -------- -- --------\n     @xmath      (1.12)\n  -- -------- -- --------\n\nWe can write it, at least formally, as a derivative of the generating\nfunctional @xmath , or characteristic functional , essentially the\nFourier transform of the density :\n\n  -- -- -- --------\n           (1.13)\n  -- -- -- --------\n\nwith\n\n  -- -------- -- --------\n     @xmath      (1.14)\n  -- -------- -- --------\n\nIn other words, the @xmath -point moments can be considered as the\nsuccessive terms in an expansion of the generating functional in a power\nseries in @xmath . Note that there are cases, such as for instance the\nlognormal field, where the generating functional cannot be written as a\npower series, even for @xmath very close to zero. In this case, the\nseries should be considered as a formal power series regardless of\nconvergence. The connected @xmath -point correlation functions are then\ndefined as the successive terms in the formal expansion of @xmath :\n\n  -- -------- -- --------\n     @xmath      (1.15)\n  -- -------- -- --------\n\nIf all arguments @xmath to @xmath are identical, these connected point\nfunctions become the familiar cumulants of the one dimensional density\nfunction @xmath .\nThe connected point functions are convenient since they are additive for\nuncorrelated fields. Indeed, if two fields are uncorrelated, then one\nfinds directly from its very definition ( 1.14 ) that the characteristic\nfunction @xmath of the joint density is the product of the\ncharacteristic functions of each of the densities. Taking the logarithm\nand using the definition ( 1.15 ) shows that the connected functions\njust add up. From these relations ( 1.13 ) and ( 1.15 ) one can infer\nrecursion relations for the connected point functions, as well as\nconvenient diagrammatic representations, Feynman diagrams alike, where\nconnected point functions are represented by connected graphs (\nBernardeau et\u00a0al. , 2002 ; Szapudi , 2005 , e.g.) .\nIt holds that the very first connected point functions are identical to\nthe first moments of the delta field,\n\n  -- -------- -- --------\n     @xmath      (1.16)\n  -- -------- -- --------\n\nbut this is not the case anymore for higher @xmath .\nFrom homogeneity and isotropy, these functions are invariant under\ntranslations and rotations. In particular the two-point function is a\nfunction of a single argument,\n\n  -- -------- -- --------\n     @xmath      (1.17)\n  -- -------- -- --------\n\nTranslation invariance allows conveniently the use of a description in\nterms of harmonics. In Cartesian space, with Fourier transform\n\n  -- -------- -- --------\n     @xmath      (1.18)\n  -- -------- -- --------\n\nwe have for any statistically homogeneous field the simple relation\n\n  -- -------- -- --------\n     @xmath      (1.19)\n  -- -------- -- --------\n\nwhere @xmath is the Dirac @xmath function and @xmath , the power\nspectrum, is the Fourier transform of the two-point function\n\n  -- -------- -- --------\n     @xmath      (1.20)\n  -- -------- -- --------\n\nIs the field further statistically isotropic, the spectrum is only a\nfunction of the modulus @xmath of the wavenumber. Similarly, one can\ndefine higher order spectra, the polyspectra, prominently the bispectrum\nfor @xmath and trispectrum for @xmath through the Fourier transforms of\nthe connected @xmath -point functions, or equivalently the expectation\nof products of the Fourier modes of the field.\nIn this thesis, the distinction between connected and disconnected point\nfunctions, or the use of polyspectra rather than the @xmath -point\nfunctions, are of no fundamental relevance, as they provide equivalent\ndescriptions of the same source of information. We will not make a\ndifference between a connected or disconnected point function. We regard\na generic @xmath -point moment\n\n  -- -------- -- --------\n     @xmath      (1.21)\n  -- -------- -- --------\n\nas a @xmath -point function.\nThe prime example of a homogeneous isotropic random fluctuation field is\nof course the Gaussian field. Gaussian fields are very convenient for\nmany reasons. They are stable under any linear transformations, such as\nsmoothing, and also under convolutions. The celebrated central limit\ntheorem states that sums of a large number of independent variables tend\nto have a Gaussian distribution under fairly generic conditions.\nBesides, they also arise as fields of maximum information entropy for a\ngiven two-point function. The Gaussian field is defined through\n\n  -- -------- -- --------\n     @xmath      (1.22)\n  -- -------- -- --------\n\nor, in Fourier space,\n\n  -- -------- -- --------\n     @xmath      (1.23)\n  -- -------- -- --------\n\nThe second representation shows that the Fourier modes of such a field\nare independent complex Gaussian variables with the correlations as\ngiven in ( 1.19 ). All finite @xmath -dimensional joint densities are\n@xmath -dimensional multivariate Gaussian distributions.\nThe characteristic functional can be evaluated in closed form. It is a\nstandard result called the Gaussian integral.\n\n  -- -------- -- --------\n     @xmath      (1.24)\n  -- -------- -- --------\n\nIt follows that @xmath is a polynomial second order in @xmath . It is\nthen immediate that the connected point functions of the Gaussian field\nvanish for @xmath , since the derivatives of that order do vanish.\n\n##### 1.3.2 The density from @xmath-point functions : determinacy of the\nmoment problem\n\nA key to several results of this thesis is the so-called moment problem\nand its determinacy . These are respectively the problem of finding a\ndensity given the hierarchy of @xmath -point moments, and the question\nof whether a solution is unique or not. While not part of the usual\ncosmological literature, this topic is a well known area of research of\nmathematics, in particular for one dimensional densities ( Akhiezer ,\n1965 ; Simon , 1997 ) . For such one dimensional densities examples of\ndifferent distributions with the same moment series have been known for\nmore than a century ( Stieltjes , 1894 ; Heyde , 1963 ) .\nIt is not uncommonly argued in the cosmological literature that the\nrelation between the moments, the characteristic functional and the\ndensity function can be inverted, suggesting that the density is always\nuniquely set by the @xmath -point moments ( Fry , 1985 ; Mo et\u00a0al. ,\n2010 , e.g.) . It is important to keep in mind that this holds only when\nthe characteristic functional can be written as a convergent power\nseries in the moments in a region around @xmath . As already mentioned\nthis is not always true, in which case the characteristic functional\ncannot be expressed in terms of @xmath -point moments. However, it is\ntrue that the mapping between the characteristic functional and the\ndensity is one to one. The indeterminacy of the moment problem was\ntouched upon in a cosmological context in Coles and Jones ( 1991 ) ,\nthough it did not attract much attention in the cosmological literature\nsince then.\nObviously, an indeterminate moment problem is relevant for our purposes\nas it implies that the entire @xmath -point function hierarchy contains\nless information than the density itself. In that case, the entire\n@xmath -point hierarchy is an inefficient set of observables. Namely, it\nis impossible to reconstruct uniquely the density from the hierarchy.\nThe implications for cosmological parameter inference are discussed in\nseveral chapters of this thesis, notably in chapter 6 , where to the\nbest of our knowledge first explicit examples of densities of any\ndimensionality with identical @xmath -point moments at all orders are\npresented.\nThe Gaussian field is an example of a density that can be uniquely\nrecovered from the @xmath -point moment hierarchy. On the other hand,\nthe lognormal field, first introduced later in 1.4 is an example where\nthis is not possible.\n\n##### 1.3.3 @xmath-point functions from discrete populations, poisson\nsamples\n\nIn galaxy or weak lensing surveys, the fields that are observed are\nrather discrete than continuous. Namely positions of galaxies are\nrecorded, and additional information such as the distortion of galaxy\nimages can be effectively measured only on these positions. Discreteness\nadds some complexity. We are not able to predict galaxy positions in the\nsky, and this discrete field may not trace in an obvious manner the\nunderlying, interesting field, typically the dark matter density field\nor its projection. Rather, they are only tracers that can be biased in\nseveral ways, and the measured @xmath -point functions need not always\nbe representative of that of the underlying field.\nThere is no unique manner to create a point process from a continuous\nrandom field, but for density fields the infinitesimal Poisson model is\nrather natural and gives a direct interpretation of the point functions.\nWithin this prescription, one divides the total volume in infinitesimal\ncells and simply set the probability for a point in a cell to be\nproportional to the value of the continuous field @xmath at that point,\nand this independently from cells to cells. In that case, given a total\nnumber of @xmath objects in a total volume @xmath , the probability\ndensity to find these at @xmath conditional on @xmath is by definition\n\n  -- -------- -- --------\n     @xmath      (1.25)\n  -- -------- -- --------\n\nNote that the normalisation @xmath must require ergodicity, in order to\nbe able to identify @xmath with @xmath . This condition implies that for\nany @xmath the following link between @xmath -point functions must hold\n\n  -- -------- -- --------\n     @xmath      (1.26)\n  -- -------- -- --------\n\nwhich is a very non trivial condition on a density function, requiring\nin fact the zeroth mode of the field, @xmath to be actually no random\nvariable but a usual number. For a Gaussian field, this is equivalent to\nrequire the condition on the spectrum @xmath and thus presents no\ndifficulty for any volume @xmath . On the other hand, as we will discuss\nin chapter 4 , a lognormal field never has this property fulfilled\nexactly in a finite volume, since its power at zero must be strictly\npositive.\nWe find the probability density @xmath , unconditional to @xmath , to\nfind these objects at these positions by marginalising over the unseen\nunderlying field @xmath ,\n\n  -- -------- -- --------\n     @xmath      (1.27)\n  -- -------- -- --------\n\nFrom ( 1.27 ) we find a direct interpretation of the two-point function.\nFrom the rule of probability theory we find that the probability density\nof observing an object at @xmath given that there is one at @xmath is\ngiven by\n\n  -- -------- -- --------\n     @xmath      (1.28)\n  -- -------- -- --------\n\nThus for such processes the connected two-point function describes\ndirectly the clustering of the points, by enhancing or reducing this\nconditional probability to find particles separated by some distance (\nPeebles , 1980 ; Bernardeau et\u00a0al. , 2002 , e.g.) .\n\n#### 1.4 Gaussian and non-Gaussian matter density fields\n\nIn cosmology, the Gaussian field ( 1.22 ) is fundamental. It is used\nroutinely in order to describe the statistics of the small fluctuations\npresent in the early Universe that we observe in the CMB radiation, or\nmore importantly for us that of the density we observe on the largest\nscales. While it is possible to treat this working hypothesis as an\nad-hoc assumption adopted for convenience or lack of a better\nprescription, it has now some theoretical support as well, in that the\nsimplest model of inflation predict initial conditions that are\nextremely close to Gaussian ( Liddle and Lyth , 2000 ) . It is\nfortunately possible to see where this comes about without entering any\ndetails : in such models a nearly free scalar field is responsible for\nthe rapid expansion of the Universe, and its fluctuations give rise to\nthe primordial deviations from homogeneity. Since the action of a free\nfield is quadratic in the field, and since the action plays the same\nrole in a quantum field theory as @xmath in a statistical field theory,\nwe see that it corresponds to a Gaussian field.\nNevertheless, it should be noted that in the particular case of the\nmatter density or fluctuation field relevant for galaxy surveys, the\nassumption of Gaussianity is in fact flawed from the very beginning.\nThis is because the matter density is positive, while the Gaussian\nassumption assigns non-zero probability density to negative values. As\nlong as the variance is small, this is however not an essential\nshortcoming of the model.\nOf course, there are many situations where non-Gaussian statistics play\na major role, even in the noise-free fields. For instance, signatures\nfrom non-Gaussianities in the primordial fluctuations can be used to try\nand constrain more sophisticated inflationary models. This is often\ndubbed as primordial non-Gaussianity. In this thesis we are going to\ndeal with the non-Gaussianity sourced from the nonlinear evolution of\nthe density field. We already mentioned that Gaussian statistics cannot\nprovide a perfect description of a density field, and this is even more\ntrue as nonlinear evolution take place. This is illustrated in figure\n1.2 , from A. Pillepich ( Pillepich et\u00a0al. , 2010 ) . The four panels on\nthe left show the evolution of the matter density field in a @xmath\n-body simulation, from redshift 50 to redshift 0 downwards. The inbox\ninside each panel shows the one-point probability density @xmath of the\nmatter fluctuation field as the dark line, together with that of the\nprevious panel in grey. As the fluctuations grows, one observes the\nfield to develop large tails in the overdense regions, and a cutoff in\nthe underdense regions. The right panels are the same simulations where\nan amount of primordial non Gaussianity of the local type roughly 10\ntimes larger than current observational constraints ( Komatsu et\u00a0al. ,\n2011 ) was added, represented as the blue line in the inboxes. It is\nobvious that the non Gaussianity induced by the formation of structures\nis both very strong and completely dominant over the primordial\nnon-Gaussianity in the late Universe.\n\nMore to the point in the case of the density field is the assumption of\na lognormal field ( Coles and Jones , 1991 ) , where essentially the\nlogarithm @xmath is set to be a Gaussian field. Since @xmath is very\nclose to @xmath for small fluctuations, these two fields are\nindistinguishable for any practical purposes as long as the variance is\nsmall. The lognormal is however always positive definite, correcting for\nthe defect of the Gaussian prescription. In the nonlinear regime, it\nalso shows large tails and a cutoff in the underdense regions,\nreproducing the qualitative features the one-point distribution of the\nfluctuation field remarkably well given the simplicity of the\nprescription.\nLet us illustrate these aspects in figure 1.1 with the help of\nperturbation theory. As the dotted line is shown the prediction of\nsecond order perturbation theory for the distribution function,\ncalculated with the same methods as Taylor and Watts ( 2000 ) , assuming\nGaussian initial conditions for @xmath , at a variance of @xmath . We\nsee that the assumption of Gaussian initial conditions gives rise to a\nnonsensical non zero probability density for negative matter density. On\nthe other hand, as expected, it predicts a large tail in the overdense\nregions. The dashed line shows the probability density obtained from the\nsame type of perturbative calculations for @xmath , and the solid line\nthe lognormal distribution. It is rather remarkable how both the tails\nand the underdense regions of the lognormal are reproduced with these\ntwo perturbative calculations. The agreement between the lognormal\nprescription and the matter fluctuations measured in the @xmath -body\nsimulations is also seen to be very good, see Taylor and Watts ( 2000 )\n.\nWe can see from the apparition of a long tail and a sharp cutoff in the\ndensity fluctuations that the statistics of the nonlinear regime are not\ngoing to obey the same rules as that of the linear Gaussian field. For\ninstance, it is worth mentioning at this point that the traditional\nobservable the spectrum of the field, that contains the entire\ninformation in the field in the Gaussian regime, seems to lose most of\nits advantages leaving the nonlinear regime. In particular, heavy\ncorrelations appear between the Fourier modes, and little information\ncan apparently be extracted from the spectrum on these scales ( Rimes\nand Hamilton , 2005 ; Neyrinck et\u00a0al. , 2006 ; Lee and Pen , 2008 ) .\nThe study of the information within the lognormal field will form a\nlarge part of this thesis, chapter 6 .\n\n#### 1.5 Structure of the thesis\n\nThe thesis is built out of two parts. The first part, that includes the\nfirst and second chapter, describes and builds upon the mathematical\ntools that are used in later chapters. The second part, chapter 3 to\nchapter 7, contains the cosmological research properly speaking. Each\nchapter begins with a more detailed description of its content, as well\nas the references to our corresponding publications when appropriate.\nIn chapter 2, we discuss two measures of information, Fisher\u2019s\ninformation matrix and Shannon\u2019s information entropy, and the duality\nbetween them. We comment extensively on the information inequality,\nfundamental for much of this thesis. We discuss the information content\nof maximal entropy distributions, and identify these distributions as\nthose for which the information inequality is an equality.\nIn chapter 3 we deal with the information content of @xmath -point\nmoments for a given density function. We present how to decompose the\nFisher information matrix in uncorrelated components, associated to the\n@xmath -point moments of a given order, with the help of orthogonal\npolynomials. The properties of this expansion are discussed. In\nparticular, it is shown that the hierarchy of @xmath -point moments does\nnot necessarily carry the entire Fisher information content of the\ndistribution for indeterminate moment problems, while the entire\ninformation is recovered for determinate moment problems. We also\npresent several models for which we could obtain this expansion\nexplicitly at all orders.\nChapter 4 uses the tools introduced in chapter 2 in the context of weak\nlensing. We show in this chapter how the information from different\nprobes of the weak lensing convergence field, the magnification, shears\nand flexion fields, do combine in a very simple way. We then evaluate\ntheir information content using current values for the dispersion\nparameters and discuss the benefits of their combination.\nChapter 5 is a little note on the use of Gaussian distributions for the\nstatistics of estimators of second order statistics in cosmology. We\nshow that we can use these information-theoretic concepts to clarify\nsome issues in the literature and the signification of the parameter\ndependence of the covariance matrices for two-point correlation\nfunctions or power spectra.\nChapter 6 discusses the information content of @xmath -point moments in\nthe lognormal density field. It is the largest chapter in this thesis,\nand contains our main results as well. After discussing some fundamental\nlimitations of the lognormal field to describe the matter density field\nof the @xmath CDM universe, we present families of different fields all\nhaving the same hierarchy of @xmath -point moments than the lognormal,\nand discuss the implications for parameter inference. The expansion of\nthe Fisher information matrix introduced in chapter 2 is then performed\nexactly at all orders in two simplified but tractable situations. This\nthen allows us to make successful connections with @xmath -body\nsimulation results on the extraction of power spectra\nFinally, in chapter 7 we evaluate the information content of the moment\nhierarchy of the one-point distribution of the weak lensing convergence\nfield, demonstrating that the nonlinearities generically lead to\ndistributions that are very poorly described by their moments. On the\nother hand, it is shown that simple mappings are able to correct for\nthis deficiency.\n\n## Part I Quantifying information\n\n### Chapter 2 Shannon entropy and Fisher information\n\nThe primary aim of this first chapter is to introduce in a rather\ndetailed and comprehensive manner the tools that form the building\nblocks of this thesis, which are Fisher\u2019s matrix valued measure of\ninformation, as well as Shannon\u2019s measure of entropy. As such, unlike\nthe subsequent chapters, it does not contain exclusively original\nmaterial. Namely, the sections 2.1 and 2.2 , while important parts of\nour publication Carron et\u00a0al. ( 2011 ) can be considered to some extent\na review of our perspective on the properties of Fisher information and\nShannon entropy that are then built upon in the later parts of this\nthesis.\nThis chapter is built as follows :\nIn section 2.1 , we introduce and discuss the main properties of the\nFisher information, with an emphasis on its information theoretic\nproperties. Essential to most of this thesis is the information\ninequality, equation ( 2.21 ), and its consequences. In section 2.2 , we\ndiscuss maximal entropy distributions associated to a prescribed set of\nobservables, and that these distributions are precisely those for which\nthe information inequality is an equality. We find with equation ( 2.44\n) a measure of information content that depends only on the constraints\nput on the data and the physical model, written in terms of the\ncurvature of Shannon\u2019s entropy surface. We recover the Fisher\ninformation matrices for Gaussian fields of common use in cosmology as\nthe special case of fields with prescribed two-point functions.\nThe text in these two sections is based to a large extent on the first\npart of Carron et\u00a0al. ( 2011 ) , with the exception of appendix 2.3.1 .\n\n#### 2.1 Fisher information and the information inequality\n\nWe first review here a few simple points of interest that justify the\ninterpretation of the Fisher matrix as a measure of the information\ncontent of an experiment. Let us begin by considering the case of a\nsingle measurement @xmath , with different possible outcomes, or\nrealisations, @xmath , and our model has a single parameter @xmath . We\nalso assume that we have knowledge, prior to the given experiment, of\nthe probability density function @xmath , which depends on our parameter\n@xmath , that gives the probability of observing particular realisations\nfor each value of the model parameter. The Fisher information, @xmath ,\nin @xmath on @xmath , is a non-negative scalar in this one parameter\ncase. It is defined in a fully general way as a sum over all\nrealisations of the data ( Fisher , 1925 ) :\n\n  -- -------- -- -------\n     @xmath      (2.1)\n  -- -------- -- -------\n\nThree simple but important properties of Fisher information are worth\nhighlighting at this point.\n\n-   The first is that @xmath is positive definite, and it vanishes if\n    and only if the parameter @xmath does not impact the data, i.e. if\n    the derivative of @xmath with respect to @xmath is zero for every\n    realisation @xmath .\n\n-   The second point is that it is invariant to invertible manipulations\n    of the observed data. This can be seen by considering an invertible\n    change of variable @xmath , which, due to the rules of probability\n    theory can be expressed as\n\n      -- -------- -- -------\n         @xmath      (2.2)\n      -- -------- -- -------\n\n    Thus\n\n      -- -------- -- -------\n         @xmath      (2.3)\n      -- -------- -- -------\n\n    leading to the simple equivalence that @xmath . On the other hand,\n    information may be lost when the transformation is not unique in\n    both directions. For instance, if the data is combined to produce a\n    new variable that could arise from different sets of data points.\n    This is only the statement that manipulations of the data leads, at\n    best, only to conservation of the information.\n\n-   The third point is that information from independent experiments add\n    together. Indeed, if two experiments with data @xmath and @xmath are\n    independent, then the joint probability density factorises,\n\n      -- -------- -- -------\n         @xmath      (2.4)\n      -- -------- -- -------\n\n    and it is easy to show that the joint information in the\n    observations decouples,\n\n      -- -------- -- -------\n         @xmath      (2.5)\n      -- -------- -- -------\n\nThese three properties satisfy what we might intuitively expect from a\nmathematical implementation of an abstract concept such as information.\nHowever, we can ask the reverse question and try to find an alternative\nmeasure of information that may be better suited, for a particular\npurpose, than the Fisher information. In appendix 2.3.1 , we discuss to\nwhat extent the information measure in ( 2.1 ) is in fact uniquely set\nby the these requirements above.\nThese properties are making the Fisher information a meaningful measure\nof information. This is independent of its interpretation as providing\nerror bars on parameters. It further implies that once a physical model\nis specified with a given set of parameters, a given experiment has a\ndefinite information content that can only decrease with data\nprocessing.\n\n##### 2.1.1 The case of a single observable\n\nTo quantify the last point above, and in order to get an understanding\nof the structure of the information in a data set, we first discuss a\nsimple situation, common in cosmology, where the extraction of the model\nparameter @xmath from the data goes through the intermediate step of\nestimating a particular observable, @xmath , from the data, @xmath ,\nwith the help of which @xmath will be inferred. A typical example could\nbe, from the temperature map of the CMB ( @xmath ), the measurement of\nthe power spectra of the fluctuations ( @xmath ), from which a\ncosmological parameter ( @xmath ) is extracted. The observable @xmath is\nmeasured from @xmath with the help of an estimator, that we call @xmath\n, and that we will take as unbiased. This means that its mean value, as\nwould be obtained for instance if many realizations of the data were\navailable, converges to the actual value that we want to compare with\nthe model prediction,\n\n  -- -------- -- -------\n     @xmath      (2.6)\n  -- -------- -- -------\n\nA measure for its deviations from sample to sample, or the uncertainty\nin the actual measurement, is then given by the variance of @xmath ,\ndefined as\n\n  -- -- -- -------\n           (2.7)\n  -- -- -- -------\n\nIn such a situation, a major role is played by the so-called Cram\u00e9r-Rao\ninequality ( Rao ( 1973 ) ), that links the Fisher information content\nof the data to the variance of the estimator, stating that\n\n  -- -------- -- -------\n     @xmath      (2.8)\n  -- -------- -- -------\n\nThis equation holds for any such estimator @xmath and any model\nparameter @xmath . Two different interpretations of this equation are\npossible:\n\nThe first bounds the variance of @xmath by the inverse of the Fisher\ninformation. To see this, we consider the special case of the model\nparameter @xmath being @xmath itself. Although we are making in general\na conceptual distinction between the observable @xmath and the model\nparameter @xmath , nothing requires us from doing so. Since @xmath is\nnow equal to @xmath , the derivative on the right hand side becomes\nunity, and one obtains\n\n  -- -------- -- -------\n     @xmath      (2.9)\n  -- -------- -- -------\n\nThe variance of any unbiased estimator @xmath of @xmath is therefore\nbounded by the inverse of the amount of information @xmath the data\npossess on @xmath . If @xmath is known it gives a useful lower limit on\nthe error bars that the analysis of the data can put on this observable.\nWe emphasise at this point that this bound only holds in the case of\nunbiased estimators. There are cosmologically relevant situations where\nbiased estimators can go beyond this level, and thus perform better\naccording to the minimal squared error criterion than any unbiased one.\nThe second reading of the Cram\u00e9r-Rao inequality, closer in spirit to the\npresent thesis, is to look at how information is lost by constructing\nthe observable @xmath , and discarding the rest of the data set. For\nthis, we rewrite trivially equation ( 2.8 ) as\n\n  -- -------- -- --------\n     @xmath      (2.10)\n  -- -------- -- --------\n\nThe expression on the right hand side is the ratio of the sensitivity of\nthe observable to the model parameter @xmath , to the accuracy with\nwhich the observable can be extracted from the data, @xmath . One of the\nconceivable approaches in order to estimate the true value of the\nparameter @xmath , is to perform a @xmath fit to the measured value of\n@xmath . It is simple to show that this ratio, evaluated at the best fit\nvalue, is in fact proportional to the expected value of the curvature of\n@xmath at this value. Since the curvature of the @xmath surface\ndescribes how fast the value of the @xmath is increasing when moving\naway from the best fit value, its inverse may be interpreted as an\napproximation to the error estimate that the analysis with the help of\n@xmath will put on @xmath .\nThus, equation ( 2.10 ) shows that by only considering @xmath and not\nthe full data set, we may have lost information on @xmath , a loss given\nby the difference between the left and right hand side of that equation.\nWhile the latter may be interpreted as the information on @xmath\ncontained in the part of the data represented by @xmath , we may have\nlost trace of any other source of information.\nIt should be noted that while we have just chosen to interpret the right\nhand side of ( 2.10 ) as the information in @xmath , this is a slight\nabuse of terminology. More rigorously, the Fisher information in @xmath\nis not the right hand side of ( 2.10 ) but the Fisher information of its\ndensity function\n\n  -- -------- -- --------\n     @xmath      (2.11)\n  -- -------- -- --------\n\nbut it will always be clear in this thesis from the context which one is\nmeant. Anticipating the nomenclature of chapter 3 , the right hand side\nof ( 2.10 ) is actually the information in the mean of @xmath . From\nequation ( 2.10 ) we infer\n\n  -- -------- -- --------\n     @xmath      (2.12)\n  -- -------- -- --------\n\n##### 2.1.2 The general case\n\nThese considerations on the Cram\u00e9r-Rao bound can be easily generalised\nto the case of many parameters and many estimators of as many\nobservables. Still dealing with a measurement @xmath with outcomes\n@xmath , we want to estimate a set of parameters\n\n  -- -------- -- --------\n     @xmath      (2.13)\n  -- -------- -- --------\n\nwith the help of some vector of observables,\n\n  -- -------- -- --------\n     @xmath      (2.14)\n  -- -------- -- --------\n\nthat are extracted from @xmath with the help of an array of unbiased\nestimators,\n\n  -- -------- -- --------\n     @xmath      (2.15)\n  -- -------- -- --------\n\nIn this multidimensional setting, all the three scalar quantities that\nplayed a role in our discussion in section 2.1.1 , i.e. the variance of\nthe estimator, the derivative of the observable with respect to the\nparameter, and the Fisher information, are now matrices.\nThe Fisher information @xmath in @xmath on the parameters @xmath is\ndefined as the square matrix\n\n  -- -------- -- --------\n     @xmath      (2.16)\n  -- -------- -- --------\n\nWhile the diagonal elements @xmath are the information scalars @xmath in\nequation ( 2.1 ), the off diagonal ones describe correlated information.\nThe Fisher information matrix still carries the three properties we\ndiscussed in section 2.1 .\nThe variance of the estimator in equation ( 2.7 ) now becomes the\ncovariance matrix @xmath of the estimators @xmath , defined as\n\n  -- -------- -- --------\n     @xmath      (2.17)\n  -- -------- -- --------\n\nFinally, the derivative of the observable with respect to the parameter,\nin the right hand side of ( 2.8 ), becomes a matrix @xmath , in general\nrectangular, defined as\n\n  -- -------- -- --------\n     @xmath      (2.18)\n  -- -------- -- --------\n\nwhere @xmath runs over all elements of the set @xmath of model\nparameters. Again, the Cram\u00e9r-Rao inequality provides a useful link\nbetween these three matrices, and again there are two approaches to that\nequation : first, as usually presented in the literature ( Rao , 1973 )\n, in the form of a lower bound to the covariance matrix of the\nestimators,\n\n  -- -------- -- --------\n     @xmath      (2.19)\n  -- -------- -- --------\n\nThe inequality between two symmetric matrices @xmath having the meaning\nthat the matrix @xmath is positive definite. \u00b9 \u00b9 1 A symmetric matrix\n@xmath is called positive definite when for any vector @xmath holds that\n@xmath . Further we say for such matrices that @xmath is larger than\n@xmath , or @xmath , whenever @xmath . A concrete implication for our\npurposes is e.g. that the diagonal entries of the left hand side of (\n2.19 ) or ( 2.20 ), which are the individual variances of each estimator\n@xmath , are greater than those of the right hand side. For many more\nproperties of positive definite matrices, see for instance ( Bhatia ,\n2007 ) . If, as above, we consider the special case of identifying the\nparameters with the observables themselves, the matrix @xmath is the\nidentity matrix, and so we obtain that the covariance of the vector of\nthe estimators is bounded by the inverse of the amount of Fisher\ninformation that there is on the observables in the data,\n\n  -- -------- -- --------\n     @xmath      (2.20)\n  -- -------- -- --------\n\nSecond, we can turn this lower bound on the covariance to a lower bound\non the amount of information in the data set as well. By rearranging\nequation ( 2.19 ), we obtain the multidimensional analogue of equation (\n2.10 ), the information inequality, which describes the loss of\ninformation that occurs when the data is reduced to a set of estimators,\n\n  -- -- -- --------\n           (2.21)\n  -- -- -- --------\n\nThis information inequality is a central piece to much of this thesis. A\nproof can be found in the appendix. A maybe simpler proof follows also\nfor instance from the discussion in the appendix of chapter 3 .\nInstead of giving a useful lower bound to the covariance of the\nestimator as in the Cram\u00e9r-Rao inequality, equation ( 2.19 ), the\ninformation inequality makes clear how information is in general lost\nwhen reducing the data to any particular set of estimators. The right\nhand side may be seen, as before, as the expected curvature of a @xmath\nfit to the estimates produced by the estimators @xmath , when evaluated\nat the best fit value, with all correlations fully and consistently\ntaken into account. Note that as before the right hand side of the\ninformation inequality is not the Fisher information content of the\njoint probability density function of the estimators, but only that of\ntheir means.\nIn section 2.2 , we discuss how Jaynes\u2019 Maximal Entropy Principle allow\nus to understand the total information content of a data set, once a\nmodel is specified, in very similar terms.\n\n##### 2.1.3 Resolving the density function: Fisher information density\n\nDue to its generality, the information inequality ( 2.21 ) is very\npowerful. We now have a deeper look at a special case that sheds some\nlight on the definition of the Fisher information matrix ( 2.16 ), and\nthat we will use in part II .\nAssuming that the variable @xmath is continuous and one dimensional,\npick a set of points @xmath with separation @xmath covering some range\n@xmath of the variable, such that in the limit of a large number of\npoints we can write\n\n  -- -------- -- --------\n     @xmath      (2.22)\n  -- -------- -- --------\n\nGeneralisation to discrete variables or multidimensional cases will be\nobvious.\nDefine then a set of estimator @xmath as follows\n\n  -- -------- -- --------\n     @xmath      (2.23)\n  -- -------- -- --------\n\nThese estimators simply build an histogram of the variable over @xmath .\nIn other words, our set of estimators are defined such the entire\ndensity function is resolved over @xmath .\nWe want to evaluate the information inequality for this set of\nestimators. We have\n\n  -- -------- -- --------\n     @xmath      (2.24)\n  -- -------- -- --------\n\nwith covariance matrix\n\n  -- -------- -- --------\n     @xmath      (2.25)\n  -- -------- -- --------\n\nDefine as @xmath the probability that a realisation of the variable does\nnot belong to @xmath :\n\n  -- -------- -- --------\n     @xmath      (2.26)\n  -- -------- -- --------\n\nIt is then easily seen that the inverse covariance matrix is\n\n  -- -------- -- --------\n     @xmath      (2.27)\n  -- -------- -- --------\n\nIt follows that the right hand side of the information inequality\nbecomes\n\n  -- -- -- --------\n           (2.28)\n  -- -- -- --------\n\nThis is nothing else than\n\n  -- -------- -- --------\n     @xmath      (2.29)\n  -- -------- -- --------\n\nIf @xmath covers the full range of the variable, then the first term is\nprecisely the total Fisher information matrix, and the second vanishes,\nsince @xmath . It is clear from ( 2.29 ) that we can interpret\n\n  -- -------- -- --------\n     @xmath      (2.30)\n  -- -------- -- --------\n\nas a Fisher information density, representing information from\nobservations of the variables around @xmath . The additional term in (\n2.29 ) involving @xmath originates from the fact the the density is\nnormalised to unity : observations of the density over the range @xmath\nprovides some information on the density in the complement to @xmath ,\n\n  -- -------- -- --------\n     @xmath      (2.31)\n  -- -------- -- --------\n\nHowever, it is not possible to resolve the individual contributions of\n@xmath to @xmath for each @xmath on the complement of @xmath , and thus\nthe derivatives act in this case outside of the integrals, unlike the\nfirst term in ( 2.29 ).\n\n#### 2.2 Jaynes Maximal Entropy Principle\n\nIn cosmology, the knowledge of the probability distribution of the data\nas function of the parameters, @xmath , which is compulsory in order to\nevaluate its Fisher information content, is usually very limited. In a\ngalaxy survey, a data outcome @xmath would be typically the full set of\nangular positions of the galaxies, together with some redshift\nestimation if available, to which we may add any other kind of\ninformation, such as luminosities, shapes, etc. Our ignorance of both\ninitial conditions and of many relevant physical processes does not\nallow us to predict either galaxy positions in the sky, or all\ninterconnections with all this additional information. Our predictions\nof the shape of @xmath is thus limited to some statistical properties,\nthat are sensitive to the model parameters @xmath , such as the mean\ndensity over some large volume, or certain types of correlation\nfunctions.\nIn fact, even if it were possible to devise some procedure in order to\nget the exact form of @xmath , it may eventually turn out to be useless,\nor even undesirable, to do so. The incredibly large number of degrees of\nfreedom of such a function is very likely to overwhelm the analyst with\na mass of irrelevant details, which may have no relevant significance on\ntheir own, or improve the analysis in any meaningful way.\nThese arguments call for a kind a thermodynamical approach, which would\ntry and capture those aspects of the data which are relevant to our\npurposes, reducing the number of degrees of freedom in a drastic way.\nSuch an approach already exists in the field of probability theory (\nJaynes , 1957 ) . It is based on Shannon\u2019s concept of entropy of a\nprobability distribution ( Shannon , 1948 ) and did shed new light on\nthe connection between probability theory and statistical mechanics.\nAs we have just argued, our predictive knowledge of @xmath is limited to\nsome statistical properties. Let us formalise this mathematically, in a\nsimilar way as in section 2.1.2 . Astrophysical theory gives us a set of\nconstraints on the shape of @xmath , in the form of averages of some\nfunctions @xmath ,\n\n  -- -------- -- --------\n     @xmath      (2.32)\n  -- -------- -- --------\n\nwhere @xmath enters through the angle brackets. As an example, suppose\nthe data outcome @xmath is a map of the matter density field as a\nfunction of position. In this case, one of these constraints @xmath\ncould be the mean of the field or its power spectrum, as given by some\ncosmological model.\nThe role of this array @xmath is to represent faithfully the physical\nunderstanding we have of @xmath , according to the model, as a function\nof the model parameters @xmath . In the ideal case, some way can be\ndevised to extract each one of these quantities @xmath from the data and\nto confront them to theory. The set of observables @xmath , that we used\nin section 2.1.2 , would be a subset of these predictions @xmath , and\nwe henceforth refer to @xmath as the \u2019constraints\u2019.\nAlthough @xmath must satisfy the constraints ( 2.32 ), there may still\nbe a very large number of different distributions compatible with these.\nHowever, a very special status among these distributions has the one\nwhich maximises the value of Shannon\u2019s entropy \u00b2 \u00b2 2 Formally, for\ncontinuous distributions the reference to another distribution is needed\nto render S invariant with respect to invertible transformations,\nleading to the concept of the entropy of @xmath relative to another\ndistribution @xmath , @xmath , also called Kullback-Leibler divergence.\nThe quantity defined in the text is more precisely the entropy of @xmath\nrelative to a uniform probability density function. For an recent\naccount on this, close in spirit to this work, see Caticha ( 2008 ) . ,\ndefined as\n\n  -- -------- -- --------\n     @xmath      (2.33)\n  -- -------- -- --------\n\nFirst introduced by Shannon ( Shannon , 1948 ) as a measure of the\nuncertainty in a distribution on the actual outcome, Shannon\u2019s entropy\nis now the cornerstone of information theory. Jaynes\u2019 Maximal Entropy\nPrinciple states that the @xmath for which this measure @xmath is\nmaximal is the one that best deals with our insufficient knowledge of\nthe distribution, and should be therefore preferred. We refer the reader\nto Jaynes\u2019 work ( Jaynes , 1983 ; Jaynes and Bretthorst , 2003 ) and to\nCaticha ( 2008 ) for detailed discussions of the role of entropy in\nprobability theory and for the conceptual basis of maximal entropy\nmethods. Astronomical applications related to some extent to Jaynes\u2019s\nideas include image reconstruction from noisy data, (see e.g. Skilling\nand Bryan ( 1984 ); Starck and Pantin ( 1996 ); Maisinger et\u00a0al. ( 2004\n) and references therein) , mass profiles reconstruction from shear\nestimates ( Bridle et\u00a0al. , 1998 ; Marshall et\u00a0al. , 2002 ) , as well as\nmodel comparison when very few data is available ( Zunckel and Trotta ,\n2007 ) . We will see that for our purposes as well it provides us a\npowerful tool, and that the Maximal Entropy Principle is the ideal\ncomplement to Fisher information, fitting very well within our\ndiscussions in section 2.1 on the information inequality.\nIntuitively, the entropy @xmath of @xmath tells us how sharply\nconstrained the possible outcomes @xmath are, and Jaynes\u2019 Maximal\nEntropy Principle selects the @xmath which is as wide as possible, but\nat the same time consistent with the constraints ( 2.32 ) that we put on\nit. The actual maximal value attained by the entropy @xmath , among all\nthe possible distributions which satisfy ( 2.32 ), is a function of the\nconstraints @xmath , which we denote by\n\n  -- -------- -- --------\n     @xmath      (2.34)\n  -- -------- -- --------\n\nOf course it is a function of the model parameters @xmath as well, since\nthey enter the constraints. As we will see, the shape of that surface as\na function of @xmath , and thus implicitly as a function of @xmath , is\nthe key point in understanding the Fisher information content of the\ndata. In the following, in order to keep the notation simple, we will\nomit the dependency on @xmath of most of our expressions, though it will\nalways be implicit.\nThe problem of finding the distribution @xmath that maximises the\nentropy ( 2.33 ), while satisfying the set of constraints ( 2.32 ), is\nan optimization exercise. We can quote the end result ( Jaynes , 1983 ,\nchap. 11) , ( Caticha , 2008 , chap. 4) :\nThe probability density function @xmath , when it exists, has the\nfollowing exponential form,\n\n  -- -------- -- --------\n     @xmath      (2.35)\n  -- -------- -- --------\n\nin which to each constraint @xmath is associated a conjugate quantity\n@xmath , that arises formally as a Lagrange multiplier in this\noptimization problem with constraints. The conjugate variables @xmath \u2019s\nare also called \u2019potentials\u2019, terminology that we will adopt in the\nfollowing. We will see below in equation ( 2.39 ) that the potentials\nhave a clear interpretation, in the sense that the each potential @xmath\nquantifies how sensitive is the entropy function @xmath in ( 2.34 ) to\nits associated constraint @xmath . The quantity @xmath , that plays the\nrole of the normalisation factor, is called the partition function.\nSince equation ( 2.35 ) must integrate to unity, the explicit form of\nthe partition function is\n\n  -- -------- -- --------\n     @xmath      (2.36)\n  -- -------- -- --------\n\nThe actual values of the potentials are set by the constraints ( 2.32 ).\nThey reduce namely, in terms of the partition function, to a system of\nequations to solve for the potentials,\n\n  -- -------- -- --------\n     @xmath      (2.37)\n  -- -------- -- --------\n\nThe partition function @xmath is closely related to the entropy @xmath\nof @xmath . It is simple to show that the following relation holds,\n\n  -- -------- -- --------\n     @xmath      (2.38)\n  -- -------- -- --------\n\nand the values of the potentials can be explicitly written as function\nof the entropy, in a relation mirroring equation ( 2.37 ),\n\n  -- -------- -- --------\n     @xmath      (2.39)\n  -- -------- -- --------\n\nGiven the nomenclature, it is of no surprise that a deep analogy between\nthis formalism and statistical physics does exist. Just as the entropy,\nor partition function, of a physical system determines the physics of\nthe system, the statistical properties of these maximal entropy\ndistributions follow from the functional form of the Shannon entropy or\nits partition function as a function of the constraints. For instance,\nthe covariance matrix of the constraints is given by\n\n  -- -- -- --------\n           (2.40)\n  -- -- -- --------\n\nIn statistical physics the constraints can be the mean energy, the\nvolume or the mean particle number, with potentials being the\ntemperature, the pressure and the chemical potential. We refer to Jaynes\n( 1957 ) for the connection to the physical concept of entropy in\nthermodynamics and statistical physics.\n\n##### 2.2.1 Information in maximal entropy distributions\n\nWith our choice of probabilities @xmath given by equation ( 2.35 ), the\namount of Fisher information on the parameters @xmath of the model can\nbe evaluated in a straightforward way. The dependence on the model goes\nthrough the constraints, or, equivalently, through their associated\npotentials. It holds therefore that\n\n  -- -------- -- --------\n     @xmath      (2.41)\n  -- -------- -- --------\n\nwhere the second line follows from the first after application of the\nchain rule and equation ( 2.37 ). Using the covariance matrix of the\nconstraints given in ( 2.40 ), the Fisher information matrix, defined in\n( 2.16 ), can then be written as a double sum over the potentials,\n\n  -- -------- -- --------\n     @xmath      (2.42)\n  -- -------- -- --------\n\nThere are several ways to rewrite this expression as a function of the\nconstraints and\/or their potentials. First, it can be written as a\nsingle sum by using equation ( 2.37 ) as\n\n  -- -------- -- --------\n     @xmath      (2.43)\n  -- -------- -- --------\n\nAlternatively, since we will be more interested in using the constraints\nas the main variables, and not the potentials, we can show, using\nequation ( 2.39 ), that it also takes the form \u00b3 \u00b3 3 We note that this\nresult is valid only for maximal entropy distributions and is not\nequivalent to the second derivative of the entropy with respect to the\nparameters themselves. However it is formally identical to the\ncorresponding expression for the information content of distributions\nwithin the exponential family ( Jennrich and Moore , 1975 ) , or ( van\nden Bos , 2007 , chapter 4) , once the curvature of the entropy surface\nis identified with the generalized inverse of the covariance matrix.\n\n  -- -------- -- --------\n     @xmath      (2.44)\n  -- -------- -- --------\n\nWe will use both of these last expressions in chapter 4 of this thesis.\nEquation ( 2.44 ) presents the total amount of information on the model\nparameters @xmath in the data @xmath , when the model predicts the set\nof constraints @xmath . The amount of information is in the form of a\nsum of the information contained in each constraint, with correlations\ntaken into account, as in the right hand side in equation ( 2.21 ). In\nparticular, it is a property of the maximal entropy distributions, that\nif the constraints @xmath are not redundant, then it follows that the\ncurvature matrix of the entropy surface @xmath is invertible and is the\ninverse of the covariance matrix @xmath between the observables. To see\nthis explicitly, consider the derivative of equation ( 2.37 ) with\nrespect to the potentials,\n\n  -- -------- -- --------\n     @xmath      (2.45)\n  -- -------- -- --------\n\nThe inverse of the matrix on the left hand side, if it can be inverted,\nis @xmath , which can be obtained taking the derivative of equation (\n2.39 ), with the result\n\n  -- -------- -- --------\n     @xmath      (2.46)\n  -- -------- -- --------\n\nWe have thus obtained in equation ( 2.44 ), combining Jaynes\u2019 Maximal\nEntropy Principle together with Fisher\u2019s information, the exact\nexpression of the information inequality ( 2.21 ) for our full set of\nconstraints, but with an equality sign.\nWe see that the choice of maximal entropy probabilities is fair, in the\nsense that all the Fisher information comes from what was forced upon\nthe probability density function, i.e. the constraints. No additional\nFisher information is added when these probabilities are chosen. In\nfact, as shown in the appendix this requirement alone is enough to\nsingle out the maximal entropy distributions, as being precisely those\nfor which the information inequality is an equality. This can be\nunderstood in terms of sufficient statistics and goes back to Pitman and\nWishart ( 1936 ) and Kopman ( 1936 ) . For a discussion in the language\nof the exponential family of distribution see Zografos and Ferentinos (\n1994 ) .\nIn the special case that the model parameters are the constraints\nthemselves, we have\n\n  -- -------- -- --------\n     @xmath      (2.47)\n  -- -------- -- --------\n\nwhich means that the Fisher information on the model predictions\ncontained in the expected future data is directly given by the\nsensitivity of their corresponding potential. Also, the application of\nthe Cram\u00e9r-Rao inequality, in the form given in equation ( 2.20 ), to\nany set of unbiased estimators of @xmath , shows that the best joint,\nunbiased, reconstruction of @xmath is given by the inverse curvature of\nthe entropy surface @xmath , which is, as we have shown, @xmath .\nWe emphasise at this point that although the amount of information is\nseen to be identical to the Fisher information in a Gaussian\ndistribution of the observables with the above correlations, nowhere in\nour approach do we assume Gaussian properties. The distribution of the\nconstraints @xmath themselves is set by the maximal entropy distribution\nof the data.\n\n##### 2.2.2 Redundant observables\n\nWe have just seen that in the case of independent constraints, the\nentropy of @xmath provides through equation ( 2.44 ) both the joint\ninformation content of the data, as well as the inverse covariance\nmatrix between the observables. However, if the constraints put on the\ndistribution are redundant, the covariance matrix is not invertible, and\nthe curvature of the entropy surface cannot be inverted either. We show\nhowever that in these cases, our equations for the Fisher information\ncontent ( 2.42 , 2.43 , 2.44 ) are still fully consistent, dealing\nautomatically with redundant information to provide the correct answer.\n\nAn example of redundant information occurs trivially if one of the\nfunctions @xmath can be written in terms of the others. For instance,\nfor galaxy survey data, the specification of the galaxy power spectrum\nas an constraint, together with the mean number of galaxy pairs as\nfunction of distance, and\/or the two-points correlation function, which\nare three equivalent descriptions of the same statistical property of\nthe data. Although the number of observables @xmath , and thus the\nnumber of potentials, describing the maximal entropy distribution\ngreatly increases by doing so, it is clear that we should expect the\nFisher matrix to be unchanged, by adding such superfluous pieces of\ninformation. A small calculation shows that the potentials adjust\nthemselves so that it is actually the case, meaning that this type of\nredundant information is automatically discarded within this approach.\nTherefore, we need not worry about the independency of the constraints\nwhen evaluating the information content of the data, which will prove\nconvenient in some cases.\n\nThere is another, more relevant type of redundant information, that\nallow us to understand better the role of the potentials. Consider that\nwe have some set of constraints @xmath , and that we obtain the\ncorresponding @xmath that maximises the entropy. This @xmath could then\nbe used to predict the value @xmath of the average some other function\n@xmath , that is not contained in our set of predictions,\n\n  -- -------- -- --------\n     @xmath      (2.48)\n  -- -------- -- --------\n\nFor instance, the maximal entropy distribution built with constraints on\nthe first @xmath moments of @xmath , will predict some particular value\nfor the @xmath -th moment, @xmath , that the model was unable to predict\nby itself.\nSuppose now some new theoretical work provides the shape of @xmath as a\nfunction of the model parameters. This new constraint can thus now be\nadded to the previous set, and a new, updated @xmath is obtained by\nmaximising the entropy. There are two possibilities at this point :\n\n-   It may occur that the value of @xmath as provided by the model is\n    identical to the prediction by the maximal entropy distribution that\n    was built without that constraint. Since the new constraint was\n    automatically satisfied, the maximal entropy distribution satisfying\n    the full set of @xmath constraints must be equal to the one\n    satisfying the original set. From the equality of the two\n    distributions, which are both of the form ( 2.35 ), it follows that\n    the additional constraint must have vanishing associated potential,\n\n      -- -------- -- --------\n         @xmath      (2.49)\n      -- -------- -- --------\n\n    while the other potentials are pairwise identical. It follows\n    immediately that the total information, as seen from equation ( 2.43\n    ) is unaffected, and no information on the model parameters was\n    gained by this additional prediction. A cosmological example would\n    be to enforce on the distribution of some field, together with the\n    two-points correlation function, fully disconnected higher order\n    correlation functions. It is well known that the maximal entropy\n    distribution with constrained two-points correlation function has a\n    Gaussian shape, and that Gaussian distributions have disconnected\n    points function at any order. No information is thus provided by\n    these field moments of higher order in this case.\n    This argument shows that, for a given set of original constraints\n    and associated maximal entropy distribution, any function @xmath ,\n    which was not contained in this set, with average @xmath , can be\n    seen as being set to zero potential. Such @xmath \u2019s therefore do not\n    contribute to the information.\n\n-   More interesting is, of course, the case where this additional\n    constraint differs from the predictions obtained from the original\n    set @xmath . Suppose that there is a mismatch @xmath between the\n    predictions of the maximal entropy distribution and the model. In\n    this case, when updating @xmath to include this constraint, the\n    potentials are changed by this new information, a change given to\n    first order by\n\n      -- -------- -- --------\n         @xmath      (2.50)\n      -- -------- -- --------\n\n    and the amount of Fisher information changes accordingly. It is\n    interesting to note that the entropy itself is invariant at this\n    order. From equation ( 2.39 ) we have namely\n\n      -- -------- -- --------\n         @xmath      (2.51)\n      -- -------- -- --------\n\n    since the new constraint was originally at zero potential. The\n    entropy is, therefore, stationary not only with respect to changes\n    in the probability distribution function, but also with respect to\n    the predictions its associated maximal entropy distribution makes on\n    any other quantities.\n\nOf course, although the formulae of this section are valid for any\nmodel, it requires numerical work in order to get the partition function\nand\/or the entropy surface in a general situation.\n\n##### 2.2.3 The entropy and Fisher information content of Gaussian\nhomogeneous fields\n\nWe now obtain the Shannon entropy of a family of fields when only the\ntwo-point correlation function is the relevant constraint, that we will\nuse later in this thesis. It is easily obtained by a straightforward\ngeneralisation of the finite dimensional multivariate case, where the\nmeans and covariance matrix of the variables are known. It is well known\n( Shannon , 1948 ) that the maximal entropy distribution is in this case\nthe multivariate Gaussian distribution. Denoting the constraints on\n@xmath with the matrix @xmath and vector @xmath\n\n  -- -- -- --------\n           (2.52)\n  -- -- -- --------\n\nthe associated potentials are given explicitly by the relations\n\n  -- -------- -- --------\n     @xmath      (2.53)\n  -- -------- -- --------\n\nwhere the matrix @xmath is the covariance matrix\n\n  -- -------- -- --------\n     @xmath      (2.54)\n  -- -------- -- --------\n\nThe Shannon entropy is given by, up to some irrelevant additive\nconstant,\n\n  -- -------- -- --------\n     @xmath      (2.55)\n  -- -------- -- --------\n\nThe fact that about half of the constraints are redundant, due to the\nsymmetry of the @xmath and @xmath matrices, is reflected by the fact\nthat the corresponding inverse correlation matrix in equation ( 2.44 ),\n\n  -- -------- -- --------\n     @xmath      (2.56)\n  -- -------- -- --------\n\nis not invertible as such if we considers all entries of the matrix\n@xmath as constraints. Of course, this is not the case anymore if only\nthe independent entries of @xmath form the constraints.\nUsing the handy formalism of functional calculus, we can\nstraightforwardly extend the above relations to systems with infinite\ndegrees of freedom, i.e. fields, where means as well as the two-point\ncorrelation functions are constrained. A realisation of the variable\n@xmath is now a field, or a family of fields @xmath , taking values on\nsome @xmath -dimensional space. The expressions above in the\nmultivariate case all stays valid, with the understanding that\noperations such as matrix multiplications have to be taken with respect\nto the discrete indices as well as the continuous ones.\nWith the two-point correlation function and means\n\n  -- -- -- --------\n           (2.57)\n  -- -- -- --------\n\nwe still have, up to an unimportant constant,\n\n  -- -------- -- --------\n     @xmath      (2.58)\n  -- -------- -- --------\n\nIn n-dimensional Euclidean space, within a box of volume @xmath for a\nfamily of homogeneous fields, it is simplest to work with the spectral\nmatrices. These are defined as\n\n  -- -------- -- --------\n     @xmath      (2.59)\n  -- -------- -- --------\n\nwhere the Fourier transforms of the fields are defined through\n\n  -- -------- -- --------\n     @xmath      (2.60)\n  -- -------- -- --------\n\nIt is well known that these matrices provide an equivalent description\nof the correlations, since the they form Fourier pairs with the\ncorrelation functions\n\n  -- -------- -- --------\n     @xmath      (2.61)\n  -- -------- -- --------\n\nIn this case, the entropy in equation ( 2.58 ) reduces, again discarding\nirrelevant constants, to an uncorrelated sum over the modes,\n\n  -- -------- -- --------\n     @xmath      (2.62)\n  -- -------- -- --------\n\nwhich is the straightforward mutlidimensional version of ( Taylor and\nWatts , 2001 , eq. 39) . Comparison with equation ( 2.55 ) shows the\nwell-known fact that the modes can be seen as Gaussian, uncorrelated and\ncomplex variables with correlation matrices proportional to @xmath . All\nmodes have zero mean, except for the zero-mode, which, as seen from its\ndefinition, is proportional to the mean of the field itself.\nAccordingly, taking the appropriate derivatives, the potentials @xmath\nassociated to @xmath read\n\n  -- -------- -- --------\n     @xmath      (2.63)\n  -- -------- -- --------\n\nand those associated to the means @xmath ,\n\n  -- -------- -- --------\n     @xmath      (2.64)\n  -- -------- -- --------\n\nNote that although the spectral matrices are, in general, complex, they\nare hermitian, so that the determinants are real. The amount of Fisher\ninformation in the family of fields is easily obtained with the help of\nequation ( 2.43 ) , with the familiar result\n\n  -- -- -- --------\n           (2.65)\n  -- -- -- --------\n\nwith @xmath being the connected part of the spectral matrices,\n\n  -- -------- -- --------\n     @xmath      (2.66)\n  -- -------- -- --------\n\nThese expressions are of course also valid for isotropic fields on the\nsphere. With a decomposition in spherical harmonics, the sum runs over\nthe multipoles.\nThe Fisher matrices in common use in weak lensing or clustering can thus\nall be seen as special cases of this approach, namely equation ( 2.65 ),\nwhen knowledge of the statistical properties of the future data does not\ngo beyond the two-point statistics. Indeed, in the case that the model\ndoes not predict the means, and knowing that for discrete fields the\nspectral matrices, equation ( 2.59 ), carry a noise term due to the\nfinite number of galaxies, or, in the case of weak lensing, also due to\nthe intrinsic ellipticities of galaxies, the amount of information in (\n2.65 ) is essentially identical to the standard expressions used to\npredict the accuracy with which parameters will be extracted from\npower-spectra analysis.\nOf course, the maximal entropy approach, which tries to capture the\nrelevant properties of @xmath through a sophisticated guess, gives no\nguaranties that its predictions are actually correct. Nevertheless, as\ndiscussed in section 2.2.2 , it provides a systematic approach with\nwhich to update the probability density function in case of improved\nknowledge of the relevant physics.\n\n#### 2.3 Appendix\n\nIn 2.3.1 , we look at what possible \u2019information densities\u2019 do in fact\nsatisfy those conditions that we would like any measure of information\nabout the true value of a model parameter to possess. We then provide in\n2.3.2 a unified derivation of the Cram\u00e9r-Rao and information inequality\nin the multidimensional case (following a similar argumentation than in\nRao ( 1973 ) ) and then show its relation to maximal entropy\ndistributions.\n\n##### 2.3.1 Measures of information on a parameter\n\nDenoting with @xmath the probability density function of some variable,\nwe look for functionals @xmath\n\n  -- -------- -- --------\n     @xmath      (2.67)\n  -- -------- -- --------\n\nsuch that our candidate of the measure of information on @xmath is given\nby\n\n  -- -------- -- --------\n     @xmath      (2.68)\n  -- -------- -- --------\n\nand has the following properties :\nC1: We would want our functional to be a regular function of two\narguments, one being the value of the probability function at @xmath\nitself, and the second the value of its derivative with respect to the\nsame @xmath ,\n\n  -- -------- -- --------\n     @xmath      (2.69)\n  -- -------- -- --------\n\nWhile the main reason for this very strong requirement is simplicity, it\nappears nonetheless reasonable to us. This condition simply reflects the\nfact that the values of @xmath in regions far away from the true value\nof @xmath should not provide much information, or that the information\nis provided by the probabilities and the linear impact of @xmath around\nthe true value.\nC2: The choice of coordinates must not carry information, i.e. we want\n\n  -- -------- -- --------\n     @xmath      (2.70)\n  -- -------- -- --------\n\nwhenever @xmath is an invertible function. While this is automatic for\ndiscrete probabilities, this is not the case for continuous\ndistributions.\nC3: The information on @xmath from independent experiments should add\n\n  -- -------- -- --------\n     @xmath      (2.71)\n  -- -------- -- --------\n\nThe last two are the key requirements for the interpretation of @xmath\nas information. In combination with the first requirement, it leads to\nthe following result: up to a multiplicative constant, there is a unique\npositive definite density satisfying these conditions. it reads\n\n  -- -------- -- --------\n     @xmath      (2.72)\n  -- -------- -- --------\n\nwhich is easily seen to be precisely the Fisher information measure, as\ndefined in equation ( 2.1 ).\nFrom now on, in order to simplify the notation, we write the two\narguments @xmath and @xmath of @xmath as @xmath and @xmath . If we drop\nthe positive definite condition, the general solution is\n\n  -- -------- -- --------\n     @xmath      (2.73)\n  -- -------- -- --------\n\nfor arbitrary constants @xmath . This result follows from the claim that\nthe most general smooth function satisfying @xmath and @xmath should be\nof the form\n\n  -- -------- -- --------\n     @xmath      (2.74)\n  -- -------- -- --------\n\nfor a set of arbitrary constants @xmath . The two last terms do not meet\n@xmath and are thus to be discarded, while the first one is the only\npositive definite among the three others. In order to see why this\nholds, we first note, as can be checked by direct calculation, that in\nthis form @xmath fulfill the requirements @xmath and @xmath . We then\nuse extensively @xmath for particular instances of variables with\ndifferent distributions and derivatives, sketching the proof that these\ncriteria do not allow other functional forms.\nWe first notice that, since any probability density function must be\nnormalised to unity, for any value of the model parameter, the following\nrelations must hold for any variable @xmath ,\n\n  -- -------- -- --------\n     @xmath      (2.75)\n  -- -------- -- --------\n\nas well as\n\n  -- -------- -- --------\n     @xmath      (2.76)\n  -- -------- -- --------\n\nWe now consider, beside an arbitrary distribution @xmath , the\ndistribution of some independent variable @xmath , given by @xmath , and\ndenote the derivatives with respect to @xmath associated to @xmath and\n@xmath , as @xmath and @xmath ,\n\n  -- -------- -- --------\n     @xmath      (2.77)\n  -- -------- -- --------\n\nwhere the dependency on @xmath is omitted. The joint probability density\nfunction of the independent variables @xmath and @xmath is given by the\nproduct of @xmath with @xmath , with associated derivative\n\n  -- -------- -- --------\n     @xmath      (2.78)\n  -- -------- -- --------\n\nCondition @xmath states in these terms explicitly that for any such\n@xmath such that ( 2.75 ) holds, and @xmath such that ( 2.76 ) holds,\nthe following relation, describing the additivity of information, must\nbe true,\n\n  -- -------- -- --------\n     @xmath      (2.79)\n  -- -------- -- --------\n\nWith the help of this relation we can constrain the functional form of\n@xmath .\nLet us first pick a uniform probability density for the variable @xmath\n,\n\n  -- -------- -- --------\n     @xmath      (2.80)\n  -- -------- -- --------\n\nIt must hold, using @xmath , that\n\n  -- -------- -- --------\n     @xmath      (2.81)\n  -- -------- -- --------\n\nfor any allowed @xmath . It can be shown, for instance by performing\nvariations with respect to @xmath , that any solution to this integral\nequation must obey the relation\n\n  -- -------- -- --------\n     @xmath      (2.82)\n  -- -------- -- --------\n\nfor some function @xmath , that satisfies\n\n  -- -------- -- --------\n     @xmath      (2.83)\n  -- -------- -- --------\n\nThis must still hold as above for any @xmath and associated derivative\nfunction @xmath , satisfying ( 2.75 ) and ( 2.76 ) respectively. Taking\na variation with respect to @xmath shows that the only solutions for\n@xmath of this equation are\n\n  -- -------- -- --------\n     @xmath      (2.84)\n  -- -------- -- --------\n\nfor some arbitrary constants @xmath and @xmath . Therefore, we have\nconstrained the full function @xmath to be of the form\n\n  -- -------- -- --------\n     @xmath      (2.85)\n  -- -------- -- --------\n\nfor some unknown functions @xmath and @xmath . The first two terms are\nfull solutions of @xmath . With very similar methods, the two other\nterms can be reduced to\n\n  -- -------- -- --------\n     @xmath      (2.86)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (2.87)\n  -- -------- -- --------\n\nIn this form, all terms in equation ( 2.85 ) are consistent with @xmath\nand we have thus proved our claim ( 2.74 ).\n\n##### 2.3.2 Cram\u00e9r-Rao bound and maximal entropy distributions\n\nWe denote the vector of model parameters of dimension @xmath with\n\n  -- -------- -- --------\n     @xmath      (2.88)\n  -- -------- -- --------\n\nand a vector of functions of dimension @xmath the estimators\n\n  -- -------- -- --------\n     @xmath      (2.89)\n  -- -------- -- --------\n\nwith expectation values @xmath . In the following, we rely on Gram\nmatrices, whose elements are defined by scalar products. Namely, for a\nset of vectors @xmath , the Gram matrix @xmath generated by this set of\nvectors is defined as\n\n  -- -------- -- --------\n     @xmath      (2.90)\n  -- -------- -- --------\n\nGram matrices are positive definite and have the same rank as the set of\nvectors that generate them. Especially, if the vectors are linearly\nindependent, the Gram matrix is strictly positive definite and\ninvertible.\nWe adopt a vectorial notation for functions, writing scalar products\nbetween vectors as\n\n  -- -------- -- --------\n     @xmath      (2.91)\n  -- -------- -- --------\n\nwith @xmath being the probability density function of the variable\n@xmath of interest. In this notation, both the Fisher information matrix\nand covariance matrix are seen to be Gram matrices. We have namely that\nthe Fisher information matrix reads\n\n  -- -------- -- --------\n     @xmath      (2.92)\n  -- -------- -- --------\n\nwhile the covariance matrix of the estimators is\n\n  -- -------- -- --------\n     @xmath      (2.93)\n  -- -------- -- --------\n\nFor simplicity and since it is sufficently generic for our purpose, we\nwill assume that both sets of vectors @xmath and @xmath are lineary\nindependent, so that both matrices can be inverted. Note that we also\nhave\n\n  -- -------- -- --------\n     @xmath      (2.94)\n  -- -------- -- --------\n\nThe Gram matrix @xmath of dimension @xmath generated by the set of\nvectors @xmath takes the form\n\n  -- -------- -- --------\n     @xmath      (2.95)\n  -- -------- -- --------\n\nand is also positive definite due to its very definition. It is\ncongruent to the matrix\n\n  -- -------- -- --------\n     @xmath      (2.96)\n  -- -------- -- --------\n\nwith\n\n  -- -------- -- --------\n     @xmath      (2.97)\n  -- -------- -- --------\n\nSince two congruent matrices have the same number of positive, zero and\nnegative eigenvalues respectively and since both @xmath and @xmath are\npositive, we can conclude that\n\n  -- -------- -- --------\n     @xmath      (2.98)\n  -- -------- -- --------\n\nwhich is the Cram\u00e9r-Rao inequality. The lower bound on the amount of\ninformation is seen from the fact that for any matrix written in block\nform holds\n\n  -- -------- -- --------\n     @xmath      (2.99)\n  -- -------- -- --------\n\nand using the same congruence argument leads to the lower bound on\ninformation\n\n  -- -------- -- ---------\n     @xmath      (2.100)\n  -- -------- -- ---------\n\nAssume now that we have a probability density function such that this\ninequality is in fact an equality, i.e.\n\n  -- -------- -- ---------\n     @xmath      (2.101)\n  -- -------- -- ---------\n\nBy the above argument, the Gram matrix generated by\n\n  -- -------- -- ---------\n     @xmath      (2.102)\n  -- -------- -- ---------\n\nis congruent to the matrix\n\n  -- -------- -- ---------\n     @xmath      (2.103)\n  -- -------- -- ---------\n\nand has rank @xmath . By assumption, the covariance matrix is\ninvertible, such that the set @xmath alone has rank @xmath . It implies\nthat each of the @xmath vector can be written as linear combination of\nthe @xmath vectors,\n\n  -- -------- -- ---------\n     @xmath      (2.104)\n  -- -------- -- ---------\n\nor, more explicitly,\n\n  -- -------- -- ---------\n     @xmath      (2.105)\n  -- -------- -- ---------\n\nwhere the key point is that the coefficients @xmath are independent of\n@xmath . Integrating this equation, we obtain\n\n  -- -------- -- ---------\n     @xmath      (2.106)\n  -- -------- -- ---------\n\nfor some functions @xmath and @xmath of the model parameters only, and a\nfunction @xmath of @xmath only. We obtain thus\n\n  -- -------- -- ---------\n     @xmath      (2.107)\n  -- -------- -- ---------\n\nThis is precisely the distribution that we obtain by maximising the\nentropy relative to @xmath , while satisfying the constraints\n\n  -- -------- -- ---------\n     @xmath      (2.108)\n  -- -------- -- ---------\n\nTaking @xmath as the uniform distribution makes it identical with the\nformula in equation ( 2.35 ).\n\n### Chapter 3 Information within N-point moments\n\nIn this chapter we demonstrate how to decompose the Fisher information\nmatrix into components unambigously associated to independent\ninformation from @xmath -point moments of each order. The general\napproach to decompose the Fisher information matrix in uncorrelated\ncomponents according to an orthogonal system was briefly discussed in a\nstatistical journal in theorem 3.1 in Jarrett ( 1984 ) . It seems\nhowever that this procedure was not given further attention. In this\nchapter, similar ideas are taken further, dealing mostly with the system\nof moments, where the associated orthogonal system are orthogonal\npolynomials.\nWe start in section 3.1 with one dimensional variables. We will in a\nfirst step define for a probability distribution @xmath , coefficients\n@xmath which unambiguously represent the independent information content\nof the moment of order @xmath on @xmath . These coefficients can then be\nused to reconstruct the Fisher information matrix order by order. The\nstraight forward generalisation to any number of variables is performed\nin 3.2 , or to any hierarchical system other than the @xmath -point\nmoments in the appendix. Properties of this expansion under the presence\nof noise are discussed in 3.2.2 .\nIn section 3.3 , we then present this exact decomposition for a few\ndeterminate probability density functions. We give in closed form these\ncoefficients for several common classes of distributions, spanning a\nwide range of different situations. We solve these decomposition for the\nnormal, the gamma and the beta families of distributions, as well as for\nan extended Poisson model.\nWe use this decomposition in 3.3.1 to approach the indeterminate moment\nproblem. Namely, the Fisher information content of a moments series can\nbe less than the information content of the probability density function\nit originates from, if that function cannot be uniquely recovered from\nthe moment series. Therefore, this loss of information is also a useful\nmeasure of the indeterminacy of the moment problem. After dealing with\nthe lognormal distribution, whose expansion we will present in greater\ndetails in chapter 6 , we treat numerically the Weibull distribution and\nstrectched exponential. For each of those we compare the information\nlost to the moment hierarchy to Stoyanov\u2019s dissimilarity index of\nassociated Stieltjes classes ( Stoyanov , 2004 ) .\n\n#### 3.1 One variable\n\nOur starting point is the information inequality of chapter 2 : for any\nset of unbiased estimators @xmath aimed at extracting the vector of\nobservables @xmath , the following inequality between positive definite\nmatrices holds,\n\n  -- -------- -- -------\n     @xmath      (3.1)\n  -- -------- -- -------\n\nwhere @xmath is the covariance matrix of the estimators,\n\n  -- -------- -- -------\n     @xmath      (3.2)\n  -- -------- -- -------\n\nand @xmath is the matrix of derivatives,\n\n  -- -------- -- -------\n     @xmath      (3.3)\n  -- -------- -- -------\n\nWhen the vector @xmath are the moments themselves, @xmath for @xmath ,\nit is possible to rewrite the information inequality in a more\ninsightful form. Consider a set of polynomials @xmath , @xmath the\ndegree of the polynomial, orthogonal with respect to @xmath ,\n\n  -- -------- -- -------\n     @xmath      (3.4)\n  -- -------- -- -------\n\nwhere @xmath is some strictly positive number, equal to unity if the\npolynomials are orthonormal. Since the normalisation of many common\nfamilies of orthogonal polynomials is not unity, we will at the expense\nof extra notation keep track of the terms @xmath in the following. Of\ncourse, the polynomials\n\n  -- -------- -- -------\n     @xmath      (3.5)\n  -- -------- -- -------\n\nare then orthonormal. We refer to Freud ( 1971 ) or Szeg\u00f6 ( 2003 ) for\nthe theory of orthogonal polynomials. The polynomial @xmath is always\nset by the first @xmath moments, and is unique up to an overall sign,\nwhich we set by requiring the coefficient of @xmath in @xmath (the\nleading coefficient) to be positive. A simple way to build formally the\northonormal polynomials with this sign convention is for instance to\napply the Gram-Schmidt orthonormalisation process to the set @xmath with\nrespect to the scalar product @xmath .\nThe key point for our purposes is to realise that the inverse covariance\nmatrix between the moments can be written \u00b9 \u00b9 1 A proof can be found in\na slightly more general setting later in section 3.4.2 .\n\n  -- -------- -- -------\n     @xmath      (3.6)\n  -- -------- -- -------\n\nThis identity allows us to express the right hand side of the\ninformation inequality in the form of a sum of uncorrelated pieces :\nusing ( 3.6 ), it holds\n\n  -- -------- -- -------\n     @xmath      (3.7)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (3.8)\n  -- -------- -- -------\n\nThe matrix @xmath is therefore the part of the Fisher information in the\n@xmath th moment that was not contained in the moments of lower order.\nThese coefficients have a straightforward interpretation. They can be\nnamely written as\n\n  -- -------- -- -------\n     @xmath      (3.9)\n  -- -------- -- -------\n\nwhich we will take as the definition of @xmath . This can be seen from\nexpanding @xmath in terms of the matrix @xmath , and noting that @xmath\n, recovering ( 3.8 ). In other words, @xmath is nothing else than the\ncomponent of the corresponding function @xmath (the score function)\nparallel to the orthonormal polynomial of order @xmath .\nIt follows immediately from equation ( 3.9 ) that the Fisher information\ncontent of the moments depends on how well the score functions can be\napproximated through polynomials. With increasing @xmath , one expects\nthe score function to be better and better reproduced by the series\n\n  -- -------- -- --------\n     @xmath      (3.10)\n  -- -------- -- --------\n\nWe see that the following inequality between positive matrices holds\n\n  -- -- -- --------\n           (3.11)\n  -- -- -- --------\n\nIn particular, for any parameter @xmath holds that the residual to the\nbest approximation of the score function with polynomials is given by\n\n  -- -------- -- --------\n     @xmath      (3.12)\n  -- -------- -- --------\n\nwhere @xmath is the Fisher information on @xmath . The bits of Fisher\ninformation that are absent from the set of moments @xmath to @xmath are\nthus precisely the mean squared error of the fit of the score function\nthrough polynomials throughout the range of @xmath .\nWe define for further reference the matrices\n\n  -- -------- -- --------\n     @xmath      (3.13)\n  -- -------- -- --------\n\nas well as\n\n  -- -------- -- --------\n     @xmath      (3.14)\n  -- -------- -- --------\n\nThese are the matrices representing the independent information content\nof the @xmath th moment and of the first @xmath moments respectively. By\nconstruction holds\n\n  -- -------- -- --------\n     @xmath      (3.15)\n  -- -------- -- --------\n\nWe stress that these matrices are strictly speaking associated to a\nmoment series rather than a density function. These matrices are namely\nidentical for different densities having the same moment series.\nWe see that if the score function is itself a polynomial, of degree\n@xmath , for each values of the parameters, then only the first @xmath\nof these coefficients are possibly non-zero. A finite number of moments\ndo catch all the Fisher information content of @xmath in this case. In\nfact, the reverse statement is also true. This can be understood in the\nframework of orthodox statistics : in this case @xmath is proportional\nto the exponential of a polynomial with parameter dependent\ncoefficients, where a finite number of sufficient statistics exist\nPitman and Wishart ( 1936 ); Kopman ( 1936 ) . In the light of chapter 2\n, these distributions are precisely those that maximise Shannon entropy\nfor fixed values of the first @xmath moments. We thus have\n\n  -- -------- -- --------\n     @xmath      (3.16)\n  -- -------- -- --------\n\nThe ubiquitous example of this family being of course the Gaussian\ndistribution, for which @xmath .\nMore generally, a sufficient criterium for the moment hierarchy to\npossess the same amount of Fisher information as the density function\nitself, is that the moment problem associated to the moment series is\ndeterminate , that is to say that the density can be uniquely recovered\nfrom the moment series. In this case, indeed, by a well known theorem\ndue to M. Riesz, ( Riesz , 1923 ) , the orthogonal polynomials\nassociated to the density form a complete set of basis functions for\nsquare integrable functions. Therefore, the square residual in equation\n( 3.12 ) must go to zero for @xmath . We have in this case\n\n  -- -------- -- --------\n     @xmath      (3.17)\n  -- -------- -- --------\n\nFinally, for moment indeterminate density functions, for which different\ndensity functions exist with the same moment series, we have in general\nan inequality (again, an inequality between positive matrices, not\nmatrix element to matrix element)\n\n  -- -------- -- --------\n     @xmath      (3.18)\n  -- -------- -- --------\n\nThe amplitude of the mismatch can vary very substantially from case to\ncase. In chapter 6 , we study extensively the lognormal field, for which\nthe inequality is always a strict inequality, but is a very strong\nfunction of the variance of the field.\n\n##### 3.1.1 The Christoffel-Darboux kernel as information on the density\nitself\n\nTo conclude this section, it is interesting to understand the\ninterpretation of the orthogonal polynomials themselves, in this\ninformation theoretic framework. To this aim, consider that the model\nparameter of interests are the values of the density function\nthemselves, allowing thus complete freedom. In the following, we do not\nrequire the density to be normalised to unity for convenience. Take for\nsimplicity discrete values @xmath , with associated probability density\n@xmath and the set of model parameters being precisely the density, i.e.\n@xmath . Straight calculation leads to the following expression for the\nFisher information matrix elements on the parameters @xmath , @xmath ,\n\n  -- -------- -- --------\n     @xmath      (3.19)\n  -- -------- -- --------\n\nOn the other hand, we have @xmath , leading to\n\n  -- -------- -- --------\n     @xmath      (3.20)\n  -- -------- -- --------\n\nTherefore, the @xmath th orthogonal polynomial @xmath is the information\ncontent of the @xmath th moment on the density function @xmath itself.\nThe matrices @xmath become the celebrated Christoffel-Darboux kernel\n@xmath ( Simon , 2008 ) ,\n\n  -- -------- -- --------\n     @xmath      (3.21)\n  -- -------- -- --------\n\nWe have from these relations that the information escaping the first\n@xmath moments is given by\n\n  -- -------- -- --------\n     @xmath      (3.22)\n  -- -------- -- --------\n\nIn accordance with our discussions above, this right hand side of ( 3.22\n) is known to tend to zero as @xmath precisely for determinate moment\nproblem. This is can be seen from the fact that in this case, from Riesz\ntheorem, the reproducing property holds\n\n  -- -------- -- --------\n     @xmath      (3.23)\n  -- -------- -- --------\n\nfor any function @xmath that is square summable with respect to @xmath .\nThis implies\n\n  -- -------- -- --------\n     @xmath      (3.24)\n  -- -------- -- --------\n\nfor any such function and therefore\n\n  -- -------- -- --------\n     @xmath      (3.25)\n  -- -------- -- --------\n\n#### 3.2 Several variables\n\nThe general theory on the statistical power of moments exposed in\nsection 3.1 extends is a straightforward way to density functions of any\nnumber of variables and @xmath -point moments. We first need a little\nbit of notation. For a @xmath -dimensional variable @xmath taking values\n@xmath , a multiindex\n\n  -- -------- -- --------\n     @xmath      (3.26)\n  -- -------- -- --------\n\nis a @xmath -dimensional vector of non negative integers. The order of\nthe multiindex is defined as\n\n  -- -------- -- --------\n     @xmath      (3.27)\n  -- -------- -- --------\n\nFor a given order @xmath , there are @xmath different such multiindices\n@xmath . We define further the notation @xmath as\n\n  -- -------- -- --------\n     @xmath      (3.28)\n  -- -------- -- --------\n\nWith this notation in place, a moment of order @xmath is given by\n\n  -- -------- -- --------\n     @xmath      (3.29)\n  -- -------- -- --------\n\nand the covariance matrix between the moments is\n\n  -- -------- -- --------\n     @xmath      (3.30)\n  -- -------- -- --------\n\nIn this notation, the decomposition of the information in independent\nbits of order @xmath proceeds by strict analogy with the one dimensional\ncase. We refer to Dunkl and Xu ( 2001 ) for the general theory of\northogonal polynomials in several variables. A main difference being\nthat at a fixed order @xmath there are not one but @xmath independent\northogonal polynomials. This number is the same as the number of the\nabove multiindices of that order @xmath . Each multiindex defines namely\nan independent monomial @xmath of that order. These polynomials are not\ndefined in an unique way. The orthogonality of the polynomials of same\norder is not essential for our purposes, but requiring the following\ncondition is enough,\n\n  -- -------- -- --------\n     @xmath      (3.31)\n  -- -------- -- --------\n\nfor some positive matrices @xmath , which replace the normalisation\n@xmath in 3.1 . The component of the score function @xmath parallel to\nthe polynomial @xmath is\n\n  -- -------- -- --------\n     @xmath      (3.32)\n  -- -------- -- --------\n\nand the expansion of the score function in terms of these polynomials\nreads\n\n  -- -------- -- --------\n     @xmath      (3.33)\n  -- -------- -- --------\n\nIt will converge to the score function for @xmath if the set of\npolynomials is complete, whereas it may not if not. We note that there\nis some freedom in the definition ( 3.31 ). This freedom is that of the\nchoice of a basis in the vector space of polynomials of order @xmath\northogonal to all polynomials of lower order. For this reason, @xmath\ndepends on the particular basis. However, the expansion ( 3.33 ) does\nnot, and so will not the information matrices at fixed order.\nWriting now the orthogonal polynomials in terms of a triangular\ntransition matrix\n\n  -- -------- -- --------\n     @xmath      (3.34)\n  -- -------- -- --------\n\nwe see that the information matrix of order @xmath ( 3.13 ) becomes\n\n  -- -------- -- --------\n     @xmath      (3.35)\n  -- -------- -- --------\n\nThe strict analog of equation ( 3.14 ) holds for each @xmath ,\n\n  -- -------- -- --------\n     @xmath      (3.36)\n  -- -------- -- --------\n\nrecovering the right hand side of the information inequality for all\nmoments of order up to @xmath . Just as before, the missing piece\nbetween @xmath and @xmath is the least squared residual the\napproximation of the score function through polynomials of order up to\n@xmath .\nThe matrices @xmath and @xmath are easily seen to be invariant under\nmappings @xmath , where @xmath is an invertible square matrix of size\n@xmath and @xmath a @xmath dimensional vector, provided both are\nparameter independent.\nAs a simple illustration, for the multivariate Gaussian distribution\nwith mean vector @xmath and covariance matrix @xmath we have\n\n  -- -------- -- --------\n     @xmath      (3.37)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (3.38)\n  -- -------- -- --------\n\nsumming up to the total information, @xmath .\n\n##### 3.2.1 Independent variables and uncorrelated fiducial\n\nIn general, it is a rather difficult problem to obtain explicit\nexpressions for the orthogonal polynomials or the matrices @xmath and\n@xmath , especially in the case of several variables. Using exact though\nformal expressions as starting point requires the evaluation of\ndeterminants of moment matrices, and cases are rare when this is\ntractable. For independent variables @xmath , however, a canonical\nchoice of @xmath can be written down in terms of the ones of associated\nto one dimensional problem. More specifically, if the variables are\nindependent, then\n\n  -- -------- -- --------\n     @xmath      (3.39)\n  -- -------- -- --------\n\nwhere @xmath denotes the one dimensional probability density function of\nthe @xmath th variable. Define then the polynomial in @xmath variables\nof order @xmath through\n\n  -- -------- -- --------\n     @xmath      (3.40)\n  -- -------- -- --------\n\nwhere @xmath is the orthonormal polynomial in one variable of order\n@xmath with respect to @xmath . It is not difficult to see that for any\nmultiindices @xmath and @xmath the average over @xmath factorizes in\naverages with respect to each variable @xmath . We have namely\n\n  -- -------- -- --------\n     @xmath      (3.41)\n  -- -------- -- --------\n\nThe so defined polynomials are therefore orthogonal with matrices @xmath\nbeing unit matrices. From equation ( 3.39 ) follows that the function\n@xmath is the sum of the functions @xmath of the individual variables.\nTherefore, using the above polynomials defined in ( 3.40 ), it is not\ndifficult to see that all the coefficients @xmath that couples different\nvariables vanishes, i.e. @xmath if @xmath has two or more non zero\nindices. The information content of order @xmath becomes then simply the\nsum of the information of order @xmath within each variable, as\nexpected. This is an manifestation of the additivity of Fisher\ninformation for independent variables, which is thus seen to hold order\nby order.\nNote that polynomials also take this product form ( 3.40 ) if as above\nthe probability density function factorizes at the fiducial values of\nthe model parameters, but with the difference that there is no splitting\nof the derivative functions @xmath as a uncorrelated sum. In this case,\nthe fiducial model is uncorrelated, but model parameters create\ncorrelations away from their fiducial values. @xmath -point moments at\nnon zero lag may carry genuine information in this case. In mathematical\nterms, all @xmath can possibly be non zero, depending on how the score\nfunctions couple the different variables.\n\n##### 3.2.2 On the impact of noise\n\nVery often the observed random variable is the sum of two random\nvariables,\n\n  -- -------- -- --------\n     @xmath      (3.42)\n  -- -------- -- --------\n\nwhere @xmath is a @xmath -dimensional variable carrying the information\non the parameters @xmath , and @xmath is some additive noise. We set\n\n  -- -------- -- --------\n     @xmath      (3.43)\n  -- -------- -- --------\n\nto be the probability density function for @xmath , and\n\n  -- -------- -- --------\n     @xmath      (3.44)\n  -- -------- -- --------\n\nbeing that for @xmath , which is parameter independent. From the rules\nof probability theory, we have\n\n  -- -------- -- --------\n     @xmath      (3.45)\n  -- -------- -- --------\n\nIn this section, we prove the following, maybe rather intuitive fact,\nvalid for any functional form of @xmath and of @xmath , any model\nparameters and any dimensionality @xmath :\nFor any @xmath , the following relation between positive matrices holds\n\n  -- -------- -- --------\n     @xmath      (3.46)\n  -- -------- -- --------\n\nOn the other hand, this relation does not hold for the matrices @xmath .\nFor instance, a non Gaussian noise @xmath on a Gaussian signal @xmath\nwill create in general third and higher order terms in the score\nfunctions. However, their amplitude is constrained by ( 3.46 ).\nWe prove this inequality here only for one dimensional variables, @xmath\n. The general proof consists in replacing indices such as @xmath with\nmultindices @xmath and so on.\nOur proof is based on the following basic fact concerning blockwise\npositive matrices (for a proof of this particular fact, see ( Bhatia ,\n2007 , e.g.) : Whenever @xmath and @xmath are strictly positive\nmatrices, then\n\n  -- -------- -- --------\n     @xmath      (3.47)\n  -- -------- -- --------\n\nWe proceed as follows : in general we can write the moments of @xmath as\na linear combination of those of @xmath\n\n  -- -- -- --------\n           (3.48)\n  -- -- -- --------\n\nNote that @xmath is a triangular matrix with non vanishing diagonal\nelements, and is therefore invertible. Writing @xmath , it holds\ntherefore\n\n  -- -------- -- --------\n     @xmath      (3.49)\n  -- -------- -- --------\n\nwhere @xmath , respectively @xmath is the moment matrix @xmath of @xmath\n, respectively @xmath . The claim ( 3.46 ) is proven provided\n\n  -- -------- -- --------\n     @xmath      (3.50)\n  -- -------- -- --------\n\nwhich is equivalent to\n\n  -- -------- -- --------\n     @xmath      (3.51)\n  -- -------- -- --------\n\nWe now prove this last relation.\nConsider the following vector\n\n  -- -------- -- --------\n     @xmath      (3.52)\n  -- -------- -- --------\n\nand the matrix @xmath defined with the help of this vector,\n\n  -- -------- -- --------\n     @xmath      (3.53)\n  -- -------- -- --------\n\nSuch a matrix of scalar products is called a Gram matrix. @xmath has by\ndefinition the block form\n\n  -- -------- -- --------\n     @xmath      (3.54)\n  -- -------- -- --------\n\nIt is well known that any Gram matrix is positive : from the definition\nof @xmath , we have that @xmath for any vector @xmath . Using the above\nfact ( 3.47 ) we have\n\n  -- -------- -- --------\n     @xmath      (3.55)\n  -- -------- -- --------\n\nEquivalently\n\n  -- -------- -- --------\n     @xmath      (3.56)\n  -- -------- -- --------\n\nTaking the inverse gives\n\n  -- -------- -- --------\n     @xmath      (3.57)\n  -- -------- -- --------\n\nwhich concludes the proof.\n\n##### 3.2.3 Poissonian discreteness effects\n\nThe same relations hold for another source of noise relevant in\ncosmological surveys, i.e. discreteness effects due to a finite number\nof tracers of the underlying fields. A common parametrisation is the\nPoisson model, where the observed number of tracers in a cell is given\nby a Poisson variable with intensity the value of the underlying\ncontinuous field @xmath at that point. Explicitly, with @xmath the\nnumber of tracers in @xmath cells, we set their joint probability to be\n\n  -- -------- -- --------\n     @xmath      (3.58)\n  -- -------- -- --------\n\nThis model has the peculiar property of transforming the moments of\n@xmath to factorial moments : the falling factorial in @xmath variables\n\u00b2 \u00b2 2 see ( 3.95 ) for the falling factorial in one dimension becomes\n\n  -- -------- -- --------\n     @xmath      (3.59)\n  -- -------- -- --------\n\nand we have indeed the known curious relation\n\n  -- -- -- --------\n           (3.60)\n  -- -- -- --------\n\nUsing this relation, it is easy to prove with the same methods than\nabove that\n\n  -- -------- -- --------\n     @xmath      (3.61)\n  -- -------- -- --------\n\nfor any @xmath . This does not appear to be necessarily the case for\nmore generic functional form of @xmath , since there are no obvious\nrelations between the first @xmath moments of @xmath and those of @xmath\n.\n\n#### 3.3 Some exactly solvable models for moment determinate densities\n\nWe derive in this section the exact analytical expressions for the\ninformation coefficients at all orders of well known families of moment\ndeterminate probability density functions. We will deal with the normal\ndistribution, the beta and gamma families as well as an extended Poisson\nmodel. For all these instances, the matrices @xmath converges to @xmath\nas @xmath .\n\n###### Normal distribution\n\nThe normal distribution provides us with a very simple illustration of\nthe approach. Its probability density function is\n\n  -- -------- -- --------\n     @xmath      (3.62)\n  -- -------- -- --------\n\nIts Fisher information matrix is well known,\n\n  -- -------- -- --------\n     @xmath      (3.63)\n  -- -------- -- --------\n\nThe information coefficients take the form\n\n  -- -------- -- --------\n     @xmath      (3.64)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (3.65)\n  -- -------- -- --------\n\nWe recover already the full matrix with the first two moments, @xmath .\nThe matrix is diagonal because there is no order @xmath for which both\ncoefficients @xmath and @xmath do not vanish.\n\n###### Derivation :\n\nIt is easily seen that the score function @xmath is a polynomial of\nfirst order in @xmath . This implies immediately that only @xmath is\nnon-zero. For any probability density function and parameter @xmath , it\nholds from ( 3.8 ) that\n\n  -- -------- -- --------\n     @xmath      (3.66)\n  -- -------- -- --------\n\nwhich proves ( 3.64 ). Very similarly, the score function associated to\n@xmath is a polynomial of second order, such that only the first two\ncoefficients can possibly be non-zero. However, @xmath vanishes since\n@xmath does not impact the mean. Finally, @xmath can be gained by noting\nthat the polynomials orthogonal to the normal distribution are the\nHermite polynomials ( Szeg\u00f6 , 2003 ) ,\n\n  -- -------- -- --------\n     @xmath      (3.67)\n  -- -------- -- --------\n\nwith normalisation @xmath . From @xmath and equation ( 3.8 ) follows\n@xmath and @xmath\n\n###### Beta distribution\n\nThe beta distribution is defined as\n\n  -- -------- -- --------\n     @xmath      (3.68)\n  -- -------- -- --------\n\nwhere @xmath is the beta integral, which will also enter the following\nsection on the gamma distribution. It has the well known representation\nin terms of the gamma function @xmath , @xmath . It plays a fundamental\nrole in order statistics.\nThe full Fisher information matrix can be conveniently expressed in\nterms of the second derivative of the logarithm of the gamma function,\ncalled the trigamma function @xmath ( Abramowitz and Stegun , 1970 , p.\n258-260) ,\n\n  -- -------- -- --------\n     @xmath      (3.69)\n  -- -------- -- --------\n\nOur derivation of the information coefficients associated to @xmath and\n@xmath , based on the explicit expressions of the orthogonal\npolynomials, in this case the Jacobi polynomials, is rather lengthy. We\ndefer it to the appendix.\nThe result is\n\n  -- -------- -- --------\n     @xmath      (3.70)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (3.71)\n  -- -------- -- --------\n\nwhere @xmath is the rising factorial. For the symmetric case @xmath ,\nthese expressions simplify considerably. We have namely\n\n  -- -------- -- --------\n     @xmath      (3.72)\n  -- -------- -- --------\n\nSince @xmath and @xmath , a short calculation shows that we recover\nindeed, summing these coefficients, the full matrix given in ( 3.69 )\n\n  -- -------- -- --------\n     @xmath      (3.73)\n  -- -------- -- --------\n\n###### Gamma distribution\n\nThe gamma distribution is a two parameter family,\n\n  -- -------- -- --------\n     @xmath      (3.74)\n  -- -------- -- --------\n\nwhere @xmath is the gamma function. Special cases include the\nexponential distribution ( @xmath ), or the chi squared distribution\nwith @xmath degrees of freedom ( @xmath ). The calculation of the Fisher\ninformation matrix associated to @xmath and @xmath is not difficult.\nAgain, the trigamma function shows up,\n\n  -- -------- -- --------\n     @xmath      (3.75)\n  -- -------- -- --------\n\nThe information coefficients are evaluated below, with the result\n\n  -- -------- -- --------\n     @xmath      (3.76)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (3.77)\n  -- -------- -- --------\n\nAs a consistency check, we see that since @xmath , we recover trivially\nthe @xmath and @xmath elements of the matrix ( 3.75 ). Its @xmath\nelement implies that the following identity must hold,\n\n  -- -------- -- --------\n     @xmath      (3.78)\n  -- -------- -- --------\n\nwhich reduces for @xmath to Euler\u2019s famous formula @xmath .\n\n###### Derivation :\n\nThe polynomials associated to that distribution are the generalized\nLaguerre polynomials @xmath ( Abramowitz and Stegun , 1970 , p.775) .\nMore precisely, we have\n\n  -- -------- -- --------\n     @xmath      (3.79)\n  -- -------- -- --------\n\nFor this reason, the polynomials orthogonal to the gamma distribution\nare\n\n  -- -------- -- --------\n     @xmath      (3.80)\n  -- -------- -- --------\n\nwith normalisation\n\n  -- -------- -- --------\n     @xmath      (3.81)\n  -- -------- -- --------\n\nThey have the explicit matrix elements @xmath \u00b3 \u00b3 3 We added the factor\n@xmath to the conventions of Abramowitz and Stegun ( 1970 ) , in\naccordance with our own conventions of having a positive leading\ncoefficient @xmath . ,\n\n  -- -------- -- --------\n     @xmath      (3.82)\n  -- -------- -- --------\n\nThe moments of the gamma function are given by\n\n  -- -------- -- --------\n     @xmath      (3.83)\n  -- -------- -- --------\n\nThe Fisher information on @xmath is the simplest. It holds namely that\nthe score function associated to @xmath is a polynomial first order in\n@xmath , and therefore that only @xmath is non-zero. It follows\n\n  -- -------- -- --------\n     @xmath      (3.84)\n  -- -------- -- --------\n\nThe calculation of @xmath requires a little bit more work, but we can\nmake use of previous results we derived when dealing with the beta\nfamily. The derivatives of the moments with respect to @xmath are given\nby\n\n  -- -------- -- --------\n     @xmath      (3.85)\n  -- -------- -- --------\n\nUsing the representation ( 3.8 ), together with\n\n  -- -------- -- --------\n     @xmath      (3.86)\n  -- -------- -- --------\n\none obtains the following expression\n\n  -- -------- -- --------\n     @xmath      (3.87)\n  -- -------- -- --------\n\nThe sum is precisely the function @xmath defined in ( 3.142 ), evaluated\na @xmath and @xmath , and that we proved in ( 3.150 ) to be a\nrepresentation of the beta function,\n\n  -- -------- -- --------\n     @xmath      (3.88)\n  -- -------- -- --------\n\nWe conclude therefore\n\n  -- -------- -- --------\n     @xmath      (3.89)\n  -- -------- -- --------\n\n###### Poisson model\n\nConsider the probability density function\n\n  -- -------- -- --------\n     @xmath      (3.90)\n  -- -------- -- --------\n\nwith @xmath the Dirac delta function. This is the usual Poisson law,\ntogether with some amplitude @xmath that is left free. If @xmath is set\nto unity, we recover the Poisson law. This is a peculiar situation in\nterms of Fisher information. Unlike the previous situations, the\nparameter @xmath impacts indeed the range of @xmath . The Fisher\ninformation on @xmath is not well defined, formally infinite.\nEven though the Fisher information matrix is not well defined, the\ninformation coefficients as given in equations ( 3.8 ) or ( 3.9 ) are\nstill meaningful, and so are their interpretation ( 3.7 ) in terms of\nthe expected curvature of a @xmath fit. The result is\n\n  -- -------- -- --------\n     @xmath      (3.91)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (3.92)\n  -- -------- -- --------\n\nNote that it is compatible with the fact that the Fisher information on\n@xmath is infinite. For any @xmath the sum\n\n  -- -------- -- --------\n     @xmath      (3.93)\n  -- -------- -- --------\n\nis divergent. The turnover of the coefficients occurs around @xmath\nwhere they start to increase. Atypically, the higher order the moment\nthe most interesting it becomes for inference on @xmath in this model.\n\n###### Derivation :\n\nConsider the Charlier polynomials ( Abramowitz and Stegun , 1970 ,\npp.788) , defined by\n\n  -- -------- -- --------\n     @xmath      (3.94)\n  -- -------- -- --------\n\nwhere\n\n  -- -------- -- --------\n     @xmath      (3.95)\n  -- -------- -- --------\n\nis the falling factorial. These are the polynomials orthogonal with\nrespect to the Poisson distribution with intensity @xmath . Clearly, the\npolynomials\n\n  -- -------- -- --------\n     @xmath      (3.96)\n  -- -------- -- --------\n\nare then the polynomials orthogonal to @xmath . The normalization is\n\n  -- -------- -- --------\n     @xmath      (3.97)\n  -- -------- -- --------\n\nOn the other hand, the moments are given by @xmath , where @xmath is the\n@xmath th moment of the Poisson distribution. For this reason, it holds\nthat @xmath . This equation, together with ( 3.96 ) implies that the\ninformation coefficients on @xmath are independent of the actual value\nof @xmath , since @xmath and @xmath . So are the coefficients @xmath .\nWe can therefore from now on safely chose @xmath as the fiducial value,\nand work with the usual Poisson distribution and associated Charlier\npolynomials.\nThe coefficients associated to @xmath are the simplest to obtain. It is\nnot difficult to see that the score function associated to @xmath of the\nPoisson distribution is a polynomial of first order. We obtain @xmath\nand @xmath . Turning to @xmath , we need to evaluate\n\n  -- -------- -- --------\n     @xmath      (3.98)\n  -- -------- -- --------\n\nThe derivation we propose uses extensively the technique of generating\nfunctions ( Wilf , 1994 ) , and is a variation on the following theme :\nconsider the known expression for the factorial moments of the Poisson\ndistribution,\n\n  -- -------- -- --------\n     @xmath      (3.99)\n  -- -------- -- --------\n\nEven though it may appear mysterious at first sight, a simple way to\nprove this identity is to notice\n\n  -- -------- -- ---------\n     @xmath      (3.100)\n  -- -------- -- ---------\n\nwhere @xmath is called the probability generating function, and to try\nand evaluate the right hand side. This is indeed very convenient, since\nthe probability generating function of the poisson law takes a very\nsimple form,\n\n  -- -------- -- ---------\n     @xmath      (3.101)\n  -- -------- -- ---------\n\nThe derivatives are trivial to evaluate, proving ( 3.99 ). We will need\nthe following result, that comes out directly from an essentially\nidentical argument,\n\n  -- -------- -- ---------\n     @xmath      (3.102)\n  -- -------- -- ---------\n\nwhere @xmath is some number.\nWe now turn to the evaluation of\n\n  -- -------- -- ---------\n     @xmath      (3.103)\n  -- -------- -- ---------\n\nThis sum can be written as the first derivative with respect to @xmath\nevaluated at @xmath of the following expression\n\n  -- -------- -- ---------\n     @xmath      (3.104)\n  -- -------- -- ---------\n\nas can be seen directly from an expansion of the Charlier polynomials\n@xmath in terms of the coefficients @xmath . Using equation ( 3.94 ) and\nour result ( 3.102 ), we obtain\n\n  -- -- -- ---------\n           (3.105)\n  -- -- -- ---------\n\nThe derivative with respect to @xmath is easily performed :\n\n  -- -------- -- ---------\n     @xmath      (3.106)\n  -- -------- -- ---------\n\nAlso, using Leibniz rule for derivatives of products, we can write\n\n  -- -------- -- ---------\n     @xmath      (3.107)\n  -- -------- -- ---------\n\nThe factor of @xmath cancels in equation ( 3.105 ), so that\n\n  -- -------- -- ---------\n     @xmath      (3.108)\n  -- -------- -- ---------\n\nFrom the properties of the binomial coefficients follows that the sum\nover @xmath is just @xmath . Therefore,\n\n  -- -------- -- ---------\n     @xmath      (3.109)\n  -- -------- -- ---------\n\nThe derivatives are easily computed :\n\n  -- -------- -- ---------\n     @xmath      (3.110)\n  -- -------- -- ---------\n\nwith the final result given in equation ( 3.92 ).\n\n##### 3.3.1 Moment indeterminate densities\n\nWe now turn to indeterminate distributions, i.e. those that cannot be\nuniquely recovered from their moments. In this case, the Fisher\ninformation content of the moments will generally not converge to the\ntotal amount. In this respect, the limit\n\n  -- -------- -- ---------\n     @xmath      (3.111)\n  -- -------- -- ---------\n\na number in @xmath , may be thought of as an indirect measure of the\namount of indeterminacy of the moment problem. A value of unity means\nthat the moments do carry the same information on the parameter @xmath\nas the probability density function, while for values close to zero a\nlarge amount of information on @xmath is not present in the hierarchy.\nThe quantity @xmath has via the information inequality the\ninterpretation of the ratio of the expected constraints on @xmath by\nextraction of the full set of moments to the best constraints achievable\nwith the help of unbiased estimators of @xmath . When more than one\nparameter are of interest, this definition is not really satisfactory\nanymore, since it is tied to @xmath exclusively. One way to get around\nthis is by defining a ratio of determinants,\n\n  -- -------- -- ---------\n     @xmath      (3.112)\n  -- -------- -- ---------\n\nwhere @xmath was defined in equation ( 3.14 ). Clearly, @xmath is the\ncumulative efficiency to catch the information. Since the matrices in\nthe numerator and denominator do transform in the same way under any\nsmooth reparametrisation of the parameters, or coordinates, of the\nfamily, this ratio is left unchanged under such transformations. Thus,\n@xmath and @xmath are well defined quantities associated to that family\nof distributions, independently of the chosen coordinates.\nNaively, one might expect this lost information to reflect in some way\nthe freedom there is in the choice of a distribution with the very same\nseries of moments. We will therefore compare our results to a measure of\nthis freedom, @xmath , that was proposed recently ( Stoyanov , 2004 ) as\nthe index of dissimilarity of a Stieltjes class. A Stieltjes class is a\nfamily of probability density functions of the form\n\n  -- -------- -- ---------\n     @xmath      (3.113)\n  -- -------- -- ---------\n\nall having the same moment series as the central probability density\nfunction @xmath . The index @xmath , defined as\n\n  -- -------- -- ---------\n     @xmath      (3.114)\n  -- -------- -- ---------\n\nin @xmath is the maximal distance between two members of the class,\nbeing zero for determinate moment problems, where @xmath must\nidentically vanish.\nWe will consider three types of probability density functions, the\nlognormal, which is indeterminate for any values of its parameter space,\nas well as the Weibull distribution and the stretched exponential, which\nare indeterminate solely for parts of their parameter range. For these\nlast two distributions we could not find in all cases exact analytical\nexpressions for the coefficients @xmath . We generated them therefore\nnumerically, using a fine discretization procedure to obtain the\northogonal polynomials, following the exposition in Gautschi ( 2004 ) .\n\n###### Lognormal distribution\n\nThe lognormal distribution has the following functional form,\n\n  -- -------- -- ---------\n     @xmath      (3.115)\n  -- -------- -- ---------\n\nThe parameters @xmath and @xmath are the mean and the variance of @xmath\nwhich is normally distributed. They are related to the mean @xmath and\nvariance @xmath of @xmath by the relations\n\n  -- -------- -- ---------\n     @xmath      (3.116)\n  -- -------- -- ---------\n\nThe only relevant parameter for our purposes is the reduced variance\n@xmath , in terms of which our results can be expressed. The information\ncoefficients associated to the parameters @xmath and @xmath we will\nderive in details in chapter 6 , (see also Carron ( 2011 ) ), with the\nhelp of @xmath -series. These are given by\n\n  -- -------- -- ---------\n     @xmath      (3.117)\n  -- -------- -- ---------\n\nIn these equations,\n\n  -- -------- -- ---------\n     @xmath      (3.118)\n  -- -------- -- ---------\n\nand\n\n  -- -------- -- ---------\n     @xmath      (3.119)\n  -- -------- -- ---------\n\nis the q-Pochammer symbol Andrews et\u00a0al. ( 1999 ) . According to the\nchain rule of derivation, we obtain @xmath and @xmath . On the other\nhand, since @xmath is normally distributed, the total Fisher information\nmatrix @xmath associated to @xmath and @xmath is diagonal with @xmath\nand @xmath as diagonal elements. It follows that in these coordinates\n@xmath .\nThe Stieltjes class we consider is set by\n\n  -- -------- -- ---------\n     @xmath      (3.120)\n  -- -------- -- ---------\n\nOthers are given in Heyde ( 1963 ) but are equivalent to a uninteresting\nrescaling of @xmath . After an obvious variable substitution, the\ndissimilarity index becomes\n\n  -- -------- -- ---------\n     @xmath      (3.121)\n  -- -------- -- ---------\n\nIn figure 3.1 , we show the cumulative efficiency @xmath , for @xmath\nand @xmath for the lognormal family, evaluated with the exact\nexpressions given in ( 3.117 ), solid lines from bottom to top, together\nwith the dissimilarity index @xmath , shown as the dashed line,\nevaluated by numerical integration of equation ( 3.121 ). It is not\ndifficult to see from the above expressions that the coefficients @xmath\ndecay exponentially for large @xmath , such that the convergence is\nrather quick over the full range. We observe a very sharp transition in\n@xmath as soon as the reduced variance approaches unity, from a regime\nwhere the entire information content is within the second moment, as for\nthe normal distribution (and thus where the indeterminacy of the moment\nproblem is irrelevant for parameter estimation), to the opposite regime\nwhere all moments completely fail to capture the information. This\ncutoff is discussed at length in chapter 6 . On the other hand. the\nindex @xmath is seen to be remarkably constant over the range shown,\nequal to its limiting values for @xmath , which can be evaluated from (\n3.121 ) to be @xmath .\n\n###### Weibull distribution\n\nWe consider now the Weibull distribution with shape parameter @xmath and\nscale parameter @xmath ,\n\n  -- -------- -- ---------\n     @xmath      (3.122)\n  -- -------- -- ---------\n\nThe variable @xmath can be seen as a power of an exponentially\ndistributed variable with intensity unity, @xmath , for @xmath . It is\nknown that the moment problem associated to the moments of @xmath is\ndeterminate for @xmath and indeterminate for @xmath ( Stoyanov , 1987 ,\nsection 11.3 e.g.) . A Stieltjes class in the latter regime is provided\nin the same reference, which after some algebraic manipulations reduces\nto\n\n  -- -------- -- ---------\n     @xmath      (3.123)\n  -- -------- -- ---------\n\nThe index @xmath becomes\n\n  -- -------- -- ---------\n     @xmath      (3.124)\n  -- -------- -- ---------\n\nIt is interesting to note that this integral can be performed\nanalytically, for instance with the help of partial integration, with\nthe result\n\n  -- -------- -- ---------\n     @xmath      (3.125)\n  -- -------- -- ---------\n\nWe evaluated @xmath and the associated @xmath numerically, using the\nconvenient coordinates @xmath and @xmath . It is not difficult to see\nthat @xmath is independent of @xmath . The full information matrix for\nthese parameters can be evaluated analytically, with the result @xmath .\nThe results for @xmath are shown in figure 3.2 , that we present as for\nthe lognormal as function of the reduced variance\n\n  -- -------- -- ---------\n     @xmath      (3.126)\n  -- -------- -- ---------\n\nThe dashed vertical line corresponding to @xmath separates the two\nregimes where, on the left, @xmath is unity and @xmath zero since the\nmoment problem is determinate, and on the right, where the moment\nproblem is indeterminate. The scale @xmath corresponds to @xmath .\nWhile the decay of @xmath is also very sharp in the indeterminate\nregime, very slow convergence of @xmath is seen to occur in the large\nreduced variance regime unlike for the lognormal distribution. This also\nin the region @xmath , which corresponds to the phase where the Weibull\ndistribution goes from a unimodal to a monotonically decreasing\ndistribution, but @xmath still is unity, since the moment problem still\nis determinate. For instance, for @xmath , the following exact result\ncan be gained with the same methods as exposed in this section,\n\n  -- -------- -- ---------\n     @xmath      (3.127)\n  -- -------- -- ---------\n\n###### Stretched exponential function\n\nFinally, we treat the case of the stretched exponential,\n\n  -- -------- -- ---------\n     @xmath      (3.128)\n  -- -------- -- ---------\n\nJust as for the Weibull distribution, the moment problem associated to\nthe moments of @xmath is determinate for @xmath and indeterminate for\n@xmath ( Stoyanov , 1987 , section 11.4) A Stieltjes class is given by\n\n  -- -------- -- ---------\n     @xmath      (3.129)\n  -- -------- -- ---------\n\nwhere @xmath is as above given by @xmath .\n\nNumerical evaluation of @xmath , and of the dissimilarity index is shown\nin fig 3.3 . As for the Weibull distribution, these results are\nindependent of the scale parameter @xmath . We can conclude that in none\nof the situations we investigated is @xmath a good tracer of the\nimportance of the indeterminacy of the moment problem for parameter\ninference.\n\n#### 3.4 Appendix\n\n##### 3.4.1 Derivation for the beta family\n\nIn the following we will need the first two derivatives of the logarithm\nof the gamma function. These are called the digamma @xmath and trigamma\n@xmath functions respectively ( Abramowitz and Stegun , 1970 , p.\n258-260) ,\n\n  -- -------- -- ---------\n     @xmath      (3.130)\n  -- -------- -- ---------\n\nThe Fisher information matrix can be gained by noting that by\ndifferentiation under the integral sign, we have\n\n  -- -------- -- ---------\n     @xmath      (3.131)\n  -- -------- -- ---------\n\nUsing the representation of the beta integral in terms of the Gamma\nfunction, we conclude that\n\n  -- -------- -- ---------\n     @xmath      (3.132)\n  -- -------- -- ---------\n\nIn order to obtain the information coefficients @xmath and @xmath , it\nis more convenient to start with @xmath . @xmath will then be gained\neffortlessly by looking at the symmetry of the problem.\nFrom the definition of the beta integral, the moments of the beta\ndistribution are given by\n\n  -- -------- -- ---------\n     @xmath      (3.133)\n  -- -------- -- ---------\n\nThe derivatives of the moments with respect to @xmath are given by\n\n  -- -------- -- ---------\n     @xmath      (3.134)\n  -- -------- -- ---------\n\nThe orthogonal polynomials are the Jacobi polynomials @xmath (\nAbramowitz and Stegun , 1970 , page 774) . Instead of the parameters\n@xmath used in Abramowitz and Stegun ( 1970 ) , we stick to @xmath and\n@xmath , which are more appropriate for our purposes \u2074 \u2074 4 We have in\nthe notation of Abramowitz and Stegun ( 1970 ) @xmath . These\npolynomials are proportional to the Jacobi polynomials @xmath ( Szeg\u00f6 ,\n2003 , chap. IV) , orthogonal on the interval @xmath . Their matrix\nelements of @xmath are given explicitly by\n\n  -- -- -- ---------\n           (3.135)\n  -- -- -- ---------\n\nWe first note the following relation,\n\n  -- -------- -- ---------\n     @xmath      (3.136)\n  -- -------- -- ---------\n\nwhere\n\n  -- -------- -- ---------\n     @xmath      (3.137)\n  -- -------- -- ---------\n\nis the rising factorial. Since @xmath is given by\n\n  -- -------- -- ---------\n     @xmath      (3.138)\n  -- -------- -- ---------\n\nthe evaluation of the following sum is necessary,\n\n  -- -------- -- ---------\n     @xmath      (3.139)\n  -- -------- -- ---------\n\nThe following paragraphs are dedicated to the lengthy but\nstraightforward proof of the following result,\n\n  -- -------- -- ---------\n     @xmath      (3.140)\n  -- -------- -- ---------\n\nThe proof consists of a number of steps.\n\n###### Step 1 :\n\nUsing an always useful trick, we turn the rising factorial in the sum\ninto a power and differentiate : from\n\n  -- -------- -- ---------\n     @xmath      (3.141)\n  -- -------- -- ---------\n\nfollows\n\n  -- -------- -- ---------\n     @xmath      (3.142)\n  -- -------- -- ---------\n\nWe then perform the derivatives using the Leibniz rule of derivation.\nSince\n\n  -- -------- -- ---------\n     @xmath      (3.143)\n  -- -------- -- ---------\n\none obtains\n\n  -- -------- -- ---------\n     @xmath      (3.144)\n  -- -------- -- ---------\n\n###### Step 2\n\nTo obtain @xmath , we first construct an integral representation of the\nfunction @xmath . From the relation ( Andrews et\u00a0al. , 1999 , theorem\n1.2.7)\n\n  -- -------- -- ---------\n     @xmath      (3.145)\n  -- -------- -- ---------\n\nof the digamma function, we note that\n\n  -- -------- -- ---------\n     @xmath      (3.146)\n  -- -------- -- ---------\n\nWriting\n\n  -- -------- -- ---------\n     @xmath      (3.147)\n  -- -------- -- ---------\n\nthe sum over @xmath becomes a geometric series. We obtain therefore,\n\n  -- -------- -- ---------\n     @xmath      (3.148)\n  -- -------- -- ---------\n\nWe can now perform the sum over @xmath in @xmath . We have indeed\n\n  -- -------- -- ---------\n     @xmath      (3.149)\n  -- -------- -- ---------\n\nIt follows immediately\n\n  -- -------- -- ---------\n     @xmath      (3.150)\n  -- -------- -- ---------\n\nWe only need derivatives of that function evaluated at @xmath . The\norder of each derivative is @xmath . For this reason the term @xmath in\nthis expression actually plays no role. Each such derivative is thus a\nbeta integral :\n\n  -- -------- -- ---------\n     @xmath      (3.151)\n  -- -------- -- ---------\n\n###### Step 3 :\n\nTo go further, we use the following property of the beta integral,\n\n  -- -------- -- ---------\n     @xmath      (3.152)\n  -- -------- -- ---------\n\nwhich can be seen from its representation in terms of the gamma\nfunction, or from its integral representation ( Andrews et\u00a0al. , 1999 ,\npage 5) . Two applications of this rule leads to\n\n  -- -------- -- ---------\n     @xmath      (3.153)\n  -- -------- -- ---------\n\nBy combining this relation with ( 3.151 ), and using\n\n  -- -------- -- ---------\n     @xmath      (3.154)\n  -- -------- -- ---------\n\nwe have shown\n\n  -- -------- -- ---------\n     @xmath      (3.155)\n  -- -------- -- ---------\n\nThis form is very convenient, since many terms now cancel in equation (\n3.144 ). We obtain\n\n  -- -------- -- ---------\n     @xmath      (3.156)\n  -- -------- -- ---------\n\nThe sum over @xmath would vanish would it run up to @xmath . Its value\nis therefore minus the @xmath term, which is unity. It follows\n\n  -- -------- -- ---------\n     @xmath      (3.157)\n  -- -------- -- ---------\n\nwhich was to be proved.\nGetting @xmath requires now only to keep track of the normalization. The\nnormalization of the Jacobi polynomials @xmath Abramowitz and Stegun (\n1970 ) is\n\n  -- -------- -- ---------\n     @xmath      (3.158)\n  -- -------- -- ---------\n\n(Note that there is a additional factor of @xmath with respect to\nAbramowitz and Stegun ( 1970 ) since there the measure is not normalized\nto unit integral). We have from equations ( 3.134 ), ( 3.136 ), ( 3.138\n) and ( 3.140 ) together with some algebra\n\n  -- -------- -- ---------\n     @xmath      (3.159)\n  -- -------- -- ---------\n\nTedious calculations are not needed to get @xmath , but symmetry\nconsiderations are enough. The Jacobi polynomials obeys the symmetry\nrelation,\n\n  -- -------- -- ---------\n     @xmath      (3.160)\n  -- -------- -- ---------\n\nand therefore\n\n  -- -------- -- ---------\n     @xmath      (3.161)\n  -- -------- -- ---------\n\nIt is then not difficult \u2075 \u2075 5 for instance from the representation (\n3.9 ) to see that @xmath is proportional to @xmath with @xmath and\n@xmath exchanged. We conclude\n\n  -- -------- -- ---------\n     @xmath      (3.162)\n  -- -------- -- ---------\n\n##### 3.4.2 General hierarchical systems, recursion relations.\n\nThis chapter was focussed on the hierarchy of @xmath -point moments,\nwith associated orthogonal system the orthogonal polynomials. One of\ncourse expects the approach of this chapter to extend in some way to any\nsystem of observables. It is the aim of this section to discuss briefly\nthe case of other hierarchical systems.\nGiven a density function @xmath , where @xmath , consider a set of\nfunctions, (a hierarchy @xmath ),\n\n  -- -------- -- ---------\n     @xmath      (3.163)\n  -- -------- -- ---------\n\nwhich can be finite or infinite. The restrictions are @xmath , the\nfunctions to be linearly independent with respect to the density @xmath\n, as well as @xmath to be well defined.\nThe density provides us with a scalar product,\n\n  -- -------- -- ---------\n     @xmath      (3.164)\n  -- -------- -- ---------\n\nConsider now the orthonormal system built from @xmath , following the\nGram-Schmidt orthogonalisation procedure. Explicitly, they can be built\nrecursively from\n\n  -- -------- -- ---------\n     @xmath      (3.165)\n  -- -------- -- ---------\n\nBy construction, we have indeed\n\n  -- -------- -- ---------\n     @xmath      (3.166)\n  -- -------- -- ---------\n\n@xmath is a polynomial in the hierarchy members, in the sense that\n\n  -- -------- -- ---------\n     @xmath      (3.167)\n  -- -------- -- ---------\n\nfor some matrix elements @xmath , with @xmath , and @xmath .\nVery useful is the following identity between matrices of size @xmath :\n\n  -- -------- -- ---------\n     @xmath      (3.168)\n  -- -------- -- ---------\n\n###### Derivation\n\nConsider the expansion of @xmath in terms of @xmath :\n\n  -- -------- -- ---------\n     @xmath      (3.169)\n  -- -------- -- ---------\n\nSuch an expansion is always possible since the set of @xmath and @xmath\nspan the same space by construction. It follows @xmath . Expanding in\nthis relation @xmath with the help of the matrix @xmath , we obtain\n\n  -- -------- -- ---------\n     @xmath      (3.170)\n  -- -------- -- ---------\n\nRelation ( 3.168 ) follows.\nWe are writing now the moments of the hierarchy as @xmath . The inverse\nof the covariance matrix @xmath between the members of @xmath is given\nby\n\n  -- -------- -- ---------\n     @xmath      (3.171)\n  -- -------- -- ---------\n\nThis is indeed the @xmath lower right block of @xmath .\nFrom these considerations follows : Define the (positive) Fisher\ninformation matrix within the first @xmath hierarchy members, @xmath as\n\n  -- -------- -- ---------\n     @xmath      (3.172)\n  -- -------- -- ---------\n\nIf the density is a probability density, then @xmath , and therefore\n\n  -- -------- -- ---------\n     @xmath      (3.173)\n  -- -------- -- ---------\n\nWriting @xmath as @xmath we can expand the matrix as\n\n  -- -------- -- ---------\n     @xmath      (3.174)\n  -- -------- -- ---------\n\nThe coefficients @xmath is therefore the information on @xmath in @xmath\nthat was not contained already in the previous members of the hierarchy.\nThe bits of information absent from the hierarchy are given by\n\n  -- -------- -- ---------\n     @xmath      (3.175)\n  -- -------- -- ---------\n\nThis matrix on the right hand side of that relation is positive (it is a\nGram matrix), and thus this relation states that the information within\nthe hierarchy is always less than the total information. From this\ninequality follows thus the information inequality for any set of\nprobes. Convergence to the total information occurs when\n\n  -- -------- -- ---------\n     @xmath      (3.176)\n  -- -------- -- ---------\n\nin the mean square error sense with respect to @xmath . This implies\nthat the hierarchy is efficient precisely when @xmath is sparse in\n@xmath . In particular, maximal entropy distributions with the\nprescribed moments of @xmath have a finite non zero numbers of\ncoefficients. Note that @xmath is the best approximation of @xmath with\nthe given hierarchy up to @xmath according to this mean square\ncriterium.\n\n###### Recursion relations\n\nRemember the triangular matrix @xmath of size @xmath defined above,\n@xmath . The following relations are easily seen to hold,\n\n  -- -------- -- ---------\n     @xmath      (3.177)\n  -- -------- -- ---------\n\nIt follows that the matrix @xmath is nothing else than the Cholesky\ndecomposition of the moment matrix. Multiplying ( 3.165 ) with the score\nfunction and integrating, one obtains\n\n  -- -------- -- ---------\n     @xmath      (3.178)\n  -- -------- -- ---------\n\nThis can provide a way to evaluate numerically these coefficient, after\na Cholesky decomposition of the moment matrix. However, it is necessary\nto keep in mind that large moment matrices are infamously known for\nbeing generically badly conditioned ( Tyrtyshnikov , 1994 ) .\n\n## Part II Applications for cosmology\n\n### Chapter 4 On the combination of shears, magnification and flexion\nfields\n\nAt the heart of weak lensing as a cosmological probe lies the\nconvergence field, the weighted projection along the line of sight of of\nthe density fluctuation field, with weights sensitive to the geometry of\nthe Universe. In this chapter we use the duality of the Shannon entropy\nand Fisher information introduced in chapter 2 to discuss quantitatively\nthe combination of different probes of the convergence field, both for\nmass reconstruction as well as for cosmological purposes. The probes we\ninclude are the galaxy shears, the magnification as well as the flexion\nfields, i.e. all modifications to the galaxy images up to second order.\nSection 4.2 describes the observables and the approach, and section 4.3\nthe results.\nWe find that flexion alone outperforms the well established shears on\nthe arcsecond scale, making flexion well suited for mass reconstruction\non small scales. At the same time, it complements powerfully the shears\non the scale of the arcminute. We find size information to carry some\nmodest, scale independent amount of information. Besides, the results of\nthis chapter show how standard cosmological Fisher matrix analysis based\non Gaussian statistics can incorporate these other probes in the most\nsimple way. From ( 4.24 ) follows namely that the inclusion of all the\ntwo-point correlations of these additional weak lensing probes can be\naccounted for by adapting the noise term.\nThe text in this section follows the second part of Carron et\u00a0al. ( 2011\n) .\n\n#### 4.1 Introduction\n\nGravitational lensing, which can be used to measure the distribution of\nmass along the line of sight, has been recognized as powerful probe of\nthe dark components of the Universe ( Schneider et\u00a0al. , 1992 ;\nBartelmann and Schneider , 2001 ; Refregier , 2003 ; Munshi et\u00a0al. ,\n2006 ; Schneider et\u00a0al. , 2006 ) since it is sensitive to both the\ngeometry of the Universe, and to the growth of structure. Weak lensing\ndata is typically used in two ways. The first, which is deployed for\ncosmological parameter fitting, relies on measuring the correlated\ndistortions in galaxy images ( Albrecht et\u00a0al. , 2006 ) . The second\napproach uses each galaxy to make a noisy measurement of the lensing\nsignal at that position. These point estimates are then used to\nreconstruct the dark matter density distribution (e.g. Kaiser and\nSquires , 1993 ; Seitz and Schneider , 2001 ) . Most of the measurements\nof weak lensing to date have focused on the shearing that galaxy images\nexperience. However, gravitational lensing causes a number of other\ndistortions of galaxy images. These include change in size, which is\nrelated to the magnification, and higher order image distortions known\nas the flexion ( Bacon et\u00a0al. , 2006 ) . A number of techniques have\nbeen developed for measuring these higher order images distortions, such\nas HOLICS ( Okura et\u00a0al. , 2007 ) and shapelets methods ( Massey et\u00a0al.\n, 2007 ) . Since all of the image distortions originate from the same\nsource, the lensing potential field, the information content of any two\nlensing measurements must be degenerate. At the same time, since each\nmethod has different systematics and specific noise properties,\ncombining multiple measurement may bring substantial benefits. Some\nrecent works have looked at the impact of combining shear and flexion\nmeasurements for mass reconstruction ( Er et\u00a0al. , 2010 ; Pires and\nAmara , 2010 ; Velander et\u00a0al. , 2010 ) , as well as the benefits for\nbreaking multiplicative bias of including galaxy size measurements (\nVallinotto et\u00a0al. , 2010 ) .\nWe will focus on tracers of galaxy image distortions up to second order\nin the distortions. These include, to first order, the change in\napparent size of the galaxies, due to the magnification source by the\nconvergence field, the two components of the shear, and, to second\norder, the four components of the two flexion fields. We will limit\nourselves to the case where the noise contaminating each probe can be\neffectively treated as independent of the model parameters. The common\npoint of the probes cited above is that they all trace, in some noisy\nway, the same central field on a discrete set of points, represented by\nthe positions of the galaxies on which the tracers are measured. The\nframework we presented in chapter 2 is ideal to deal with the special\nstructure of the situation. We will first show how we can understand the\ntotal information content of such degenerate probes of a central field\nin a general situation, and then make quantitative evaluations at the\ntwo-point level.\n\n#### 4.2 Linear tracers\n\nThe situation that we consider here is one where a broad number of\nobservables are linked in some way to a central field. We will limit\nourselves to the case where the noise contaminating each probe can be\neffectively treated as independent of the model parameters. Imagine one\nplans to perform different measurements, of observables that are all\nlinked in some way or another to the same central field, which is the\nactually interesting quantity from the point of view of the analyst. The\nmost straightforward example of such a situation, occurs when the two\npoint correlations of the central field, say the the power spectrum of\nthe convergence in weak lensing, is predicted from theory, while we try\nto extract it looking at the correlations of the two ellipticity\ncomponents of galaxies. In this case, predictive power of the power\nspectrum of the convergence turns into predictive power of (parts of)\nthe three correlation functions there are between the two ellipticity\ncomponents.\nThe predictive power of some observable @xmath of a central field (for\ninstance its power spectrum at some mode) translates into an array of\nconstraints @xmath in the noisy probes, that we could try and extract\nand confront to theory :\n\n  -- -------- -- -------\n     @xmath      (4.1)\n  -- -------- -- -------\n\nfor some functions @xmath .\nFor the purpose of this work, the case of functions linear with respect\nto @xmath is generic enough, i.e. we will consider that\n\n  -- -------- -- -------\n     @xmath      (4.2)\n  -- -------- -- -------\n\nThe entropy @xmath of the data is a function of the @xmath constraints\n@xmath . It is however fundamentally a function of @xmath since it does\nenter all of these observables. It is therefore very natural to\nassociate a potential @xmath to @xmath , although it is not itself a\nconstraint on the probability density function. In analogy with\n\n  -- -------- -- -------\n     @xmath      (4.3)\n  -- -------- -- -------\n\nwe define\n\n  -- -------- -- -------\n     @xmath      (4.4)\n  -- -------- -- -------\n\nwith the result, given by application of the chain rule, of\n\n  -- -------- -- -------\n     @xmath      (4.5)\n  -- -------- -- -------\n\nOn the other hand, the impact of a model parameter on each observables\ncan be similarly written in terms of the central observable @xmath ,\n\n  -- -------- -- -------\n     @xmath      (4.6)\n  -- -------- -- -------\n\nIt follows directly from these relations ( 4.5 ) and ( 4.6 ), and the\nlinearity of @xmath , that the joint information in the full set of\nconstraints @xmath , given in equation ( 2.43 ) as a sum over all @xmath\nconstraints, reduces to a formally identical expression with the only\ndifference that only @xmath enters :\n\n  -- -------- -- -------\n     @xmath      (4.7)\n  -- -------- -- -------\n\nwhich can also be written in the form analog to ( 2.44 ),\n\n  -- -------- -- -------\n     @xmath      (4.8)\n  -- -------- -- -------\n\nThis last equation shows that all the effect of combining this set of\nconstraints have been absorbed into the second total derivative of the\nentropy. This second total derivative is the total amount of information\nthere is on the central quantity @xmath in the data. Indeed, taking as a\nspecial case of model parameter to the central quantity itself, i.e.\n\n  -- -------- -- -------\n     @xmath      (4.9)\n  -- -------- -- -------\n\none obtains now that the full amount of information in @xmath on @xmath\nis\n\n  -- -------- -- --------\n     @xmath      (4.10)\n  -- -------- -- --------\n\nA simple application of the Cramer Rao inequality presented in equation\n( 2.10 ) shows that this effective variance @xmath is the lower bound to\nan unbiased reconstruction of the central observable from the noisy\nprobes.\nThese considerations on the effect of probe combination in the case of a\nsingle central field observable @xmath generalize easily to the case\nwhere there are many, @xmath . In this case, each central field quantity\nleads to an array of constraints in the form of equation ( 4.1 ), it is\nsimple to show that the amount of Fisher information can again be\nwritten in terms of the information associated to the central field,\nwith an effective covariance matrix between the @xmath . The result is\n\n  -- -------- -- --------\n     @xmath      (4.11)\n  -- -------- -- --------\n\nAll the effects of probe combination are thus encompassed in an\neffective covariance matrix @xmath of the central field observables,\n\n  -- -------- -- --------\n     @xmath      (4.12)\n  -- -------- -- --------\n\nAgain, an application of the Cramer Rao inequality, in the\nmulti-dimensional case, shows that this effective covariance matrix is\nthe best achievable unbiased joint reconstruction of @xmath .\nWe now explore further the case of linear probes of homogeneous Gaussian\nfields, which is cosmologically relevant and can be solved analytically\nto full extent. We will focus on zero mean fields, for which according\nto our previous section the entropy can be written in terms of the\nspectral matrices, up to a constant,\n\n  -- -------- -- --------\n     @xmath      (4.13)\n  -- -------- -- --------\n\n##### 4.2.1 Linear tracers at the two-point level\n\nThe standard instance of a linear tracer @xmath of some central field\n@xmath in weak lensing is provided by a relation in Fourier space of the\nform\n\n  -- -------- -- --------\n     @xmath      (4.14)\n  -- -------- -- --------\n\nfor some noise term @xmath , uncorrelated with @xmath , and coefficient\n@xmath . Typically, if one observes a tracer of the derivative of the\nfield @xmath , then the vector @xmath would be proportional to @xmath .\nWe are ignoring here any observational effect, such as incomplete sky\ncoverage, that would require corrections to this relation. It is clear\nfrom this relation that the spectral matrices of this family take a\nspecial form of equation ( 4.1 ): defining the spectrum of the @xmath\nfield by @xmath , we obtain by putting this relation ( 4.14 ) into (\n2.59 ), that the spectral matrices can be written at each mode in the\nform\n\n  -- -------- -- --------\n     @xmath      (4.15)\n  -- -------- -- --------\n\nwhere @xmath is the hermitian conjugate of @xmath . The matrix @xmath is\nthe spectrum of the noise components @xmath ,\n\n  -- -------- -- --------\n     @xmath      (4.16)\n  -- -------- -- --------\n\nOur subsequent results hold for any family of tracers that obey this\nrelation. While the special case in ( 4.14 ) enter this category, this\nneed not be the only instance. All the weak lensing observables we deal\nwith in this work will satisfy equation ( 4.15 ).\nBoth the n-dimensional vector @xmath and the noise matrix @xmath can\ndepend on the wave vector @xmath , but they are independent from the\nmodel parameters. The matrix @xmath of dimension @xmath is the noise\ncomponent of the spectra of the fields, typically built from two parts.\nThe first is due to the discrete nature of the fields, since such data\nconsist in quantities measured where galaxies sits, and the second to\nthe intrinsic dispersion of the measured values.\n\n##### 4.2.2 Joint entropy and information content\n\nInformation on the model parameters enters through @xmath only. To\nevaluate the full information content, we need only evaluate eq. ( 4.13\n) with the spectral matrix given in ( 4.15 ), keeping in mind the result\nfrom last section, that we need only the total derivative with respect\nto @xmath . In other words, any additive terms in the expression of the\nentropy that are independent of @xmath can be discarded.\nThis determinant can be evaluated immediately. Defining for each mode\nthe real positive number @xmath through\n\n  -- -------- -- --------\n     @xmath      (4.17)\n  -- -------- -- --------\n\nwhich can be seen as an effective noise term, a simple \u00b9 \u00b9 1 We have\nnamely for any invertible matrix @xmath and vectors @xmath the matrix\ndeterminant lemma,\n\n@xmath (4.18)\n\ncalculation shows that the joint entropy ( 4.13 ) is equivalent to the\nfollowing, where the @xmath dimensional determinant has disappeared,\n\n  -- -------- -- --------\n     @xmath      (4.19)\n  -- -------- -- --------\n\nComparison with equation ( 4.13 ) shows that we have with this equation\n( 4.19 ) the entropy of the field @xmath itself, where all the effects\nof the joint observation of this @xmath fields have been absorbed into\nthe effective noise term @xmath , that contaminates its spectrum. It\nmeans that the full combined information in the @xmath probes of the\nfield @xmath is equivalent to the information in @xmath , observed with\nspectral noise @xmath .\nOur result ( 4.10 ) applied to ( 4.19 ) puts bounds on reconstruction of\nthe field @xmath out of the observed samples, which can be at best\nreconstructed with a contaminating noise term of @xmath in its spectrum,\nwhose best unbiased reconstruction is given by\n\n  -- -------- -- --------\n     @xmath      (4.20)\n  -- -------- -- --------\n\nSince the effect of combining these probes at a single mode is only to\nchange the model independent noise term, the parameter correlations and\ndegenaracies as approximated by the Fisher information matrix stay\nunchanged, whatever the number of such probes is. We have namely from (\n4.19 ) that at a given mode @xmath , the Fisher information matrix reads\n\n  -- -------- -- --------\n     @xmath      (4.21)\n  -- -------- -- --------\n\nwith\n\n  -- -- -- --------\n           (4.22)\n  -- -- -- --------\n\nFrom the point of view of the Fisher information, it makes formally no\ndifference to extract the full set of @xmath independent elements of\neach spectral matrices, or reconstruct the field @xmath and extract its\nspectrum. They carry indeed the same amount of Fisher information.\nThese results still hold when other fields are present in the analysis,\nwhich are correlated with the field @xmath . To make this statement\nrigorous, consider in the analysis on top of our @xmath samples of the\nform ( 4.14 ) of @xmath , another homogeneous field @xmath , with\nspectrum @xmath , and cross spectrum to @xmath given by @xmath The full\nspectral matrices are in this case\n\n  -- -------- -- --------\n     @xmath      (4.23)\n  -- -------- -- --------\n\nAgain, the determinant of this matrix can be reduced to a determinant of\nlower dimension, leading to the equivalent entropy\n\n  -- -------- -- --------\n     @xmath      (4.24)\n  -- -------- -- --------\n\nIt shows that the the full set of @xmath fields can be reduced without\nloss to two fields, @xmath and @xmath , with the effective noise @xmath\ncontaminating the spectrum of @xmath .\nNote that the derivation of our results do not refer to any hypothetical\nestimators, but came naturally out of the expression of the entropy.\n\n##### 4.2.3 Weak lensing probes\n\nWe now seek a quantitative evaluation of the full joint information\ncontent of the weak lensing probes in galaxy surveys, up to second order\nin the image distortions of galaxies. The data @xmath consists of a set\nof fields, which are discrete point fields, which take values where\ngalaxies sits. We work in the two-dimensional flat sky limit, using the\nmore standard notation @xmath for the wave vector, and decompose it in\nmodulus and polar coordinate as\n\n  -- -------- -- --------\n     @xmath      (4.25)\n  -- -------- -- --------\n\nWe will throughout assume that the intrinsic values of each probe are\npairwise uncorrelated, as commonly done. Also, we will assume that the\nset of points on which the relevant quantities are measured show low\nenough clustering so that corrections to the spectra due to intrinsic\nclustering can be neglected. This is however not a limitation of our\napproach, since corrections to the above assumptions, such as the\nintroduction of some level of intrinsic alignment, can be accommodated\nfor by introducing appropriate terms in the noise matrices @xmath in (\n4.17 ). As a central field to which all our point fields relates, we\ntake for convenience the isotropic convergence field @xmath , with\nspectrum\n\n  -- -------- -- --------\n     @xmath      (4.26)\n  -- -------- -- --------\n\nIn the case of pairwise uncorrelated intrinsic values that we are\nfollowing, we see easily from ( 4.17 ) that by combining any number of\nsuch probes the effective noise is reduced at a given mode according to\n\n  -- -------- -- --------\n     @xmath      (4.27)\n  -- -------- -- --------\n\nWe therefore only need to evaluate the effective noise for each probe\nseparately, while their combination follows ( 4.27 ). To this aim, the\nevaluation of the spectral matrices ( 4.15 ), giving us @xmath , is\nnecessary. The calculations for this are presented in appendix 4.4 and\nwe use the final results in this section.\n\n###### First order, distortion matrix\n\nTo first order, the distortion induced by weak lensing on a galaxy image\nis described by the distortion matrix that contains the shear, @xmath ,\nand convergence, @xmath , which come from the second derivatives of the\nlensing potential field @xmath , (e.g. Schneider et\u00a0al. , 2006 )\n\n  -- -------- -- --------\n     @xmath      (4.28)\n  -- -------- -- --------\n\nThe shear components read\n\n  -- -------- -- --------\n     @xmath      (4.29)\n  -- -------- -- --------\n\nand we assume they are measured from the apparent ellipticities of the\ngalaxies, with identical intrinsic dispersion @xmath . Denoting with\n@xmath the number density of galaxies for which ellipticity measurements\nare available, the effective noise is\n\n  -- -------- -- --------\n     @xmath      (4.30)\n  -- -------- -- --------\n\nThe information content of the two observed ellipticity fields is thus\nexactly the same as the one of the convergence field, with a mode\nindependent noise term as above.\nTo reach for the @xmath component of the distortion matrix, we imagine\nwe have measurements of their angular size @xmath , with intrinsic\ndispersion @xmath . The intrinsic sizes of the galaxies @xmath gets\ntransformed through weak lensing according to\n\n  -- -------- -- --------\n     @xmath      (4.31)\n  -- -------- -- --------\n\nThe coefficient @xmath , is equal to unity in pure weak lensing theory,\nbut we allow it to take other values, since in a realistic situation,\nother effects such as magnification bias effectively enter this\ncoefficient (see e.g. Vallinotto et\u00a0al. ( 2010 ) ). Under our assumption\nthat the correlation of the fluctuations in intrinsic sizes can\nthemselves be neglected, the effective noise reduces to\n\n  -- -------- -- --------\n     @xmath      (4.32)\n  -- -------- -- --------\n\nThis combination of @xmath with the dispersion parameters @xmath and\n@xmath becomes the only relevant parameter in our case, and not the\nvalue of each of them.\n\n###### Second order, flexion\n\nTo second order, the distortions caused by lensing on the galaxies\nimages are given by third order derivatives of the lensing potential.\nThese are conveniently described by the spin 1 and spin 3 flexion\ncomponents @xmath and @xmath , which in the notation of ( Schneider and\nEr , 2008 ) read\n\n  -- -------- -- --------\n     @xmath      (4.33)\n  -- -------- -- --------\n\nand are extracted from measurements with intrinsic dispersion @xmath and\n@xmath . The effective noise is this time mode-dependent,\n\n  -- -------- -- --------\n     @xmath      (4.34)\n  -- -------- -- --------\n\n#### 4.3 Results\n\nFigure 4.1 shows the ratio of the effective noise to the noise present\nconsidering the shear fields only, assuming the same number densities of\ngalaxies for each probe, and the values for the intrinsic dispersion\nstated in table 4.1 . The conversion multipole @xmath (upper x-axis) to\nangular scale @xmath (lower x-axis) follows @xmath . We have adopted for\nthe size dispersion parameters the numbers from ( Vallinotto et\u00a0al. ,\n2010 ) , who evaluated this number for the DES survey conditions ( The\nDark Energy Survey Collaboration , 2005 ) . We refer to the discussion\nin ( Pires and Amara , 2010 ) for our choice of flexion dispersion\nparameters. The curves on this figure are ratios independent of the\ngalaxy number density. They are redshift independent as well, only to\nthe extent that the dispersion in intrinsic values can be treated as\nsuch. We can draw two main conclusions from figure 4.1 . First, flexion\ninformation beings to play role only at the smallest scales, on the\narcsecond scales, where it takes over and becomes the most interesting\nprobe. On the scale of @xmath amin, it can bring substantial improvement\nover shear only analysis, but only in combination with the shears, and\nnot on its own. This is in good agreement with the comparative analysis\nof the power of the flexion @xmath field and shears fields for mass\nreconstruction done in Pires and Amara ( 2010 ) , restricted to direct\ninversion methods. Second, the inclusion of size of galaxies into the\nanalysis provides a density independent, scale independent, improvement\nfactor of\n\n  -- -------- -- --------\n     @xmath      (4.35)\n  -- -------- -- --------\n\nwhich is close to a @xmath improvement for the quoted numbers. Of\ncourse, the precise value depends on the dispersion parameters of the\npopulation considered.\n\nFor the purpose of measuring cosmological parameters rather than mass\nreconstruction, more interesting are the actual values of the Fisher\ninformation matrices. Since with any combination of such probes, these\nmatrices are proportional to each other at a single mode, it makes sense\nto define the efficiency parameter of the probe @xmath through\n\n  -- -------- -- --------\n     @xmath      (4.36)\n  -- -------- -- --------\n\nwhich is a measure of what fraction of the information contained in the\nconvergence field is effectively captured by that probe. The information\nin the convergence field is, at a given mode @xmath , counting the\nmultiplicity of the mode,\n\n  -- -------- -- --------\n     @xmath      (4.37)\n  -- -------- -- --------\n\nand we have indeed that the total Fisher information in the observed\nfields is\n\n  -- -------- -- --------\n     @xmath      (4.38)\n  -- -------- -- --------\n\nTherefore, according to the interpretation of the Fisher matrix\napproximating the expected constraints on the model parameters, the\nfactor @xmath is precisely equal to the factor of degradation in the\nconstraints one would be able to put on any a parameter, with respect to\nthe case of perfect knowledge of the convergence field at this mode. It\nis not the purpose of this work to perform a very detailed study on the\nbehavior of the efficiency parameter for some specific survey and the\nsubsequent statistical gain, but its qualitative behavior is easy to\nsee. This parameter is essentially unity in the high signal to noise\nregime, while it is the inverse effective noise whenever the intrinsic\ndispersion dominates the observed spectrum. Since information on\ncosmological parameters is beaten down by cosmic variance in the former\ncase, the latter dominates the constraints. We can therefore expect from\nour above discussion the size information to tighten by a few percent\nconstraints on any cosmological parameter. On the other hand, while\nflexion becomes ideal for mass reconstruction purposes on small scales,\nit will be able to help inference on cosmological parameters only if the\nchallenge of very accurate theoretical predictions on the convergence\npower spectrum for multipoles substantially larger than @xmath will be\nmet.\nTo make these expectations more concrete, we evaluated the improvement\nin information on cosmological parameters performing a lensing Fisher\nmatrix calculation for a wide, EUCLID-like survey, in a tomographic\nsetting. For a data vector consisting of @xmath probes of the\nconvergence field @xmath in each redshift bin @xmath , it is simple to\nsee following our previous argument, that the Fisher information reduces\nto\n\n  -- -------- -- --------\n     @xmath      (4.39)\n  -- -------- -- --------\n\nwhere the @xmath matrix is given by\n\n  -- -------- -- --------\n     @xmath      (4.40)\n  -- -------- -- --------\n\nwith @xmath given by ( 4.17 ). The only difference between standard\nimplementations of Fisher matrices for lensing, such as the lensing part\nof Hu and Jain ( 2004 ) , being thus the form of the noise component. we\nevaluated these matrices respectively for\n\n  -- -------- -- --------\n     @xmath      (4.41)\n  -- -------- -- --------\n\nwhich is the precise form of the Fisher matrix for shear analysis, for\n\n  -- -------- -- --------\n     @xmath      (4.42)\n  -- -------- -- --------\n\nwhich account for size information, and\n\n  -- -------- -- --------\n     @xmath      (4.43)\n  -- -------- -- --------\n\nwhich accounts for the flexion fields as well. We note that in terms of\nobservables, these small modifications incorporate in its entirety the\nfull set of all possible correlations between the fields considered. The\nvalues of the dispersion parameters involved in these formulae are the\nsame as in table ( 4.1 ). Our fiducial model is a flat @xmath CDM\nuniverse, with parameters @xmath , @xmath , @xmath , power spectrum\nparameters @xmath , and Chevallier- Polarski-Linder parametrisation (\nChevallier and Polarski , 2001 ; Linder , 2003 ) of the dark energy\nequation of state implemented as @xmath . The distribution of galaxies\nas function of redshift needed both for the calculation of the spectra\nand to obtain the galaxy densities in each bin was generated using the\ncosmological package iCosmo ( Refregier et\u00a0al. , 2008 ) , in a way\ndescribed in ( Amara and R\u00e9fr\u00e9gier , 2007 ) . We adopted EUCLID-like\nparameters of @xmath redshift bins, a median redshift of @xmath , a\ngalaxy angular density of @xmath , and photometric redshift errors of\n@xmath .\nIn figure 4.2 , we show the improvement in the dark energy Figure of\nMerit (FOM), defined as the square root of the determinant of the\nsubmatrix @xmath of the Fisher matrix inverse @xmath ( @xmath and @xmath\nrunning over the set of eight parameters as described above), as\nfunction of the maximal angular mode @xmath considered, while @xmath\nbeing always taken to be 10. In perfect agreement with our discussion\nabove, including size information (solid line) increases the FOM\nsteadily until it saturates at a @xmath improvement when constraints on\nthe dark energy parameters are dominated by the low signal to noise\nregime. Also, flexion becomes only useful in the deep non-linear regime,\nwhere however theoretical understanding of the shape of the spectra\nstill leaves a lot to be desired.\n\nThese results are found to be very insensitive to the survey parameters,\nfor a fixed @xmath . There are also only weakly model parameter\nindependent, as illustrated in table 4.2 , which shows the corresponding\nimprovement in Fisher constraints,\n\n  -- -------- -- --------\n     @xmath      (4.44)\n  -- -------- -- --------\n\nat the saturation scale @xmath . These results are also essentially\nunchanged using either standard implementations of the halo model (\nCooray and Sheth , 2002 , for a review) or the the HALOFIT ( Smith\net\u00a0al. , 2003 ) non linear power spectrum.\n\n#### 4.4 Appendix\n\nThe data consists in a set of numbers, at each position where a galaxy\nsit and a measurement was done. We use the handy notation in terms of\nDirac delta function,\n\n  -- -------- -- --------\n     @xmath      (4.45)\n  -- -------- -- --------\n\nwhere the sum runs over the positions @xmath for which @xmath is\nmeasured. To obtain the spectral matrices, we need the Fourier transform\nof the field, which reads in our case\n\n  -- -------- -- --------\n     @xmath      (4.46)\n  -- -------- -- --------\n\nIn this work, we assume that the set of points shows negligible\nclustering, so that the probability density function for the joint\noccurrence of a particular set of galaxy positions is uniform.\nWe decompose in the following the wave vector @xmath on the flat sky in\nterms of its modulus and polar angle as\n\n  -- -------- -- --------\n     @xmath      (4.47)\n  -- -------- -- --------\n\n###### Ellipticities\n\nWhen the two ellipticity components are measured, we have two such\nfields @xmath at our disposal. For instance, the field describing the\nfirst component becomes\n\n  -- -------- -- --------\n     @xmath      (4.48)\n  -- -------- -- --------\n\nWe assume that the measured ellipticities trace the shear fields, in the\nsense that the measured components are built out of the shear at that\nposition plus some value unrelated to it,\n\n  -- -------- -- --------\n     @xmath      (4.49)\n  -- -------- -- --------\n\nThe vector @xmath relating the spectral matrices of the ellipticities\nand the convergence is then obtained by plugging ( 4.48 ) with the above\nrelations ( 4.49 ) in its definition ( 4.15 ), and using the relation\nbetween shears and convergence in equation ( 4.28 ). The result is\n\n  -- -------- -- --------\n     @xmath      (4.50)\n  -- -------- -- --------\n\nwhere @xmath is the number density of galaxies for which ellipticity\nmeasurements are available. Under our assumptions of uncorrelated\nintrinsic ellipticities, with dispersions of equal magnitude @xmath for\nthe two components, the noise matrix @xmath becomes\n\n  -- -------- -- --------\n     @xmath      (4.51)\n  -- -------- -- --------\n\nThe effective noise, given in equation ( 4.17 ) is readily computed\n\n  -- -------- -- --------\n     @xmath      (4.52)\n  -- -------- -- --------\n\n###### Sizes\n\nAs noted in the main text, the apparent sizes of galaxies are modified\nby lensing, in the following way,\n\n  -- -------- -- --------\n     @xmath      (4.53)\n  -- -------- -- --------\n\nfor some coefficient @xmath which is unity in pure weak lensing theory.\nDenoting the number of galaxies for which sizes measurements are\navailable by @xmath , and the mean intrinsic size of the sample by\n@xmath , the spectrum of the size field reduces, under the assumption of\nuncorrelated intrinsic sizes, to\n\n  -- -------- -- --------\n     @xmath      (4.54)\n  -- -------- -- --------\n\nThe vector @xmath and matrix @xmath are now numbers, that are read out\nfrom the above equation, to be\n\n  -- -------- -- --------\n     @xmath      (4.55)\n  -- -------- -- --------\n\nleading to the effective noise\n\n  -- -------- -- --------\n     @xmath      (4.56)\n  -- -------- -- --------\n\n###### Second order, flexion\n\nDenoting with @xmath and @xmath the number of galaxies for which @xmath\nand @xmath are measured, the vectors linking the flexion to convergence\nare\n\n  -- -------- -- --------\n     @xmath      (4.57)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (4.58)\n  -- -------- -- --------\n\nUsing again the assumption of uncorrelated intrinsic components, we have\nthe four dimensional diagonal noise matrix\n\n  -- -------- -- --------\n     @xmath      (4.59)\n  -- -------- -- --------\n\nleading to the effective noise, this time mode-dependent,\n\n  -- -------- -- --------\n     @xmath      (4.60)\n  -- -------- -- --------\n\n### Chapter 5 On the use of Gaussian likelihoods for power spectra\nestimators\n\nThe text of this chapter follows very closely that of Carron ( 2012a ) .\nIn this note we revisit the Fisher information content of cosmological\npower spectra of Gaussian fields, when based on the assumption of a\nmultivariate Gaussian likelihood for estimators, in order to comment on\nthat assumption. We discuss that despite the fact that the assumption of\na Gaussian likelihood is motivated by the central limit theorem, it\nleads if used consistently to a Fisher information content that violates\nthe Cram\u00e9r-Rao inequality, due to the presence of independent\ninformation from the parameter dependent covariance matrix. At any fixed\nmultipole, this artificial term is shown to become dominant in the limit\nof a large number of correlated fields. While the distribution of the\nestimators does indeed tend to a Gaussian with a large number of modes,\nit is shown, however, that its Fisher information content does not, in\nthe sense that their covariance matrix never carries independent\ninformation content. The reason why the information content of the\nspectra is correctly described by the usual formula (i.e. without the\ncovariance term) in this estimator perspective is precisely the fact the\nthe estimators have a chi-squared like distribution, and not a Gaussian\ndistribution. The assumption of a Gaussian estimators likelihood is thus\nfrom the point of view of the information neither necessary nor really\nadequate, and we warn against the use of Gaussian likelihoods with\nparameter dependent covariance matrices for parameter inference from\nsuch spectra.\n\n#### 5.1 Introduction\n\nStarting from the second half of the nineties ( Jungman et\u00a0al. , 1996a ,\nb ; Tegmark , 1997 ; Tegmark et\u00a0al. , 1997 ) , the calculation of Fisher\ninformation matrices in order to understand quantitatively the\nconstraining power of an experiment has become ubiquitous in cosmology,\nwith its fundamental aspects now covered in cosmological textbooks (\nDodelson , 2003 ; Durrer , 2008 , section 11 and 6 respectively, e.g.) ,\nor ( Heavens , 2009 ) . This is especially true for experiments aimed at\nmeasuring power spectra of close to Gaussian fields, since in this case\nvery handy analytical expressions can be obtained that can be applied in\na variety of major cosmological subfields, such as for instance the CMB,\ngalaxy clustering, weak lensing as well as their combination.\nNevertheless, even applied to Gaussian variables, Fisher information\nmatrices are not totally exempt of subtleties. In this note, we revisit\nthe two different possible perspectives on the Fisher information\ncontent of such spectra. One starting point is often the assumption of\nGaussian errors. We point out that this assumption of a multivariate\nGaussian likelihood for power spectra estimators is not fully consistent\nfor the purpose of understanding their information content, due to a\nterm violating the Cram\u00e9r-Rao inequality, that we show is not\nnecessarily small. Too much information is therefore assigned to the\nspectra under this assumption. We show that we can understand why this\nterm is artificial precisely from the non Gaussian properties of the\nestimators, and discuss the reasons why the usual formula, i.e. without\nthis term, or setting the covariance matrix to be parameter independent,\nstill gives the correct amount of information.\nThe note is built as follows : In section 5.2 the two common approaches\nto the information content of spectra are discussed in details in the\ncase of a single field. We clarify to what extent and why one is\nactually flawed, which is the source our comments on the use of Gaussian\nlikelihoods for spectra. In section 5.3 we then turn to a correlated\nfamily of fields, where the violation of the Cram\u00e9r-Rao inequality is\nshown to become substantial. We summarize and conclude in section 5.4 .\nWe recall first the specific form of the Fisher information matrix,\ndefined for a probability density function @xmath as @xmath model\nparameters of interest, in the particular case of a multivariate\nGaussian distribution with mean vector @xmath and covariance matrix\n@xmath , ( Vogeley and Szalay , 1996 ; Tegmark et\u00a0al. , 1997 )\n\n  -- -------- -- -------\n     @xmath      (5.1)\n  -- -------- -- -------\n\nRemember that the Fisher information matrix has all the properties a\nmeaningful measure of information on parameters must have, most\nimportantly for us here the fact that any transformation of the data can\nonly decrease its Fisher information matrix.\n\n#### 5.2 One field, gamma distribution\n\nConsider a zero mean isotropic homogeneous Gaussian random field, in\neuclidean space or on the sphere. It is well known that the Gaussianity\nof the field is equivalent to the fact that the Fourier or spherical\nharmonic coefficients are independent complex Gaussian variables, only\nconstrained by the reality condition. Equivalently, the real and\nimaginary parts of those coefficients form independent real Gaussian\nvariables. Such fields are entirely described by their spectrum, and so\nthe extraction of the spectrum from the data with the help of an\nestimator is a fairly natural way to proceed for inference on parameters\nof interest. We place ourselves on the sphere, adopting the spherical\nharmonic notation for convenience. With the set of @xmath the harmonic\ncoefficients, the model parameter dependent spectrum @xmath is defined\nas\n\n  -- -------- -- -------\n     @xmath      (5.2)\n  -- -------- -- -------\n\nStandard, unbiased quadratic estimators can be written as a sum over the\nnumber of Gaussian modes available, as\n\n  -- -------- -- -------\n     @xmath      (5.3)\n  -- -------- -- -------\n\nWe do not consider any source of observational noise, incomplete\ncoverage or any other such issue, which are irrelevant for the points of\nour discussion. At this point, there are two ways to approach the\nproblem of evaluating its information content in the cosmological\nliterature. The first, - let us call this approach the \u2019field\nperspective\u2019 -, first calculates the information content of the field\nitself (equal to that of the set of @xmath \u2019s), and then interprets this\ninformation as being the one of the spectrum. In this case, the\ninformation in the field is given by formula ( 5.1 ), with zero mean\nvector and diagonal covariance matrix @xmath .\n\n  -- -------- -- -------\n     @xmath      (5.4)\n  -- -------- -- -------\n\nwhere the factor @xmath accounts for the number of independent Gaussian\nvariables at a given multipole @xmath . The sum is in practice\nrestricted to the multipole range that will actually be measured to\nobtain the information in the spectrum to be extracted. A very small\nsample of works in this approach are Tegmark et\u00a0al. ( 1997 ) ; Hu and\nJain ( 2004 ) ; Bernstein ( 2009 ) . This approach is arguably\nconceptually appealing, as it deals with the information content of the\nfield itself, and does not require the definition of estimators nor the\ncalculation of their covariance. However, for the same reasons, it is\nonly indirectly connected to data analysis as it is not yet specified\nprecisely how this information content is to be extracted.\nIn the second approach - that we call the \u2019estimator perspective\u2019 - is\ndefined first an estimator @xmath for each @xmath to be extracted,\nwithin some @xmath and @xmath (maybe with some bandwidth that we ignore\nhere), and its covariance matrix @xmath is calculated. Then it is argued\nthat due to the central limit theorem, the distribution of the estimator\nwill be approximately Gaussian. In the case of spectra of Gaussian\nfields, this is very well founded, at least for small scales modes,\nsince ( 5.3 ) is a large sum of well behaved identically distributed\nindependent variables. Then, under this assumption of Gaussianity, their\ninformation content is given by equation ( 5.1 ) with mean vector this\ntime the set of @xmath \u2019s itself and (model parameter dependent)\ncovariance matrix @xmath ,\n\n  -- -------- -- -------\n     @xmath      (5.5)\n  -- -------- -- -------\n\nIt is well known that for the estimator ( 5.3 ) we have @xmath . The\nFisher information matrix, in the estimator perspective, reduces thus to\n\n  -- -------- -- -------\n     @xmath      (5.6)\n  -- -------- -- -------\n\nClearly, the first term in the estimator perspective corresponds to that\nof the field perspective. However, the second term, coming from the\nderivative of the covariance matrix, is new. That term is not enhanced\nby a @xmath factor, and is therefore very subdominant at high @xmath .\nIt is either usually neglected, or the covariance matrix of the\nestimators is inconsistently taken to be parameter independent, and in\nthese cases the two approaches give the same results. Some expositions\nusing explicitly this perspective include ( Tegmark , 1997 ; Seo and\nEisenstein , 2003 , 2007 ) , where the additional term is neglected, or\nthe approach in ( Dodelson , 2003 , section 11.4.3) , where the\ncovariance matrix is treated as parameter independent. A work where this\nterm plays a direct role is ( Eifler et\u00a0al. , 2009 ) , where the authors\nspecifically study the impact of parameter dependent covariance matrices\nfor parameter estimation using such Gaussian likelihoods.\nBeyond the question of the quantitative relevance of this additional\nterm, its very appearance is however very disturbing. Under this\narguably reasonable Gaussian assumption, our estimator ( 5.3 ) is found\nto carry more information than the full field, even on the smallest\nscales. This obviously violates the most fundamental property of Fisher\ninformation, i.e. that information can only be at best conserved when\ntransforming the data (in this case reducing the field to its spectrum),\na fact essentially equivalent to the celebrated Cram\u00e9r-Rao inequality (\nTegmark et\u00a0al. , 1997 ) . Something must clearly have gone wrong in the\nassumption of a Gaussian likelihood for our spectra.\nTo understand what has happened, it is worth tracking the exact\ndistribution and information content of the estimator ( 5.3 ). Since\nthey are independent at different @xmath , we can work at a fixed @xmath\n, and the total information content of these estimators will simply be\nthe sum over @xmath of the information of the estimator at fixed @xmath\n. Under our assumptions, the estimator is a sum of squares of @xmath\nindependent Gaussian variables, and its probability density function can\nbe obtained with no difficulty. The exact distribution is the gamma\nprobability density function with shape parameter @xmath and location\nparameter @xmath as follows\n\n  -- -------- -- -------\n     @xmath      (5.7)\n  -- -------- -- -------\n\nwith\n\n  -- -------- -- -------\n     @xmath      (5.8)\n  -- -------- -- -------\n\nand where @xmath is the gamma function. It is well known that the gamma\ndistribution does indeed tend towards the Gaussian distribution for\nlarge @xmath , with mean @xmath and variance @xmath , as expected.\nHowever, its Fisher information content does not tend to that of the\nGaussian. In our case, since only @xmath is parameter dependent, we have\nthat the Fisher information in the estimator density function ( 5.7 ) is\n\n  -- -------- -- -------\n     @xmath      (5.9)\n  -- -------- -- -------\n\nSince @xmath , and @xmath , we obtain with straightforward algebra\n\n  -- -------- -- --------\n     @xmath      (5.10)\n  -- -------- -- --------\n\nSumming over @xmath , we recover the first term of ( 5.6 ), but not the\nsecond. We have recovered the field perspective result ( 5.4 ) at any\n@xmath without the Gaussian assumption but with the exact distribution.\nIt turns out that even though the variance of the gamma distribution is\nparameter dependent, it does not in fact contribute to the information.\nThis can be seen as the following. Consider the information in the mean\nonly of the estimator. From the Cram\u00e9r-Rao inequality this must be less\nthan the total information,\n\n  -- -------- -- --------\n     @xmath      (5.11)\n  -- -------- -- --------\n\nPlugging in the values for the mean and variance leads in fact to the\nresult that the inequality is an equality, so that the mean of the\nestimator captures all of its information.\nIn summary, the Gaussian approximation assumes the mean and the variance\nof the estimator are uncorrelated, such that both contributes to the\ninformation, while for the exact gamma, they are degenerate in such a\nway that the variance does not carry independent information. Another\nway to see this, that we will use below when the exact form of the\ndistribution will be less convenient, comes from the fact that @xmath is\na first order polynomial in @xmath . It can be shown namely that the\nfirst @xmath moments capture all the information precisely when @xmath\nis a polynomial of order @xmath ( Carron , 2011 ) .\n\n#### 5.3 Several fields, Wishart distribution\n\nIt is instructive to see how these considerations generalize to a\nsituation of a family of @xmath jointly zero mean Gaussian correlated\nfields, where the analysis proceeds through the extraction of the\nspectra and cross spectra. In this case, the @xmath of the above\ndiscussion becomes a @xmath (possibly complex) Hermitian matrix\n\n  -- -------- -- --------\n     @xmath      (5.12)\n  -- -------- -- --------\n\nFrom the hermiticity property there are only @xmath non redundant\nspectra. Adequate estimators are defined by a straightforward\ngeneralization of equation ( 5.3 ),\n\n  -- -------- -- --------\n     @xmath      (5.13)\n  -- -------- -- --------\n\nWhile the estimators are still independent for different @xmath \u2019s, the\ndifferent components at a given @xmath are not. The information content\nof the set of @xmath in the field perspective is still given by formula\n( 5.1 ) for zero mean Gaussian variables. Explicitly, at a given @xmath\n,\n\n  -- -------- -- --------\n     @xmath      (5.14)\n  -- -------- -- --------\n\nIn the estimator perspective, assuming the estimators @xmath are jointly\nGaussian, we have instead\n\n  -- -------- -- --------\n     @xmath      (5.15)\n  -- -------- -- --------\n\nwhere the covariance matrix is\n\n  -- -------- -- --------\n     @xmath      (5.16)\n  -- -------- -- --------\n\nWhile it may not be immediately obvious this time, it has been noted (\nHu and Jain , 2004 , e.g.) that the first term in ( 5.15 ) is rigorously\nequivalent to the expression from the field perspective ( 5.14 ). The\nestimator perspective under the assumption of a multivariate Gaussian\ndistribution for @xmath thus still violates the Cram\u00e9r-Rao inequality\ndue the presence of the second term. Since since this term is not\nenhanced by a factor of @xmath we expect it to be subdominant again.\nHowever, it is less true this time than in the one dimensional setting :\nusing the explicit form of the inverse covariance matrix,\n\n  -- -- -- --------\n           (5.17)\n  -- -- -- --------\n\none can derive with some lengthy but straightforward algebra the\nfollowing expression for the violating term,\n\n  -- -------- -- --------\n     @xmath      (5.18)\n  -- -------- -- --------\n\nfor any number @xmath of fields. If @xmath , we recover indeed ( 5.6 ).\nWhile the term is still subdominant at high @xmath , the situation is\nyet a bit less comfortable. The number of fields is not necessary very\nsmall in cosmologically relevant situations, such as tomographic joint\nshear and galaxy densities analysis in redshift slices, to which one may\nalso add magnification, flexion fields, etc. Writing schematically\n@xmath , where @xmath is the number of bins and @xmath the number of\nfields per bin, we have e.g. @xmath for the galaxy density and the two\nshear fields, @xmath including magnification, @xmath adding\nhypothetically the four flexion fields, and so on. Comparing ( 5.14 )\nand ( 5.18 ), and neglecting the second term in ( 5.18 ), we have that\nat\n\n  -- -------- -- --------\n     @xmath      (5.19)\n  -- -------- -- --------\n\nthe Cram\u00e9r-Rao violating term is actually still the dominant one. Note\nthat this is still optimistic. Due to the product of two traces in the\nsecond term in ( 5.18 ), one can expect roughly the same scaling with\n@xmath as the first term. Thus, the correct @xmath in ( 5.19 ) may\ngenerically be closer to\n\n  -- -------- -- --------\n     @xmath      (5.20)\n  -- -------- -- --------\n\nFrom the discussion in section 5.2 , we can easily guess what went\nwrong. Consider the information content of the means of the estimators\nexclusively. This is given for any probability density function by\nweighting the derivatives of the means with the inverse covariance\nmatrix, and is thus equal to the correct, first term in ( 5.15 ). Since\nalready the means of the estimators do exhaust the information in the\nfield, we can therefore already conclude that the total information\ncontent of the estimators must be equal to that of their means, and in\nparticular that the covariance does not contribute to the information.\nAs before, the second term in the estimator perspective is an artifact\nof the Gaussian assumption. It is interesting though to derive as above\nmore explicitly why only the means carry information, from the shape of\nthe joint probability density of the estimators. The remainder of this\nsection sketches how this can be simply performed, leading to equation (\n5.26 ).\nWe restrict ourselves now for the sake of notation to the case of two\nfields, @xmath , but the following argumentation holds for any @xmath .\nThe exact joint distribution for the three estimators @xmath , is given\nfrom the rules of probability theory as\n\n  -- -------- -- --------\n     @xmath      (5.21)\n  -- -------- -- --------\n\nwhere @xmath is the Dirac delta function. The average is over the joint\nprobability density for the two sets of harmonic coefficients @xmath and\n@xmath . Define the vector\n\n  -- -------- -- --------\n     @xmath      (5.22)\n  -- -------- -- --------\n\nSince the @xmath are zero mean Gaussian variables with correlations as\ngiven in ( 5.12 ), this probability density function is given by\n\n  -- -------- -- --------\n     @xmath      (5.23)\n  -- -------- -- --------\n\nwith\n\n  -- -------- -- --------\n     @xmath      (5.24)\n  -- -------- -- --------\n\nwhere @xmath is the unit matrix of size @xmath . @xmath is the\nnormalization of the density for @xmath , that does depend on the model\nparameters through the determinant of the @xmath matrix. The inverse\nmatrix @xmath has the same block structure, with entries being those of\n@xmath . In the following we are not really interested in keeping track\nof the exact value of the components of this matrix, but only that they\nare dependent on the model parameters. With the understanding that\n@xmath , we have thus, due to the sparse structure of the @xmath matrix\nand the Dirac delta functions in ( 5.21 ),\n\n  -- -------- -- --------\n     @xmath      (5.25)\n  -- -------- -- --------\n\nDue to the presence of the Dirac delta functions, we can thus take the\nexponential ( 5.23 ) out of the integral in ( 5.21 ). Writing explicitly\nthe dependency of the different terms on @xmath and the model\nparameters, we obtain the following form\n\n  -- -------- -- --------\n     @xmath      (5.26)\n  -- -------- -- --------\n\nwhich generalizes the gamma distribution, equation ( 5.7 ), in this\nmultidimensional case. The factor @xmath is what is left from the\nintegral ( 5.21 ) when the density for the set of @xmath is taken out,\ni.e. the volume of the space spanned by the @xmath \u2019s that satisfies the\nconstraints set by the Dirac delta function. It is thus a factor that\ndepends on @xmath but importantly for us not on the model parameters \u00b9 \u00b9\n1 The prefactors in ( 5.26 ) can be obtained in closed form, leading to\nthe Wishart density function. See ( Hamimeche and Lewis , 2008 , e.g.) .\nThe point of the representation ( 5.26 ) is that it is immediate that\n@xmath is a polynomial first order in the components of @xmath . Second\norder terms, corresponding to information within the covariance matrix\nnever appear, however close to a Gaussian the exact density function\nmight be. It follows that the total Fisher information matrix is always\nequal to that of the mean, even if we did not derive the exact shape of\nthe distribution.\n\n#### 5.4 Summary and conclusions\n\nWe discussed two common perspectives (the \u2019field\u2019 and \u2019estimator\u2019\nperspectives) on the Fisher information content of cosmological power\nspectra, and why in the estimator perspective the assumption of a\nGaussian likelihood of the spectra estimators violates the Cram\u00e9r-Rao\ninequality, assigning the estimators more information than there is in\nthe full underlying fields. Under the assumption of Gaussianity of the\nestimators, their means and covariance matrix are artificially rendered\nuncorrelated, creating an additional piece of information in their\ncovariance, that we showed was inexistent by calculating the exact\ninformation content of the estimators true probability density function.\nWe showed that this violating term can become dominant in the limit of a\nlarge number of fields. Using Gaussian likelihoods consistently, i.e.\nwith parameter dependent covariance matrices, as argued for example in (\nEifler et\u00a0al. , 2009 ) , assigns therefore far too much information to\nthe spectra in this regime, and should thus be avoided.\nIn the estimator perspective of the derivation of the Fisher information\nmatrix, this term is usually neglected. This note clarifies why it\nshould not be present in the very first place, and how the agreement\nbetween the field and estimator perspective can thus arguably be seen as\nan happy cancellation of two inconsistencies. It is interesting to note\nthat the reason why we still find the exact result in the estimator\nperspective without this wrong piece is that this expression is also the\nexact Fisher information content of the exact, for low @xmath strongly\nnon Gaussian, distribution of the estimators, the central limit theorem\nplaying actually no role.\nThe other lesson we can take from this work is that in general, when in\ndoubt about the joint distribution of a set of estimators, a safe choice\nof information content is always that of their means exclusively, which\nrequires only the knowledge of their covariance. Provided the covariance\nmatrix is correctly chosen, one is indeed sure for any probability\ndensity function from the properties of Fisher information to make a\nconservative evaluation, that does not rely on any further assumptions\non its shape. Thus, leaving apart the question of the very accuracy of\nthe approximation itself, using a Gaussian likelihood with parameter\nindependent covariance matrix, having the entire information in the\nmeans, while not entirely consistent remains a safe prescription in the\nsense that a conservative information content is always assigned to the\nestimators.\n\n### Chapter 6 @xmath-point functions in lognormal density fields\n\nIn this chapter we discuss extensively the information content of the\nlognormal field as a model for the matter fluctuation field in\ncosmology. It is built out of published as well as yet unpublished\nelements. The text in sections 6.1 and 6.4 follows closely that of\nCarron ( 2011 ) , and that of sections 6.1.1 , 6.1.2 , 6.3 and 6.5 that\nof Carron and Neyrinck ( 2012 ) . On the other hand, sections 6.2 , 6.6\nand 6.7 present unpublished material.\n\n#### 6.1 Introduction\n\nThe cosmological matter density field is becoming more and more directly\naccessible to observations with the help of weak lensing ( Schneider\net\u00a0al. , 1992 ; Bartelmann and Schneider , 2001 ; Refregier , 2003 ;\nMunshi et\u00a0al. , 2006 ) . Its statistical properties are the key element\nin trying to optimize future large galaxy surveys aimed at answering\nactual fundamental cosmological questions, such as the nature of the\ndark components of the universe ( Caldwell and Kamionkowski , 2009 ;\nFrieman et\u00a0al. , 2008 ) . To this aim, Fisher\u2019s measure of information\non parameters ( Fisher , 1925 ; Rao , 1973 ; van den Bos , 2007 ) has\nnaturally become of standard use in cosmology. It provides indeed an\nhandy framework, in which it is possible to evaluate in a quantitative\nmanner the statistical power of some experiment configuration aimed at\nsome observable ( Tegmark et\u00a0al. , 1997 ; Tegmark , 1997 ; Hu and\nTegmark , 1999 ; Hu and Jain , 2004 ; Amara and R\u00e9fr\u00e9gier , 2007 ;\nParkinson et\u00a0al. , 2007 ; Albrecht et\u00a0al. , 2006 ; Bernstein , 2009 ,\ne.g.) . Such studies are in the vast majority of cases limited to\nGaussian probability density functions, or perturbations therefrom, and\ndeal mostly with the prominent members of the correlation function\nhierarchy ( Peebles , 1980 ) , or equivalently their Fourier transforms\nthe polyspectra, such as the matter power spectrum.\nThe approach via the correlation function hierarchy is very sensible in\nthe nearly linear regime for at least two reasons. First, in principle,\nthe correlations are the very elements that cosmological perturbation\ntheory is able to predict in a systematic manner (see Bernardeau et\u00a0al.\n","output":["A large fraction of this thesis is dedicated to the study of the information\ncontent of random fields with heavy tails, in particular the lognormal field, a\nmodel for the matter density fluctuation field. It is well known that in the\nnonlinear regime of structure formation, the matter fluctuation field develops\nsuch large tails. It has also been suggested that fields with large tails are\nnot necessarily well described by the hierarchy of $N$-point functions. In this\nthesis, we are able to make this last statement precise and with the help of\nthe lognormal model to quantify precisely its implications for inference on\ncosmological parameters : we find as our main result that only a tiny fraction\nof the total Fisher information of the field is still contained in the\nhierarchy of $N$-point moments in the nonlinear regime, rendering parameter\ninference from such moments very inefficient. We show that the hierarchy fails\nto capture the information that is contained in the underdense regions, which\nat the same time are found to be the most rich in information. We find further\nour results to be very consistent with numerical analysis using $N$-body\nsimulations. We also discuss these issues with the help of explicit families of\nfields with the same hierarchy of $N$-point moments defined in this work. A\nsimilar analysis is then applied to the convergence field, the weighted\nprojection of the matter density fluctuation field along the line of sight,\nwith similar conclusions. We also show how simple mappings can correct for this\ninadequacy, consistently with previous findings in the literature (Abridged) .","This research is a contribution to our understanding of the information\ncontent of the cosmological dark matter density field, and of the means\nto extract this information. These questions are of prime importance in\norder to reach closer for solutions to current fundamental issues in\ncosmology, such as the nature of dark matter and dark energy, that\nfuture large galaxy surveys are aiming at. The focus is on a traditional\nclass of observables, the @xmath -point functions, that we approach with\nknown information theoretic tools, Fisher information and Shannon\ninformation entropy. It is built out of two main parts, the first\npresenting in details the mathematical methods we used and introduced,\nand the second the cosmological research that was performed with these\ntools.\nA large fraction of this thesis is dedicated to the study of the\ninformation content of random fields with heavy tails, in particular the\nlognormal field, a model for the matter density fluctuation field. It is\nwell known that in the nonlinear regime of structure formation, the\nmatter fluctuation field develops such large tails. It has also been\nsuggested that fields with large tails are not necessarily well\ndescribed by the hierarchy of @xmath -point functions. In this thesis,\nwe are able to make this last statement precise and with the help of the\nlognormal model to quantify precisely its implications for inference on\ncosmological parameters : we find as our main result that only a tiny\nfraction of the total Fisher information of the field is still contained\nin the hierarchy of @xmath -point moments in the nonlinear regime,\nrendering parameter inference from such moments very inefficient. We\nshow that the hierarchy fails to capture the information that is\ncontained in the underdense regions, which at the same time are found to\nbe the most rich in information. We find further our results to be very\nconsistent with numerical analysis using @xmath -body simulations. We\nalso discuss these issues with the help of explicit families of fields\nwith the same hierarchy of @xmath -point moments defined in this work. A\nsimilar analysis is then applied to the convergence field, the weighted\nprojection of the matter density fluctuation field along the line of\nsight, with similar conclusions. We also show how simple mappings can\ncorrect for this inadequacy, consistently with previous findings in the\nliterature.\nThese results were made possible using an expansion of the Fisher\ninformation matrix in uncorrelated components associated to @xmath\n-points moments of successive orders. An entire chapter is dedicated to\nthis expansion, investigating its properties and making a connection to\nthe moment problem in the field of mathematics. Some simple models\nexactly solvable at all orders are also presented.\nBeside these investigations of the statistical power of the hierarchy of\n@xmath -point moments, we also study the combination of various probes\nof the convergence field, including the magnification, shear and flexion\nfields, in particular at the two-point level. We use Shannon information\nentropy to discuss the simple structure of the information within these\ntracers of the lensing potential field. We then evaluate the prospects\nfor such a combination according to current understanding of the\nrelevant dispersion parameters. Finally, we revisit known derivations of\nthe Fisher information matrix for Gaussian variables, commenting in this\nlight on the use of Gaussian likelihoods for power spectra or two-point\ncorrelation function estimators in cosmology. We point towards the fact\nthat despite their motivation from the central limit theorem, care must\nbe taken in the case of a large number of fields, as this assumption\nassigns too much information to the observables.\n"]}
{"input":"### Chapter \\thechapter Introduction\n\nThe ability to use and comprehend language as a mean of communication is\na unique characteristic of human intelligence. Natural language is\nfundamentally non-stationary: the way we produce utterances is modulated\nby a myriad of factors that are ever changing based on our\ninterlocutors, social context, emotions, or communication medium used.\nOur capacity to operate in and adapt to such a dynamic environment is\nanother defining feature of intelligence. Indeed from their youngest\nage, infants are seldom placed in static situations, yet they are still\nable to learn emerging patterns from a constant flow of information (see\ne.g. Dupoux ( 2018 ) ). Hence, it is a natural goal for artificial\nintelligence research to develop agents that are capable of acquiring\nnatural language understanding and generation abilities in the face of a\nchanging environment.\n\nThe development of computer systems which can understand and produce\nnatural language is realized through Natural Language Processing (NLP) .\nIn recent years, neural-network based machine learning models have been\nthe source of rapid progress in NLP , and now represent the\nstate-of-the-art in a large number of real-world applications (such as\nmachine translation (Wu et\u00a0al., 2016 ) , named entity recognition\n(Lample et\u00a0al., 2016 ) or speech recognition (Xiong et\u00a0al., 2018 ) ),\nreaching human parity on a variety of benchmarks (Wang et\u00a0al., 2020a ;\nRajpurkar et\u00a0al., 2020 ) \u00b9 \u00b9 1 Meaning that they outperform human\nannotated baselines, we make no claim that these systems have achieved\nany kind of human-like intelligence. . Yet, these models exhibit a\npattern of failures when confronted with changes to their training\nenvironment:\n\n-   They are highly sensitive to domain shift : they perform poorly when\n    confronted with text from a different domain, for example text\n    concerning different topics (Gururangan et\u00a0al., 2020 ) ,\n    demographics (Blodgett et\u00a0al., 2016 ; Amodei et\u00a0al., 2016 ; Hovy &\n    S\u00f8gaard, 2015 ) , and even using different data collection processes\n    (Gururangan et\u00a0al., 2018 ) . In particular, these models often\n    perform poorly when evaluated on sub-populations, \u00b2 \u00b2 2 Domains that\n    exist, but are under-represented in their training data (Sagawa\n    et\u00a0al., 2020 ) . and they can latch on to spurious correlations\n    (McCoy et\u00a0al., 2019 ) .\n\n-   They are vulnerable to specific word or character-level\n    perturbations (Papernot et\u00a0al., 2016 ; Ebrahimi et\u00a0al., 2018b ;\n    Belinkov & Bisk, 2018b ) . This phenomenon poses security concerns,\n    as this opens up trained models to various types of attacks by\n    nefarious agents: e.g. bypassing toxicity detection models (Hosseini\n    et\u00a0al., 2017 ) .\n\n-   When they are trained on new tasks or domains, they rapidly forget\n    previously acquired knowledge, a phenomenon known as catastrophic\n    forgetting (McCloskey & Cohen, 1989 ; Kirkpatrick et\u00a0al., 2017 ) .\n    This makes adaptation to new data distributions an arduous and\n    unreliable process necessitating significant amounts of domain\n    expertise and regularization (Miceli\u00a0Barone et\u00a0al., 2017 ) .\n\nThese shortcomings are not only at odds with the natural behaviour\nobserved in intelligent agents mentioned above, but represents a\nliability for practical users and designers of such systems. Indeed,\nmachine learning models trained on static datasets can fail\nspectacularly in the face of real-world situations, sometimes with dire\nconsequences (for example, this mis-translation of \u201cgood morning\u201d into\n\u201cattack them\u201d due to dialectic variations; Hern ( 2017 ) ). More\ninsidiously, the representation disparity between training datasets and\nthe real world can, for example, unfairly affect and further\ndisenfranchise minority groups (Hashimoto et\u00a0al., 2018 ; Dixon et\u00a0al.,\n2018 ) .\n\nThe principal desired characteristic of the machine learning models used\nin NLP is the ability to learn and generalize from a finite number of\ntraining examples. The most common learning paradigm, empirical risk\nminimization, relies on the assumption that this training data is\nsampled from a fixed distribution, and generalization is construed as\nthe ability to perform well on unseen samples from this same\ndistribution. The failure cases described above occur when the model\noperates in a different distribution than the one it was trained on, in\nwhich case standard generalization guarantees break down. In this\ncontext, the discrepancy between a machine learning model\u2019s learning and\noperating environment can be described as distributional shift . The\nresearch presented in this thesis focuses on what we believe to be the\nthree major axes of progress towards addressing distributional shift in\nthe context of NLP : Evaluation , Robustness and Adaptation .\n\nWe start with evaluation because distributional shift is particularly\ndifficult to characterize and measure, especially in regard to natural\nlanguage. This is partly due to the absence of a canonical metric\nstructure of the data. In other words, it is not clear how to\nefficiently measure the semantic similarity between two sentences and as\na result there is no straight-forward way to measure the discrepancy\nbetween two samples, let alone two distributions. Therefore, as a\nnatural first step in addressing distributional shift, we propose a new\nbenchmark (Chapter I ) and evaluation metric (Chapter I ) to evaluate\ndomain shift and robustness to adversarial perturbations respectively.\nWith these tools in hand, we set out to construct robust models that are\ntrained to be less sensitive to distributional shift, even in the\nabsence of explicit information on the nature of shift. This is done by\nleveraging the diversity of data within the training distribution to\nensure uniform performance over a variety of domains present in the\ntraining data (sub-populations). Specifically we formulate a parametric\nversion of the distributionally robust optimization framework which\nallows for training models that are more robust to sub-population shift\n(Chapters II and II ). Finally, learning in a static environment is\nfundamentally sub-optimal: we cannot expect our models to perform well\non each and every possible future setting, and we must be able to adapt\nthem to any new scenario we encounter. Consequently, we research\nmechanisms by which we are able to fine-tune a trained model on new\nevidence, without forgetting previously acquired knowledge (Chapter III\n).\n\nThe detailed outline of our contributions in this thesis is presented\nbelow:\n\n-    Chapter Learning Neural Models for Natural Language Processing in\n    the Face of Distributional Shift lays out a description of the\n    distributional shift phenomenon and discusses previous and current\n    work in this general area.\n\n-    Part I: Measuring and Evaluating Robustness\n\n    -   In Chapter I , we introduce a benchmark for evaluating machine\n        translation models against distributional shift. Specifically,\n        the proposed dataset \u2014 dubbed MTNT \u2014 provides a testbed for\n        translation of noisy social media text, a challenging domain for\n        common state-of-the-art models trained on news and parliamentary\n        proceedings. This work was published as Michel & Neubig ( 2018a\n        ) at EMNLP 2018 \u00b3 \u00b3 3\n        https:\/\/www.aclweb.org\/anthology\/events\/emnlp-2018\/ , Li et\u00a0al.\n        ( 2019 ) at WMT 2019 \u2074 \u2074 4\n        https:\/\/www.statmt.org\/wmt19\/robustness.html and (Specia et\u00a0al.,\n        2020 ) at WMT 2020. \u2075 \u2075 5\n        https:\/\/www.statmt.org\/wmt20\/robustness.html\n\n    -   In Chapter I , we examine the difficulty of evaluating\n        adversarial perturbations on NLP models, with an emphasis on\n        sequence-to-sequence models. We propose an evaluation framework\n        centered around the idea of evaluating the perturbations\u2019 effect\n        on the semantics of the input sentences. The content of this\n        chapter originally appeared as Michel et\u00a0al. ( 2019b ) at NAACL\n        2019. \u2076 \u2076 6 https:\/\/www.aclweb.org\/anthology\/events\/naacl-2019\/\n\n-    Part II: Making Robust Models\n\n    -    Chapter II describes an approach for training models that are\n        robust to distributional shift, using a parametric version of\n        the distributionally robust optimization (DRO) framework.\n        Specifically, we train a model to minimize its expected loss\n        under the distribution defined by another generative model (the\n        \u201cadversary\u201d), which is itself trained to represent the\n        worst-case distribution for the model. In experiments, we find\n        that this approach (called Parametric DRO ) yields models that\n        are more robust compared to other baselines in the DRO\n        literature. This chapter was previously published at ICLR 2021 \u2077\n        \u2077 7 https:\/\/iclr.cc\/Conferences\/2021 as Michel et\u00a0al. ( 2021 ) .\n\n    -    Chapter II presents an improvement over the P-DRO approach\n        whereby a parametric re-weighting of the training data is\n        learned. With appropriate constraints, and a simple but crucial\n        minibatch-level renormalization trick, we find that this results\n        in a simple DRO approach which reliably outperforms other\n        baselines and necessitates little hyper-parameter tuning. The\n        work presented in this chapter is currently undergoing peer\n        review.\n\n-    Part III: Adaptation\n\n    -   In Chapter III , we develop a technique for mitigating the\n        catastrophic forgetting issue that arises when adapting a model\n        to a new domain or a new task. The approach, inspired by ideas\n        in information geometry, is demonstrated to drastically reduce\n        forgetting compared to regular gradient descent, and enjoys\n        complementarity with common continual-learning baselines. This\n        chapter contains work that was released as a preprint.\n\n### Chapter \\thechapter Background and Literature Review\n\nFrom a broad perspective, the goal of machine learning is to produce a\nmodel that is able to perform a given task, such as predicting an output\nvariable @xmath from an input, @xmath ( e.g. sentiment given a movie\nreview, or French translation given an English sentence\u2026) given finite\namounts of training data (in our example, @xmath pairs). In this\nchapter, we formalize this setting for the rest of this thesis.\n\n#### 1 Terminology and Definitions\n\nIn machine learning, we are confronted with learning to perform a task\ngiven a finite number of examples. In the context of this thesis, a task\n@xmath will be referring to a triplet containing two measurable spaces\n@xmath and @xmath , as well as a probability distribution @xmath with\nsupport on the Cartesian product @xmath . @xmath represents the space of\nall possible inputs (for example the space of all @xmath images, or the\nspace of all English sentences), while @xmath stands for the space of\nall admissible outputs (for example the set @xmath in sentiment\nclassification, or all sentences of a target language in translation).\nFinally, @xmath will represent the true distribution of the data in\nnature (for example it will assign high probability to a pair of English\nand French sentences that are translations of each other).\n\nIn general, learning a task will consist of training a model to\napproximate the conditional distribution @xmath , based only on a finite\nnumber of training examples @xmath . Specifically, we will focus on\nparametric models, i.e. models that are fully determined by a finite,\nconstant (with respect to the size of the training data) number of\nparameters described by a vector @xmath that can take its values in\n@xmath , the set of all possible parameters (in practice @xmath or a\nsubset thereof, where @xmath is the total number of parameters).\n\nTraditionally, given a loss function @xmath measuring the discrepancy\nbetween model @xmath \u2019s prediction on @xmath and the reference output\n@xmath , the modeler will estimate parameters @xmath that better fit the\ndistribution @xmath data by minimizing the expected risk\n\n  -- -------- -- -----\n     @xmath      (1)\n  -- -------- -- -----\n\nNote that we abuse notation and write @xmath for @xmath to distinguish\nbetween the dependency over @xmath , the model parameters, and @xmath ,\nthe model\u2019s inputs. As implied earlier, one cannot compute the total\nexpectation @xmath and we must resort to minimizing the empirical risk\ncomputed over a finite training set @xmath\n\n  -- -------- -- -----\n     @xmath      (2)\n  -- -------- -- -----\n\n#### 2 Distributional Shift\n\n##### 2.1 What is Distributional Shift\n\nIn the empirical risk minimization ( ERM )paradigm, machine learning\nmodels are trained to minimize their expected loss under a single,\nstatic distribution. However, this assumption is not always valid in\npractical applications. For example, a machine translation system\ntrained on a majority of news article might come to be used to translate\nsocial media comments. While the overall task is can arguably be\nconsidered the same at a high level from the point of view of a human,\nthere are significant differences in the data distribution (for\ninstance, social media comments may contain more informal language).\n\nIn the most general sense, distributional shift (or distribution shift)\nis simply an instance of the test distribution @xmath being different\nfrom the training data distribution @xmath . Of course, this definition\nis too broad to be realistic, let alone useful in practice. \u2078 \u2078 8\nConsider, in a binary classification task, setting @xmath . Only the\ndistribution changes, yet the two tasks are directly at odds with each\nother. Precisely defining and categorizing what characterizes an\nacceptable shift is still very much an active area of research.\n\n##### 2.2 Categorizing Distributional Shift\n\nWhile we will not attempt to formulate a complete taxonomy of\ndistributional shifts, we will paint a broad strokes picture of how they\nare categorized in the literature. We will distinguish two main schools\nof thought for distinguishing distributional shift: a \u201cmechanistic\u201d and\na \u201ccausal\u201d approach.\n\n###### 2.2.1 Mechanistic Categorization\n\nThe first approach is to distinguish shifts by describing, in\nmathematical terms, the mechanics of how the change manifests in the\ndata generation process. The appeal of this categorization is that it\nallows for a more principled, theoretical approach to tackling\ndistributional shift. A summary of the examples described in this\nsection can be found in Table 1 .\n\nThe most well known instance is covariate shift (Shimodaira, 2000 ;\nSugiyama & M\u00fcller, 2005 ; Storkey, 2009 ; Bickel et\u00a0al., 2009 ) , where\nonly the distribution over the input space @xmath (sometimes called the\nspace of \u201ccovariates\u201d) changes, and the conditional distribution @xmath\nis assumed to stay the same. Covariate shift is a rather intuitive\nassumption, especially in such cases where there is a clear causal\nrelationship between the covariates @xmath and the targets @xmath . It\nholds an important place within the distribution shift literature\nbecause its particular characteristics justify the use of specific\nalgorithms, some of which enjoy appealing properties. For instance, it\ncan be tackled by means of re-weighting with the covariate likelihood\nratio @xmath (Shimodaira, 2000 ) , and the covariate shift assumption\ncan yield tighter guarantees (Duchi et\u00a0al., 2019 ) .\n\nAnother, diametrically opposed type of shift is label-shift (or prior\nprobability shift in Storkey ( 2009 ) ), where only the marginal on\n@xmath changes, and the reverse conditional @xmath stays fixed. This is\nmost relevant when the causal relationship between @xmath and @xmath is\nreversed, for example when diagnosing an illness ( @xmath ) from its\nsymptoms ( @xmath ). Specific methods have been developed to tackle this\nscenario (Zhang et\u00a0al., 2013 ; Lipton et\u00a0al., 2018 ) , although their\napplication is generally less common in the NLP literature. Finally, a\ncomparatively less well studied occurrence is concept-shift , in which\nthe marginal @xmath is assumed fixed, but the conditional changes to\nanother distribution @xmath (Qui\u00f1onero-Candela et\u00a0al., 2009 ) . This can\nresult from a mismatch between annotators: for instance in machine\ntranslation, different professional annotators may use slightly\ndifferent translation conventions. Widmer & Kubat ( 1996 ) postulates\nthat this is due to the presence of some \u201cunknown context\u201d, such as the\ntwo translators having had a different education, which leads to them\nadhering to two mildly different definitions of the translation problem.\nA concrete example of this phenomenon in toxicity detection (in the\nEnglish language) is the \u201cn-word\u201d problem. This racial slur and other\nhistorically charged terms such as \u201cqueer\u201d are often used disparagingly\ntowards certain underrepresented minorities. However some of them were\nre-appropriated by minority speakers within their respective communities\n(Rahman, 2012 ) . Without information about the speaker, it can be\ndifficult to determine the toxicity of an utterance containing such\nwords, even for human annotators (Sap et\u00a0al., 2019 ) .\n\nAnother, more elaborate example of a \u201cmechanistically defined\u201d category\nof distribution shift is what Koh et\u00a0al. ( 2020 ) calls \u201csub-population\nshift\u201d. In sub-population shift, it is assumed that the training\ndistribution @xmath can be decomposed as a mixture of @xmath different\ndomains @xmath , @xmath . This can be the case by design: for example\nthe training data for the WMT machine translation competition \u2079 \u2079 9\nhttp:\/\/statmt.org\/wmt21\/ is aggregated from many different machine\ntranslation corpora, or the MultiNLI textual entailment dataset\n(Williams et\u00a0al., 2018 ) was created specifically to contain data from\ndifferent domains. But in many more cases the training data may be an\naggregate of various domains, unbeknownst to the dataset\u2019s creator: for\ninstance text datasets often contain data from different dialects ( e.g.\nAmerican vs. British English, French vs. Canadian French, etc\u2026). The\nbenchmarks aginst which the methods described Part II of this thesis\nwill be evaluated are all examples of sub-population shifts.\n\n###### 2.2.2 Causal Categorization\n\nAn alternate view is to distinguish the distribution shifts through the\nreal world phenomena that cause them. This more empirical approach has\nthe merit of describing realistic cases of distribution shift which may\nnot clearly (or provably) fit into the mathematically defined categories\npresented in the previous section, but are prevalent enough to warrant\nthe development of bespoke solutions.\n\nA predominant cause of distributional shift is change over time (Kelly\net\u00a0al., 1999 ; Hand, 2006 ) . For instance, Bloomfield ( 1933 )\ndocuments nine categories of lexical semantic drift that words may\nundergo over time \u00b9\u2070 \u00b9\u2070 10 The various causes of this drift are\nelaborated upon in later studies (Blank & Koch, 2013 ; Grzega &\nSchoener, 2007 ) . While not laying out a precise typology, McCulloch (\n2020 ) also touches on a variety of semantic shift that occurred more\nrecently (and at a comparatively faster pace) with the advent of the\ninternet. The effect of these changes in meaning on word embedding\nmodels such as Word2Vec ( Mikolov et\u00a0al. ( 2013 ) , a staple of the NLP\npipeline at the time) were summarized in Kutuzov et\u00a0al. ( 2018 ) .\nIdentifying time as the underlying cause for this phenomenon has the\nbenefit of suggesting solutions tailored to the problem at hand: for\nexample, one could use dynamic word-embedding models (Rudolph & Blei,\n2018 ) to predict upcoming drift, and use this knowledge to augment the\ntraining data. In a more recent example, Lazaridou et\u00a0al. ( 2021 )\nhighlights the specific importance of \u2018\u2018dynamic evaluation\u2019\u2019 \u00b9\u00b9 \u00b9\u00b9 11\nThe process of continuously training a language model at test time.\n(Mikolov et\u00a0al., 2010 ) for mitigating loss in performance due to time\nshift in language models.\n\nIn other examples, distributional shift can be described in terms of\ndata collection: a prime example is what Storkey ( 2009 ) calls biased\nsampling . Subtle design choices at the time of the creation of the\ntraining dataset (such as data source, pre-processing, or annotation\nscheme) can introduce biases into the training distribution. A recent\nillustration of biased sampling is the case of crowd-sourced natural\nlanguage inference \u00b9\u00b2 \u00b9\u00b2 12 Natural language inference is another name\nfor the task of recognizing textual entailment. In its most common\nformulation, the model is given two sentences, the premise and the\nhypothesis, and is asked to determine whether the first entails or\ncontradict the second (or whether there is no clear entailment\nrelationship). datasets (Gururangan et\u00a0al., 2018 ) : annotators tasked\nwith crafting a contradictory hypothesis from a premise would frequently\nresort to introducing negation markers (in English: \u201cnot\u201d, \u201cnever\u201d,\netc\u2026). This introduced a spurious correlation between the presence of\nsuch negative words and the \u201ccontradiction\u201d label. When confronted with\ntest data that doesn\u2019t conform to this pattern ( e.g. cases of\nentailment where the hypothesis does include a negation marker), models\ntrained with empirical risk minimization (ERM) break down (Sagawa\net\u00a0al., 2020 ) .\n\n###### 2.2.3 Local and Global Shifts\n\nAside from the two types of categorization described above, we believe\nthat it is worth making another distinction between what we will call\n\u201clocal\u201d and \u201cglobal\u201d shifts, purely by virtue of the fact that they are\nboth the subject of considerable, yet distinct areas of the literature.\nWe use the term local to refer to cases where the shifted distribution\n@xmath can be obtained by applying a transformation (deterministic or\nnon-deterministic) to data points in @xmath . Of course, this isn\u2019t a\nvery clearly defined category since any distribution can be transported\ninto another one via an optimal transport map. In this case, we refer\nspecifically to shifts that are best explicitly defined by such \u201clocal\u201d\ntransformations. This category encompasses phenomena such as character\nor word-level noise (of the kind described in Belinkov & Bisk ( 2018b )\nfor instance) or adversarial perturbations (Papernot et\u00a0al., 2016 ;\nEbrahimi et\u00a0al., 2018b , a ; Cheng et\u00a0al., 2018a ) , small modifications\nto the input of a machine learning model that cause dramatic changes to\nits output.\n\nThe notion of global shift will then be used to refer to those type of\ndistributional shift that cannot easily be modeled as local shifts. We\nmake this distinction because, as will be discussed in Chapter I , local\nshift can \u2014 and should \u2014 be addressed specifically.\n\n#### 3 Robustness to Distributional Shift\n\n##### 3.1 Distributionally Robust Optimization\n\nThere is a rather large body of literature devoted to training models\nthat are robust to distributional shift, under the name of\ndistributionally robust optimization ( DRO ). In DRO , models are\ntrained not to minimize their expected risk under any one distribution\n@xmath , but rather their worst case risk under a pre-determined family\nof distributions @xmath , called the \u201cuncertainty set\u201d\n\n  -- -------- -- -----\n     @xmath      (3)\n  -- -------- -- -----\n\nThe DRO loss in Equation 3 provides an upper bound on the expected loss\nof the model under any distribution in the uncertainty set @xmath ,\nwhich motivates the use the solution of the min-max problem as a robust\nmodel. However this objective is only useful insofar that @xmath (1)\ncovers test distributions of interest (corresponding to different\ndomains, demographics, etc.) and (2) is not overly pessimistic. To\nfulfil this second condition, there should exist some model @xmath that\nachieves low loss simultaneously on the test distribution as well as\n@xmath . This often requires that @xmath only contain distributions that\nare \u201cclose\u201d to the training distribution under some divergence metric,\nor that are restricted to covariate shifts.\n\nIn some cases, it is conceivable that @xmath is available at training\ntime. For instance, we might have access to some amount of data in\n@xmath domains of interest, in which case the DRO loss can be written as\na maximum over the finite set @xmath . This setting is sometimes\nreferred to as Group- DRO and has been studied in Oren et\u00a0al. ( 2019 );\nSagawa et\u00a0al. ( 2020 ); Zhou et\u00a0al. ( 2021 ) .\n\nIn the absence of explicit information about the domains of interest, it\nis up to the practitioner to carefully define this uncertainty set.\nThere is substantial existing work on nonparametric formulations of DRO\n, where @xmath is expressed as a divergence ball centered at the\ntraining distribution. Popular examples in the literature are:\n\n-   @xmath -divergence balls , also called @xmath -divergences or R\u00e9nyi\n    divergences (Cover, 1999 ; Van\u00a0Erven & Harremos, 2014 ) are a family\n    of divergence metrics of the form @xmath where @xmath is a convex\n    function mapping 1 to 0, and @xmath is assumed to be absolutely\n    continuous to @xmath ( @xmath ). Well-known representatives include\n    the Kullback-Leibler (KL) divergence ( @xmath ), Pearson\u2019s @xmath\n    divergence ( @xmath ) or the total variation distance ( @xmath ).\n    They have seen extensive use in the DRO literature (Ben-Tal et\u00a0al.,\n    2013 ; Hu & Hong, 2013 ; Faury et\u00a0al., 2020 ) .\n\n-    Wasserstein\/IPM balls . The 1-Wasserstein distance or earth mover\u2019s\n    distance between two probability distributions @xmath , @xmath on a\n    metric space @xmath is defined as @xmath where @xmath is the set of\n    all joint distributions on @xmath with marginals @xmath and @xmath ,\n    and @xmath is @xmath \u2019s canonical metric. Contrary to @xmath\n    -divergences, the Wasserstein metric makes no assumptions of\n    absolute continuity, and it allows practitioners to design problem\n    specific uncertainty sets by choosing the most relevant distance\n    metric @xmath . This has made it a popular choice for DRO problems\n    where such metrics are well defined ( e.g. for real valued inputs),\n    particularly in the context of adversarial robustness (Gao &\n    Kleywegt, 2016 ; Esfahani & Kuhn, 2018 ; Sinha et\u00a0al., 2018 ) .\n    Integral probability metrics (IPMs) are another common class of\n    divergences between probability distributions to which (under some\n    conditions, see Theorem 11.8.2 in Dudley ( 2018 ) ) the Wasserstein\n    distance belongs. They take the form @xmath where @xmath is a set of\n    real valued bounded measurable functions on @xmath . Although\n    Wasserstein-DRO is are by far more common in the literature, there\n    has been some recent work on general IPM bounded uncertainty sets\n    (Husain, 2020 ) .\n\n-    Moment constraints consists in uncertainty sets where admissible\n    distribution have to satisfy some (generally linear or quadratic)\n    constraint on their moments, e.g. @xmath for some pre-specified\n    values @xmath and @xmath . They are perhaps one of the oldest\n    formulations of DRO , with roots in operations research (Scarf, 1957\n    ; Dupa\u010dov\u00e1, 1987 ; Delage & Ye, 2010 ) and with some exceptions\n    (Nguyen et\u00a0al., 2020 ) , they have seen relatively little use in the\n    modern machine learning context.\n\n-    CVaR constraints (or @xmath -coverage). Originating from the\n    financial risk management literature (Rockafellar et\u00a0al., 2000 ) ,\n    the conditional value at risk (CVaR) is concerned with guaranteeing\n    good performance under all distributions @xmath that @xmath -covered\n    by @xmath , meaning that for all @xmath , @xmath with @xmath . This\n    formalizes in the language of probability distributions the idea\n    that @xmath is a subset that covers only a fraction @xmath of the\n    training data. CVaR-constrained uncertainty sets underpin a variety\n    of recently proposed approaches for robust machine learning, even if\n    they are not always explicitly acknowledged as such (Fan et\u00a0al.,\n    2017 ; Curi et\u00a0al., 2020 ; Levy et\u00a0al., 2020 ) .\n\nAll these nonparametric approaches are appealing as they require very\nlittle domain-specific knowledge, have well-understood theory (Duchi &\nNamkoong, 2018 ) , and optimization procedures ( e.g. Hu & Hong ( 2013 )\nfor KL constraints and Levy et\u00a0al. ( 2020 ) for @xmath and CVaR\nconstraints). We refer to (Rahimian & Mehrotra, 2019 ) for a more\nin-depth overview.\n\nUnfortunately, nonparametric DRO algorithms suffer from being overly\npessimistic. Their uncertainty sets tend to include distributions that\nare exceedingly difficult to learn, or not representative of real-world\ndistribution shifts. Furthermore, they often cannot enforce even basic\nconstraints such as covariate shift (Duchi et\u00a0al., 2020 ; Hu et\u00a0al.,\n2018 ) . Group-structured DRO uncertainty sets (Sagawa et\u00a0al., 2020 )\novercome some of these challenges, but as alluded to before, they\nrequire significant domain expertise to pre-specify target\nsub-populations that a model should be robust to.\n\n##### 3.2 Measuring Robustness\n\nOver the years, various works have attempted to come up with specific\nmeasures of model robustness in order to provide out-of-distribution\ngeneralization guarantees. Unfortunately, common divergence metrics such\nas the KL divergence ( @xmath ; Kullback & Leibler ( 1951 ) ) or the\ntotal variation distance ( @xmath ; Saks ( 1937 ) ) generally yield\nvacuous bounds.\n\nBen-David et\u00a0al. ( 2010 ) (following a line of work initiated in Kifer\net\u00a0al. ( 2004 ) and Ben-David et\u00a0al. ( 2007 ) ) introduced a new\ndistance metric called the @xmath -divergence, specifically geared\ntowards yielding out-of-distribution generalization bounds. The central\ninsight of the @xmath -divergence is to induce a distance that is\nspecific to the family of models being trained (the titular @xmath ). A\nkey feature of the @xmath -divergence is that it can be approximated\nwith another metric, the proxy @xmath -distance. In broad strokes, the\nproxy @xmath -distance is proportional to how easy it is to discriminate\nbetween the two domains @xmath and @xmath using classifiers from @xmath\n. More precisely, given two datasets @xmath and @xmath sampled from\n@xmath and @xmath respectively, it reads:\n\n  -- -------- -- -----\n     @xmath      (4)\n  -- -------- -- -----\n\nwith\n\n  -- -------- -- -----\n     @xmath      (5)\n  -- -------- -- -----\n\nIn other words, @xmath is the best error-rate (within @xmath ) for\ndistinguishing @xmath from @xmath . Naturally the exact minimum is in\ngeneral intractable, but it can be estimated by training a classifier on\nfinite amounts of training data sampled from @xmath and @xmath , making\nit more conducive to applied research.\n\nAlthough the @xmath -divergence literature has inspired some work in\n\u2018\u2018unsupervised domain adaptation\u2019\u2019 \u00b9\u00b3 \u00b9\u00b3 13 Training models to be robust\nto domain shift given unlabeled samples from the target domain ( Ganin &\nLempitsky ( 2015 ) and the follow-up literature on domain adversarial\nneural networks), it has seen relatively little use in NLP , with some\nnotable exceptions (Blitzer & Pereira, 2007 ; Rai et\u00a0al., 2010 ; Glorot\net\u00a0al., 2011 ) . More recent empirical comparisons (Elsahar & Gall\u00e9,\n2019 ; Kashyap et\u00a0al., 2021 ) have shown the proxy @xmath -Distance to\nbe competitive when it comes to predicting performance drop in the face\nof domain shift, possibly heralding a resurgence of the metric. We refer\nthe interested reader to Kashyap et\u00a0al. ( 2021 ) for a complete taxonomy\nand a more exhaustive overview of domain divergences (written with an\nNLP audience in mind).\n\nWith regards to adversarial perturbation specifically, there is a\nconsiderable amount of work devoted to providing certifiable robustness\nguarantees (see Katz et\u00a0al. ( 2017 ); Sinha et\u00a0al. ( 2018 ); Wong &\nKolter ( 2018 ); Raghunathan et\u00a0al. ( 2018 ) inter alia ). Often, these\nguarantees rely on ideas related to Lipschitz continuity bounds:\nlimiting the change in a model\u2019s output as a function of small\nperturbations in its inputs. These ideas are difficult to transpose to\nNLP as they rely on some notion of a \u201csmall change\u201d in the input, which\nis usually described in terms of @xmath norm for continuous data such as\nimages, but is harder to formalize in natural languages. Jia et\u00a0al. (\n2019 ) circumvent this issue by adapting an approach from the computer\nvision literature (Interval Bound Propagation (IBP); Dvijotham et\u00a0al. (\n2018 ) ) to specific neural architectures to yield robustness guarantees\nto word-level perturbations at the embedding level. Overall, guaranteed\nadversarial robustness in NLP is still an active area of research, with\nrecent work extending these ideas to more modern architectures (Shi\net\u00a0al., 2020 ) for example.\n\n## Part I Measuring and Evaluating Robustness\n\n### Chapter \\thechapter MTNT: A Testbed for Machine Translation of Noisy\nText\n\n#### 4 Introduction\n\nAfter this overview of the distributional shift problem, in this chapter\nwe present our first contribution: a benchmark dataset for Machine\nTranslation of Noisy Text ( MTNT ), consisting of noisy user-generated\ncontent such as the following comment:\n\n  #nlproc is actualy f*ing hARD tbh []\n\nThis handcrafted sentence showcases several types of noise that are\ncommonly seen on social media: abbreviations (\u201c#nlproc\u201d), typographical\nerrors (\u201cactualy\u201d), obfuscated profanities (\u201cf*ing\u201d), inconsistent\ncapitalization (\u201chARD\u201d), Internet slang (\u201ctbh\u201d for \u201cto be honest\u201d) and\nemojis ( [] ). Although machine translation has achieved significant\nquality improvements over the past few years due to the advent of Neural\nMachine Translation (NMT) Kalchbrenner & Blunsom ( 2013 ); Sutskever\net\u00a0al. ( 2014 ); Bahdanau et\u00a0al. ( 2014 ); Wu et\u00a0al. ( 2016 ) , systems\nare still not robust to noisy input like this Belinkov & Bisk ( 2018a );\nKhayrallah & Koehn ( 2018 ) . For example, Google Translate \u00b9\u2074 \u00b9\u2074 14\ntranslate.google.com as of May 2018 translates the above example into\nFrench as:\n\n  #nlproc est en train de f * ing dur hb\n\nwhich translates back into English as \u201c#nlproc is in the process of [f *\ning] hard hb\u201d. This shows that noisy input can lead to erroneous\ntranslations that can be misinterpreted or even offensive.\n\nNoise in social media text is a known issue that has been investigated\nin a variety of previous work Eisenstein ( 2013 ); Baldwin et\u00a0al. ( 2013\n) . Most recently, Belinkov & Bisk ( 2018a ) have focused on the\ndifficulties that character based NMT models have translating text with\ncharacter level noise within individual words (from scrambling to\nsimulated human errors such as typos or spelling\/conjugation errors).\nThis is a good first step towards noise-robust NMT systems, but as we\ndemonstrate in Section 5 , word-by-word replacement or scrambling of\ncharacters doesn\u2019t cover all the idiosyncrasies of language on the\nInternet.\n\nAt this point, despite the obvious utility of creating noise-robust MT\nsystems, and the scientific challenges contained therein, there is\ncurrently a bottleneck in that there is no standard open benchmark for\nresearchers and developers of Machine Translation (MT) systems to test\nthe robustness of their models to these and other phenomena found in\nnoisy text on the Internet. In this chapter, we introduce Machine\nTranslation of Noisy Text (MTNT) , a new, realistic dataset aimed at\ntesting robustness of MT systems to these phenomena. The dataset\ncontains naturally created noisy source sentences with professionally\nsourced translations both in a pair of typologically close languages\n(English and French) and distant languages (English and Japanese). We\ncollect noisy comments from the Reddit \u00b9\u2075 \u00b9\u2075 15 www.reddit.com online\ndiscussion website (Section 6 ) in English, French and Japanese, and\ncommissioned professional translators to translate to and from English,\nresulting in approximately 1000 test samples and from 6k to 36k training\nsamples in four language pairs ( English-French ( en-fr ) ,\nFrench-English ( fr-en ) , English-Japanese ( en-ja ) and\nJapanese-English ( ja-en ) ). In addition, we release additional small\nmonolingual corpora in those 3 languages to both provide data for\nsemi-supervised adaptation approaches as well as noisy Language Modeling\n(LM) experiments. We test standard translation models (Section 8 ) on\nour data to understand their failure cases and to provide baselines for\nfuture work. \u00b9\u2076 \u00b9\u2076 16 Additional language modeling experiments can be\nfound in Appendix 9 Finally, we describe the 2019 and 2020 WMT\nRobustness shared task in which MTNT was used as a benchmark for robust\nmachine translation (Section 10 ). The data is publicly available at\nhttps:\/\/pmichel31415.github.io\/mtnt\/ .\n\n#### 5 Noise and Input Variations in Language on the Internet\n\n##### 5.1 Examples from Social Media Text\n\nThe term \u201cnoise\u201d can encompass a variety of phenomena in natural\nlanguage, with variations across languages ( e.g. what is a typo in\nlogographic writing systems?) and type of content Baldwin et\u00a0al. ( 2013\n) . To give the reader an idea of the challenges posed to MT and NLP\nsystems operating on this kind of text, we provide a non-exhaustive list\nof types of noise and more generally input variations that deviate from\nstandard MT training data we\u2019ve encountered in Reddit comments:\n\n-    Spelling\/typographical errors : \u201cacross\u201d @xmath \u201caccross\u201d,\n    \u201creceive\u201d @xmath \u201crecieve\u201d, \u201ccould have\u201d @xmath \u201ccould of\u201d, \u201ctemps\u201d\n    @xmath \u201ctant\u201d, \u201c\u9664\u304f\u201d @xmath \u201c\u8997\u304f\u201d\n\n-    Word omission\/insertion\/repetition : \u201cje n\u2019aime pas\u201d @xmath \u201cj\u2019aime\n    pas\u201d,\u201cje pense\u201d @xmath \u201cmoi je pense\u201d\n\n-    Grammatical errors : \u201ca ton of\u201d @xmath \u201ca tons of\u201d, \u201cThere are\n    fewer people\u201d @xmath \u201cThere are less people\u201d\n\n-    Spoken language : \u201cwant to\u201d @xmath \u201cwanna\u201d, \u201cI am\u201d @xmath \u201cI\u2019m\u201d,\n    \u201cje ne sais pas\u201d @xmath \u201cchais pas\u201d, \u201c\u4f55\u3092\u7b11\u3063\u3066\u3044\u308b\u306e\u201d @xmath\n    \u201c\u4f55\u308f\u308d\u3066\u3093\u306d\u3093\u201d,\n\n-    Internet slang : \u201cto be honest\u201d @xmath \u201ctbh\u201d, \u201cshaking my head\u201d\n    @xmath \u201csmh\u201d, \u201cmort de rire\u201d @xmath \u201cmdr\u201d, \u201c\u7b11\u201d @xmath \u201cw\u201d\/\u201c\u8349\u201d\n\n-    Proper nouns (with or without correct capitalization): \u201cReddit\u201d\n    @xmath \u201creddit\u201d\n\n-    Dialects : African American Vernacular English, Scottish,\n    Proven\u00e7al, Qu\u00e9b\u00e9cois, Kansai, Tohoku\u2026\n\n-    Code switching : \u201cThis is so cute\u201d @xmath \u201cThis is so kawaii\u201d,\n    \u201cC\u2019est trop conventionel\u201d @xmath \u201cC\u2019est trop mainstream\u201d,\n    \u201c\u73fe\u5728\u634f\u9020\u4e2d\u2026\u201d @xmath \u201cNow \u634f\u9020ing\u2026\u201d\n\n-    Jargon : on Reddit: \u201cupvote\u201d, \u201cdownvote\u201d, \u201csub\u201d, \u201cgild\u201d\n\n-    Emojis and other unicode characters : [] , [] , [] , [] , [] , [] ,\n    []\n\n-    Profanities\/slurs (sometimes masked) \u201cf*ck\u201d, \u201cm*rde\u201d \u2026\n\n##### 5.2 Is Translating Noisy Text just another Adaptation Problem?\n\nTo a certain extent, translating noisy text is a type of adaptation ,\nwhich has been studied extensively in the context of both Statistical\nMachine Translation (SMT) and NMT Axelrod et\u00a0al. ( 2011 ); Li et\u00a0al. (\n2010 ); Luong & Manning ( 2015 ); Chu et\u00a0al. ( 2017 ); Miceli\u00a0Barone\net\u00a0al. ( 2017 ); Wang et\u00a0al. ( 2017 ); Michel & Neubig ( 2018b ) .\nHowever, it presents many differences with previous domain adaptation\nproblems, where the main goal is to adapt from a particular topic or\nstyle. In the case of noisy text, it will not only be the case that a\nparticular word will be translated in a different way than it is in the\ngeneral domain (e.g. as in the case of \u201csub\u201d), but also that there will\nbe increased lexical variation (e.g. due to spelling or typographical\nerrors), and also inconsistency in grammar (e.g. due to omissions of\ncritical words or mis-usage). The sum of these differences warrants that\nnoisy MT be treated as a separate instance than domain adaptation, and\nour experimental analysis in 8.4 demonstrates that even after performing\nadaptation, MT systems still make a large number of noise-related\nerrors.\n\n#### 6 Collection Procedure\n\nWe first collect noisy sentences in our three languages of interest,\nEnglish, French and Japanese. We refer to Figure 1 for an overview of\nthe data collection and translation process.\n\nWe choose Reddit as a source of data because (1) its content is likely\nto exhibit noise, (2) some of its sub-communities are entirely run in\ndifferent languages, in particular, English, French and Japanese, and\n(3) Reddit is a popular source of data in curated and publicly\ndistributed NLP datasets Tan et\u00a0al. ( 2016 ) . We collect data using the\npublic Reddit API. \u00b9\u2077 \u00b9\u2077 17 In particular, we use this implementation:\npraw.readthedocs.io\/en\/latest , and our complete code is available at\nhttp:\/\/www.cs.cmu.edu\/~pmichel1\/mtnt\/ .\n\nNote that the data collection and translation is performed at the\ncomment level. We split the parallel data into sentences as a last step.\n\n##### 6.1 Data Sources\n\nFor each language, we select a set of communities (\u201csubreddits\u201d) that we\nknow contain many comments in that language:\n\n  English:  \n\n    Since an overwhelming majority of the discussions on Reddit are\n    conducted in English, we don\u2019t restrict our collection to any\n    community in particular.\n\n  French:  \n\n     \/r\/france , \/r\/quebec and \/r\/rance . The first two are among the\n    biggest French speaking communities on Reddit. The third is a\n    humor\/sarcasm based offspring of \/r\/france .\n\n  Japanese:  \n\n     \/r\/newsokur , \/r\/bakanewsjp , \/r\/newsokuvip , \/r\/lowlevelaware and\n    \/r\/steamr . Those are the biggest Japanese speaking communities,\n    with over 2,000 subscribers at the time of collection.\n\nWe collect comments made during the 03\/27\/2018-03\/29\/3018 time period\nfor English, 09\/2018-03\/2018 for French and 11\/2017-03\/2018 for\nJapanese. The large difference in collection time is due to the variance\nin comment throughput and relative amount of noise between the\nlanguages.\n\n##### 6.2 Contrast Corpora\n\nNot all comments found on Reddit exhibit noise as described in Section 5\n. Because we would like to focus our data collection on noisy comments,\nwe devise criteria that allow us to distinguish potentially noisy\ncomments from clean ones. Specifically, we compile a contrast corpus\ncomposed of clean text that we can compare to, and find potentially\nnoisy text that differs greatly from the contrast corpus. Given that our\nfinal goal is MT robust to noise, we prefer that these contrast corpora\nconsist of the same type of data that is often used to train NMT models.\nWe select different datasets for each language:\n\n  English:  \n\n    The English side of the preprocessed parallel training data provided\n    for the German-English WMT 2017 News translation task, \u00b9\u2078 \u00b9\u2078 18\n    http:\/\/www.statmt.org\/wmt17\/translation-task.html as provided on the\n    website. This amounts to @xmath million sentences.\n\n  French:  \n\n    The entirety of the French side of the parallel training data\n    provided for the English-French WMT 2015 translation task. \u00b9\u2079 \u00b9\u2079 19\n    http:\/\/www.statmt.org\/wmt15\/translation-task.html This amounts to\n    @xmath million sentences.\n\n  Japanese:  \n\n    We aggregate three small\/medium sized MT datasets: KFTT Neubig (\n    2011 ) , JESC Pryzant et\u00a0al. ( 2017 ) and TED talks Cettolo et\u00a0al. (\n    2012 ) , amounting to @xmath million sentences.\n\n##### 6.3 Identifying Noisy Comments\n\nWe now describe the procedure used to identify comments containing\nnoise.\n\n###### Pre-filtering\n\nFirst, we perform three pre-processing to discard comments that do not\nrepresent natural noisy text in the language of interest:\n\n1.  Comments containing a URL, as detected by a regular expression.\n\n2.  Comments where the author\u2019s username contains \u201cbot\u201d or\n    \u201cAutoModerator\u201d. This mostly removes automated comments from bots.\n\n3.  Comments in another language: we run langid.py \u00b2\u2070 \u00b2\u2070 20\n    https:\/\/github.com\/saffsd\/langid.py Lui & Baldwin ( 2012 ) and\n    discard comments where @xmath for any language other than the one we\n    are interested in.\n\nThis removes cases that are less interesting, i.e. those that could be\nsolved by rule-based pattern matching or are not natural text created by\nregular users in the target language. Our third criterion in particular\ndiscards comments that are blatantly in another language while still\nallowing comments that exhibit code-switching or that contain proper\nnouns or typos that might skew the language identification. In\npreliminary experiments, we noticed that these criteria 14.47, 6.53 and\n7.09 % of the collected comments satisfied the above criteria\nrespectively.\n\n###### Normalization\n\nAfter this first pass of filtering, we pre-process the comments before\nrunning them through our noise detection procedure. We first strip\nMarkdown \u00b2\u00b9 \u00b2\u00b9 21 https:\/\/daringfireball.net\/projects\/markdown syntax\nfrom the comments. For English and French, we normalize the punctuation,\nlowercase and tokenize the comments using the Moses tokenizer. For\nJapanese, we simply lowercase the alphabetical characters in the\ncomments. Note that this normalization is done for the purpose of noise\ndetection only. The collected comments are released without any kind of\npreprocessing. We apply the same normalization procedure to the contrast\ncorpora.\n\n###### Unknown words\n\nIn the case of French and English, a clear indication of noise is the\npresence of out-of-vocabulary words (OOV) : we record all lowercased\nwords encountered in our reference corpus described in Section 6.2 and\nonly keep comments that contain at least one OOV . Since we did not use\nword segmentation for the Japanese reference corpus, we found this\nmethod not to be very effective to select Japanese comments and\ntherefore skipped this step.\n\n###### Language model scores\n\nThe final step of our noise detection procedure consists of selecting\nthose comments with a low probability under a language model trained on\nthe reference monolingual corpus. This approach mirrors the one used in\nMoore & Lewis ( 2010 ) and Axelrod et\u00a0al. ( 2011 ) to select data\nsimilar to a specific domain using language model perplexity as a\nmetric. We search for comments that have a low probability under a\nsub-word language model for more flexibility in the face of OOV words.\nWe segment the contrast corpora with Byte-Pair Encoding (BPE) using the\nsentencepiece \u00b2\u00b2 \u00b2\u00b2 22 https:\/\/github.com\/google\/sentencepiece\nimplementation. We set the vocabulary sizes to @xmath , @xmath and\n@xmath for English, French and Japanese respectively. We then use a\n5-gram Kneser-Ney smoothed language model trained using kenLM \u00b2\u00b3 \u00b2\u00b3 23\nhttps:\/\/kheafield.com\/code\/kenlm\/ Heafield et\u00a0al. ( 2013 ) to calculate\nthe log probability, normalized by the number of tokens for every\nsentence in the reference corpus. Given a reddit comment, we compute the\nnormalized log probability of each of its lines under our subword\nlanguage model. If for any line this score is below the 1st percentile\nof scores in the reference corpus, the comment is labeled as noisy and\nsaved.\n\n##### 6.4 Creating the Parallel Corpora\n\nOnce enough data has been collected, we isolate @xmath comments in each\nlanguage by the following procedure:\n\n-   Remove all duplicates. In particular, this handles comments that\n    might have been scraped twice or automatic comments from bots.\n\n-   To further weed out outliers (comments that are too noisy, e.g.\n    ASCII art, wrong language\u2026or not noisy enough), we discard comments\n    that are on either end of the distribution of normalized LM scores\n    within the set of collected comments. We only keep comments whose\n    normalized score is within the 5-70 percentile for English (resp.\n    5-60 for French and 10-70 for Japanese). These numbers are chosen by\n    manually inspecting the data.\n\n-   Choose @xmath samples at random.\n\nWe then concatenate the title of the thread where the comment was found\nto the text and send everything to an external vendor for manual\ntranslations. Upon reception of the translations, we noticed a certain\namount of variation in the quality of translations, likely because\ntranslating social media text, with all its nuances, is difficult even\nfor humans. In order to ensure the highest quality in the translations,\nwe manually filter the data to segment the comments into sentences and\nweed out poor translations for our test data. We thereby retain around\n@xmath sentence pairs in each direction for the final test set.\n\nWe gather the samples that weren\u2019t selected for the test sets to be used\nfor training or fine-tuning models on noisy data. We automatically split\ncomments into sentences with a regular expression detecting sentence\ndelimiters, and then align the source and target sentences. Should this\nalignment fail ( i.e. the source comment contains a different number of\nsentences than the target comment after automatic splitting), we revert\nback to providing the whole comment without splitting. For the training\ndata, we do not verify the correctness of translations as closely as for\nthe test data. Finally, we isolate @xmath samples in each direction to\nserve as validation data.\n\nInformation about the size of the data can be found in Table 2(c) , 2(a)\nand 2(b) for the test, training and validation sets respectively. We\ntokenize the English and French data with the Moses Koehn et\u00a0al. ( 2007\n) tokenizer and the Japanese data with Kytea Neubig et\u00a0al. ( 2011 )\nbefore counting the number of tokens in each dataset.\n\n##### 6.5 Monolingual Corpora\n\nAfter the creation of the parallel train and test sets, a large number\nof unused comments remain in each language, which we provide as\nmonolingual corpora. This additional data has two purposes: first, it\nserves as a resource for in-domain training using semi-supervised\nmethods relying on monolingual data (e.g. Cheng et\u00a0al. ( 2016 ); Zhang &\nZong ( 2016 ) ). Second, it provides a language modeling dataset for\nnoisy text in three languages.\n\nWe select @xmath comments at random in each dataset to form a validation\nset to be used to tune hyper-parameters, and provide the rest as\ntraining data. The data is provided with one comment per line. Newlines\nwithin individual comments are replaced with spaces. Table 2(d) contains\ninformation on the size of the datasets. As with the parallel MT data,\nwe provide the number of tokens after tokenization with the Moses\ntokenizer for English and French and Kytea for Japanese.\n\n#### 7 Dataset Analysis\n\nIn this section, we investigate the proposed data to understand how\ndifferent categories of noise are represented and to show that our test\nsets contain more noise overall than established MT benchmarks.\n\n##### 7.1 Quantifying Noisy Phenomena\n\nWe run a series of tests to count the number of occurrences of some of\nthe types of noise described in Section 5 . Specifically we pass our\ndata through spell checkers to count spelling and grammar errors. Due to\nsome of these tests being impractical to run on a large scale, we limit\nour analysis to the test sets of MTNT .\n\nWe use slightly different procedures depending on the tools available\nfor each language. We test for spelling and grammar errors in English\ndata using Grammarly \u00b2\u2074 \u00b2\u2074 24 https:\/\/www.grammarly.com\/ , an online\nresource for English spell-checking. Due to the unavailability of an\nequivalent of Grammarly in French and Japanese, we test for spelling and\ngrammar error using the integrated spell-checker in Microsoft Word 2013\n\u00b2\u2075 \u00b2\u2075 25 https:\/\/products.office.com\/en-us\/microsoft-word-2013 . Note\nthat Word seems to count proper nouns as spelling errors, giving higher\nnumbers of spelling errors across the board in French as compared to\nEnglish.\n\nFor all languages, we also count the number of profanities and emojis\nusing custom-made lists and regular expressions \u00b2\u2076 \u00b2\u2076 26 available with\nour code at https:\/\/github.com\/pmichel31415\/mtnt . In order to compare\nresults across datasets of different sizes, we report all counts per\n@xmath words.\n\nThe results are recorded in the last row of each section in Table 3 . In\nparticular, for the languages with a segmental writing system, English\nand French, spelling errors are the dominant type of noise, followed by\ngrammar error. Unsurprisingly, the former are much less present in\nJapanese.\n\n##### 7.2 Comparison to Existing Machine Translation Test Sets\n\nTable 3 also provide a comparison with the relevant side of established\nMT test sets. For English and French, we compare our data to\nnewstest2014 \u00b2\u2077 \u00b2\u2077 27 http:\/\/www.statmt.org\/wmt15\/dev-v2.tgz and\nnewsdiscusstest2015 \u00b2\u2078 \u00b2\u2078 28 http:\/\/www.statmt.org\/wmt15\/test.tgz test\nsets. For Japanese, we compare with the test sets of the datasets\ndescribed in Section 6.2 .\n\nOverall, MTNT contains more noise in all metrics but one (there are more\nprofanities in JESC, a Japanese subtitle corpus). This confirms that\nMTNT indeed provides a more appropriate benchmark for translation of\nnoisy or non-standard text.\n\nCompared to synthetically created noisy test sets Belinkov & Bisk (\n2018a ) MTNT contains less systematic spelling errors and more varied\ntypes of noise ( e.g. emojis and profanities) and is thereby more\nrepresentative of naturally occurring noise.\n\n#### 8 Machine Translation Experiments\n\nWe evaluate standard NMT models on our proposed dataset to assess its\ndifficulty. Our goal is not to train state-of-the art models but rather\nto test standard off-the-shelf NMT systems on our data, and elucidate\nwhat features of the data make it difficult.\n\n##### 8.1 Model Description\n\nAll our models are implemented in DyNet Neubig et\u00a0al. ( 2017 ) with the\nXNMT toolkit Neubig et\u00a0al. ( 2018 ) . We use approximately the same\nsetting for all language pairs: the encoder is a bidirectional LSTM with\n2 layers, the attention mechanism is a multi layered perceptron and the\ndecoder is a 2 layered LSTM. The embedding dimension is 512, all other\ndimensions are 1024. We tie the target word embeddings and the output\nprojection weights Press & Wolf ( 2017 ) . We train with Adam Kingma &\nBa ( 2014 ) with XNMT\u2019s default hyper-parameters, as well as dropout\n(with probability @xmath ). We used BPE subwords to handle OOV words.\nFull configuration details as well as code to reproduce the baselines is\navailable at https:\/\/github.com\/pmichel31415\/mtnt .\n\n##### 8.2 Training Data\n\nWe train our models on standard MT datasets:\n\n-   en @xmath fr: Our training data consists in the europarl-v7 \u00b2\u2079 \u00b2\u2079 29\n    http:\/\/www.statmt.org\/europarl\/ and news-commentary-v10 \u00b3\u2070 \u00b3\u2070 30\n    http:\/\/www.statmt.org\/wmt15\/training-parallel-nc-v10.tgz corpora,\n    totaling @xmath samples, @xmath French tokens and @xmath English\n    tokens (non-tokenized). We use the newsdiscussdev2015 \u00b2\u2077 dev set\n    from WMT15 as validation data and evaluate the model on the\n    newsdiscusstest2015 \u00b2\u2078 and newstest2014 \u00b2\u2077 test sets.\n\n-   en @xmath ja: We concatenate the respective train, validation and\n    test sets of the three corpora mentioned in 6.2 . In particular we\n    detokenize the Japanese part of each dataset to make sure that any\n    tokenization we perform will be uniform (in practice we remove ASCII\n    spaces). This amounts to @xmath training samples ( @xmath English\n    tokens without tokenization). We concatenate the dev sets associated\n    with these corpora to serve as validation data and evaluate on each\n    respective test set separately.\n\n##### 8.3 Results\n\nWe use sacreBLEU \u00b3\u00b9 \u00b3\u00b9 31 https:\/\/github.com\/mjpost\/sacreBLEU , a\nstandardized BLEU score evaluation script proposed by Post ( 2018b ) ,\nfor BLEU evaluation of our benchmark dataset. It takes in detokenized\nreferences and hypotheses and performs its own tokenization before\ncomputing BLEU score. We specify the intl tokenization option. In the\ncase of Japanese text, we run both hypothesis and reference through\nKyTea before computing BLEU score. We strongly encourage that evaluation\nbe performed in the same manner in subsequent work, and will provide\nboth scripts and an evaluation web site in order to facilitate\nreproducibility.\n\nTable 4 lists the BLEU scores for our models on the relevant test sets\nin the two language pairs, including the results on MTNT .\n\n##### 8.4 Analysis of the MT outputs\n\nTo better understand the types of errors made by our model, we count the\nn-grams that are over- and under- generated with respect to the\nreference translation. Specifically, we compare the count ratios of all\n1- to 3-grams in the output and in the reference and look for the ones\nwith the highest (over-generated) and lowest (under-generated) ratio.\n\nWe find that in English, the model under-generates the contracted form\nof the negative (\u201cdo not\u201d\/\u201cdon\u2019t\u201d) or of auxiliaries (\u201cThat is\u201d\/\u201cI\u2019m\u201d).\nSimilarly, in French, our model over generates \u201cde votre\u201d (where \u201cvotre\u201d\nis the formal 2nd person plural for \u201cyour\u201d) and \u201cn\u2019ai pas\u201d which\nshowcases the \u201cne [\u2026] pas\u201d negation, often dropped in spoken language.\nConversely, the informal second person \u201ctu\u201d is under-generated, as is\nthe informal and spoken contraction of \u201ccela\u201d, \u201c\u00e7a\u201d. In Japanese, the\nmodel under-generates, among others, the informal personal pronoun \u4ffa\n(\u201core\u201d) or the casual form \u3060 (\u201cda\u201d) of the verb \u3067\u3059 (\u201cdesu\u201d, to be).\nIn ja-en the results are difficult to interpret as the model seems to\nproduce incoherent outputs ( e.g. \u201cno, no, no\u2026\u201d) when the NMT system\nencounters sentences it has not seen before. The full list of n-grams\nwith the top 5 and bottom 5 count ratios in each language pair is\ndisplayed in Table 6 .\n\n##### 8.5 Fine-Tuning\n\nFinally, we test a simple domain adaptation method by fine-tuning our\nmodels on the training data described in Section 6.4 . We perform one\nepoch of training with vanilla SGD with a learning rate of @xmath and a\nbatch size of @xmath . We do not use the validation data at all. As\nevidenced by the results in the last row of Table 4 , this drives BLEU\nscore up by 3.17 to 7.96 points depending on the language pair. However\nlarge this increase might be, our model still breaks on very noisy\nsentences. Table 5 shows three examples in fr-en . Although our model\nsomewhat improves after fine-tuning, the translations remain inadequate\nin all cases. In the third case, our model downright fails to produce a\ncoherent output. This shows that despite improving BLEU score, naive\ndomain adaptation by fine-tuning doesn\u2019t solve the problem of\ntranslating noisy text.\n\n#### 9 Language Modeling Experiments\n\nIn addition to our MT experiments, we report character-level language\nmodeling results on the monolingual part of our dataset. We use the data\ndescribed in Section 6.5 as training and validation sets. We evaluate\nthe trained model on the source side of our en-fr , fr-en and ja-en test\nsets for English, French and Japanese respectively.\n\nWe report results for two models: a Kneser-Ney smoothed 6-gram model\n(implemented with KenLM) and an implementation of the AWD-LSTM proposed\nin Merity et\u00a0al. ( 2018 ) \u00b3\u00b2 \u00b3\u00b2 32\nhttps:\/\/github.com\/salesforce\/awd-lstm-lm . We report the\nBit-Per-Character (bpc) counts in table 7 . We intend these results to\nserve as a baseline for future work in language modeling of noisy text\nin either of those three languages.\n\n#### 10 MTNT in Action: the 2019 and 2020 WMT Robustness Shared Tasks\n\nA year after MTNT was originally published, the dataset was featured in\nthe Robustness shared task \u00b3\u00b3 \u00b3\u00b3 33\nhttp:\/\/www.statmt.org\/wmt19\/robustness.html at the 2019 conference on\nmachine translation (WMT). Participants were allowed to use large\namounts of out-of-domain data from the main WMT translation task \u00b3\u2074 \u00b3\u2074\n34 http:\/\/www.statmt.org\/wmt15\/translation-task.html or from the three\nen-ja corpora described in Section 8 , as well as the MTNT dataset\nitself as a small in-domain corpus. Submitted systems were evaluated on\nnew, blind test sets collected using the same procedure as MTNT i.e.\nscraped from Reddit, filtered out for noisy comments using a sub-word\nlanguage modeling criterion and translated by professionals.\n\nThe shared task attracted 23 submissions from 11 teams. Methods used by\ncompeting teams included variants of data cleaning (removal of noisy\ntraining samples), the use of placeholders (to account for special\ncharacters that could be copied such as emojis), data augmentation\nstrategies (such as back-translation or the addition of filtered data\nfrom external sources), domain-aware training (via the addition of\ndomain tags), fine-tuning and ensembling. Table 8 showcases an example\nwhere specific handling of casing allowed some systems to outperform\nothers on samples containing ALL CAPS (a common phenomenon in\nuser-generated content on social media). A more detailed description of\nthe submissions, as well as an analysis of the results, can be found in\nthe findings paper Li et\u00a0al. ( 2019 ) .\n\nThe shared task was renewed in 2020, with a broader focus on general\ndomain robustness \u00b3\u2075 \u00b3\u2075 35 http:\/\/www.statmt.org\/wmt20\/robustness.html .\nIn this iteration, participants were asked to train models in one of two\nlanguage pairs (English-German and English Japanese) using only the data\navailable for the WMT20 news translation task (Barrault et\u00a0al., 2020 ) .\nThe evaluation data was aggregated from three different domains:\nWikipedia comments with toxic content \u00b3\u2076 \u00b3\u2076 36\nhttps:\/\/www.kaggle.com\/c\/jigsaw-toxic-comment-classification-challenge ,\nspeech recognition transcripts (Wang et\u00a0al., 2020b ) , and a new test\nset of reddit comments, collected following again the same procedure as\nMTNT . Evaluation proceeded in two distinct phases. In the first\n\u201czero-shot\u201d phase, submitted systems were simply evaluated against the\nunseen test sets, thus testing the domain robustness of models trained\nusing only out-of-domain data. In the second \u201cfew-shot\u201d phase,\nparticipants were given a single week to fine-tune their systems using\nlimited amounts of training data from each domain (including the MTNT\ntraining data). Each system output was evaluated using both automatic\nmetrics (BLEU) and human judgements. In the case of the latter,\nevaluators were not only asked to rate the machine-generated\ntranslations on a numerical scale of 1 to 5, but also to indicate the\npresence of \u201ccatastrophic errors\u201d belonging to pre-defined categories\nsuch as \u201cintroduction of toxicity\u201d, \u201cmis-translation of named entities\u201d\nor \u201cchange in units\/time\/date\/numbers\u201d\n\nThis edition of the task received 59 submissions by 11 participating\nteams from both industry and academic institutions. By and large, most\nteams used similar approaches as the previous year, specifically tagged\nback-translations, ensembling or fine-tuning on filtered data. In\naddition, some teams used adaptor modules (Bapna & Firat, 2019 ) for\nmore efficient fine-tuning, with some level of success. The human\nevaluation of the results uncovered a predominance of named entity\nmis-translations among catastrophic errors, followed by sentiment\nreversal and introduction of toxicity. We refer to the findings paper\n(Specia et\u00a0al., 2020 ) for a full description of the data collection\nprocess, evaluation procedure and participating systems.\n\n###### Acknowledgement\n\nThe work discussed in this section was carried out in two different\npapers, Li et\u00a0al. ( 2019 ) and Specia et\u00a0al. ( 2020 ) . The present\nauthor was not first author on either of these papers. His contributions\nwere, for Li et\u00a0al. ( 2019 ) to help with the general organization of\nthe task, including establishing the goal of the task, planning,\nhandling submissions and in particular to be responsible for collecting\nthe blind test sets. For Specia et\u00a0al. ( 2020 ) , his contributions were\nmore focused on data collection for the reddit test set.\n\n#### 11 Related work\n\nHandling noisy text has received growing attention among various\nlanguage processing tasks due to the abundance of user generated content\non popular social media platforms Crystal ( 2001 ); Herring ( 2003 );\nDanet & Herring ( 2007 ) . These contents are considered as noisy when\ncompared to news corpora which have been the main data source for\nlanguage tasks Baldwin et\u00a0al. ( 2013 ); Eisenstein ( 2013 ) . They pose\nseveral unique challenges because they contain a larger variety of\nlinguistic phenomena that are absent in the news domain and that lead to\ndegraded quality when applying an model to out-of-domain data (Ritter\net\u00a0al., 2011 ; Luong & Manning, 2015 ) . Additionally, they are live\nexamples of the Cmabrigde Uinervtisy (Cambridge University) effect,\nwhere state-of-the-art models become brittle while human\u2019s language\nprocessing capability is more robust (Sakaguchi et\u00a0al., 2017 ; Belinkov\n& Bisk, 2018a ) .\n\nEfforts to address these challenges have been focused on creating\nin-domain datasets and annotations (Owoputi et\u00a0al., 2013 ; Kong et\u00a0al.,\n2014 ; Blodgett et\u00a0al., 2017 ) , and domain adaptation training (Luong &\nManning, 2015 ) . In MT , improvements were obtained for SMT (Formiga &\nFonollosa, 2012 ) . However, the specific challenges for neural machine\ntranslation have not been studied until recently Belinkov & Bisk ( 2018a\n); Sperber et\u00a0al. ( 2017 ); Cheng et\u00a0al. ( 2018b ) . The first provides\nempirical evidence of non-trivial quality degradation when source\nsentences contain natural noise or synthetic noise within words, and the\nlast two explore data augmentation and adversarial approaches of adding\nnoise efficiently to training data to improve robustness.\n\nOur work also contributes to recent advances in evaluating neural\nmachine translation quality with regard to specific linguistic\nphenomena, such as manually annotated test sentences for English to\nFrench translation, in order to identify errors due to specific\nlinguistic divergences between the two languages (Isabelle et\u00a0al., 2017\n) , or automatically generated test sets to evaluate typical errors in\nEnglish to German translation (Sennrich, 2017 ) . Our contribution\ndistinguishes itself from this previous work and other similar\ninitiatives (Peterson, 2011 ) by providing an open test set consisting\nof naturally occurring text exhibiting a wide range of phenomena related\nto noisy input text from contemporaneous social media.\n\n#### 12 Discussion\n\nIn this chapter, we proposed a new dataset to test MT models for\nrobustness to the types of noise encountered in natural language on the\nInternet. We contribute parallel training and test data in both\ndirections for two language pairs, English @xmath French and English\n@xmath Japanese, as well as monolingual data in those three languages.\nWe show that this dataset contains more noise than existing MT test sets\nand poses a challenge to models trained on standard MT corpora. We\nfurther demonstrate that these challenges cannot be overcome by a simple\ndomain adaptation approach alone. After its publication, MTNT served as\nthe basis for two shared tasks at the WMT conference in machine\ntranslation, fostering research on models and evaluation metrics for\nthis specific problem (Li et\u00a0al., 2019 ; Specia et\u00a0al., 2020 ) . In\naddition, it was used independently in a variety of subsequent work,\neither as a benchmark for e.g. data augmentation techniques (Karpukhin\net\u00a0al., 2019 ; Vaibhav et\u00a0al., 2019 ) or as an exemplar of domain shift\nin machine translation (Michel et\u00a0al., 2019a ) .\n\n### Chapter \\thechapter On Evaluation of Adversarial Perturbations for\nSequence-to-Sequence Models \\chaptermark\n\nOn Evaluation of Adversarial Perturbations\n\n#### 13 Introduction\n\nWhile the previous chapter\u2019s focus was on evaluating models under\ndistributional shift to the social media domain (a type of shift which\nwe referred to as a \u201cglobal\u201d shift in Chapter Learning Neural Models for\nNatural Language Processing in the Face of Distributional Shift ), in\nthis chapter we take a closer look at a different type of distributional\nshift: adversarial perturbations. At a high level, attacking a machine\nlearning model with adversarial perturbations is the process of making\nchanges to its input to maximize an adversarial goal, such as\nmis-classification Szegedy et\u00a0al. ( 2013 ) or mis-translation Zhao\net\u00a0al. ( 2018 ) . These attacks provide insight into the vulnerabilities\nof machine learning models and their brittleness to samples outside the\ntraining distribution. Lack of robustness to these attacks poses\nsecurity concerns to safety-critical applications, e.g. self-driving\ncars Bojarski et\u00a0al. ( 2016 ) .\n\nAdversarial attacks were first defined and investigated for computer\nvision systems ( Szegedy et\u00a0al. ( 2013 ); Goodfellow et\u00a0al. ( 2014b );\nMoosavi-Dezfooli et\u00a0al. ( 2016 ) inter alia), where the input space is\ncontinuous, making minuscule perturbations largely imperceptible to the\nhuman eye. In discrete spaces such as natural language sentences, the\nsituation is more problematic; even a flip of a single word or character\nis generally perceptible by a human reader. Thus, most of the\nmathematical framework in previous work is not directly applicable to\ndiscrete text data. Moreover, there is no canonical distance metric for\ntextual data like the @xmath norm in real-valued vector spaces such as\nimages, and evaluating the level of semantic similarity between two\nsentences is a field of research of its own Cer et\u00a0al. ( 2017 ) . This\nelicits a natural question: what does the term \u201cadversarial\nperturbation\u201d mean in the context of NLP ?\n\nWe propose a simple but natural criterion for adversarial examples in\nNLP , particularly untargeted \u00b3\u2077 \u00b3\u2077 37 Here we use the term untargeted\nin the same sense as Ebrahimi et\u00a0al. ( 2018a ) : an attack whose goal is\nsimply to decrease performance with respect to a reference translation.\nattacks on sequence-to-sequence (seq2seq) models: adversarial examples\nshould be meaning-preserving on the source side, but meaning-destroying\non the target side . The focus on explicitly evaluating meaning\npreservation is in contrast to previous work on adversarial examples for\nseq2seq models Belinkov & Bisk ( 2018b ); Zhao et\u00a0al. ( 2018 ); Cheng\net\u00a0al. ( 2018a ); Ebrahimi et\u00a0al. ( 2018a ) . Nonetheless, this feature\nis extremely important; given two sentences with equivalent meaning, we\nwould expect a good model to produce two outputs with equivalent\nmeaning. In other words, any meaning-preserving perturbation that\nresults in the model output changing drastically highlights a fault of\nthe model.\n\nA first technical contribution of this chapter is to lay out a method\nfor formalizing this concept of meaning-preserving perturbations\n(Section 14 ). This makes it possible to evaluate the effectiveness of\nadversarial attacks or defenses either using gold-standard human\nevaluation, or approximations that can be calculated without human\nintervention. We further propose a simple method of imbuing\ngradient-based word substitution attacks (Section 15.1 ) with simple\nconstraints aimed at increasing the chance that the meaning is preserved\n(Section 15.2 ).\n\nOur experiments are designed to answer several questions about meaning\npreservation in seq2seq models. First, we evaluate our proposed\n\u201csource-meaning-preserving, target-meaning-destroying\u201d criterion for\nadversarial examples using both manual and automatic evaluation (Section\n16.2 ) and find that a less widely used evaluation metric (chrF)\nprovides significantly better correlation with human judgments than the\nmore widely used BLEU and METEOR metrics. We proceed to perform an\nevaluation of adversarial example generation techniques, finding that\nchrF does help to distinguish between perturbations that are more\nmeaning-preserving across a variety of languages and models (Section\n16.3 ). Finally, we apply existing methods for adversarial training to\nthe adversarial examples with these constraints and show that making\nadversarial inputs more semantically similar to the source is beneficial\nfor robustness to adversarial attacks and does not decrease test\nperformance on the original data distribution (Section 17 ). A toolkit\nimplementing our evaluation framework is released at\nhttps:\/\/github.com\/pmichel31415\/teapot-nlp .\n\n#### 14 A Framework for Evaluating Adversarial Attacks\n\nIn this section, we present a simple procedure for evaluating\nadversarial attacks on seq2seq models. We will use the following\nnotation: @xmath and @xmath refer to the source and target sentence\nrespectively. We denote @xmath \u2019s translation by model @xmath as @xmath\n. Finally, @xmath and @xmath represent an adversarially perturbed\nversion of @xmath and its translation by @xmath , respectively. The\nnature of @xmath and the procedure for obtaining @xmath from @xmath are\nirrelevant to the discussion below.\n\n##### 14.1 The Adversarial Trade-off\n\nThe goal of adversarial perturbations is to produce failure cases for\nthe model @xmath . Hence, the evaluation must include some measure of\nthe target similarity between @xmath and @xmath , which we will denote\n@xmath . However, if no distinction is being made between perturbations\nthat preserve the meaning and those that don\u2019t, a sentence like \u201che\u2019s\nvery friendly \u201d is considered a valid adversarial perturbation of \u201che\u2019s\nvery adversarial \u201d, even though its meaning is the opposite. Hence, it\nis crucial, when evaluating adversarial attacks on MT models, that the\ndiscrepancy between the original and adversarial input sentence be\nquantified in a way that is sensitive to meaning. Let us denote such a\nsource similarity score @xmath .\n\nBased on these functions, we define the target relative score decrease\nas:\n\n  -- -------- -- -----\n     @xmath      (6)\n  -- -------- -- -----\n\nThe choice to report the relative decrease in @xmath makes scores\ncomparable across different models or languages \u00b3\u2078 \u00b3\u2078 38 Note that we do\nnot allow negative @xmath to keep all scores between 0 and 1. . For\ninstance, for languages that are comparatively easy to translate ( e.g.\nFrench-English), @xmath will be higher in general, and so will the gap\nbetween @xmath and @xmath . However this does not necessarily mean that\nattacks on this language pair are more effective than attacks on a\n\u201cdifficult\u201d language pair ( e.g. Czech-English) where @xmath is usually\nsmaller.\n\nWe recommend that both @xmath and @xmath be reported when presenting\nadversarial attack results. However, in some cases where a single number\nis needed, we suggest reporting the attack\u2019s success @xmath . The\ninterpretation is simple: @xmath , which means that the attack has\ndestroyed the target meaning ( @xmath ) more than it has destroyed the\nsource meaning ( @xmath ).\n\nImportantly, this framework can be extended beyond strictly\nmeaning-preserving attacks. For example, for targeted keyword\nintroduction attacks Cheng et\u00a0al. ( 2018a ); Ebrahimi et\u00a0al. ( 2018a ) ,\nthe same evaluation framework can be used if @xmath (resp. @xmath ) is\nmodified to account for the presence (resp. absence) of the keyword (or\nits translation in the source). Similarly this can be extended to other\ntasks by adapting @xmath ( e.g. for classification one would use the\nzero-one loss, and adapt the success threshold).\n\n##### 14.2 Similarity Metrics\n\nThroughout Section 14.1 , we have not given an exact description of the\nsemantic similarity scores @xmath and @xmath . Indeed, automatically\nevaluating the semantic similarity between two sentences is an open area\nof research and it makes sense to decouple the definition of adversarial\nexamples from the specific method used to measure this similarity. In\nthis section, we will discuss manual and automatic metrics that may be\nused to calculate it.\n\n###### 14.2.1 Human Judgment\n\nJudgment by speakers of the language of interest is the de facto gold\nstandard metric for semantic similarity. Specific criteria such as\nadequacy\/fluency Ma & Cieri ( 2006 ) , acceptability Goto et\u00a0al. ( 2013\n) , and 6-level semantic similarity Cer et\u00a0al. ( 2017 ) have been used\nin evaluations of MT and sentence embedding methods. In the context of\nadversarial attacks, we propose the following 6-level evaluation scheme,\nwhich is motivated by previous measures, but designed to be (1)\nsymmetric, like Cer et\u00a0al. ( 2017 ) , (2) and largely considers meaning\npreservation but at the very low and high levels considers fluency of\nthe output \u00b3\u2079 \u00b3\u2079 39 This is important to rule out nonsensical sentences\nand distinguish between clean and \u201cnoisy\u201d paraphrases ( e.g. typos,\nnon-native speech\u2026). We did not give annotators additional instruction\nspecific to typos. , like Goto et\u00a0al. ( 2013 ) :\n\nHow would you rate the similarity between the meaning of these two\nsentences? [itemsep=-4pt] The meaning is completely different or one of\nthe sentences is meaningless The topic is the same but the meaning is\ndifferent Some key information is different The key information is the\nsame but the details differ Meaning is essentially equal but some\nexpressions are unnatural Meaning is essentially equal and the two\nsentences are well-formed English \u2074\u2070 \u2074\u2070 40 Or the language of interest.\n\n###### 14.2.2 Automatic Metrics\n\nUnfortunately, human evaluation is expensive, slow and sometimes\ndifficult to obtain, for example in the case of low-resource languages.\nThis makes automatic metrics that do not require human intervention\nappealing for experimental research. This section describes 3 evaluation\nmetrics commonly used as alternatives to human evaluation, in particular\nto evaluate translation models. \u2074\u00b9 \u2074\u00b9 41 Note that other metrics of\nsimilarity are certainly applicable within the overall framework of\nSection 14.2.1 , but we limit our examination in this chapter to the\nthree noted here.\n\nBLEU: Papineni et\u00a0al. ( 2002 ) is an automatic metric based on n-gram\nprecision coupled with a penalty for shorter sentences. It relies on\nexact word-level matches and therefore cannot detect synonyms or\nmorphological variations.\n\nMETEOR: Denkowski & Lavie ( 2014 ) first estimates alignment between the\ntwo sentences and then computes unigram F-score (biased towards recall)\nweighted by a penalty for longer sentences. Importantly, METEOR uses\nstemming, synonymy and paraphrasing information to perform alignments.\nOn the downside, it requires language specific resources.\n\nchrF: Popovi\u0107 ( 2015 ) is based on the character @xmath -gram F-score.\nIn particular we will use the chrF2 score (based on the F2-score \u2014\nrecall is given more importance), following the recommendations from\nPopovi\u0107 ( 2016 ) . By operating on a sub-word level, it can reflect the\nsemantic similarity between different morphological inflections of one\nword (for instance), without requiring language-specific knowledge which\nmakes it a good one-size-fits-all alternative.\n\nBecause multiple possible alternatives exist, it is important to know\nwhich is the best stand-in for human evaluation. To elucidate this, we\nwill compare these metrics to human judgment in terms of Pearson\ncorrelation coefficient on outputs resulting from a variety of attacks\nin Section 16.2 .\n\n#### 15 Gradient-Based Adversarial Attacks\n\nIn this section, we overview the adversarial attacks we will be\nconsidering in the rest of this chapter.\n\n##### 15.1 Attack Paradigm\n\nWe perform gradient-based attacks that replace one word in the sentence\nso as to maximize an adversarial loss function @xmath , similar to the\nsubstitution attacks proposed in Ebrahimi et\u00a0al. ( 2018b ) .\n\n###### 15.1.1 General Approach\n\nPrecisely, for a word-based translation model @xmath \u2074\u00b2 \u2074\u00b2 42 Note that\nthis formulation is also valid for character-based models (see Ebrahimi\net\u00a0al. ( 2018a ) ) and subword-based models. For subword-based models,\nadditional difficulty would be introduced due to changes to the input\nresulting in different subword segmentations. This poses an interesting\nchallenge that is beyond the scope of the current work. , and given an\ninput sentence @xmath , we find the position @xmath and word @xmath\nsatisfying the following optimization problem:\n\n  -- -------- -- -----\n     @xmath      (7)\n  -- -------- -- -----\n\nwhere @xmath is a differentiable function which represents our\nadversarial objective. Using the first order approximation of @xmath\naround the original word vectors @xmath \u2074\u00b3 \u2074\u00b3 43 More generally we will\nuse the bold @xmath when talking about the embedding vector of word\n@xmath , this can be derived to be equivalent to optimizing\n\n  -- -------- -- -----\n     @xmath      (8)\n  -- -------- -- -----\n\nThe above optimization problem can be solved by brute-force in @xmath\nspace complexity, whereas the time complexity is bottlenecked by a\n@xmath times @xmath matrix multiplication, which is not more\ncomputationally expensive than computing logits during the forward pass\nof the model. Overall, this naive approach is sufficiently fast to be\nconducive to adversarial training. We also found that the attacks\nbenefited from normalizing the gradient by taking its sign.\n\nExtending this approach to finding the optimal perturbations for more\nthan 1 substitution would require exhaustively searching over all\npossible combinations. However, previous work Ebrahimi et\u00a0al. ( 2018a )\nsuggests that greedy search is a good enough approximation.\n\n###### 15.1.2 The Adversarial Loss @xmath\n\nWe want to find an adversarial input @xmath such that, assuming that the\nmodel has produced the correct output @xmath up to step @xmath during\ndecoding, the probability that the model makes an error at the next step\n@xmath is maximized.\n\nIn the log-semiring, this translates into the following loss function:\n\n  -- -------- -- -----\n     @xmath      (9)\n  -- -------- -- -----\n\n##### 15.2 Enforcing Semantically Similar Adversarial Inputs\n\nIn contrast to previous methods, which don\u2019t consider meaning\npreservation, we propose simple modifications of the approach presented\nin Section 15.1 to create adversarial perturbations at the word level\nthat are more likely to preserve meaning. The basic idea is to restrict\nthe possible word substitutions to similar words. We compare two sets of\nconstraints:\n\nkNN: This constraint enforces that the word be replaced only with one of\nits 10 nearest neighbors in the source embedding space. This has two\neffects: first, the replacement will be likely semantically related to\nthe original word (if words close in the embedding space are indeed\nsemantically related, as hinted by Table 9 ). Second, it ensures that\nthe replacement\u2019s word vector is close enough to the original word\nvector that the first order assumption is more likely to be satisfied.\n\nCharSwap: This constraint requires that the substituted words must be\nobtained by swapping characters. Word internal character swaps have been\nshown to not affect human readers greatly McCusker et\u00a0al. ( 1981 ) ,\nhence making them likely to be meaning-preserving. Moreover we add the\nadditional constraint that the substitution must not be in the\nvocabulary, which will likely be particularly meaning-destroying on the\ntarget side for the word-based models we test here. In such cases where\nword-internal character swaps are not possible or can\u2019t produce OOV\nwords, we resort to the naive strategy of repeating the last character\nof the word. The exact procedure used to produce this kind of\nperturbations is described in Listing 15.2 . Note that for a word-based\nmodel, every OOV will look the same (a special <unk> token), however the\nchoice of OOV will still have an influence on the output of the model\nbecause we use unk-replacement.\n\n\u2b07\n\n1\n\n1 def make_oov (\n\n2 word ,\n\n3 vocab ,\n\n4 max_scrambling ,\n\n5 ):\n\n6 \"\"\"Modify a word to make it OOV\n\n7 (while keeping the meaning)\"\"\"\n\n8 # If the word has >3 letters\n\n9 # try scrambling them\n\n10 L = len ( word )\n\n11 if L > 3:\n\n12 # For a fixed number of steps\n\n13 for _ in range ( max_scrambling ):\n\n14 # Swap two adjacent letters\n\n15 # in the middle of the word\n\n16 pos = random . randint (1, L - 3)\n\n17 word = word [: pos ]\n\n18 word += word [ pos +1] + word [ pos ]\n\n19 word += word [ pos +2:]\n\n20 # If we got an OOV already just\n\n21 # return it\n\n22 if word not in vocab :\n\n23 return word\n\n24 # If nothing worked, or the word is\n\n25 # too short for scrambling, just\n\n26 # repeat the last letter ad nauseam\n\n27 char = word [-1]\n\n28 while word in vocab :\n\n29 word = word + char\n\n30 return word\n\n\\setstretch\n\nIn contrast, we refer the base attack without constraints as\nUnconstrained hereforth. Table 9 gives qualitative examples of the kind\nof perturbations generated under the different constraints.\n\nFor subword-based models, we apply the same procedures at the\nsubword-level on the original segmentation. We then de-segment and\nre-segment the resulting sentence (because changes at the subword or\ncharacter levels are likely to change the segmentation of the resulting\nsentence).\n\n#### 16 Experiments\n\nOur experiments serve two purposes. First, we examine our proposed\nframework of evaluating adversarial attacks (Section 14 ), and also\nelucidate which automatic metrics correlate better with human judgment\nfor the purpose of evaluating adversarial attacks (Section 16.2 ).\nSecond, we use this evaluation framework to compare various adversarial\nattacks and demonstrate that adversarial attacks that are explicitly\nconstrained to preserve meaning receive better assessment scores\n(Section 16.3 ).\n\n##### 16.1 Experimental setting\n\nData: Following previous work on adversarial examples for seq2seq models\nBelinkov & Bisk ( 2018b ); Ebrahimi et\u00a0al. ( 2018a ) , we perform all\nexperiments on the IWSLT2016 dataset Cettolo et\u00a0al. ( 2016 ) in the\n{French,German,Czech} @xmath English directions ( fr-en , de-en and\ncs-en ). We compile all previous IWSLT test sets before 2015 as\nvalidation data, and keep the 2015 and 2016 test sets as test data. The\ndata is tokenized with the Moses tokenizer Koehn et\u00a0al. ( 2007 ) . The\nexact data statistics can be found in Table 10 .\n\nMT Models: We perform experiments with two common NMT models. The first\nis an LSTM based encoder-decoder architecture with attention (Luong\net\u00a0al., 2015 ) . It uses 2-layer encoders and decoders, and dot-product\nattention. We set the word embedding dimension to 300 and all others to\n500. The second model is a self-attentional Transformer Vaswani et\u00a0al. (\n2017 ) , with 6 1024-dimensional encoder and decoder layers and 512\ndimensional word embeddings. Both the models are trained with Adam\nKingma & Ba ( 2014 ) , dropout Srivastava et\u00a0al. ( 2014 ) of probability\n0.3 and label smoothing Szegedy et\u00a0al. ( 2016 ) with value 0.1. We\nexperiment with both word based models (vocabulary size fixed at 40k)\nand subword based models (BPE Sennrich et\u00a0al. ( 2016 ) with 30k\noperations). For word-based models, we perform <unk> replacement,\nreplacing <unk> tokens in the translated sentences with the source words\nwith the highest attention value during inference. The full experimental\nsetup and source code are available at\nhttps:\/\/github.com\/pmichel31415\/translate\/tree\/paul\/pytorch_translate\/research\/adversarial\/experiments\n.\n\nAutomatic Metric Implementations: To evaluate both sentence and corpus\nlevel BLEU score, we first de-tokenize the output and use sacreBLEU \u2074\u2074\n\u2074\u2074 44 https:\/\/github.com\/mjpost\/sacreBLEU Post ( 2018b ) with its\ninternal intl tokenization, to keep BLEU scores agnostic to\ntokenization. We compute METEOR using the official implementation \u2074\u2075 \u2074\u2075\n45 http:\/\/www.cs.cmu.edu\/~alavie\/METEOR\/ . ChrF is reported with the\nsacreBLEU implementation on detokenized text with default parameters. A\ntoolkit implementing the evaluation framework described in Section 14.1\nfor these metrics is released at\nhttps:\/\/github.com\/pmichel31415\/teapot-nlp .\n\n##### 16.2 Correlation of Automatic Metrics with Human Judgment\n\nWe first examine which of the automatic metrics listed in Section 14.2\ncorrelates most with human judgment for our adversarial attacks. For\nthis experiment, we restrict the scope to the case of the LSTM model on\nfr-en . For the French side, we randomly select 900 sentence pairs\n@xmath from the validation set, 300 for each of the Unconstrained, kNN\nand CharSwap constraints. To vary the level of perturbation, the 300\npairs contain an equal amount of perturbed input obtained by\nsubstituting 1, 2 and 3 words. On the English side, we select 900 pairs\nof reference translations and translations of adversarial input @xmath\nwith the same distribution of attacks as the source side, as well as 300\n@xmath pairs (to include translations from original inputs). This\namounts to 1,200 sentence pairs in the target side.\n\nThese sentences are sent to English and French speaking annotators to be\nrated according to the guidelines described in Section 14.2.1 . Each\nsample (a pair of sentences) is rated by two independent evaluators. If\nthe two ratings differ, the sample is sent to a third rater (an auditor\nand subject matter expert) who makes the final decision.\n\nFinally, we compare the human results to each automatic metric with\nPearson\u2019s correlation coefficient. The correlations are reported in\nTable 11 . As evidenced by the results, chrF exhibits higher correlation\nwith human judgment, followed by METEOR and BLEU. This is true both on\nthe source side ( @xmath vs @xmath ) and in the target side ( @xmath vs\n@xmath ). We evaluate the statistical significance of this result using\na paired bootstrap test for @xmath . Notably we find that chrF is\nsignificantly better than METEOR in French but not in English. This is\nnot too unexpected because METEOR has access to more language-dependent\nresources in English (specifically synonym information) and thereby can\nmake more informed matches of these synonymous words and phrases.\nMoreover the French source side contains more \u201ccharacter-level\u201d errors\n(from CharSwap attacks) which are not picked-up well by word-based\nmetrics like BLEU and METEOR.\n\nWe provide a breakdown of the correlation coefficients of automatic\nmetrics with human judgment for source-side meaning-preservation, both\nin terms of number of perturbed words (Table 12 ) and constraint (Table\n13 ). While those coefficients are computed on a much smaller sample\nsize, and their differences are not all statistically significant with\n@xmath , they exhibit the same trend as the results from Table 11 (BLEU\n@xmath METEOR @xmath chrF). In particular Table 12 shows that the good\ncorrelation of chrF with human judgment is not only due to the ability\nto distinguish between different number of edits.\n\nThus, in the following, we report attack results both in terms of chrF\nin the source ( @xmath ) and relative decrease in chrF (RDchrF) in the\ntarget ( @xmath ).\n\n##### 16.3 Attack Results\n\nWe can now compare attacks under the three constraints Unconstrained,\nkNN and CharSwap and draw conclusions on their capacity to preserve\nmeaning in the source and destroy it in the target. Attacks are\nconducted on the validation set using the approach described in Section\n15.1 with 3 substitutions (this means that each adversarial input is at\nedit distance at most 3 from the original input). Results (on a scale of\n0 to 100 for readability) are reported in Table 14 for both word- and\nsubword- based LSTM and Transformer models. To give a better idea of how\nthe different variables (language pair, model, attack) affect\nperformance, we give a graphical representation of these same results in\nFigure 2 for the word-based models. The rest of this section discusses\nthe implication of these results.\n\nSource chrF Highlights the Effect of Adding Constraints: Comparing the\nkNN and CharSwap rows to Unconstrained in the \u201csource\u201d sections of Table\n14 clearly shows that constrained attacks have a positive effect on\nmeaning preservation. Beyond validating our assumptions from Section\n15.2 , this shows that source chrF is useful to carry out the comparison\nin the first place \u2074\u2076 \u2074\u2076 46 It can be argued that using chrF gives an\nadvantage to CharSwap over kNN for source preservation (as opposed to\nMETEOR for example). We find that this is the case for Czech and German\n(source METEOR is higher for kNN) but not French. Moreover we find (see\ne.g. Table 12 ) that chrF correlates better with human judgement even\nfor kNN. . To give a point of reference, results from the manual\nevaluation carried out in Section 16.2 show that that @xmath of the\nFrench sentence pairs to which humans gave a score of 4 or 5 in semantic\nsimilarity have a chrF @xmath .\n\nDifferent Architectures are not Equal in the Face of Adversity:\nInspection of the target-side results yields several interesting\nobservations. First, the high RDchrF of CharSwap for word-based model is\nyet another indication of their known shortcomings when presented with\nwords out of their training vocabulary, even with <unk> -replacement.\nSecond, and perhaps more interestingly, Transformer models appear to be\nless robust to small embedding perturbations (kNN attacks) compared to\nLSTMs. Although the exploration of the exact reasons for this phenomenon\nis beyond the scope of this work, this is a good example that RDchrF can\nshed light on the different behavior of different architectures when\nconfronted with adversarial input. Overall, we find that the CharSwap\nconstraint is the only one that consistently produces attacks with\n@xmath average success (as defined in Section 14.1 ) according to Table\n14 . Table 15 contains two qualitative examples of this attack on the\nLSTM model in fr-en .\n\n#### 17 Adversarial Training with Meaning-Preserving Attacks\n\n##### 17.1 Adversarial Training\n\nAdversarial training Goodfellow et\u00a0al. ( 2014b ) augments the training\ndata with adversarial examples. Formally, in place of the negative log\nlikelihood (NLL) objective on a sample @xmath , @xmath , the loss\nfunction is replaced with an interpolation of the NLL of the original\nsample @xmath and an adversarial sample @xmath :\n\n  -- -------- -- ------\n     @xmath      (10)\n  -- -------- -- ------\n\nEbrahimi et\u00a0al. ( 2018a ) suggest that while adversarial training\nimproves robustness to adversarial attacks, it can be detrimental to\ntest performance on non-adversarial input. We investigate whether this\nis still the case when adversarial attacks are largely\nmeaning-preserving.\n\nIn our experiments, we generate @xmath by applying 3 perturbations on\nthe fly at each training step. To maintain training speed we do not\nsolve Equation ( 7 ) iteratively but in one shot by replacing the argmax\nby top-3. Although this is less exact than iterating, this makes\nadversarial training time less than @xmath slower than normal training.\nWe perform adversarial training with perturbations without constraints\n(Unconstrained-adv) and with the CharSwap constraint (CharSwap-adv). All\nexperiments are conducted with the word-based LSTM model.\n\n##### 17.2 Results\n\nTest performance on non-adversarial input is reported in Table 16 . In\nkeeping with the rest of the paper, we primarily report chrF results,\nbut also show the standard BLEU as well.\n\nWe observe that when @xmath , i.e. the model only sees the perturbed\ninput during training \u2074\u2077 \u2074\u2077 47 This setting is reminiscent of word\ndropout Iyyer et\u00a0al. ( 2015 ) . , the Unconstrained-adv model suffers a\ndrop in test performance, whereas CharSwap-adv\u2019s performance is on par\nwith the original. This is likely attributable to the spurious training\nsamples @xmath where @xmath is not an acceptable translation of @xmath\nintroduced by the lack of constraint. This effect disappears when @xmath\nbecause the model sees the original samples as well.\n\nNot unexpectedly, Table 17 indicates that CharSwap-adv is more robust to\nCharSwap constrained attacks for both values of @xmath , with @xmath\ngiving the best results. On the other hand, Unconstrained-adv is\nsimilarly or more vulnerable to these attacks than the baseline. Hence,\nwe can safely conclude that adversarial training with CharSwap attacks\nimproves robustness while not impacting test performance as much as\nunconstrained attacks.\n\n#### 18 Related work\n\nFollowing seminal work on adversarial attacks by Szegedy et\u00a0al. ( 2013 )\n, Goodfellow et\u00a0al. ( 2014b ) introduced gradient-based attacks and\nadversarial training. Since then, a variety of attack Moosavi-Dezfooli\net\u00a0al. ( 2016 ) and defense Ciss\u00e9 et\u00a0al. ( 2017 ); Kolter & Wong ( 2017\n) mechanisms have been proposed. Adversarial examples for NLP\nspecifically have seen attacks on sentiment Papernot et\u00a0al. ( 2016 );\nSamanta & Mehta ( 2017 ); Ebrahimi et\u00a0al. ( 2018b ) , malware Grosse\net\u00a0al. ( 2016 ) , gender Reddy & Knight ( 2016 ) or toxicity Hosseini\net\u00a0al. ( 2017 ) classification to cite a few.\n\nIn MT , methods have been proposed to attack word-based Zhao et\u00a0al. (\n2018 ); Cheng et\u00a0al. ( 2018a ) and character-based Belinkov & Bisk (\n2018b ); Ebrahimi et\u00a0al. ( 2018a ) models. However these works side-step\nthe question of meaning preservation in the source: they mostly focus on\ntarget side evaluation. Finally there is work centered around\nmeaning-preserving adversarial attacks for NLP via paraphrase generation\nIyyer et\u00a0al. ( 2018 ) or rule-based approaches Jia & Liang ( 2017 );\nRibeiro et\u00a0al. ( 2018 ); Naik et\u00a0al. ( 2018 ); Alzantot et\u00a0al. ( 2018 )\n. However the proposed attacks are highly engineered and focused on\nEnglish.\n\n#### 19 Conclusion\n\nThis chapter highlights the importance of performing meaning-preserving\nadversarial perturbations for NLP models (with a focus on seq2seq ). We\nproposed a general evaluation framework for adversarial perturbations\nand compared various automatic metrics as proxies for human judgment to\ninstantiate this framework. We then confirmed that, in the context of MT\n, \u201cnaive\u201d attacks do not preserve meaning in general, and proposed\nalternatives to remedy this issue. Finally, we have shown that a careful\nchoice of more meaning-preserving perturbations is beneficial for\nadversarial training.\n\nSince the original publication of the content in this chapter in 2019, a\nnumber of works have followed-up, either by adapting the evaluation\nframework to other tasks, e.g. semantic parsing in Huang et\u00a0al. ( 2021 )\n, or by building upon it for designing more imperceptible adversarial\nperturbations, for instance using the proposed evaluation metrics as\nrewards for reinforcement learning based perturbation generation (Zou\net\u00a0al., 2020 ) , or pushing further the concept of indistinguishable\nperturbations with encoding specific character substitutions (Boucher\net\u00a0al., 2021 ) .\n\n## Part II Making Robust Models\n\n### Chapter \\thechapter Modeling the Second Player in Distributionally\nRobust Optimization\n\n#### 20 Introduction\n\nUp to this point, we have principally been concerned with evaluating the\neffect that various types of distributional shifts have on existing\nmodels. In this chapter and the next, we now tackle the problem of\ntraining models that are more robust against distributional shifts.\n\nThe tendency of machine learning models to exhibit drops in accuracy\nwhen confronted with data from domains that are absent from or\nunder-represented in their training data often arises from the objective\nfunction of ERM . Recall that in ERM , the parameters @xmath of the\nmodel are learned by minimizing the expectation of a loss function\n@xmath under a data distribution @xmath (or, specifically in practice,\nan associated empirical data distribution @xmath )\n\n  -- -------- -- ------\n     @xmath      (11)\n  -- -------- -- ------\n\nWhen the model encounters data sampled from a different distribution\n@xmath , performance can suffer significantly. As described in Chapter\nLearning Neural Models for Natural Language Processing in the Face of\nDistributional Shift , distributionally robust optimization ( DRO\n)provides a natural solution to this issue by replacing the expected\nrisk under a single distribution @xmath with the worst expected risk\nover a pre-determined family of distributions @xmath (the \u201cuncertainty\nset\u201d)\n\n  -- -------- -- ------\n     @xmath      (12)\n  -- -------- -- ------\n\nIf @xmath contains @xmath , the DRO objective upper bounds the expected\nrisk under @xmath . However, a priori knowledge of possible test\ndistributions is not always available or easy to acquire. For example,\ntraining a model to be robust to some demographic attributes ( @xmath )\nrequires collecting and annotating data with the necessary information,\nan expensive and ethically fraught endeavour. In the absence of such\ninformation, one has to resort to defining the uncertainty set\nanalytically, drawing on one\u2019s intuition of what constitutes a possible\ntest distribution given the observed training distribution, such as\nusing moment constraints (Delage & Ye, 2010 ; Nguyen et\u00a0al., 2020 ) ,\n@xmath -divergence (Ben-Tal et\u00a0al., 2013 ; Hu & Hong, 2013 ; Faury\net\u00a0al., 2020 ) , Wasserstein\/IPM (Sinha et\u00a0al., 2018 ; Husain, 2020 )\nballs, or coarse-grained mixture models (Oren et\u00a0al., 2019 ; Hu et\u00a0al.,\n2018 ) . However, the need for keeping the inner supremum in Eq.\u00a0( 12 )\ntractable limits the possible choices.\n\nIn this chapter, we propose that the uncertainty set be instead defined\nas a family of parametric generative models. The resulting DRO objective\n(\u00a7 21 ) is a differentiable game with two players: the original model\n@xmath and a model of its worst-case distribution @xmath , the titular\n\u201csecond player\u201d which we hereafter refer to as the adversary . Using\nthis formulation \u2014 which we call Parametric DRO (P-DRO) \u2014 allows for\nmore flexibility in the choice of the adversary\u2019s architecture (and so\nthe uncertainty set). Unfortunately, finding a solution of this game via\ndirect application of simultaneous gradient descent (Singh et\u00a0al., 2000\n) is difficult (Balduzzi et\u00a0al., 2018 ) . In particular, direct gradient\ndescent on the uncertainty set suffers from instability due to the large\nvariance of the gradients (Greensmith et\u00a0al., 2004 ) , and\nhyper-parameter selection is not straightforward.\n\nTo address these challenges, we make two main contributions (\u00a7 22 ):\nfirst, we propose a new relaxation of the DRO game\u2019s inner maximization\nproblem (with KL constraints). The resulting objective is more amenable\nto simultaneous gradient update than the original zero-sum game and\nsignificantly improves training stability, while still yielding useful\nadversaries. Second, we develop a principled approach for selecting\nhyper-parameters: we leverage the learned adversaries to decide which of\nany two given models trained with P-DRO is more robust than the other.\n\nWe do an in-depth set of experiments analyzing the effect of our\nproposed changes on both a toy task as well as a more realistic, yet\nstill synthetic sentiment classification task (\u00a7 23 ). Finally, we show\nthat in the more realistic setting of toxicity detection, P-DRO yields\nmodels that are more robust to changes in demographic groups, even\nthough these groups are unknown at training time, opening up\napplications in combatting dataset bias (\u00a7 24 ). Code to reproduce our\nexperiments can be found at https:\/\/github.com\/pmichel31415\/P-DRO .\n\n#### 21 Parameterizing the Uncertainty Set\n\nConsider a model parameterized by @xmath . Minimizing the DRO objective\ndescribed in Eq.\u00a0( 12 ) over the uncertainty set @xmath turns the\noptimization problem into the min-max (or zero-sum) game\n\n  -- -------- -- ------\n     @xmath      (13)\n  -- -------- -- ------\n\nThe first player controls the parameters @xmath , whilst the second\nplayer controls the worst-case distribution @xmath . In the absence of\nexplicit information on groups of interest (such as demographics,\ndomain, etc.), an adequate choice of the uncertainty set @xmath is\ncritical to the success of DRO . This is in fact very much an active\narea of research ( Sinha et\u00a0al. ( 2018 ); Duchi & Namkoong ( 2018 );\nOren et\u00a0al. ( 2019 ) , see Rahimian & Mehrotra ( 2019 ) for a survey).\n@xmath must be sufficiently large to contain test distributions of\ninterest, but if it is too large it may contain \u201cadversarial\u201d\ndistributions on which no model can perform well. Moreover, the design\nof @xmath is also circumscribed by the necessity of keeping the min-max\nproblem tractable, particularly in the context of stochastic\noptimization. In Hu & Hong ( 2013 ) and Duchi et\u00a0al. ( 2016 ) for\nexample, the choice of @xmath -divergence balls allows the use of\nduality arguments to reformulate ( 13 ) as a more manageable min-min\nproblem. Others, like Hu et\u00a0al. ( 2018 ) or Oren et\u00a0al. ( 2019 ) ,\npropose using mixture models, the simplicity of which enables them to\nsolve the inner maximization problem efficiently.\n\nInstead, we propose to explicitly model the second player in the DRO\ngame as a parametric model @xmath of the data. Of course, not all\nparameterizations @xmath of a given generative model represent useful\ndistributions, and we require that the adversary stay \u201cclose\u201d to the\nunderlying true data distribution @xmath . As a measure of distance\nbetween @xmath and @xmath , we choose the KL (Kullback & Leibler, 1951 )\ndivergence due to its wide acceptance in the machine learning community,\nas well as its appealing properties in the context of DRO . \u2074\u2078 \u2074\u2078 48 For\ninstance: @xmath implies that @xmath stays within the support of @xmath\nThe KL upper bound, @xmath , is left as a parameter to be decided by the\nexperimenter. We refer to the resulting DRO formulation as Parametric\nDRO\n\n  -- -------- -- ------\n     @xmath      (14)\n  -- -------- -- ------\n\n#### 22 Optimizing P-DRO\n\nThe min-max problem in Eq. ( 14 ) belongs to a class of games called\n\u201cdifferentiable games\u201d (another famous representative being generative\nadversarial networks (Goodfellow et\u00a0al., 2014a ) ). We can search for a\nsolution of this game with simultaneous gradient descent (Singh et\u00a0al.,\n2000 ) , i.e. by simultaneously updating @xmath and @xmath with @xmath\nand @xmath respectively. Unfortunately, in general, there is no\ntheoretical guarantee that simultaneous gradient descent will converge\nto a Nash equilibrium \u2074\u2079 \u2074\u2079 49 Nash equilibria (Osborne & Rubinstein,\n1994 ) can be thought of the game theoretic analog of global minima in\noptimization. (Balduzzi et\u00a0al., 2018 ) , nor that any such equilibrium\neven exists if the objective is non-convex in @xmath (or non-concave in\n@xmath ). The success of GANs and the follow-up literature (Wang et\u00a0al.,\n2019c ) serves as an encouraging example that gradient based methods can\nyield useful solutions despite the pessimistic theoretical results. In\nthis section, we discuss difficulties that arise when optimizing @xmath\nand @xmath jointly, and propose modifications of the objective to\naddress them.\n\n##### 22.1 Training the Model @xmath\n\nWe could train the model @xmath by taking negative gradient steps on\n@xmath . This gradient can be estimated by sampling examples from @xmath\nand averaging the gradient of their losses. Unfortunately, this\nobjective requires that @xmath is well-behaved at all iterations, as it\nis the only source of supervision for @xmath . If @xmath is initialized\nincorrectly or begins producing unrealistic @xmath , the quality of\n@xmath degrades as it begins to learn a predictor on invalid training\nexamples from @xmath As an alternative, we opt to compute the gradients\nfor @xmath with importance sampling, i.e. rewriting @xmath as @xmath ,\nwhich ensures that all @xmath samples will be derived from the training\nset itself. Unfortunately, the true density @xmath is unknown to us. As\nan approximation, we replace @xmath with the likelihood ratio between\n@xmath and the maximum likelihood estimate of @xmath , @xmath . This\nchanges the min-max problem to\n\n  -- -------- -- ------\n     @xmath      (15)\n  -- -------- -- ------\n\nThis becomes a simple expected loss objective, which we can estimate by\nsampling from the empirical distribution @xmath . In experiments, we\nfind that with this formulation we are able to train robust @xmath even\nwhen @xmath is only a mediocre generative model (see Appendix 25.2 ). To\nfurther stabilize training at the beginning of the optimization process,\nwe initialize @xmath with @xmath , making the objective exactly the same\nas ERM for the first gradient step.\n\n##### 22.2 Training the Adversary @xmath\n\nAccording to Eq.\u00a0( 15 ) the adversary @xmath must maximize @xmath within\na KL ball of fixed radius. This is challenging for several reasons:\nfirst, enforcing the bound is intractable for complex families of\nadversaries where e.g. projecting onto the KL ball is another difficult\noptimization problem of its own. Second, maximizing the expectation with\nrespect to the parameters of the distribution @xmath is prone to\ninstability due to large gradient variance (Greensmith et\u00a0al., 2004 ) .\n\n###### Lagrangian Relaxation\n\nTo address the first difficulty, we loosen the strict KL constraint and\ninstead consider the Lagrangian relaxation @xmath\n\n  -- -------- -------- -- ------\n     @xmath   @xmath      (16)\n  -- -------- -------- -- ------\n\nWe fix the Lagrangian multiplier @xmath as treat it as a \u201ctemperature\u201d\nhyper-parameter. With some reorganization (which we develop in Appendix\nA ), we can show that\n\n  -- -------- -- ------\n     @xmath      (17)\n  -- -------- -- ------\n\nWhere @xmath and @xmath is a constant in @xmath . In other words,\nmaximizing @xmath in @xmath is equivalent to minimizing the KL\ndivergence between @xmath and @xmath . One difficulty with this\nobjective is that @xmath depends upon the unknown probability density\n@xmath . We avoid this problem by treating the density ratio @xmath as a\nconstant, which is closely related to assumptions that have been used\nsuccessfully in past formulations of DRO (Oren et\u00a0al., 2019 ) .\nEmpirically, we find that incorporating @xmath as a surrogate for @xmath\nis a serviceable approximation, as demonstrated in Section 23 .\n\n###### Reversing the KL\n\nMinimizing the KL divergence in this direction is difficult for several\nreasons. First, it entails optimizing an expectation in @xmath over\n@xmath , which is difficult due to the large variance of the gradients\n(Greensmith et\u00a0al., 2004 ) . Second, computing this KL necessitates\naccess to the true theoretical density @xmath in order to compute @xmath\nin the argument of the expectation, but this quantity is unknown in\npractice. \u2075\u2070 \u2075\u2070 50 Note that substituting the empirical distribution\n@xmath for @xmath poses issues here, because @xmath is not absolutely\ncontinuous with respect to @xmath . To sidestep these issues, we elect\nto minimize the reverse direction @xmath instead. Due to the KL\ndivergence being non-symmetric, this is a rather crude approximation \u2075\u00b9\n\u2075\u00b9 51 For instance, the optimum of the reverse KL doesn\u2019t necessarily\nmatch that of the forward KL within the parametric confusion set @xmath\n, the implications of which are discussed in Norouzi et\u00a0al. ( 2016 ) .\nHowever, we find that this approach dramatically stabilizes the gradient\ndynamics while still yielding good adversaries, as observed empirically\nin Section 23.7 . Discarding the entropy term (constant in @xmath ), the\nresulting problem is equivalent to minimizing\n\n  -- -------- -- ------\n     @xmath      (18)\n  -- -------- -- ------\n\nin @xmath , where @xmath is the normalizer of @xmath . In this case, we\ncan estimate this expectation by substituting the empirical distribution\n@xmath for @xmath in the expectation.\n\n###### Computing the Normalizer\n\nApproximating the inverse normalizer @xmath in a minibatch yields a\nbiased estimator. On the other hand, computing @xmath over the entire\ntraining data at each step is prohibitive since it requires computing\nthe loss of every single example. As a middle ground, we keep a running\nnormalizer @xmath computed from the average of the normalizers over a\nfixed number @xmath of consecutive minibatches. In other words, if\n@xmath and @xmath denote the minibatch and adversary parameters at step\n@xmath respectively, the normalizer at step @xmath will be\n\n  -- -------- -- ------\n     @xmath      (19)\n  -- -------- -- ------\n\nIf @xmath is too low, there is a risk of under-estimating the\nnormalizer, especially if the distribution of weights contains\ninfrequent high weight samples. On the other hand, if @xmath is too high\nthere is a risk of using \u201cstale\u201d weights in the normalizer. In\nexperiments, we treat @xmath as a hyper-parameter.\n\n##### 22.3 Optimal Stopping\n\nWhen should one stop training a model with P-DRO ? In ERM it is\ncustomary to stop training after the empirical risk \u2014 periodically\nevaluated on a held out validation dataset \u2014 stops decreasing. This is\nparticularly important to prevent over-fitting to the training data.\nHowever, it is not an appropriate criterion for P-DRO , since the model\nis not trained to minimize empirical risk in the first place. A more\npertinent choice is to compare the robust validation losses\n\n  -- -------- -- ------\n     @xmath      (20)\n  -- -------- -- ------\n\nHowever, finding the inner supremum for each of the @xmath evaluation\ncheckpoints @xmath is expensive as it requires solving @xmath\nindependent optimization problems. Instead, we leverage the existence of\nadversaries @xmath associated with each model @xmath , as well as the\ninitial adversary @xmath and take the maximum over the @xmath\nadversaries @xmath . Since our relaxation of the P-DRO objective loosens\nthe KL constraint, we need weed out adversaries which might violate it.\nSpecifically, we estimate the @xmath on the validation set, using @xmath\nas a stand-in for @xmath , and reject all adversaries for which the\nresult is greater than a threshold, which we set to @xmath based on\npreliminary experiments detailed in Appendix 25.1 . \u2075\u00b2 \u2075\u00b2 52 To simplify\nnotation, this additional constraint is implicit in the rest of this\nsection. We refer to this stopping criterion as Minmax .\n\nComputing the full min-max necessitates keeping track of @xmath models\nand @xmath adversaries, which is ponderous when the model is large. As a\nsolution, we propose an approximation, Greedy-Minmax , in which we only\nkeep one best model @xmath . At each evaluation step @xmath , we compare\n@xmath to @xmath , and update @xmath to whichever achieves lower robust\nvalidation loss over the @xmath adversaries @xmath .\n\nBy keeping track of only one additional model, and using the weights\n@xmath of individual examples in @xmath as sufficient statistics for\ncomputing the loss against each adversary, Greedy-Minmax can be achieved\nwith space complexity @xmath , which is much more efficient than the\n@xmath of Minmax.\n\n##### 22.4 Hyper-parameter Selection\n\nOur proposed P-DRO method relies on 3 different hyper-parameters (in\naddition to the model\u2019s hyper-parameters): the adversary learning rate\n@xmath , the temperature @xmath and the size of the re-normalizing\nwindow @xmath . As a consequence, we need a reliable criterion for\ndeciding which of two configurations is better. This model comparison\nbears many similarities with the stopping problem described above.\nTherefore, we resort to a similar solution: given two models @xmath ,\n@xmath trained with P-DRO , and their respective adversaries @xmath ,\n@xmath (for instance, the adversaries associated with @xmath and @xmath\nat periodic checkpoints during training), we select the best model\nfollowing\n\n  -- -------- -- ------\n     @xmath      (21)\n  -- -------- -- ------\n\n#### 23 Experimental Analysis of P-Dro\n\nBefore moving on to a real world scenario in Section 24 , we first\ndemonstrate that P-DRO is able to learn robust models in a synthetic NLP\ntask, and perform ablation studies to examine the importance of the\nvarious modifications described in Section 22 .\n\n##### 23.1 Experimental Setting\n\nFor analysis purposes, we design a simple NLP task amenable to DRO . We\nspecifically choose NLP as a domain due to the striking success of\nlanguage models as generative models of textual data (Sundermeyer\net\u00a0al., 2012 ; Radford et\u00a0al., 2018 ) , which can be used to model the\nuncertainty set. We base our task off of the binary version of the\nStanford Sentiment Treebank dataset (SST-2; Socher et\u00a0al. ( 2013 ) ),\nwhich we modify to introduce spurious correlation. Specifically, we\nintroduce a distractor token to some sentences. The distractor we use\nconsists of prepending \u201cso , \u201d to the sentence (\u201ci hated this movie\u201d\n@xmath \u201cso , I hated this movie\u201d), which doesn\u2019t change the underlying\nsentiment. The resulting samples can be categorized in 4 \u201cgroups\u201d\ndepending on their label (positive or negative) and the presence or\nabsence of the distractor. In particular, we add this distractor to 95%\nof the negative reviews and 5% of the positive reviews in the training\nand validation set, so that the presence of the distractor strongly\ncorrelates with negative sentiment (a similar construction is proposed\nin (Utama et\u00a0al., 2020 ) ). In the test data, we modify 50% of all\nsentences for each class equitably to ensure that there is enough data\nin each group, but we report \u201caverage\u201d test accuracy by re-weighting the\ngroup accuracies to mimick the training distribution. We call this\nmodified task BiasedSST .\n\n##### 23.2 Model Settings\n\nIn all experiments, we split the text into sub-word tokens using the\ntokenizer described in (Devlin et\u00a0al., 2018 ) . For the classifier, we\ntrain a simple one layer BiLSTM model with embedding\/hidden dimension\n300. During training, we sample minibatches that contain at most @xmath\nsentences or @xmath tokens, whichever is greater, in order to prevent\nGPU memory overflow in case of long sentences. We train all models with\nAdam (Kingma & Ba, 2014 ) with an initial learning rate of @xmath ,\nwhich we decay linearly at each step until the end of training. We\nvalidate the models every epoch. For BERT, we start from the\nbert-base-uncased checkpoint.\n\n##### 23.3 Adversary Settings\n\nIn all experiments, we use an auto-regressive transformer model based on\nthe successful GPT-2 language model (Radford et\u00a0al., 2019 ) architecture\nbut with 6 layers, a dimension of 512 and 8 attention heads (we\nexperiment with a smaller, LSTM based adversary in Section 25.2 ). In\norder to model the input output pair @xmath , we pre-pend a special\nlabel-specific token to sentences before running them through the\nlanguage model. We train the adversary with vanilla stochastic gradient\ndescent, which we found more stable in experiments.\n\nTo initialize the adversary (to obtain @xmath ), we first pre-train the\nmodel on a generic, relatively large language modeling dataset,\nWikiText-103 (Merity et\u00a0al., 2017 ) . We also use a batch size of 64\nsamples or 2500 tokens, and train with Adam for 10 epochs, with a fixed\nlearning rate of @xmath . Then, we fine-tune this model on each dataset,\nthis time minimizing the negative log-likelihood of the @xmath pair,\nusing the same hyper-parameters but a smaller learning rate ( @xmath ).\nWe find that, due to the small to medium size of the datasets under\nconsideration, this LM pretraining step helped achieve lower error on\nthe generative modeling task.\n\n##### 23.4 Baselines\n\nIn addition to ERM, we also compare three other approaches. First, to\nappreciate how well the model could perform if the groups were known at\ntraining time, we train with Group-DRO on the oracle groups using an\nexponentiated-gradients based online algorithm ( Oracle DRO ; Sagawa\net\u00a0al. ( 2020 ) ). Second, we implement Topic DRO (Oren et\u00a0al., 2019 ) ,\na method for DRO on NLP where the uncertainty set is determined by\nmixtures of a topic model. Finally, we compare to non-parametric DRO\nwith a KL constrained uncertainty set (Hu & Hong, 2013 ; Hu et\u00a0al., 2018\n) , which we adapt to fit our online mini-batch training setting (\nNonParam ). Below, we outline experimental details for the latter two.\n\n###### 23.4.1 Topic DRO\n\nTo train the topic model for Topic DRO, we first pre-process the text by\nremoving all punctuation, urls and user mentions (for twitter data).\nImportantly, we remove stop-words for our toxicity experiments but not\nfor our BiasedSST experiment. This is because the distractor token we\nuse (\u2018\u2018so\u2019\u2019) belongs to most English stop words lists, and removing it\nwould completely prevent the topic model from picking up on the groups\nof interest. We then estimate the parameters of the model with Gensim \u2075\u00b3\n\u2075\u00b3 53 https:\/\/radimrehurek.com\/gensim\/ and use similar settings as Oren\net\u00a0al. ( 2019 ) ( @xmath , @xmath ), setting the number of topics to 10.\n\nFor both Oracle-DRO and Topic DRO, we use the algorithm proposed in\nSagawa et\u00a0al. ( 2020 ) to estimate the worst-case group (either oracle\ngroup or topic in Topic DRO) online during training. We perform\ngrid-search over @xmath to find the best learning rate for the group\nweights update. For Oracle DRO , the best model is simply selected by\nrobust validation accuracy. For Topic DRO, unless specified otherwise,\nwe select the model with the lowest worst-case error over all topics.\n\n###### 23.4.2 NonParam\n\nIn the KL-constrained non-parametric setting, the min-max problem reads\n\n  -- -------- -- ------\n     @xmath      (22)\n  -- -------- -- ------\n\nHere, @xmath is the desired radius of the KL ball, and is treated as a\nhyper-parameter. The solution of the inner maximum has an analytical\nsolution of the form @xmath (see Hu & Hong ( 2013 ); Hu et\u00a0al. ( 2018 )\nfor details) with @xmath and @xmath such that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNote that both computing @xmath and @xmath require taking expectations\nover @xmath . In our setting, where @xmath is the output of a large\nneural network, we cannot afford to take this expectation over the\nentire training data at each step. Instead, we fall back to taking the\naverage over each mini-batch. We find @xmath with binary search in\n@xmath space within the @xmath interval and clip to the lowest or\nhighest value should the result lie outside the search interval.\n\nIn all experiments, we try 4 different values for @xmath : @xmath ,\n@xmath , @xmath and @xmath . Unless indicated otherwise, we perform\nearly stopping and hyper-parameter selection using our Minmax criterion\nusing the non-parametric weights as adversaries on the validation data.\n\n##### 23.5 P-DRO can Learn Robust Models\n\nWe train 7 models with P-DRO on BiasedSST using different\nhyper-parameters for the adversary. We start from configuration @xmath ,\n@xmath , @xmath , and for each hyper-parameter we run a configuration\nwith a smaller and a higher value, keeping all other hyper-parameters\nthe same. We train for 50 epochs and select the best model using the\nstrategies described in Section 22 .\n\nWe report the worst-case (\u201crobust\u201d) accuracy over all groups on the test\nset, as well the average accuracy in Table 18 (we report the mean and\nstandard deviation over 5 runs). We find that both Topic DRO, NonParam\nand P-DRO are more robust than ERM , but the latter outperforms the\nformer two close to 30 and 7 points respectively, achieving @xmath of\nOracle DRO\u2019s robust accuracy, while not leveraging any information on\nthe oracle groups.\n\n##### 23.6 Optimal Stopping and Hyper-parameter Selection Ablation\n\nTo understand the importance of the optimal stopping and hyper-parameter\nselection strategy described in Section 22.3 , we perform an ablation on\nthe BiasedSST dataset comparing 4 strategies:\n\n-    Average : models are selected based on their average zero-one loss\n    ( i.e. error rate) on the unmodified validation set. This is the\n    baseline stopping criterion.\n\n-    Minmax : selection based on the adversaries (as described in\n    Section 22.3 ), with and without the KL constraint , as well as its\n    variant Greedy-Minmax for stopping.\n\n-    Oracle : in this setting the groups are known (in the validation\n    set), and models are selected based on their error rate on the worst\n    performing group. This is the optimal criterion for the group-DRO\n    setting we are considering.\n\nTo compare stopping criterions experiments, we only consider one set of\nhyper-parameters: @xmath , @xmath and @xmath . From the robust\nvalidation accuracies reported in Table 19(a) , we first observe that\nAverage stopping results in a robust accuracy of 0, highlighting the\nnecessity for a suitable stopping criterion. We find that Minmax,\nespecially with a KL constraint, is a much better strategy, recovering\n@xmath of the performance achievable with Oracle stopping. Notably, the\nGreedy-Minmax variant which we use in practice reaches very close\nresults ( @xmath point difference) despite its requiring to keep track\nof only 2 out of the 50 model checkpoints at any time.\n\nTo understand the effectiveness of the Minmax strategy for selecting\nhyper-parameters. We take the models trained in Section 23.5 , but\nselect the best hyper-parameters using the different strategies\ndescribed above. Results, shown in Table 19(b) , confirm that Minmax\n(with the KL constraint) is a better choice than Average for selecting\nhyper-parameters, even though the improvement is not as striking as for\nstopping.\n\n##### 23.7 Importance of @xmath\n\nFinally, we investigate the importance of modifying the adversary\u2019s\nobjective as described in Section 22.2 . For this experiment, we devise\na simpler toy task on which directly training the constrained DRO\nobjective is possible. Specifically, we consider the two-dimensional\nbinary classification problem pictured in Figure 4 . The training data\nconsists of 10,000 points partitioned in two normally distributed\n\u201cdomains\u201d with a 1:50 sampling ratio and different classification\nboundaries. We train a logistic regression model, which cannot perfectly\nfit the training data and must trade-off between accuracy on each\ndomain. For the sake of simplicity, we only model the input variables\n@xmath \u2075\u2074 \u2075\u2074 54 In other words, we set @xmath , where @xmath , is the\ntrue conditional which will be canceled out in the ratio @xmath . as\nisotropic normal distributions with fixed variance: the adversaries\u2019\nparameter @xmath represents the location of the Gaussian (we fix the\nvariance to the empirical variance of the data).\n\nWe compare 3 different versions of P-DRO : first, naive simultaneous\ngradient descent on the zero-sum game, without any constraint on the\nadversary ( bare P-DRO ), then the same, but with an approximation of\nthe explicit KL constraint between @xmath and @xmath ( +KL constraint .\nEven in this simplest setting, the exact KL between @xmath (a gaussian)\nand @xmath (a mixture of gaussians) does not have an analytical\nexpression (Hershey & Olsen, 2007 ) . Instead, we fall back on enforcing\nthe KL constraint between @xmath and @xmath , both isotropic gaussians\nwith the same standard deviation. Let @xmath and @xmath denote their\nrespective mean, and @xmath their standard deviation. In this context,\ntheir KL divergence reduces to:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn other words, the KL divergence is equivalent to the euclidean\ndistance between the distributions\u2019 means. We use this fact to project\n@xmath (in the KL sense) onto @xmath :\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nFinally we report results using our relaxation and the KL reversal\ndescribed in Section 22.2 ( + @xmath ). For each setting, we report the\naverage and robust accuracy with mean and standard deviation over 10\nruns. For the KL constraint and the relaxation, we report the best\nresults among 4 values of the KL bound @xmath and the temperature @xmath\nrespectively.\n\nIn Table 20 , we observe that bare P-DRO is too unstable and\nsystematically diverges. The addition of a KL constraint mitigates this\nbehaviour, but the zero-sum objective is still unstable, as evidenced by\nthe high standard deviations. Finally, we find that the addition of\n@xmath stabilizes the training process greatly, leading to consistently\nhigh robust accuracy.\n\n#### 24 P-DRO in Practice: Case Study of Toxicity Detection\n\nIn this section, we demonstrate the effectiveness of P-DRO in the more\nrealistic setting of toxicity detection, the task of recognizing various\nforms of toxic language (eg. hate speech or offensive language).\nIdentifying online abuse on the internet is a crucial challenge, and has\ngarnered much interest in the NLP community (Schmidt & Wiegand, 2017 ;\nFortuna & Nunes, 2018 ) . However, recent work (Sap et\u00a0al., 2019 ) has\nshown that there is strong correlation between toxic labels and the\npresence of certain markers of dialects of English spoken by minority\ngroups. This correlation is in turn amplified by hate speech classifiers\ntrained on such data, leading to biased prediction.\n\nOur results on BiasedSST suggest that P-DRO can provide one solution to\npreventing models from absorbing spurious correlations present in their\ntraining data, even in the absence of protected attributes (such as\nlanguage variety here).\n\n##### 24.1 Experimental Setting\n\nFollowing Sap et\u00a0al. ( 2019 ) and Xia et\u00a0al. ( 2020 ) , we perform\nexperiments on two datasets: DWMW17 (Davidson et\u00a0al., 2017 ) , a corpus\nof 25K tweets classified in three categories: hate speech ( @xmath ),\noffensive ( @xmath ) and neither ( @xmath ), and FDCL18 (Founta et\u00a0al.,\n2018 ) , a 100k sized dataset, also collected from Twitter and annotated\nwith an additional spam label, with the following breakdown by\ncategories: hateful ( @xmath ), abusive ( @xmath ), normal ( @xmath )\nand spam ( @xmath ).\n\nThe released version of these datasets does not contain information on\nthe dialect of each user. In order to be able to evaluate our models,\nand to train an Oracle DRO baseline, we follow Sap et\u00a0al. ( 2019 ) and\nuse annotations provided by the dialect classifier described in Blodgett\net\u00a0al. ( 2016 ) to label each example as one of four English varieties:\nWhite-aligned, African American, Hispanic, and Other. Note that, as\nthese are automatically obtained labels, the groups may not exactly\ncorrespond to the actual racial sociolects, however Sap et\u00a0al. ( 2019 )\ndoes report that they correlate highly with self-reported race, and they\nserve as a useful proxy in the absence of manual annotation.\n\nWe formulate the group-DRO problem by separating each dataset into\nindependent groups identified by both language variety and label, for a\ntotal of 12 and 16 groups for DWMW17 and FDCL18 respectively. Some of\nthese groups are severely under-represented in the test set. In order to\nmake our robust accuracy results reliable yet still representative of\nthe under-represented groups, we combine groups that contain less than\n100 samples into a single group to compute robust test accuracies.\n\nOn DWMW17 , we train the same BiLSTM model as described in Section 23.6\n. To illustrate the applicability of P-DRO to other model architectures,\nwe pick BERT (Devlin et\u00a0al., 2018 ) , a large scale pre-trained model as\na classifier on FDCL18 . In both cases, we adopt the Transformer\narchitecture described in Section 23.6 as the adversary. We train the\nadversary with a temperature of @xmath and a normalizing window @xmath .\nTo demonstrate the efficacy of automatic hyper-parameter selection in\nthe P-DRO setting, we delegate the choice of the adversary\u2019s learning\nrate @xmath to grid-search, training 3 models with @xmath and selecting\nthe best using the Minmax criterion described in Section 22.4 . We also\nreport numbers for Oracle DRO and Topic DRO. Results are averaged over 5\nruns, each with a different random seed.\n\n##### 24.2 Can P-Dro Produce more Robust Models?\n\nTable 21(a) reports the robust test accuracies of all models on both\ntasks. Importantly, except for Oracle DRO, none of the methods compared\nhere necessitate any knowledge of the groups, neither in the training\nnor validation data. We observe that in both settings P-DRO is able to\nachieve higher robust accuracy than ERM , Topic DRO and NonParam.\n\nThis suggests P-DRO as a useful option in case no group information\nwhatsoever is available. However, in practice, it may be feasible to\nannotate at least a small amount of data with group information. To\nemulate this scenario, we perform the same experiment, but assume that\ngroup annotations are available on the validation data, which we use to\ndetermine optimal stopping and hyper-parameters. Results for this\nsetting are reported in Table 21(b) . We find that, while the use of\nrobust validation accuracy yields more robust models even for ERM\n(especially on FDCL18 ), P-DRO is still the best alternative that\ndoesn\u2019t require group annotation on the training data.\n\n#### 25 Additional Experiments\n\n##### 25.1 Minmax Validation KL Threshold\n\nThe Monte-Carlo estimate of @xmath on the validation set is @xmath .\nSimilarly to Section 22 , we approximate the (unknown) likelihood ratio\n@xmath with @xmath .\n\nWe want to reject all adversaries where this approximated KL is greater\nthan some threshold, @xmath , but how do we choose a good value for\n@xmath ? Consider an adversary which selects a fraction of the\nvalidation data of size @xmath for some @xmath . In such a case, the\nlikelihood ratio is @xmath on this subset and 0 everywhere else, and the\nresulting KL estimate will be @xmath . In other words, choosing a\nthreshold of @xmath means allowing the adversary to potentially select\nany subset of size at least @xmath of the original data. Our heuristic\nchoice, @xmath , corresponds to allowing subsets of size at least @xmath\nof @xmath .\n\nOf course, this is only a heuristic because the adversary can reweight\nthe validation set non-uniformly. To assess the effect of @xmath on\nGreedy-Minmax, we compute the average robust validation error of the\nselected model across 5 runs for 3 different values of the adversary\u2019s\nlearning rate. Results on BiasedSST, depicted in Figure 5 , show that\nadversaries with higher learning rate are more sensitive to the choice\nof threshold, but all values of @xmath between @xmath and @xmath seem to\nwork for these settings.\n\n##### 25.2 P-Dro Experiments with an LSTM Adversary\n\nWe replicate the experiments BiasedSST experiments in Section 23 , but\nthis time using a smaller generative model, which is unlikely to\ngenerate good samples. Specifically, we use a one layer LSTM model\n(Hochreiter & Schmidhuber, 1997 ) with embedding and hidden dimension\n256. We only perform grid-search over @xmath and select the best with\nMinmax.\n\nOnce pre-trained on the BiasedSST dataset, this model achieves a\nperplexity of @xmath , more than 4 times worse than the transformer\nmodel we use in other experiments ( @xmath ). However, as evidenced by\nits robust accuracy displayed in Table 22 , P-DRO is still able to learn\na robust model. We take this as evidence that the re-weighting\nintroduced in Section 22 helps stabilize training even when @xmath is\nnot a perfect model of the data.\n\n##### 25.3 Influence of hyper-parameters on P-Dro\n\nWe study the influence of the 3 hyper-parameters @xmath (temperature),\n@xmath (size of the renormalization window) and @xmath (learning rate of\nthe adversary) on the performance of P-DRO . All experiments are run on\nthe BiasedSST dataset, and the analysis proceeds as follows: we start\nfrom configuration @xmath , @xmath and @xmath and vary each of the\nhyper-parameters independently. We report two numbers for each\nconfiguration: robust accuracy of the best model (1) using Greedy-Minmax\nstopping and (2) using Oracle stopping. The latter is useful to\ndisentangle the effect of the stopping criterion.\n\nAs seen in the results shown in Table 23 , we find that @xmath has the\nleast effect on robust accuracies. While the renormalization window\nparameter @xmath has some effect on optimal stopping, the best robust\naccuracy achieved by the model (with oracle stopping) varies little. We\nobserve the adversary\u2019s learning rate @xmath to be the most sensitive\nhyper-parameter, which is why we restrict our grid-search to @xmath in\nSection 24 .\n\n#### 26 Conclusion\n\nIn this chapter, we have shown that there is promise in using parametric\nfamilies of neural generative models for defining the uncertainty set in\ndistributionally robust optimization. While we only perform experiments\non NLP tasks, this approach can, in theory, be applied in any modality.\nHowever, the reliance of P-DRO on good quality generative models limits\nits adoption in applications where good quality generative models are\nunavailable, or when such model cannot produce exact densities\nefficiently. In the following chapter, we will address these issues by\nparameterizing the likelihood ratio @xmath directly, an alternative\nformulation which poses different implementation challenges.\n\n### Chapter \\thechapter Distributionally Robust Models with Parametric\nLikelihood Ratios\n\nIn chapter II we proposed P-DRO , a promising approach where the\nuncertainty set is defined by a parametric family of generative models,\nwhich allows for more flexibility in defining the uncertainty set.\nDespite P-DRO \u2019s demonstrated ability to train models that are robust to\ndistributional shift, it suffers from several drawbacks: first, it\nnecessitates training an auxiliary generative model of the data. This\ncan be difficult for several reasons. First, this limits the\napplicability of the method to domains with generative models that allow\nfor exact probability computations. Moreover, even when such generative\nmodels are available, they are often more computationally demanding than\ntheir discriminative counterparts. In language models for instance,\nprobabilities for sequences of text are obtained by iteratively\nproducing conditional probabilities over all tokens in the vocabulary.\nThis additional step results in considerable computational overhead\ncompared to discriminative models. Second, it is challenging to use in\npractice due to its reliance on a number of hyperparameters and\napproximations to the objective function.\n\nIn this chapter, we propose a new approach for DRO , called R-PDRO,\nbased on a key modification of the P-DRO algorithm: instead of modeling\nthe worst-case distributions directly, we parametrize the likelihood\nratio between the training distribution and the worst-case distribution.\nThis removes the dependency on an unwieldy generative model, making the\nmethod useful for more applications. While likelihood-ratio formulations\nof DRO have been tried in prior work (Sagawa et\u00a0al., 2020 ) , we show\nthat they are particularly effective for parametric, neural-network\nbased adversaries. Our approach relies on two simple ideas: a mini-batch\nlevel normalization strategy to enforce likelihood ratio constraints and\na KL divergence penalty to limit the scope of the uncertainty set.\nR-PDRO consistently achieves equal or better robust sub-population\naccuracy compared to P-DRO and other baselines on a variety of standard\nbenchmarks in image and text classification. In addition, we find it is\nboth faster than P-DRO and depends on fewer hyper-parameters. Additional\nablation and analysis experiments demonstrate that our minibatch\nnormalization strategy is necessary for high performance, and that the\nparametric adversaries enabled by R-PDRO are substantially more\nresistant to label noise compared to traditional non-parametric\napproaches to DRO.\n\n#### 27 Parametric Likelihood Ratio\n\n##### 27.1 DRO as a Likelihood Ratio Optimization Problem\n\nIn the situation that all distributions in @xmath are absolutely\ncontinuous with respect to @xmath (i.e. for all @xmath , @xmath only if\n@xmath ) the inner maximum in Equation 3 can be rewritten purely as a\nfunction of the likelihood ratio @xmath\n\n  -- -------- -- ------\n     @xmath      (23)\n  -- -------- -- ------\n\nSuch absolute continuity assumptions are standard in @xmath -divergence\nand group DRO methods, which both rely upon re-weighting the training\ndistributions. In fact, the KL divergence constraint in P-DRO\npresupposes absolute continuity.\n\nThis suggests that the inner maximum can be re-written as an\noptimization problem on functions @xmath within the uncertainty set\n@xmath\n\n  -- -------- -- ------\n     @xmath      (24)\n  -- -------- -- ------\n\nThis reparametrization of the problem will allow us to replace the\nparametric family of generative models with a parametric family over\nprobability ratios.\n\n##### 27.2 Ratio-based P-Dro\n\nThe likelihood-ratio formulation described above is appealing for P-DRO\nbecause it enables the use of discriminative style neural architectures\nfor parameterizing the ratio @xmath , which opens up many more options\nfor defining the parametric uncertainty set. Specifically, we can set\nthe adversary to be any parametric function @xmath verifying @xmath .\nThe key insight that we use to realize our proposed method is that we do\nnot need to limit the choice of adversaries to those that implicitly\nsatisfy this normalization condition ( i.e. generative models). Instead,\nwe can pick any adversary and treat normalization as an additional\nconstraint (the \u201cnormalization constraint\u201d).\n\nNote that in this case, the KL constraint takes the simple form @xmath .\nThe final min-max problem, which we dub ratio-based P-DRO (R-PDRO), is\nas follows:\n\n  -- -------- -- ------\n     @xmath      (25)\n  -- -------- -- ------\n\nAs in P-DRO , we can look for equilibria of this differentiable min-max\ngame by performing simultaneous gradient updates (Singh et\u00a0al., 2000 )\nto @xmath and @xmath in directions @xmath and @xmath respectively.\nAlthough finding global equilibria is not guaranteed in high dimensional\nnon-convex settings (Balduzzi et\u00a0al., 2018 ) , empirical evidence from\nChapter II suggests that models trained in this manner still reach\nuseful solutions.\n\nIn experiments, we adopt an exponential parameterization @xmath where\n@xmath is the output of any parametric model with values in @xmath .\nSimilarly to P-DRO , we do not explicitly enforce the KL constraint (due\nto the difficulty of projecting onto the KL ball), and instead relax it\nin the form of a KL term @xmath added to the loss function. The\nregularization strength @xmath is treated as a hyper-parameter.\n\n##### 27.3 Enforcing the normalization constraint\n\nIn addition to the KL constraint, R-PDRO necessitates that @xmath\nsatisfies a normalization constraint @xmath to ensure that @xmath is a\nproper probability distribution over @xmath . If that were not the case,\nthe adversary @xmath could artificially increase the weighted\nexpectation @xmath by assigning a total weight greater than 1 to the\nentire dataset.\n\nExisting methods for ratio based DRO such as Sagawa et\u00a0al. ( 2020 )\nachieve this by either projecting @xmath onto the simplex @xmath after\neach gradient update on @xmath , or by directly parametrizing the ratio\nas @xmath . Unfortunately, these solutions are computationally\ninfeasible in practical scenarios with large datasets. Indeed, they\nnecessitate computing the entire expectation over @xmath , which can be\ncostly when each @xmath is the output of a neural model.\n\nWe propose two simple, yet effective solutions for addressing this issue\nin the context of minibatch training where we can only compute @xmath\nfor small number of samples @xmath at each step of training.\n\n###### Self-normalization\n\nis inspired by the idea of \u201cself-normalization\u201d developed for globally\nnormalized structured prediction models (Andreas et\u00a0al., 2015 ; Goyal\net\u00a0al., 2019 ) . It consists in adding a relaxation of the normalization\nconstraint to the objective. Specifically, following Goyal et\u00a0al. ( 2019\n) we add a squared penalty on the log normalizer at the minibatch level.\nIgnoring the KL penalty, this regularized objective takes the following\nform:\n\n  -- -------- -- ------\n     @xmath      (26)\n  -- -------- -- ------\n\nThe hyper-parameter @xmath controls the regularization strength.\nIntuitively, this penalizes adversary that assign too much (or too\nlittle) total weight to the minibatch. However, the choice of an optimal\n@xmath adds an additional degree of freedom to R-PDRO, which suggests\nour second option as a simpler alternative.\n\n###### Batch-level normalization\n\nconsists of using the normalized ratio at the minibatch level by setting\n\n  -- -------- -- ------\n     @xmath      (27)\n  -- -------- -- ------\n\nfor each sample @xmath in the minibatch. An obvious downside of this\napproach is that the weight of each sample now depends on the minibatch\nit was sampled from. This can be problematic for small batch sizes: as\nan extreme example, for a batch size of 1, this normalization scheme\nassigns the same weight of 1 to every sample, making the objective\nequivalent to ERM.\n\nHowever, minibatch approximations have proven effective for other forms\nof DRO (Hu et\u00a0al., 2018 ; Levy et\u00a0al., 2020 ) and there is some evidence\nthat they can yield accurate estimates for higher batch sizes (Cortes\net\u00a0al., 2010 ) . In practice we find that this approach yields good\nresults for commonly used batch sizes, is generally more stable than the\nself-normalization penalty, and does not introduce any additional\nhyper-parameters. In most of our experiments, we adopt this approach\nunless specified otherwise. In that case, the R-PDRO objective on a\nminibatch becomes\n\n  -- -------- -- ------\n     @xmath      (28)\n  -- -------- -- ------\n\nThe KL term serves to penalize ratios that deviate too much from @xmath\n. \u2075\u2075 \u2075\u2075 55 Note that the penalty is subtracted because we are maximizing\nwith respect to @xmath The only hyper-parameter that needs to be tuned\nis the KL regularization strength @xmath .\n\n#### 28 Experiments\n\n##### 28.1 Datasets\n\nWe perform experiments on four datasets: two text classification\ndatasets used in chapter II , Biased SST and FDCL18 and two image\nclassification datasets from Sagawa et\u00a0al. ( 2020 ) , Waterbirds and\nCelebA. Specific details for each dataset follow these previous works,\nas described below:\n\n###### Biased SST\n\nis based on the SST-2 sentiment classification dataset (Radford et\u00a0al.,\n2018 ) , but modified to introduce spurious correlation between a\ndistractor token (\u201cSo,\u201d) and positive labels in around 95% of the\ndataset. In this setting models trained with ERM can very easily learn\nthis spurious correlation, which hurts performance on the small\nsub-population that doesn\u2019t suffer from this bias.\n\n###### Fdcl18\n\nA toxicity detection dataset of tweets labeled as hateful ( @xmath ),\nabusive ( @xmath ), normal ( @xmath ) and spam ( @xmath ). The group-\nDRO problem is formulated by partitioning the evaluation data along\nlabels as dialectal annotation obtained automatically with an off-the\nshelf classifier (Blodgett et\u00a0al., 2016 ; Sap et\u00a0al., 2019 ) . In\nparticular these dialects align closely with self-reported race, and Sap\net\u00a0al. ( 2019 ) found that machine learning models trained on such\ntoxicity detection datasets tend to exhibit bias towards certain labels\ndepending on the demographics of the tweets\u2019 authors, particularly with\nminorities. In order to report more reliable accuracy numbers, all\ngroups containing less than 100 samples are aggregated when computing\ntest accuracies.\n\n###### Waterbirds\n\nAn image classification dataset where the task is to predict \u201cland bird\u201d\nor \u201cwater bird\u201d with the confounding factor of the background; most\nwater (resp. land) bird pictures have water (resp. land) on the\nbackground.\n\n###### CelebA\n\nA popular face recognition dataset originally published by Liu et\u00a0al. (\n2015 ) . The group- DRO problem is formulated as a task of predicting\nthe hair color (\u201cBlond\u201d or \u201cDark\u201d) across groups formed by the\ncombination of the label and the (binary) gender of the subject. Due to\nthe spurious correlation between blond hair\/female and dark hair\/male,\nmodels trained with ERM tend to achieve lower accuracies on\nunderrepresented groups such as \u201cblond-haired male\u201d which totals only\n0.85% of the training data.\n\n##### 28.2 Experimental Setting\n\nOn BiasedSST and FDCL18 we follow the experimental setting of chapter II\nand train a BiLSTM and BERT-base model Devlin et\u00a0al. ( 2018 )\nrespectively. On the image classification datasets we train Resnet-50\narchitectures (He et\u00a0al., 2016 ) pre-trained on ImageNet (Deng et\u00a0al.,\n2009 ) as in Sagawa et\u00a0al. ( 2020 ) .\n\nSince the adversary in R-PDRO can be any discriminative architecture, we\nopt for the natural solution of using a similar architecture for this\nmodel. For instance on Biased SST, we take @xmath as the raw logit\noutput by a BiLSTM architecture identical to that of the classifier\n(without the final softmax layer). We do the same for the other\ndatasets, with the exception of FDCL18 where we use a smaller\nDistillBERT model (Sanh et\u00a0al., 2019 ) for efficiency. We use the same\nlearning rate and optimizer for both model and adversary and only vary\nthe KL penalty weight @xmath . We perform optimal stopping using the\nMinmax criterion proposed in chapter II : every epoch @xmath , we\ndetermine the best model by explicitly solving a greedy approximation of\nthe min-max game between all previously checkpointed adversaries and\nmodels on the validation dataset @xmath .\n\n  -- -------- -- ------\n     @xmath      (29)\n  -- -------- -- ------\n\nA similar strategy is applied for hyper-parameter selection.\nImportantly, we substitute the 0-1 loss for @xmath in Equation 29 as we\nfound in preliminary experiments on BiasedSST that it consistently\nproduced better results.\n\nWe compare our results to 5 different methods experimented with in\nchapter II :\n\n-    ERM : standard training to minimize the average loss.\n\n-    NonParam : Non-parametric DRO with a KL constrained uncertainty set\n    (Hu & Hong, 2013 ; Hu et\u00a0al., 2018 ) . In this particular case, the\n    inner maximization problem has an analytical solution of the form\n    @xmath where @xmath is chosen so that the KL divergence with the\n    training distribution is smaller than a pre-defined bound @xmath .\n    As a result, examples with high losses are up-weighted.\n\n-    Topic-DRO : a variation on Topic CVaR (Oren et\u00a0al., 2019 ) using\n    the online algorithm from Sagawa et\u00a0al. ( 2020 ) to minimize the\n    worst case loss on a collection of pseudo domains automatically\n    generated via topic modeling. \u2075\u2076 \u2075\u2076 56 This baseline was\n    inaccurately referred to as \u201cTopic CVaR\u201d in chapter II We use this\n    baseline for the text datasets only (Biased SST and FDCL18 ).\n\n-    P-DRO : the parametric DRO approach proposed in chapter II . For\n    image datasets, preliminary experiments using auto-regressive models\n    for image modeling (Van\u00a0Oord et\u00a0al., 2016 ) proved to be\n    prohibitively slow. Therefore, we only report P-DRO on text datasets\n    as in chapter II .\n\n-    Oracle DRO : an online algorithm for minimizing the worst-case loss\n    on the true uncertainty set (Sagawa et\u00a0al., 2020 ) . Contrary to all\n    other methods, Oracle DRO presupposes that we know the groups of\n    interest at training time. As such, it is not directly comparable\n    and serves to provide an upper bound of the robust accuracy that can\n    be achieved.\n\nAcross all experiments, we report results with mean and standard\ndeviation across 5 reruns with different seeds.\n\n###### 28.2.1 Dataset-specific Hyper-parameters\n\nAll hyper-parameters listed below are constant across all methods:\n\n###### Text Datasets\n\nThe input data is tokenized using the bert-base-uncased sub-word\ntokenizer from Devlin et\u00a0al. ( 2018 ) . We train both classifier and\nadversary with Adam (Kingma & Ba, 2014 ) using a learning rate of @xmath\n, linearly decay the learning rate to 0 at each step. We train with\nbatches of size 64 (or containing up to 2500 tokens, whichever is lower)\nfor 50 and 20 epochs for BiasedSST and FDCL18 respectively, evaluating\nmodel on the validation data every epoch.\n\n###### Image Datasets\n\nOn both datasets, images are rescaled to @xmath pixels and pixel values\nare normalized to have mean 0 and variance 1 across all 3 color channels\non the training data. At training time, we augment the data by randomly\ncropping or flipping the images horizontally. We train using regular\nstochastic gradient descent using a constant learning rate of @xmath and\na batch size of 32. We train for 75 and 13 epochs on Waterbirds and\nCelebA respectively (those numbers were chosen to match the number of\nsteps trained to Sagawa et\u00a0al. ( 2020 ) despite the smaller batch size),\nand validate every 100 (for Waterbirds) and 1000 (for CelebA) training\nsteps.\n\n###### 28.2.2 Method Specific Hyper-parameters\n\nFor NonParam we follow the adaptation of Hu et\u00a0al. ( 2018 ) used in\nchapter II and choose the optimal temperature @xmath based on minibatch\nlevel estimates of the KL divergence. We treat the KL bound @xmath as a\nhyper-parameter. We adapt the Minmax stopping criterion of P-DRO to the\nnon-parametric adversaries as we found it yielded more robust models\nthan those selected with average validation accuracy. We sweep over\n@xmath\n\nFor R-PDRO we perform optimal stopping using the Minmax criterion with a\nKL threshold of @xmath in all experiments, to match the value\nrecommended for P-DRO . Specifically, we estimate the KL divergence of\ncheckpointed adversaries @xmath on the validation data as follows:\n\n  -- -------- -- ------\n     @xmath      (30)\n  -- -------- -- ------\n\nand reject adversaries for which this quantity exceeds @xmath .\n\n##### 28.3 Results\n\nFor all methods, we report the worst accuracy over all groups in the\ntest set (the \u201crobust accuracy\u201d). Models that are robust to\nsub-population shift will have higher robust accuracies. Since there is\noften a trade-off between being robust to distribution shift and\nperforming well on the training distribution, we also report the\nstandard accuracy on the original test set (the \u201caverage accuracy\u201d)\n\nAs shown in Table 24 , R-PDRO works particularly well on the two text\nclassification tasks, beating all baselines by a large margin on both\nBiasedSST and FDCL18 . In fact, its robust accuracy almost matches that\nof Oracle DRO on FDCL18 , despite the fact that the former doesn\u2019t use\nan any group information at training time. Compared to P-DRO , we find\nthat results are not only better, but also more consistent as evidenced\nby the lower standard deviation.\n\nResults are also generally good on image datasets (see Table 25 ). On\nWaterbirds both the NonParam baseline and R-PDRO perform much better\nthan ERM, with a slight edge for R-PDRO (although the latter exhibits a\nhigher variance across reruns). On CelebA, R-PDRO largely outperforms\nthe baselines.\n\n#### 29 Analysis and Ablations\n\nWe perform a series of analysis experiments and ablation studies to\nbetter (1) identify how the parametric representation of the ratio\nprovides improvements over non-parametric alternatives and (2)\nunderstand the importance of the various choices made with regards to\nthe renormalization scheme described in Section 27 . Throughout this\nsection, experiments are performed on the BiasedSST dataset.\n\n##### 29.1 Why are Parametric Adversaries Better? The Case of Label\nNoise\n\nOur experimental results in Section 28 shows that parametric approaches\nsuch as P-DRO and R-PDRO consistently outperform their non-parametric\ncounterparts. A possible explanation for this phenomenon is that for\nnon-parametric approaches, the optimal weights generally only depends on\nthe loss of the model. This can be problematic because the\nnon-parametric worst-case distribution will indiscriminately up-weight\nnoisy samples that have high loss. On the other hand, we hypothesize\nthat it is more difficult for the parametric adversary to \u201cfit to the\nnoise\u201d and that it tends to focus more on systematic patterns of\nfailures of the model.\n\nTo corroborate this hypothesis, we perform experiments by adding\nincreasing amounts of noise to the Biased SST. Specifically, for each\nexample in the training set we replace the original label with a random\nlabel with probability @xmath . \u2075\u2077 \u2075\u2077 57 @xmath corresponds to the\noriginal dataset. We then train models on these increasingly noisy\ndatasets using both a parametric (R-PDRO) and non-parametric (NonParam)\napproach. To simplify experiments we only run one hyper-parameter\nconfiguration for each ( @xmath and @xmath for R-PDRO and NonParam\nrespectively) and report the test accuracies of the model with the\nhighest robust accuracy on the validation set. Results are averaged over\n5 runs with different random seeds.\n\nAs showcased in Figure 6 , while R-PDRO\u2019s robust accuracy seems to\nsuffer under the effect of noise, we find that its average accuracy is a\nlot more resilient to the introduction of label noise compared to\nNonParam, losing around @xmath points when @xmath ( @xmath ), versus\n@xmath for NonParam ( @xmath ). This further supports our hypothesis\nthat non-parametric adversaries tend to fit to these noisy examples,\nwhich decreases the overall quality of the resulting classifier.\n\n##### 29.2 Optimization with Simultaneous Gradient Updates Plays a\nCrucial Role\n\nDespite the aforementionned results, it remains unclear why R-PDRO\nlearns re-weightings that are less sensitive to label noise or difficult\nexamples compared to R-PDRO. Indeed, since the non-parametric adversary\nis the optimal solution of the inner minimization problem in Eq. 24 , it\nstands to reason that (large, sometimes over-parameterized) parametric\nadversaries from R-PDRO would converge to the same solutions as\nNonParam.\n\nOur hypothesis is that the simultaneous updates to both model and\nadversary parameters prevent the parametric adversary from converging\ntowards such non-parametric solutions, and provides some implicit\nregularization against up-weighting examples that are noisy or too\ndifficult.\n\nTo verify this hypothesis, we conduct a toy experiment where we allow\nthe adversary to take additional gradient steps in-between each update\nto the classifier. At the limit, this would allow the adversary to find\nan optimum of the inner maximization problem at each step of training\nthe classifier (which for large enough adversaries, might come close to\nthe non-parametric solution).\n\nFor computational efficiency, these experiments are performed on the toy\nsetting described in Chapter II , Section 23.7 : a linear model is\ntrained on a binary classification problem with two domains, one of\nwhich is severely under-represented. For our adversary, we experiment\nwith a linear adversary, as well as larger multilayer perceptrons with\none hidden layer and 2 (MLP-2) and 4 (MLP-4) hidden units. In Figure 7 ,\nwe report the average robust accuracy (across 5 reruns) for classifiers\ntrained with R-PDRO when the adversary is allowed to take more steps\nthan the classifier.\n\nWe observe that R-PDRO\u2019s robust accuracy suffers from giving the\nadversary too much time to catch up with the classifier: as the number\nof updates to the adversary increases, robust accuracy decreases. This\neffect is amplified in larger adversaries ( e.g. MLP-4).\n\nThis experiment underlines the importance of the simultaneous gradient\nupdates, which prevent large, over-parameterized adversaries from\nconverging to the sub-optimal non-parametric solution.\n\n##### 29.3 Batch-level Normalization vs Self-normalization\n\nIn Section 27.3 , we discussed two alternatives for enforcing the\nnormalization constraint on the ratios ( @xmath ): a\nregularization-based approach (\u201cself-normalization\u201d) and batch level\nrenormalization. In Figure 7(a) , we show the effect of\nself-normalization with different values of the regularization weight\n@xmath for a fixed value of the KL penalty @xmath . We find that\nbatch-level normalization achieves a slightly better robust accuracy\nthan the best self-normalization configuration.\n\nIn chapter II , the Minmax stopping criterion was identified as a major\ncontributing factor to the performance of parametric DRO approaches. To\nunderstand how it affects each normalization strategy, we perform the\nsame experiment as above but this time without the Minmax criterion,\nselecting instead the model with the highest robust accuracy on the\nvalidation set (\u201cOracle stopping\u201d), which provides an upper bound to the\nrobust accuracy that can be achieved. Results in Figure 7(b) show that\nalthough accuracies are generally closer, we again find that batch-level\nnormalization matches the best self-normalization penalty. This\nindicates that batch-level normalization not only performs as well as\nself-normalization (without the need for tuning the additional\nhyper-parameter @xmath ), but also that it interacts better with the\nMinmax stopping criterion, making it a preferable alternative overall.\n\n##### 29.4 Effect of Batch Size on Re-normalization\n\nAs pointed out in Section 27.3 , a potential downside of the\nminibatch-level normalization approach is that the effective weight of\neach sample then depends on the other samples within the minibatch. For\nexample, consider an adversary that assigns high weight to only 5% of\nthe training data. With a small enough batch size, it is likely that\nsome batches may not contain any example of the high weight\nsubpopulation, in which case minibatch level renormalization will\noverestimate the weight of the sample in the minibatch.\n\nTo assess the severity of this issue, we run R-PDRO on Biased SST with\n@xmath and vary the batch size in @xmath . Each configuration is run 3\ntimes, and we report average and standard deviation of the robust and\naverage test accuracies in Table 26 . Results suggest that while robust\naccuracy indeed deteriorates for lower batch sizes (4 and 8), results\nare consistently good for batch sizes upwards of 16, a reasonable number\nconsidering that larger batch sizes are often preferred in the\nliterature (Popel & Bojar, 2018 ; Goyal et\u00a0al., 2017 ) .\n\n#### 30 Conclusion\n\nIn this chapter we have proposed a parametric, likelihood ratio based\napproach to distributionally robust optimization of machine learning\nmodels. With the proposed method, we can use any type of parametric\nfunction estimator to define the uncertainty set of the DRO min-max\ngame. We showed that with a careful renormalization strategy, the\nproposed method (R-PDRO) can be used to train robust models. It depends\non very few hyper-parameters and consistently performs well on a number\nof benchmarks, making it an appealing off-the-shelf option. Finally we\nhave shown that such parametric approaches are more resilient to the\npresence of noise in the training data when compared to their\nnon-parametric alternatives.\n\nThe main downside of R-PDRO is the computational overhead of jointly\ntraining a second neural model. An interesting direction for future work\nis to improve its efficiency through parallel computation or by sharing\nparameters between the classifier and the adversary.\n\n## Part III Adaptation\n\n### Chapter \\thechapter Regularizing Trajectories to Mitigate\nCatastrophic Forgetting \\chaptermark\n\nRegularizing Trajectories\n\n  It is good to have an end to journey toward; but it is the journey\n  that matters, in the end.\n\n  Ursula K. Le Guin\n\n#### 31 Introduction\n\nThe methods presented in previous chapters are able to train models that\nare more robust to distributional shifts because they can identify\nsub-population of the training data corresponding to potential domains\nwhere the model performs poorly. However, there are cases where the\nmodel might be confronted with a completely unseen test distribution, or\neven with a new task. In such cases where the test environment cannot be\nanticipated, an alternative solution is to adapt the model, using the\nlimited amounts of data that are available in the target domain or task.\n\nHowever, continual learning of multiple tasks is hampered by\ncatastrophic forgetting (McCloskey & Cohen, 1989 ; Ratcliff, 1990 ) ,\nthe tendency of previously acquired knowledge to be overwritten when\nlearning a new task.\n\nModern techniques to mitigate catastrophic forgetting can be roughly\ncategorized into 3 lines of work (see Parisi et\u00a0al. ( 2019 ) for a\ncomprehensive overview): 1.\u00a0regularization-based approaches, where\nforgetting is mitigated by the addition of a penalty term in the\nlearning objective ( Kirkpatrick et\u00a0al. ( 2017 ); Chaudhry et\u00a0al. (\n2018a ) , inter alia ), 2.\u00a0dynamic architectures approaches, which\nincrementally increase the model\u2019s capacity to accomodate the new tasks\n(Rusu et\u00a0al., 2016 ) , and 3.\u00a0memory-based approaches, which retain data\nfrom learned tasks for later reuse (Lopez-Paz & Ranzato, 2017 ; Chaudhry\net\u00a0al., 2018b , 2019 ) . Among these, regularization-based approaches\nare particularly appealing because they do not increase the model size\nand do not require access to past data. This is particularly relevant to\nreal-world scenarios where keeping data from previous training tasks may\nbe impractical because of infrastructural or privacy-related reasons.\nMoreover, they are of independent intellectual interest because of their\nbiological inspiration rooted in the idea of synaptic consolidation\n(Kirkpatrick et\u00a0al., 2017 ) .\n\nIn these regularization-based approaches, a good regularizer will ensure\nthat, when learning a new task, gradient descent will ultimately\nconverge to parameters that yield good results on the new task while\npreserving performance on previously learned tasks. Critically, this is\npredicated upon successful optimization of the regularized objective, a\nfact that has been largely taken for granted in previous work.\nNon-convexity of the loss function, along with noise in the data (due to\nsmall or biased datasets) or in the gradients (due to stochastic\ngradient descent), can yield optimization trajectories \u2014 and ultimately\nconvergence points \u2014 that are highly non-deterministic, even for the\nsame starting parameters. As we demonstrate in this chapter, this can\ncause unintended catastrophic forgetting along the optimization path.\nThis is illustrated in a toy setting in Figure 9 : a two parameter model\nis trained to perform task @xmath (an arbitrary bi-modal loss function)\nafter having learned task @xmath (a logistic regression task). Standard\nfinetuning, even in the presence of a regularized objective (EWC;\nKirkpatrick et\u00a0al. ( 2017 ) ), quickly changes the loss of @xmath and\ntends to converge to a solution with high @xmath loss.\n\nWe propose to remedy this issue by regularizing not the objective\nfunction but the optimization trajectory itself , specifically by\npreconditioning gradient descent with the empirical Fisher information\nof previously learned tasks (\u00a7 33 ). This yields what we refer to as a\nco-natural gradient, an update rule inspired by the natural gradient\n(Amari, 1997 ) , but taking the Fisher information of previous tasks as\na natural Riemannian metric \u2075\u2078 \u2075\u2078 58 Informally, the reader can think of\na Riemannian metric as a function that assigns an inner product @xmath\nto each point @xmath in the space, thus inducing a localized notion of\ndistance and curvature. of the parameter space, instead of the Fisher\ninformation of the task being optimized for. When we introduce our\nproposed co-natural gradient for the toy example of Figure 9 , the\nlearning trajectory follows a path that changes the loss on @xmath much\nmore slowly, and tends to converges to the optimum that incurs the\nlowest performance degradation on @xmath .\n\nWe test the validity of our approach in a continual learning scenario (\u00a7\n34 ). We show that the co-natural gradient consistently reduces\nforgetting in a variety of existing continual learning approaches by a\nlarge factor, and greatly improves performance over simple finetuning,\nwithout modification to the training objective. As an additional\ncontribution, we assemble a new collection of 13 tasks for evaluating\ncontinual learning on text classification.\n\nWe further investigate the special case of transfer learning in a\ntwo-task, low-resource scenario. In this specific case, control over the\noptimization trajectory is particularly useful because the optimizer has\nto rely on early stopping to prevent overfitting to the meager amount of\ntraining data in the target task. We show that the co-natural gradient\nyields the best trade-offs between source and target domain performance\nover a variety of hyper-parameters (\u00a7 36 ).\n\nThe work presented in this chapter bears many similarities to previous\nrelated works on Bayesian formulations of continual learning which used\nsimilar inverse-Fisher conditioning to reduce forgetting: NVCL (Tseran\net\u00a0al., 2018 ) and GNG (Chen et\u00a0al., 2018 ) . However, we our work makes\nsignificant contributions over these previous approaches\n\nFirst, these prior works were developed in the framework of Bayesian\ncontinual learning. While the central idea of using the Fisher to\nmodulate the update is similar, we adopt a broader approach and\nsuccessfully apply this technique to a variety of other techniques\noutside the Bayesian scaffolding. Second, we introduce a damping\ncoefficient, which allows control over the regularization effect of the\nco-natural gradient, as evidenced by our analysis in Appendix A.4\nspecifically, and more generally by the results in Section 4 and 5,\nwhere our results are obtained by performing grid-search over this\nadditional hyper-parameter. Third, we provide empirical evidence of the\nco-natural gradients\u2019 effectiveness in a variety of experimental\nsettings from relatively small, toy-like models and datasets ( e.g.\nSplit CIFAR or Omniglot) to more realistic scenarios ( e.g.\nMiniImageNet, BERT on text classification and our MT experiments). In\ncomparison, the aforementioned previous work only test small 2 layers\nMLP models on MNIST and FashionMNIST. We believe that this establishes\nour work as a strong, independent contribution.\n\n#### 32 Background and Notations\n\nWe first give a brief overview of the continual learning paradigm and\nexisting approaches for overcoming catastrophic forgetting.\n\n##### 32.1 Notation\n\nLet us define a task as a triplet containing an input space @xmath and\nan output space @xmath , both measurable spaces, as well as a\ndistribution @xmath over @xmath . In general, learning a task will\nconsist of training a model to approximate the conditional distribution\n@xmath induced by @xmath .\n\nConsider a probabilistic model @xmath parametrized by @xmath where\n@xmath is the size of the model, trained to perform a source task @xmath\nto some level of performance, yielding parameters @xmath . In the most\nsimple instance of continual learning, we are tasked with learning a\nsecond target task @xmath . In general in a multitask setting, it is not\nthe case that the input or output spaces are the same. The discrepancy\nbetween input\/output space can be addressed in various ways, e.g. by\nadding a minimal number of task-specific parameters (for example,\ndifferent softmax layers for different label sets). To simplify\nexposition, we set these more specific considerations aside for now, and\nassume that @xmath and @xmath .\n\nAt any given point during training for task @xmath , our objective will\nbe to minimize the loss function @xmath \u2013 generally the expected\nnegative log-likelihood @xmath . Typically, this will be performed by\niteratively adding incremental update vectors @xmath to the parameters\n@xmath .\n\n##### 32.2 Existing Approaches for Continual Learning\n\nIn this chapter, we focus on those models that have a fixed architecture\nover the course of continual learning. The study of continual learning\nfor models of fixed capacity can be split into two distinct (but often\noverlapping) streams of work:\n\nRegularization-based approaches introduce a penalty in the loss function\n@xmath , often quadratic, pulling the weights @xmath back towards @xmath\n:\n\n  -- -------- -- ------\n     @xmath      (31)\n  -- -------- -- ------\n\nwhere @xmath is a matrix, generally diagonal, that encodes the\nrespective importance of each parameter with respect to task @xmath ,\nand @xmath is a regularization strength hyper-parameter. Various choices\nhave been proposed for @xmath ; the diagonal empirical Fisher\ninformation matrix (Kirkpatrick et\u00a0al., 2017 ) , or path-integral based\nimportance measures (Zenke et\u00a0al., 2017 ; Chaudhry et\u00a0al., 2018a ) .\nMore elaborate regularizers have been proposed based on e.g. a Bayesian\nformulation of continual learning (Nguyen et\u00a0al., 2017 ; Ahn et\u00a0al.,\n2019 ) or a distillation term (Li & Hoiem, 2016 ; Dhar et\u00a0al., 2019 ) .\nThe main advantage of these approaches is that they do not rely on\nhaving access to training data of previous tasks.\n\nMemory-based approaches store data from previously seen tasks for re-use\nin continual learning, either as a form of constraint, by e.g. ensuring\nthat training on the new task doesn\u2019t increase the loss on previous\ntasks (Lopez-Paz & Ranzato, 2017 ; Chaudhry et\u00a0al., 2018b ) , or for\nreplay i.e. by retraining on instances from previous tasks (Rebuffi\net\u00a0al., 2017 ; Chaudhry et\u00a0al., 2019 ; Aljundi et\u00a0al., 2019b , a ) .\nVarious techniques have been proposed for the selection of samples to\nstore in the memory (Chaudhry et\u00a0al., 2019 ; Aljundi et\u00a0al., 2019b ) or\nfor retrieval of the samples to be used for replay Aljundi et\u00a0al. (\n2019a ) .\n\nAll of these methods rely on stochastic gradient descent to optimize\ntheir regularized objective or to perform experience replay, with the\nnotable exception of GEM (Lopez-Paz & Ranzato, 2017 ; Chaudhry et\u00a0al.,\n2018b ) , where the gradients are projected onto the orthogonal\ncomplement of previous task\u2019s gradients. However, this method has been\nshown to perform poorly in comparison with simple replay (Chaudhry\net\u00a0al., 2019 ) , and it still necessitates access to data from previous\ntasks.\n\n#### 33 Regularizing the Trajectory\n\nAfter briefly recalling how the usual update is obtained in gradient\ndescent, we derive a new, co-natural update designed to better preserve\nthe distribution induced by the model over previous tasks.\n\n##### 33.1 Warm up: the Standard Gradient Descent Update\n\nAt point @xmath in the parameter space, gradient descent finds the\noptimal update @xmath that is (1) small and (2) locally minimizes the\ndifference in loss @xmath ( @xmath at the first order). Traditionally\nthis can be formulated as minimizing the Lagrangian:\n\n  -- -------- -- ------\n     @xmath      (32)\n  -- -------- -- ------\n\nwith Lagrangian multiplier @xmath . Minimizing @xmath for @xmath yields\nthe well-known optimal update @xmath :\n\n  -- -------- -- ------\n     @xmath      (33)\n  -- -------- -- ------\n\nwhere @xmath corresponds to the learning rate (see Appendix Appendix for\nthe full derivation).\n\n##### 33.2 KL Regularization of Trajectories\n\nThe @xmath term in @xmath implicitly expresses the underlying assumption\nthat the best measure of distance between parameters @xmath and @xmath\nis the Euclidean distance. In a continual learning setting however, the\nquantity we are most interested in preserving is the probability\ndistribution that @xmath models on the source task @xmath :\n\n  -- -------- -- ------\n     @xmath      (34)\n  -- -------- -- ------\n\nTherefore, a more natural distance between @xmath and @xmath is the\nKullback-Leibler divergence @xmath (Kullback & Leibler, 1951 ) . For\npreventing catastrophic forgetting along the optimization path, we\nincorporate incorporate this KL term into the Lagrangian @xmath itself:\n\n  -- -------- -- ------\n     @xmath      (35)\n  -- -------- -- ------\n\nDoing so means that the optimization trajectory will tend to follow the\ndirection that changes the distribution of the model the least. Notably,\nthis is not a function of the previous objective @xmath , so knowledge\nof the original training objective is not necessary during continual\nlearning (which is typically the case in path-integral based\nregularization methods (Zenke et\u00a0al., 2017 ) or experience replay\n(Chaudhry et\u00a0al., 2019 ) ).\n\n##### 33.3 Co-natural Gradient Optimization\n\nPresuming that @xmath is small, we can perform a second order Taylor\napproximation of the function @xmath around 0. Considering that both the\nzeroeth and first order terms are null because @xmath is a global\nminimizer of @xmath , this reduces the Lagrangian to a quadratic\noptimization problem (we refer the reader to Pascanu & Bengio ( 2013 )\nfor a more detailed derivation.):\n\n  -- -------- -- ------\n     @xmath      (36)\n  -- -------- -- ------\n\nwhere @xmath is the Hessian of the KL divergence around @xmath . A\ncrucial, well-known property of this matrix is that it coincides with\nthe Fisher information matrix \u2075\u2079 \u2075\u2079 59 Hence our use of the letter\n@xmath to designate the Hessian @xmath (the expectation being taken over\nthe model\u2019s distribution @xmath ; see Appendix Appendix for details).\nThis is appealing from a computational perspective because the Fisher\ncan be computed by means of first order derivatives only.\n\nMinimizing for @xmath yields the following optimal update:\n\n  -- -------- -- ------\n     @xmath      (37)\n  -- -------- -- ------\n\nwhere coefficients @xmath and @xmath are folded into two\nhyper-parameters: the learning rate @xmath and a damping coefficient\n@xmath (the step-by-step derivation can be found in Appendix Appendix ).\nIn practice, especially with low damping coefficients, it is common to\nobtain updates that are too large (typically when some parameters have\nno effect on the KL divergence). To address this, we re-normalize @xmath\nto have the same norm as the original gradient, @xmath . Moreover, to\nimprove numerical stability in the case of degenerate Fisher matrices,\nwe add a very small damping term of @xmath to all experiments.\n\nFor computational reasons, we will make 3 key practical approximations\nto the Fisher:\n\n1.  @xmath : we maintain the Fisher computed at @xmath , instead of\n    recomputing @xmath at every step of training. This relieves us of\n    the computational burden of updating the Fisher for every new value\n    of @xmath . This approximation (shared by previous work, e.g.\n    Kirkpatrick et\u00a0al. ( 2017 ) ; Chaudhry et\u00a0al. ( 2018a ) ) is only\n    valid insofar as @xmath and @xmath are close. Empirically we observe\n    that this still leads to good results.\n\n2.  @xmath is diagonal: this is a common approximation in practice with\n    two appealing properties. First, this makes it realistic to store\n    the @xmath diagonal Fisher coefficients in memory. Second, this\n    trivializes the inverse operation (simply invert the diagonal\n    elements).\n\n3.  Empirical Fisher: this common approximation replaces the expectation\n    under the model\u2019s distribution by the expected log-likelihood of the\n    true distribution: @xmath (mind the subscript). This is particularly\n    useful in tasks with a large or unbounded number of classes ( e.g.\n    structured prediction), where summing over all possible outputs is\n    intractable. We can then compute the diagonal of the empirical\n    Fisher using Monte Carlo sampling: @xmath with @xmath sampled from\n    @xmath (we use @xmath for all experiments).\n\nThis formulation bears many similarities with the natural gradient from\nAmari ( 1997 ) , which also uses the KL divergence as a metric for\nchoosing the optimal update @xmath in gradient descent. There is a\nhowever a crucial difference, both in execution and purpose: where the\nnatural gradient uses knowledge of the curvature of the KL divergence of\n@xmath to speed-up convergence, our proposed method leverages the\ncurvature of the KL divergence on @xmath to slow-down divergence from\n@xmath . To highlight the resemblance and complementarity between these\ntwo concepts, we refer to the new update as the co-natural gradient.\n\n##### 33.4 Beyond Two Tasks\n\nIn a continual learning scenario, we are confronted with a large number\nof tasks @xmath presented in sequential order. When learning @xmath , we\ncan change the Lagrangian @xmath from 35 to incorporate the constraints\nfor all previous tasks @xmath :\n\n  -- -------- -- ------\n     @xmath      (38)\n  -- -------- -- ------\n\nThis in turn changes the Fisher in Eq. 38 to @xmath . The choice of the\ncoefficients @xmath is crucial. Setting all @xmath to the same value,\ni.e. assigning the same importance to all tasks is suboptimal for a few\nreasons. First and foremost, it is unreasonable to expect of a model\nwith finite capacity to remember an unbounded number of tasks (as tasks\n\u201cfill-up\u201d the model capacity, @xmath is likely to become more\n\u201chomogeneous\u201d). Second, as training progresses and @xmath changes, our\napproximation that @xmath is less and less likely to hold.\n\nWe address this issue in the same fashion as Schwarz et\u00a0al. ( 2018 ) ,\nby keeping a rolling exponential average of the Fisher matrices:\n\n  -- -------- -- ------\n     @xmath      (39)\n  -- -------- -- ------\n\nIn this case, previous tasks are gracefully forgotten at an exponential\nrate controlled by @xmath . We account for the damping @xmath term in\nEq. 37 by setting @xmath . In preliminary experiments, we have found\n@xmath to yield consistently good results, and use this value in all\npresented experiments.\n\n#### 34 Continual Learning Experiment Setting\n\n##### 34.1 Setup, Evaluation and Baselines\n\nTo examine our hypothesis that controlling the optimization trajectory\nwith the co-natural gradient reduces catastrophic forgetting, we follow\nthe experimental procedure from Chaudhry et\u00a0al. ( 2019 ) : given a\ncollection of tasks, we create a \u201cvalidation set\u201d of 3 tasks used to\nselect the best hyper-parameters, and keep the remaining tasks for\nevaluation. This split is chosen at random and kept the same across all\nexperiments. In most settings, the nature and possibly the number of\nclasses changes from task to task. We account for this by training a\nseparate \u201ctask head\u201d for each task: an affine transform projecting the\nfeatures onto the number of classes, followed by a softmax layer. We\napply continual learning only to the remaining, \u201cfeature-extraction\u201d\npart of the model.\n\nWe report results using two common metrics for continual learning:\naverage accuracy , the accuracy at the end of training averaged over all\ntasks, and forgetting . Forgetting is defined in Chaudhry et\u00a0al. ( 2018a\n) as the difference in performance on a task between the current model\nand the best performing model on this task. Formally if @xmath\nrepresents the accuracy on task @xmath at step @xmath of training, the\nforgetting @xmath at step @xmath is defined as @xmath . Low forgetting\nmeans that the model tend to keep the same level of performance on a\ntask it has previously learned.\n\nWe implement the proposed co-natural update rule on top of 3 baselines:\n\n-    Finetuning : Simply train the model on the task at hand, without\n    any form of regularization.\n\n-    EWC : Proposed by Kirkpatrick et\u00a0al. ( 2017 ) , it is a simple but\n    effective quadratic regularization approach. While neither the most\n    recent nor sophisticate regularization technique, it is a natural\n    baseline for us to compare to in that it also consists in a\n    Fisher-based penalty \u2014 albeit in the loss function instead of the\n    optimization dynamics. We also use the rolling Fisher described in\n    Section 33.4 , making our EWC baseline equivalent to the superior\n    online EWC introduced by Schwarz et\u00a0al. ( 2018 ) .\n\n-    ER : Experience replay with a fixed sized episodic memory proposed\n    by Chaudhry et\u00a0al. ( 2019 ) . While not directly comparable to EWC\n    in that it presupposes access to data from previous tasks, ER is a\n    simple approach that boasts the best performances on a variety of\n    benchmarks (Chaudhry et\u00a0al., 2019 ) . In all experiments, we use a\n    memory of size 1,000 populated with reservoir sampling.\n\nTraining proceeds as follows: we perform exhaustive search on all\npossible hyper-parameter configurations using the validation tasks.\nEvery configuration is reran 5 times (3 for text classification) with a\ndifferent random seed and assigned a score based on the average task\nscore at the end of training (averaged over reruns). We then evaluate\nthe best hyper-parameters by continual training on the evaluation tasks.\nResults are reported over 5 random restarts, and we control for\nstatistical significance using a paired t-test (we pair together runs\nwith the same task ordering). For all experiments we train with plain\nstochastic gradient descent.\n\n##### 34.2 Datasets\n\nWe use the four following task suites in our experiments:\n\n###### 34.2.1 Split CIFAR\n\nThe CIFAR100 dataset, split into 20 independent 5-way classification\ntasks with 2500 training examples and 500 test examples each. This\nsplit, performed at random, is kept the same across all experiments,\nonly the order of these tasks is changed. Following Chaudhry et\u00a0al. (\n2018b ) , we use a smaller version of the ResNet architecture (He\net\u00a0al., 2016 ) train on each task for 1 epoch with batch size 10.\n\n###### 34.2.2 Omniglot\n\nThe Omniglot dataset (Lake et\u00a0al., 2015 ) consists of 50 independent\ncharacter recognition datasets on different alphabet. We adopt the\nsetting of Schwarz et\u00a0al. ( 2018 ) and consider each alphabet as a\nseparate task, and split each task such that every character is present\n12, 4 and 4 times in the training, validation and test set respectively\n(out of the 20 images for each character). \u2076\u2070 \u2076\u2070 60 Note that this is a\ndifferent setting than the usual meta-learning scenario that Omniglot is\nused for.\n\nOn this dataset we use the same small CNN architecture as Schwarz et\u00a0al.\n( 2018 ) . We augment the training data by randomly shifting and\nrotating images and train on each task for 2500 steps (120 to 417 epochs\ndepending on the alphabet) with batch size 32. We ignore the validation\ndata and simply evaluate on the test set at the end of training.\n\n###### 34.2.3 Split MiniImageNet\n\nThe MiniImageNet dataset (a subset of the popular ImageNet (Deng et\u00a0al.,\n2009 ) dataset \u2076\u00b9 \u2076\u00b9 61 Similarly to Omniglot, MiniImageNet was\noriginally intended as a meta-learning benchmark and therefore its\nstandard train\/validation\/test split consists of disjoint classes. We\nperform a custom transversal split so that the dataset can be used as a\nstandard 100-way classification task. The accuracies reported here are\nnot to be compared with the meta-learning literature. ; Vinyals et\u00a0al. (\n2016 ) ). We split the dataset into 20 disjoint 5-way classification\ntasks, similarly to Split CIFAR, and use the same smaller ResNet. We\ntrain on each task for 500 steps with batch size 32 ( @xmath epochs). We\nignore the validation data and simply evaluate on the test set at the\nend of training.\n\n###### 34.2.4 Text Classification\n\nThe most recent work on continual learning of language tasks\n(de\u00a0Masson\u00a0d\u2019Autume et\u00a0al., 2019 ) relies on a relatively small set of\ntasks (5 classification tasks from Zhang et\u00a0al. ( 2015 ) ). This small\nnumber of tasks is not amenable to our experimental setup described\nabove, where 3 tasks are reserved for validation. Therefore we assemble\na larger collection of text classification datasets from three sources:\nthe GLUE benchmark (Wang et\u00a0al., 2019b ) , the SuperGLUE benchmark (Wang\net\u00a0al., 2019a ) and the text classification datasets used in\nde\u00a0Masson\u00a0d\u2019Autume et\u00a0al. ( 2019 ) . To keep things relatively simple,\nwe only keep tasks that 1.\u00a0are single sentence or sentence pair\nclassification tasks and 2.\u00a0have more than 1000 training examples.\nSpecifically, we use the following tasks from each dataset (reported\nwith the training data size):\n\n-    GLUE\n\n    -   CoLA (Warstadt et\u00a0al., 2018 ) : 8.6K\n\n    -   MultiNLI (Williams et\u00a0al., 2018 ) : 392.7K\n\n    -   MRPC (Dolan & Brockett, 2005 ) : 3.7K\n\n    -   QNLI (Rajpurkar et\u00a0al., 2016 ) : 108.4K\n\n    -   QQP (Iyer et\u00a0al., 2017 ) : 363.8K\n\n    -   RTE (Dagan et\u00a0al., 2005 ; Haim et\u00a0al., 2006 ; Giampiccolo\n        et\u00a0al., 2007 ; Bentivogli et\u00a0al., 2009 ) : 2.5K\n\n    -   SST-2 (Socher et\u00a0al., 2013 ) : 67.3K\n\n-    SuperGLUE\n\n    -   BoolQ (Clark et\u00a0al., 2019 ) : 9.4K\n\n-   de\u00a0Masson\u00a0d\u2019Autume et\u00a0al. ( 2019 )\n\n    -   AG News (Gulli, 2005 ) (115.0K)\n\n    -   Amazon Reviews Full (McAuley & Leskovec, 2013 ) (115.0K)\n\n    -   DBPedia (Lehmann et\u00a0al., 2015 ) (115.0K)\n\n    -   Yahoo Answers (Zhang et\u00a0al., 2015 ) (115.0K)\n\n    -   Yelp Reviews Full (Yelp, 2015 ) (115.0K)\n\nNote that the RTE dataset from SuperGLUE also satisfies our task type\nand dataset size constraint, however according to Wang et\u00a0al. ( 2019a )\nit is an exact duplicate of GLUE\u2019s RTE dataset, therefore we don\u2019t\ninclude it. de\u00a0Masson\u00a0d\u2019Autume et\u00a0al. ( 2019 ) performed some mild\npreprocessing and subsampling of the datasets in Zhang et\u00a0al. ( 2015 ) ,\nhowever they did not release the final data. We perform a similar\npreprocessing step: for datasets where each sample consists in several\npieces of text (typically review title and body in the Amazon and Yelp\ndatasets), we concatenate all into one utterance, joined with a period\nand a space (\u201c . \u201d). We subsample the datasets to 115K training samples,\n5K validation samples and 7.6K test samples.\n\nWe randomly select three out of these 13 tasks to serve as the\nvalidation split upon which to perform hyper-parameter search, namely:\nBoolQ , MRPC and SST-2 . Since test sets are not available for the GLUE\nand SuperGLUE benchmark, we compute the final scores on the validation\ndatasets. Note that in all our experiments, validation data is not used\nduring training, therefore there is no leakage of the ultimate\nevaluation dataset in the training procedure\n\nInstructions to download and code to preprocess the data will be made\navailable at\nhttps:\/\/github.com\/pmichel31415\/translate\/tree\/paul\/pytorch_translate\/research\/adversarial\/experiments\nto facilitate reproduction of our results and future work on continual\nlearning for text classification. Following recent practice in text\nclassification, we use a large model that has already been pre-trained\nin an unsupervised fashion (specifically bert-base-uncased \u2076\u00b2 \u2076\u00b2 62 We\nuse the open-source implementation from Wolf et\u00a0al. ( 2019 ) with the\ndefault configuration. from Devlin et\u00a0al. ( 2018 ) ), and fine-tune the\nmodel on the supervised classification tasks. We train on each task for\n1000 steps with batch size 16 (from 7 to @xmath epochs due to the large\nvariance in dataset sizes).\n\n##### 34.3 Grid-search Parameters\n\nFor each all image-related tasks, we perform grid-search over the\nfollowing parameter values:\n\n-   Learning rate (all methods): 0.1, 0.03, 0.01\n\n-   EWC regularization strength (EWC, Co-natural EWC): 0.5, 1, 5\n\n-   Fisher damping coefficient (Co-natural finetuning, Co-natural EWC,\n    Co-natural ER): 0, 1, 0.1\n\nFor text classification with BERT specifically, preliminary experiments\nshowed that all methods benefitted from lower learning rate as well as\nlower regularization (likely due to the fact that optimization is\nstarting from a pretrained model). We therefore use the following\nvalues:\n\n-   Learning rate (all methods): 0.05, 0.01, 0.005\n\n-   EWC regularization strength (EWC, Co-natural EWC): 0.5, 0.1, 0.05\n\n-   Fisher damping coefficient (Co-natural finetuning, Co-natural EWC,\n    Co-natural ER): 1, 10, 100\n\nFor ER, we simply set the replay batch size to the same value as\nstandard training (10 and 32 for Split CIFAR and Omniglot respectively).\nNote that whenever applicable, we re-normalize the diagonal Fisher so\nthat the sum of its weights is equal to the number of parameters in the\nmodel. This is so that the hyper-parameter choice is less dependent on\nthe size of the model. In particular this means that the magnitude of\neach diagonal element is much bigger, which is why we do grid-search\nover smaller regularization parameters for EWC than is common in the\nliterature.\n\n#### 35 Continual Learning Results\n\n##### 35.1 The Co-natural Gradient Helps Prevent Forgetting\n\nThe upper half of Tables 27(a) , 27(b) , 27(c) and 27(d) reports the\naverage accuracy of all the tasks at the end of training (higher is\nbetter). We observe that the co-natural gradient always improves greatly\nover simple finetuning, and occasionally over EWC and ER. We note that\nsimple co-natural finetuning (without any other form of regularization)\nsometimes matches or exceeds the performance of EWC even though it\nrequires strictly fewer resources (there is no need to store the\nprevious parameters as in EWC, or data in ER).\n\nEven more appreciable is the effect of the co-natural trajectories on\nforgetting, as shown in the lower half of Table 27 . As evidenced by the\nresults in the lowest rows, using the co-natural gradient on top of\nfinetuning and ER systematically results in large drops in forgetting\nacross all datasets. With EWC, the conclusion is more nuanced. While the\nco-natural gradient never increases forgetting, the effect is not always\nstatistically significant.\n\nTo get a qualitative assessment of the learning trajectories that yield\nsuch results, we visualize the accuracy curves of 10 out of the 47\nevaluation tasks of Omniglot in Figure 10 . We observe that previous\napproaches do poorly at keeping stable levels of performance over a long\nperiod of time (especially for tasks learned early in training), a\nproblem that is largely alleviated by the co-natural preconditioning.\nThis seems to come at the cost of more intransigence (Chaudhry et\u00a0al.,\n2018a ) , i.e. some of the later tasks are not being learnt properly. In\nmodels of fixed capacity, there is a natural trade-off between\nintransigence and forgetting (see also the \u201cstability-plasticity\u201d\ndilemma in neuroscience Grossberg ( 1982 ) ). Our results position the\nco-natural gradient as a strong low-forgetting\/moderate intransigence\nbasis for future work.\n\n##### 35.2 Sensitivity to Damping\n\nThe main hyper-parameter for the co-natural gradient is the damping\nparameter @xmath from Eq. 37 . In our previous experiments, the value of\n@xmath is chosen according to grid search on a small number of tasks.\nWhile this is a realistic setting for practical applications, in this\nsection we perform a smaller, targeted experiment to examine the effect\nof @xmath on catastrophic forgetting.\n\nWe focus on the 17 evaluation tasks of the Split CIFAR dataset and set\nthe learning rate to 0.1. We observe how much the model \u201cforgets\u201d about\nthe first task it has observed after training on all others.\nSpecifically, we train on the first task, compute its Fisher @xmath ,\nand then proceed to train on the 16 remaining tasks with the co-natural\ngradient using @xmath (in particular we do not regularize for the other\ntasks). We observe how the value of alpha affects the final forgetting\nof the first task at the end of training, as well as the model\u2019s ability\nto learn new tasks (sometimes referred to as \u201cintransigence\u201d in the\nliterature Chaudhry et\u00a0al. ( 2018a ) ). As a measure of the latter, we\nreport the maximum accuracy achieved by the model averaged over the 16\nremaining tasks.\n\nWe evaluate values of @xmath from @xmath to @xmath (following a\ngeometric progression), as well as the two extremal values @xmath\n(\u2018\u2018pure\u2019\u2019 co-natural gradient \u2076\u00b3 \u2076\u00b3 63 As mentioned in Section 33 , we\ndo actually add a small damping term @xmath to all experiments. ) and\n@xmath (simple finetuning). All results are averaged over 10 random\nrestarts (with different model initialization and task order).\n\nWe observe in Figure 10(a) that forgetting monotonically increases with\nthe damping coefficient. Similarly, Figure 10(b) shows how increasing\n@xmath results in lower intransigence. While these two observations are\nexpected, it is interesting to note the existence of a \u201csweet spot\u201d\naround @xmath where damped co-natural gradient is significantly less\nintransigent than the un-damped co-natural gradient while simultaneously\nnot being significantly less robust to forgetting (all hypotheses are\ntested for with @xmath ).\n\n#### 36 Low-Resource Adaptation Experiments\n\nIn this section we take a closer look at the specific case of adapting a\nmodel from a single task to another, when we only have access to a\nminimal amount of data in the target task. In this case, controlling the\nlearning trajectory is particularly important because the model is being\ntrained on an unreliable sample of the true distribution of the target\ntask, and we have to rely on early-stopping to prevent overfitting. We\nshow that using the co-natural gradient during adaptation helps both at\npreserving source task performance and reach higher overall target task\nperformance.\n\n##### 36.1 Experimental Setting\n\nWe perform experiments on two different scenarios:\n\n###### Image classification\n\nWe take MiniImagenet as a source task and CUB (a 200-way birds species\nclassification dataset; Welinder et\u00a0al. ( 2010 ) ) as a target task. To\nguarantee a strong base model despite the small size of MiniImageNet, we\nstart off from a ResNet18 model (He et\u00a0al., 2016 ) pretrained on the\nfull ImageNet, which we retrofit to MiniImageNet by replacing the last\nfully connected layer with a separate linear layer regressed over the\nMiniImageNet training data. To simulate a low-resource setting, we\nsub-sample the CUB training set to 200 images ( @xmath per class).\nScores for these tasks are reported in terms of accuracy.\n\n###### Machine translation\n\nWe consider adaptation of an English to French model trained on WMT15 (a\ndataset of parallel sentences crawled from parliamentary proceedings,\nnews commentary and web page crawls; Bojar et\u00a0al. ( 2015 ) ) to MTNT (a\ndataset of Reddit comments; Michel & Neubig ( 2018a ) ). Our model is a\nTransformer (Vaswani et\u00a0al., 2017 ) pretrained on WMT15. Similarly to\nCUB, we simulate a low-resource setting by taking a sub-sample of 1000\nsentence pairs as a training set. Scores for these two datasets are\nreported in terms of BLEU score (Papineni et\u00a0al., 2002 ) . \u2076\u2074 \u2076\u2074 64 We\nuse sacrebleu (Post, 2018a ) with -tok intl as recommended by Michel &\nNeubig ( 2018a ) .\n\nHere we do not allow any access to data in the source task when training\non the target task. We compare four methods Finetuning (our baseline),\nCo-natural finetuning , EWC (which has been proven effective for domain\nadaptation, see Thompson et\u00a0al. ( 2019 ) ) and Co-natural EWC .\n\nGiven that different methods might lead to different trade-offs between\nsource and target task performance, with some variation depending on the\nhyper-parameters ( e.g. learning rate, regularization strength\u2026), we\ntake inspiration from Thompson et\u00a0al. ( 2019 ) and graphically report\nresults for all hyper-parameter configuration of each method on the 2\ndimensional space defined by the score on source and target tasks \u2076\u2075 \u2076\u2075\n65 For CUB in particular we report the average accuracy of every\nconfiguration over 5 runs, each with a different 200-sized random subset\nof the data. . Additionally, we highlight the Pareto frontier of each\nmethod i.e. the set of configurations that are not strictly worse than\nany other configuration for the same model.\n\n##### 36.2 Results\n\nThe adaptation results for both scenarios are reported in Figure 12 . We\nfind that in both cases, the co-natural gradient not only helps\npreserving the source task performance, but to some extent it also\nallows the model to reach better performance on the target task as well.\nWe take this to corroborate our starting hypothesis: while introducing a\nregularizer does help, controlling the optimization dynamics actively\nhelps counteract overfitting to the very small amount of training data,\nbecause the co-natural pre-conditioning makes it harder for stochastic\ngradient descent to push the model towards directions that would also\nhurt the source task.\n\n#### 37 Conclusion\n\nWe have presented the co-natural gradient, a technique that regularizes\nthe optimization trajectory of models trained in a continual setting. We\nhave shown that the co-natural gradient stands on its own as an\nefficient approach for overcoming catastrophic forgetting, and that it\neffectively complements and stabilizes other existing techniques at a\nminimal cost. We believe that the co-natural gradient \u2014 and more\ngenerally, trajectory regularization \u2014 can serve as a solid bedrock for\nbuilding agents that learn without forgetting.\n\n### Chapter \\thechapter Conclusion\n\nIn this thesis, we have explored ways to mitigate the difficulty of\nlearning neural models for natural language processing when confronted\nwith changes in the data distribution. We presented an overview of the\nproblem and the current state of the literature, and made contributions\nalong three core axes: evaluation, robustness and adaptation.\n\nBecause benchmarks and evaluation metrics are our compass towards\nsuccessfully addressing distributional shift, in Part I we first\ndeveloped a new dataset ( MTNT , Chapter I ) for evaluating the ability\nof machine translation models (usually trained on news articles or\nparliamentary proceedings) to handle a shift to the social media domain.\nThis confirmed that common neural architectures suffer significant\nperformance drops when confronted with text data from social media\nsources. In Chapter I , we tackled the distinct, but equally important\nissue of evaluating adversarial perturbation on textual inputs, with a\nfocus on sequence-to-sequence models. Specifically, we proposed an\nevaluation framework which we validated against human evaluations, and\nshowed its benefits for the purpose of carrying out effective\nadversarial training strategies. Collecting datasets and designing\nevaluation metrics is a time-consuming, often thankless and ultimately\nsisyphean endeavour: new models inevitably \u201coverfit\u201d to the available\nbenchmarks on which they are evaluated, which necessitates creating new\ndatasets, new metrics etc \u2026But as our work illustrates, every\ncontribution helps: for example, our MTNT dataset helped assess the\nrobustness of modern MT models, and was used as the basis for two\nsubsequent robust machine translation shared task, helping to drive\ninnovation in that area.\n\nIn Part II we focused on the central problem of training models that are\nrobust to distributional shifts. Our approach took inspiration from\nexisting work in distributionally robust optimization , wherein models\nare trained to minimize their expected risk against the most difficult\ndata distribution within a pre-determined family (the \u201cuncertainty\nset\u201d). In our work we confronted the difficulty of defining this\nuncertainty set appropriately for practical applications. Our approach\n(called Parametric DRO ) revolved around modeling the uncertainty set as\na parametric family of generative models (Chapter II ) or likelihood\nratios (Chapter II ) to strike a better balance between the extreme\npessimism or the limited expressivity of existing alternatives in the\nliterature. In P-DRO , a robust classifier learns to minimize its\nexpected loss under a parametric adversary which is itself trained to\nmodel the sub-population on which the classifier performs the worst. We\nempirically demonstrated that both variants could be used to derive\nmodels that were significantly more robust to sub-population shifts\ncompared with relevant baselines. While the work presented in these two\nchapters is more recent, we hope that it can serve as a strong\nfoundation towards more distributionally robust models in NLP .\n\nFinally, due to the inherent limitations of our DRO approach, which\nanticipates distributional shifts using only a static dataset, in Part\nIII we turned to the problem of adapting existing models to new data\ndistributions or tasks. We used ideas from information geometry to\nderive a gradient update rule (dubbed the \u201cco-natural gradient\u201d) for\nmitigating the catastrophic forgetting effect, where adapting neural\nmodels to new tasks or domains causes significant drops in performance\nin previously learned tasks (Chapter III ). The effectiveness of this\nmethod was validated on a diverse selection of continual-learning\nbenchmarks, as well as a machine translation domain adaptation problem\nusing our previously proposed MTNT dataset as a test bed.\n\nBeyond the conclusions directly derived from our contributions described\nabove, we identify two higher level takeaways from our time pursuing\nresearch on the specific topic of distributional shift. The first is\nthat proper evaluation is of paramount importance . This idea has\npermeated every chapter of this thesis. Of course, this was the central\nmotivation for the entirety of Part I , but we have also made a\nconscious effort to conduct fair and consistent evaluation in chapters\nII , II and III . This is particularly important in the specialised\nsub-areas that are distributionally robust optimization and continual\nlearning, because due to their cross-sectional nature, they tend to\nattract practitioners with diverse research backgrounds. This often\nresults in inconsistent evaluation standards, which can can hamper\nprogress (Gulrajani & Lopez-Paz, 2020 ; Farquhar & Gal, 2018 ) .\n\nOur second key takeaway is that, for practical applications of machine\nlearning (such as NLP ), research progress should be guided by, but not\nlimited to what is predicted by theory . This is especially relevant in\nthe context of deep learning, where theory lags behind the state of the\nart (Nagarajan & Kolter, 2019 ) \u2076\u2076 \u2076\u2076 66 And of course, advancing theory\nis a worthwhile and crucial pursuit in and of itself. . In our work on\nParametric DRO in Part II , we experimented with highly\nnon-convex-concave differentiable games which were not guaranteed to\neven converge. Furthermore, we used a number of (sometimes extreme)\napproximations to make our methods useable in practical NLP scenarios.\nDespite this, we found that they outperformed more principled, but\nperhaps less flexible baselines from the non-parametric DRO literature.\nThis is not to say that research should proceed by blindly throwing\nideas on the metaphorical wall and \u201cseeing what sticks\u201d (an inefficient,\nnot to mention computationally unsustainable process). But there is a\nbalance to strike, and we can achieve significant progress by taking\ninspiration from more conservative lines of work and porting them over\nto more applied research areas, without being restrained by mathematical\nrigour.\n\n##### Future Work\n\nDuring our investigations throughout the course of producing the work\ndescribed in this thesis, we have come to identify open questions which\nwe believe would provide fertile ground for future research. In the next\nfew paragraphs, we elaborate on these possible future directions towards\nclose the gap between human and machine learning in NLP in the face of\ndistributional shift\n\nIn our own work, we have mostly been concerned with \u201cinterpolative\u201d\nversions of distributional robustness, wherein we assume that our\ntraining data contains enough diversity for us to simulate potential\ndistributional shifts. This setting has its uses, as demonstrated by our\npositive results in a variety of realistic benchmarks in Part 3 . But\nthere is value in considering a more difficult scenario where we might\nhave to extrapolate and guess at what unseen domains might look like.\nWhile there is some existing work in generating difficult or\nout-of-domain examples in computer vision (Yue et\u00a0al., 2019 ; Zhou\net\u00a0al., 2020 ) , this remains an under-explored area of the literature,\nespecially when it comes to natural language processing. Leveraging the\ngenerative capabilities of strong parametric adversaries trained with\nP-DRO to hallucinate unseen, yet difficult examples could be a viable\npath to progress in this challenging setting.\n\nWith respect to the adaptation aspect, we believe that it is time for\nthe community to move beyond the episodic setting commonly considered in\ncontinual learning and start tackling the \u201cstreaming\u201d setting where the\ntest (or training!) distribution is liable to change continuously over\ntime. This scenario is more representative of how we as humans interact\nwith our non-stationary environment, and it poses exciting new\nchallenges, not only terms of the learning algorithms needed in such\nenvironments, but also with regards to how these same algorithms should\nbe evaluated. How do \u201cepisodic\u201d continual learning algorithm such as the\nco-natural gradient (Chapter III ) fare against continuous distribution\nshift? And can the variety of data distributions observed over time in\nturn guide the construction of more accurate uncertainty sets in DRO ?\nThese are only some of the many open questions in this so far relatively\nuncharted research area. While there has been preliminary work on this\ngeneral topic very recently (Lazaridou et\u00a0al., 2021 ; Hombaiah et\u00a0al.,\n2021 ) , there is still a long road ahead, as it were.\n\nFinally, as large models pre-trained with a language modeling objective\nhave become ever more prominent in NLP research over the past few years\n(Radford et\u00a0al., 2019 ; Dai et\u00a0al., 2019 ; Raffel et\u00a0al., 2019 ) , the\ndistinction between domain and task has become blurrier. For example, in\nRadford et\u00a0al. ( 2019 ) and Raffel et\u00a0al. ( 2019 ) , multiple tasks are\nreformulated as a single, unified language modeling or question\nanswering task. We hypothesize that this trend is only going to increase\nbecause, as its name indicates, natural language is a natural\ncommunication protocol for us to interact with and query our models.\nWith this in mind, we posit that creating models that are both robust\nand able to adapt to shift in the data distribution is a critical\nrequirement for developing artificial agents that are capable of\ntackling a variety of tasks in diverse environments. We hope that the\nwork presented in this thesis towards training models that are better\nequipped to deal with distributional shift provides a useful step in\nthis direction.\n","output":["The dominating NLP paradigm of training a strong neural predictor to perform\none task on a specific dataset has led to state-of-the-art performance in a\nvariety of applications (eg. sentiment classification, span-prediction based\nquestion answering or machine translation). However, it builds upon the\nassumption that the data distribution is stationary, ie. that the data is\nsampled from a fixed distribution both at training and test time. This way of\ntraining is inconsistent with how we as humans are able to learn from and\noperate within a constantly changing stream of information. Moreover, it is\nill-adapted to real-world use cases where the data distribution is expected to\nshift over the course of a model's lifetime.\n  The first goal of this thesis is to characterize the different forms this\nshift can take in the context of natural language processing, and propose\nbenchmarks and evaluation metrics to measure its effect on current deep\nlearning architectures. We then proceed to take steps to mitigate the effect of\ndistributional shift on NLP models. To this end, we develop methods based on\nparametric reformulations of the distributionally robust optimization\nframework. Empirically, we demonstrate that these approaches yield more robust\nmodels as demonstrated on a selection of realistic problems. In the third and\nfinal part of this thesis, we explore ways of efficiently adapting existing\nmodels to new domains or tasks. Our contribution to this topic takes\ninspiration from information geometry to derive a new gradient update rule\nwhich alleviate catastrophic forgetting issues during adaptation.","The dominating NLP paradigm of training a strong neural predictor to\nperform one task on a specific dataset has led to state-of-the-art\nperformance in a variety of applications (eg. sentiment classification,\nspan-prediction based question answering or machine translation).\nHowever, it builds upon the assumption that the data distribution is\nstationary, ie. that the data is sampled from a fixed distribution both\nat training and test time. This way of training is inconsistent with how\nwe as humans are able to learn from and operate within a constantly\nchanging stream of information. Moreover, it is ill-adapted to\nreal-world use cases where the data distribution is expected to shift\nover the course of a model\u2019s lifetime.\n\nThe first goal of this thesis is to characterize the different forms\nthis shift can take in the context of natural language processing, and\npropose benchmarks and evaluation metrics to measure its effect on\ncurrent deep learning architectures. We then proceed to take steps to\nmitigate the effect of distributional shift on NLP models. To this end,\nwe develop methods based on parametric reformulations of the\ndistributionally robust optimization framework. Empirically, we\ndemonstrate that these approaches yield more robust models as\ndemonstrated on a selection of realistic problems. In the third and\nfinal part of this thesis, we explore ways of efficiently adapting\nexisting models to new domains or tasks. Our contribution to this topic\ntakes inspiration from information geometry to derive a new gradient\nupdate rule which alleviate catastrophic forgetting issues during\nadaptation.\n"]}
{"input":"## Acknowledgements\n\nI gratefully acknowledge an STFC Studentship, and the University of\nGlasgow for the opportunity to undertake this PhD, and the Astro\ndepartment for suggesting a project which has taken me to some great\nplaces and introduced me to great people. I also thank our group\nsecretary, Ms Rachael McLauchlan, for invaluable help with travel,\nfinances and admin.\n\nTo my supervisor Eduard, and to Nic Bian I shall be eternally grateful,\nnot only for the in-depth discussions of physics both in the office and\nthe pub, but for supererogatory support and guidance.\n\nSignificant parts of the Introduction were composed during the ISSI\ninternational team meeting on X-ray and Radio Diagnostics of Energetic\nElectrons in Solar Flares led by E.P. Kontar, and I thank all of the\nteam members, and a few in particular, for the enlightening discussions.\n\nOn a personal note, I am indebted to all the various friends and\ncolleagues, particularly the denizens of 604, who listened to a lot of\nbad jokes, and answered many stupid questions. I owe much to the\nStevenson building for the powerlifting, and Colin, Gail, Michele and\nMarina for the climbing and running that have kept me from going\ncompletely mad.\n\nFinally, I thank again my supervisor as this has certainly been an E.P.\ni. K few years.\n\n## Table of Symbols\n\n## Chapter 1 Introduction\n\nIn this chapter, we first outline the structure of the Sun, focusing on\nthe solar corona and solar wind, and give a brief description of solar\nflares. We then introduce some basic concepts and definitions from\nplasma physics which are necessary to model these phenomena. We\nsummarise previous theoretical and simulation work on the propagation\nand evolution of fast electron beams due to wave generation which is the\ntopic of Chapters 2 and 3 of this thesis, then discuss the radiation\nwhich fast electrons produce in the corona and solar wind, in particular\nhard X-rays and radio emission. The general nature of flare associated\nradio emission is summarised, followed by a more detailed description of\nthe emission from beams propagating in the corona and solar wind, and a\ndescription of the observations and emission mechanism behind\nbeam-generated radio emission at high frequencies, which forms the focus\nof Chapter 4 .\n\n### 1.1 The Sun\n\n#### 1.1.1 Structure\n\nThe visible surface of the Sun is termed the photosphere, and is\nrelatively cool, with an average temperature of 5600\u00a0K. Above the\nphotosphere is the chromosphere, a plasma composed mostly of hydrogen\nand some helium, with an average temperature of around @xmath K, rapidly\nvarying density (from approximately @xmath cm @xmath to @xmath cm @xmath\n) and varying ionisation. It is approximately 2000\u00a0km thick, and named\nfor its appearance as a red flash at the beginning and end of solar\neclipses, due to the strong H @xmath emission line in its spectrum.\nBetween the chromosphere and the overlying corona is the very narrow\ntransition region, less than 300\u00a0km thick, over which the density drops\nby several orders of magnitude, while the temperature rises to over\n@xmath K. This temperature rise is still not fully understood, and the\ncoronal and chromospheric heating problem is the topic of much\nspeculation. The temperature and density of the corona mean it is almost\ncompletely ionised.\n\nThe corona is in a constant state of outflow, forming the solar wind.\nOpen magnetic field lines, dragged by the solar rotation, spiral\noutwards in a pattern known as the Parker Spiral. The solar wind has two\ncomponents: fast, with velocity around @xmath km\u00a0s @xmath , arising from\nregions of open magnetic field, where the field lines extend into space;\nand slow, with velocity around @xmath km\u00a0s @xmath , arising from regions\nof closed magnetic field, which only connect to the heliosphere at much\nhigher altitudes. The influence of the outflowing solar wind extends to\nthe Earth and beyond, eventually terminating at the heliopause.\n\n#### 1.1.2 Coronal Density Profiles\n\nA simple model for the coronal density profile may be derived by\nconsidering the case of hydrostatic equilibrium, in which the gas\npressure is balanced by the gravitational force, and the whole system is\nunchanging in time. The resulting density profile as a function of\nheight can be easily derived (e.g. Aschwanden, 2006 ) and leads to an\nexponential profile @xmath where @xmath is radial distance measured from\nthe reference point at density @xmath , and @xmath is the scale height,\ntypically around @xmath cm in the corona.\n\nMeasurements of the density have been performed using several methods.\nThe radio bursts know as Type III and described below (Section 1.5.4 )\nare one, as their frequency traces the plasma frequency, and hence the\nelectron density. They are observed over a wide frequency, and therefore\ndensity range (e.g. McLean & Labrum, 1985 ) , and so can be used to find\nthe plasma density from the corona to the Earth and beyond (e.g Leblanc\net\u00a0al., 1998 ) . White light radiating from the corona, resulting from\nThomson scattering of photospheric radiation, and EUV or soft X-ray\nobservations can give line-of-sight integrated densities, while certain\nemission lines can return an absolute density in some regions\n(Aschwanden, 2006 ) .\n\nFigure 1.1 shows a model of the temperature and density of the\nchromosphere, transition region and low corona. The electron density is\nroughly exponential between @xmath and @xmath km height. Various models\nexist, from the original exponential profile of Newkirk ( 1961 ) to\nseveral empirical power-law fits, such as the Baumbach-Allen (Allen,\n1947 ) or Saito (Saito et\u00a0al., 1977 ) models. In addition to this smooth\ngradation, there may be large scale fibrous structuring, as the low\nplasma-beta implies transport across field lines is inhibited; and also\ndiscrete structures.\n\n#### 1.1.3 The Solar Wind\n\nWhile the hydrostatic approximation gives a reasonable density estimate\nfor the quiet corona, it was realised by Parker ( 1958 ) that the corona\ncould not be in equilibrium, and must instead be constantly streaming\noutwards. For an isothermal ideal gas, assuming radial expansion\n(expansion factor proportional to distance squared) the hydrodynamic\nequations can be solved (e.g. Parker, 1958 ; Mann et\u00a0al., 1999 ) , and\nimply outwards flows of several hundred km\/s, in good agreement with the\nobserved solar wind speeds. The solar wind model of Parker ( 1958 ) also\ngives rise to the Parker spiral, as the Sun\u2019s rotation drags the open\nfield lines into a spiral. The distance from the Sun to the Earth along\na magnetic field line is therefore approximately 1.2\u00a0AU.\n\n#### 1.1.4 Density Fluctuations\n\nBoth the corona and the solar wind show local inhomogeneities on a\nvariety of scales. Interplanetary scintillation (IPS) measurements,\nwhere a compact radio source is seen to \u201ctwinkle\u201d due to density\nfluctuations along the line of sight, have been used to measure these in\nthe solar wind (e.g. Cronyn, 1972 ; Smith & Sime, 1979 ) and closer to\nthe Sun (e.g. Coles & Harmon, 1989 ; Woo et\u00a0al., 1995 ) . The density\ndependence of radio-wave propagation velocity in plasma was used by\nCelnikier et\u00a0al. ( 1983 ) to find the density between two closely spaced\nsatellites in the solar wind and its variations over time, again giving\nthe spectrum of density fluctuations. In general, fractional density\nfluctuations of up to around @xmath have been observed at scales down to\n@xmath km, which will be considered in this thesis.\n\n#### 1.1.5 Solar Activity\n\nSolar activity follows an 11 year cycle, with the next maximum predicted\nfor late 2013. Sunspots, cooler darker areas of the photosphere with\nstrong magnetic fields, begin to occur after the minimum of the cycle,\ndrifting to smaller latitudes as the cycle proceeds. Every cycle, the\npolarity of the global magnetic field of the Sun reverses.\n\nSolar flares occur in sunspot groups because of their association with\ncomplex magnetic field structure. Flares are transient brightenings,\nlasting from tens of minutes to a few hours, and releasing enormous\namounts of energy, from @xmath to @xmath ergs or more depending on their\nsize. Historically, coronal mass ejections (CMEs), large clouds of\nplasma released from the corona, were considered to be a separate\nphenomenon from flares, but more recently their interconnectedness has\nbecome clear. The term Solar Eruptive Event has been coined to tie\ntogether both of these, and also the energetic particles that can result\nfrom flare energy releases. Electromagnetic radiation, CMEs and\naccelerated particles each carry significant fractions of the released\nenergy.\n\nThe standard flare classification uses the emission as measured by GOES\n(the Geostationary Orbiting Environmental Satellite). The total flux in\nsoft X-Rays (wavelengths between 1 and 8 \u00c5) is used, and the classes run\nfrom A through C then M, X, X10, each with a flux 10 times that of the\nprevious class. In general the occurrence rate decreases as the class\nincreases, with X-class flares being relatively uncommon, while smaller\nflares are observed far more often.\n\nThe electromagnetic emission produced in flares covers the entire\nspectrum, from radio waves through the visible to X-Rays and gamma rays.\nThe bulk of this emission is in visible and UV wavelengths (Woods\net\u00a0al., 2006 ) . Radio emission and hard X-ray emissions are produced by\nfast electrons, while soft X-rays may be produced during the rise of a\nflare due to plasma heating, although this \u201cpre-heating\u201d is not seen in\nall events.\n\n### 1.2 Essential Plasma Physics\n\nPlasmas are the fourth and commonest state of ordinary matter in the\nuniverse, and are characterised by collective effects over large spatial\nscales, due to the ionisation of the constituent atoms. We consider here\nfully ionised, single species plasma, consisting of protons and\nelectrons. This may be described using two temperatures, the electron\nand the ion temperatures @xmath respectively. From these temperatures we\nobtain two thermal speeds, @xmath and @xmath , and the sound speed\n@xmath given by\n\n  -- -------- -- -------\n     @xmath      (1.1)\n  -- -------- -- -------\n\nwhere @xmath is Boltzmann\u2019s constant and @xmath are the masses of an\nelectron and a proton respectively.\n\nThe characteristic frequency of electron oscillations is given by the\n(electron) plasma frequency @xmath , and that for the ions by the ion\nplasma frequency @xmath which are\n\n  -- -------- -- -------\n     @xmath      (1.2)\n  -- -------- -- -------\n\nHere @xmath is the electronic charge and @xmath are the (number) density\nof electrons and ions respectively. In magnetised plasma, electrons\ngyrate around the magnetic field lines at a frequency given by the\nelectron cyclotron frequency\n\n  -- -------- -- -------\n     @xmath      (1.3)\n  -- -------- -- -------\n\nwhere @xmath is the magnetic field strength, and @xmath the speed of\nlight. Finally, the (electron) Debye wavelength @xmath or its\nreciprocal, the Debye wavenumber @xmath , are important as they give the\nmaximum spatial scale over which charge separation can occur.\n\n#### 1.2.1 Langmuir Waves\n\nPlasmas display quasineutrality , meaning there can be no charge\nseparation on scales larger than the Debye length, due to the\nsignificant restoring force of the electric field. Because the ions are\nmuch more massive than the electrons, the electrons can oscillate while\nthe ions remain stationary, giving the stationary version of a plasma\noscillation, or Langmuir wave, which has a frequency of @xmath . The\ntravelling version, with non-zero wavenumber @xmath , is ubiquitous in\nplasma, giving its alternative name of \u201cplasma wave\u201d. These are weakly\ndispersive, with @xmath , and so have frequencies very close to the\nplasma frequency. Plasma waves at very different wavenumbers can\ntherefore have very similar energies. The group velocity of Langmuir\nwaves is @xmath , which is generally far less than the electron thermal\nspeed, so for many purposes their propagation can be neglected.\n\n#### 1.2.2 Magnetoionic Modes\n\nIn plasma with an ambient magnetic field, electromagnetic waves have two\npossible modes of circular polarisation, depending on whether the\nelectric field vector rotates in the same direction as an electron\nspirals around the field lines (O-mode), or the opposite (X-mode) (e.g.\nRatcliffe, 1959 ) . Unpolarised radiation is the sum of these two\ncircular polarisation states. The O-mode propagates in plasma only above\n@xmath , and has dispersion relation @xmath , identical to that of an\nelectromagnetic wave in unmagnetised plasma, while the X-mode cutoff is\nat @xmath and the dispersion relation is\n\n  -- -------- -- -------\n     @xmath      (1.4)\n  -- -------- -- -------\n\nBecause of the different group velocities, initially unpolarised\nradiation can acquire a non-zero polarisation entirely due to\npropagation, as waves in one mode arrive before the other.\n\nIn magnetised plasma, the Langmuir wave dispersion relation becomes\n\n  -- -------- -- -------\n     @xmath      (1.5)\n  -- -------- -- -------\n\nwhere @xmath is the angle between @xmath and the magnetic field. These\ncan be considered as modified Z-mode waves (e.g. Melrose, 1976 ) , which\nare the lower-frequency ( @xmath ) branch of the X-mode waves just\ndiscussed.\n\n#### 1.2.3 Plasma Modelling\n\nThe self-consistent modelling of a plasma is a rather difficult problem.\nMoving charged particles generate currents and thus electromagnetic\nfields, which in turn act upon the particles, so the motions of the\nparticles and evolution of the fields must be considered in parallel.\nFurther complications arise due to collective effects over large\ndistances, which characterise the plasma state. Ignoring\nself-consistency and using a single-particle description, i.e. following\nthe motion of a \u201ctest particle\u201d in prescribed fields is helpful in some\ncases, for example when deriving the trajectory of a particle in an\nexternal magnetic field. In general however, we cannot follow the exact\nmotion of each particle, and must instead use a statistical description.\nThis is the basis of plasma kinetic theory.\n\nThe problem addressed in this work of an electron beam in unmagnetised\nplasma is well described by quasilinear theory (e.g. Drummond & Pines,\n1964 ; Vedenov et\u00a0al., 1962 ) , which considers the particle and wave\ndistributions in the limit where the background plasma contains far more\nenergy than the beam. Non-linear effects may be easily included, and in\n1-D these equations are straightforward to simulate. Such simulations\nmay be extended to large particle numbers and large spatial and time\nscales without requiring excessive amounts of computing power, and so we\nuse this approach here.\n\nOn the other hand, particle-in-cell (PIC) simulations address the\nproblem of self-consistency directly, following the motion of the\nparticles in electromagnetic fields, and updating the fields according\nto the particle motions. Macroscopic quantities, such as the electric\nand magnetic field and the plasma density, are calculated on a discrete\ngrid, while the particles are tracked individually as they move through\nthis grid. Such methods are very demanding computationally, especially\nfor large space or time scales or large numbers of particles. However as\nwill be mentioned in Section 2.5.3 they are useful as confirmation of\nthe effects seen using our simulation method.\n\n### 1.3 Reconnection and Particle Acceleration\n\n#### 1.3.1 Acceleration Mechanisms\n\nThe reconfiguration of magnetic field to a lower energy state, which may\nbe facilitated by magnetic reconnection, is the source of the vast\namounts of energy released during solar flares, with perhaps @xmath of\nthe free magnetic energy being released (Emslie et\u00a0al., 2004 ) . This\nenergy leads to particle acceleration, either in the energy release\nregion itself, or its vicinity.\n\nDC electric field acceleration can occur in, for example, current\nsheets. Wave turbulence, on the other hand, can also lead to\nacceleration due to the oscillating electric fields of the waves. Wave\nparticle interactions, such as those discussed below, can transfer\nenergy to and from particles, and at particular velocities the particles\ncan experience a net energy gain (Hamilton & Petrosian, 1992 ) . The\ninteractions are resonant, and so high frequency waves such as Langmuir\nwaves or whistlers are required to accelerate electrons.\n\nShock acceleration may be either first order Fermi acceleration, usually\nrequiring multiple shock crossings to reach the high energies observed\n(Toptygin, 1980 ) , or second order Fermi, if the particles are\nreflected by stochastically moving magnetic mirrors, and statistically\nmore likely to gain energy than lose it. This is important in some\ncontexts, for example in association with the shocks preceding CMEs and\nassociated with radio bursts (e.g. Mann et\u00a0al., 1998 ) .\n\n#### 1.3.2 Acceleration Region Diagnostics\n\nThe acceleration region lies at a height of ten to a few tens of Mm\nabove the photosphere, in the cusp of the flaring loop in the corona.\nRadio and HXR emission from accelerated electrons provides several\nmethods by which to derive this height and other parameters of the\nacceleration region (reviewed by e.g. Aschwanden, 2002 ) .\n\n##### Electron Time of Flight Inferences\n\nFor example, electrons at a range of velocities, simultaneously injected\ninto the loop from the acceleration region, will reach the footpoints of\nthe loop at different times. Assuming no time dependence of the\ninjection, the spectrum of the HXR emission produced at the footpoints\n(discussed in the next section) can be used to infer the emitting\nelectron distribution, and therefore the arrival times of electrons at\ndifferent velocities, which can be used to find the distance travelled\nby the electrons. Aschwanden et\u00a0al. ( 1996 ) found heights of 40\u00a0Mm for\none flare event, known as the \u201cMasuda flare\u201d, after Masuda et\u00a0al. ( 1994\n) , and the first event in which HXR emission was directly observed\nabove the loop-top, now ascribed to emission from a trapped electron\npopulation. The height of this emission was measured to be close to\n20\u00a0Mm, suggesting this trapping is below the acceleration region and the\npoint of reconnection. This geometry also supports a stochastic\nacceleration mechanism, rather than large scale electric fields.\n\n##### Bidirectional Radio Bursts\n\nAnother extremely informative diagnostic of acceleration region height\nis offered by bidirectional electron beams and their radio emission\n(Section 1.5.4 ). Here the accelerated electrons propagate both upwards\nalong open field lines and downwards along the closed field lines (e.g.\nRobinson & Benz, 2000 ) , and produce radio emission at the local plasma\nfrequency. The point at which the two bursts join is then the location\nof the accelerating region.\n\n##### Radio Hard X-ray Correlations\n\nFinally, one-to-one associations between HXR emission and single Type\nIII bursts were seen by Kane et\u00a0al. ( 1982 ) , with further studies\nperformed by e.g. Raoult et\u00a0al. ( 1985 ) . It was concluded that the two\nkinds of emission were produced by similar electron populations again\npropagating upwards or downwards along magnetic field lines. Correlated\nHXR and radio observations can therefore be used to deduce the height of\nthe acceleration region (Reid et\u00a0al., 2011 ) . However, it should be\nnoted that while individual HXR and radio bursts may be correlated the\noverall numbers do not match, with only around 1\/3rd of observed HXR\nevents showing associated Type III emission (Benz et\u00a0al., 2005 ) .\n\n#### 1.3.3 X-Ray Emission\n\nHard X-Rays themselves account for only a small fraction of the energy\nreleased during flares, but because of the relative simplicity of the\nbremsstrahlung cross-section and the low optical depth of the solar\natmosphere at HXR wavelengths, they are a very powerful diagnostic for\naccelerated electrons, which carry large amounts of energy. The recovery\nof the electron spectrum from the observed emission is by no means a\nsimple procedure, but reasonable models now exist which allow this to be\ndone.\n\nDuring flares, the HXR emission tends to follow a \u201csoft-hard-soft\u201d\nevolution (Kane & Anderson, 1970 ) , where its spectral index evolves in\ntime: it is large (steep) in the initial phase of the flare, decreases\nduring the peak and then softens again in the decay phase. Occasionally\nthe pattern is rather \u201csoft-hard-harder\u201d. This evolution may be due to\nparticle trapping or to changes in the acceleration efficiency or\nbehaviour.\n\nA large fraction of the released HXR energy is deposited in the\nchromospheric plasma, leading to heating and therefore thermal\nbremsstrahlung emission in soft X-rays (Emslie, 1989 ) . This is the\nlikely origin of the Neupert effect (Neupert, 1968 ; Dennis & Zarro,\n1993 ) where the time-integral of the HXR emission follows the time\nprofile of the thermal SXR emission, because the coronal plasma\n\u201cintegrates\u201d the non-thermal energy deposition.\n\n#### 1.3.4 Bremsstrahlung and the Thick Target Model\n\nBremsstrahlung emission by electrons in plasma is thermal when the\nemitting electrons are at the ambient plasma temperature, and can also\nbe thick or thin target, a thick target being one in which the emitting\nelectron loses its entire energy collisionally while emitting. Thermal\nbremsstrahlung can produce soft X-rays from very hot plasma, such as\nthat generated during the fast electron bombardment of the chromosphere\noccurring during flares.\n\nA comprehensive review of bremsstrahlung cross-sections was given by\nKoch & Motz ( 1959 ) , including those for thick-target emission. The\napplication of the thick-target model to solar flare HXR emission was\nconsidered by various authors, for example Arnoldy et\u00a0al. ( 1968 ) and\nwas extended to include the effects of partial ionisation (e.g. Brown,\n1973 ) , and additional evolution of the emitting electrons.\n\nHowever, assuming the simple thick target model can lead to\noverestimates of the required electron spectrum in order to produce the\nobserved HXR emission. In some large flares, this overestimate can be\nparticularly problematic as more electrons seem to be required than are\npresent in the entire acceleration region, with the discrepancy\nhistorically referred to as the electron number problem .\n\nIt is clear that any processes which lead to additional energy losses\nduring beam propagation will increase the number of electrons that must\ninitially be accelerated. Langmuir wave generation by the beam\n(discussed in the next section) was thought to fall into this category,\nbut simulations showed that the net effect of wave-generation on the\ntime-averaged electron flux was negligible (Hamilton & Petrosian, 1987 ;\nMcClements, 1987 ; Hannah et\u00a0al., 2009 ; Hannah & Kontar, 2011 ) . In\nChapter 3 we will discuss one possible means for Langmuir wave\ngeneration to instead reduce the required initial number of accelerated\nelectrons, due to interactions between the waves and ambient plasma\ndensity fluctuations.\n\n### 1.4 Electron Beam Propagation and Evolution\n\nOnce a fast electron population has been produced, the exact\nacceleration mechanism remaining unimportant for our purposes, they must\npropagate thorough the coronal plasma. For a relatively weak beam, the\nmagnetic field will guide this propagation, and the beam can remain\nhighly collimated (e.g. Muschietti, 1990 ) . However, its evolution due\nto collisional energy loss and pitch angle scattering are important in\nvery dense plasma, along with such effects as wave-particle\ninteractions.\n\n#### 1.4.1 Langmuir Wave Generation and Sturrock\u2019s Dilemma\n\nAn electron population whose distribution has a positive velocity\ngradient at some velocity \u00b9 \u00b9 1 The \u201cPenrose criterion\u201d implies that\nthis must be @xmath or larger for instability. (a \u201cbump\u201d), will be\nunstable to Langmuir wave generation (Section 2.2 ). We note that the\nprobability for this emission is independent of the magnetic field in\nthe weak field limit @xmath .\n\nHistorically, it was believed that the loss of energy to Langmuir waves\nwould cause an accelerated electron stream to decelerate within only a\nfew thousand metres (Sturrock, 1964 ) , yet these streams were known,\nfrom observations of Type III radio bursts (Section 1.5.4 ), to\npropagate over distances up to at least 1\u00a0AU. This apparent conflict was\nknown as Sturrock\u2019s dilemma and appeared to be a significant problem.\n\nMost solutions involved suppression of the beam-plasma instability\ncausing the wave generation (e.g. Grognard, 1985 ; Muschietti, 1990 ) ,\nand effects such as wave-wave interactions or density gradients were\ninvoked in order to achieve this, including the example of elastic\nangular scattering of the waves discussed in Chapter 2 . However for a\nspatially limited electron beam, it was found that the waves emitted by\nthe electrons at the front of the beam could be reabsorbed by those at\nthe back, and energy loss would thus be limited (Magelssen & Smith, 1977\n; Muschietti, 1990 ) .\n\nThe numerical simulations by Kontar et\u00a0al. ( 1998 ); Mel\u2019Nik et\u00a0al. (\n1999 ) showed that this indeed occurs, and such a beam propagates as a\n\u201cBeam-Plasma Structure\u201d (BPS), where the electrons are accompanied by a\nwave distribution, emitted at the front and absorbed at the back. Such a\nstructure has a fixed maximum propagation velocity (Mel\u2019Nik, 2003 ) ,\ndependent on density, and consistent with the observed velocities of\nType III radio burst producing streams (Section 1.5.4 ). Suppression of\nthe beam-plasma instability remains of critical importance in\nconsiderations of the beam-plasma wave interactions, for example in the\ntheory of radio bursts, but is not required in order for the beam to\npersist.\n\n#### 1.4.2 Beam Propagation in Inhomogeneous Plasma\n\nFor a BPS propagating in inhomogeneous plasma, some of the waves will be\nlost from resonance with the beam, and therefore not all of the energy\ncan be reabsorbed (Kontar, 2001a ) . Some energy will be left behind in\nthe form of Langmuir wave turbulence, which will damp collisionally, or\nmay interact with other wave modes, and can lead to electromagnetic\nemission (specifically Type V bursts, see Section 1.5.5 ).\n\nIn addition, the simulations of Reid & Kontar ( 2010 , 2012 ) following\nelectron beams propagating from the Sun outwards into the solar wind,\nfound that wave particle interactions in inhomogeneous plasma could\nsubstantially change the electron distribution found at 1\u00a0AU, with an\ninitially injected power law flattening at low velocities due to the\ngeneration and subsequent evolution of the Langmuir waves. This was\nconsidered also for a beam propagating downwards into the deep corona\nand chromosphere by Hannah et\u00a0al. ( 2013 ) who found that in this case\nadditional high energy electrons were produced, which could lead to\nenhanced HXR emission at some energies. A similar effect will be shown\nin Chapter 3 of this thesis for a beam evolving due to collisional\neffects.\n\n### 1.5 Radio Emission\n\nRadio emission from the quiet Sun follows the Rayleigh Jeans law,\n\n  -- -------- -- -------\n     @xmath      (1.6)\n  -- -------- -- -------\n\nwhere we have taken the classical limiting case @xmath . The observed\nwhole Sun emission in Solar Flux Units (sfu, 1\u00a0sfu= @xmath erg s @xmath\ncm @xmath Hz @xmath ) is shown in Figure 1.2 .\n\nMany kinds of bursty radio emission are also seen in association with\nsolar flares and active events, many of which are signatures of fast\nelectron populations. An example of a radio dynamic spectrum is shown in\nFigure 1.3 which displays many of these types simultaneously (Benz, 2004\n) , discussed briefly in the following sections. The high frequency\n(2-4\u00a0GHz) continuum is gyrosynchrotron emission, while the very faint\nvertical stripes around 1-2\u00a0GHz at 9:34:00 are some form of\nquasi-periodic pulsations. Groups of bright Type IIIs \u00b2 \u00b2 2 Type\nclassifications are explained in Section 1.5.3 . occur at 9:35:00 and\n9:36:20 between 300 and 600\u00a0MHz, and a reverse drift burst may be seen\nat 9:35:20 around 2\u00a0GHz. At low frequencies the emission is a\ncombination of Type II (emission associated with shock accelerated\nelectron beams) and Type V (smooth, long duration emission which follows\nType III bursts), although these are indistinct in this figure. The\nbright, short duration emission around 640\u00a0MHz at 9:34:20 may be radio\nspikes.\n\nIn this work we focus on plasma emission at high frequencies from around\n500\u00a0MHz up to several GHz. However, the Type III bursts are observed to\nspan the entire frequency range from several GHz down to low kHz, and\nobservations tend to focus on coronal (10\u00a0MHz to a few hundred MHz) and\nInterplanetary (IP; kHz and low MHz) bursts, as bursts at higher\nfrequencies are much more infrequent. Important implications for the\nhigher frequency bursts are inferred from the lower frequency behaviour,\nbut the parameter regimes are very disparate and some features differ\nsignificantly.\n\nAt metric and decimetric wavelengths, there are also multiple varieties\nof short duration emission. Some of these may be ascribed to a\nparticular emission mechanism, but in many cases the only classification\nis morphological. In general, the factors considered are the bandwidth,\nduration, drift rate, substructures and general shape (Benz, 2004 ) .\n\n#### 1.5.1 Coherent and Incoherent Emission\n\nIncoherent emission refers to emission by individual particles\nindependently. The thermal free-free emission which produces the quiet\nSun background is of this type, as is another important mechanism,\ngyrosynchrotron emission from mildly relativistic electrons (e.g. Dulk,\n1985 ) . This is particularly important in regions of strong magnetic\nfields, and at frequencies of a few to a few tens of GHz, as seen in\nFigure 1.3 .\n\nCoherent emission, in contrast, arises from plasma collective effects,\nand therefore emission occurs at either the electron plasma frequency\n@xmath , the electron cyclotron frequency @xmath , the ionic equivalents\n@xmath , or their harmonics. The exciting waves are generally produced\ndue to a plasma instability, and so coherent emission indicates the\npresence of fast electrons, shocks, etc. The high frequency cutoff for\nobservable coherent emission associated with flares is probably around\n10\u00a0GHz (Benz, 2004 ) .\n\n#### 1.5.2 The Plasma Emission Mechanism\n\nPlasma emission is a coherent emission mechanism in which\nelectromagnetic radiation is produced from Langmuir waves, and is the\ntopic of Chapter 4 of this thesis. The key feature is the involvement of\nLangmuir waves, generated by fast electrons, and so the emission occurs\nat the plasma frequency or its second harmonic. The proposed plasma\nemission mechanism is summarised in the books by Melrose ( 1980b );\nTsytovich ( 1995 ) , although refinements and modifications are being\ncontinually suggested (e.g. Robinson et\u00a0al., 1994 ; Melrose, 2009 ;\nTsiklauri, 2011 ) . Reviews of the currently accepted mechanism etc are\ngiven by e.g. Dulk ( 1985 ); Bastian et\u00a0al. ( 1998 ); Nindos et\u00a0al. (\n2008 ); Melrose ( 2009 ) .\n\nThe outline of the mechanism is summarised in the flowchart in Figure\n1.4 . An electron beam propagating though the coronal or solar wind\nplasma generates Langmuir waves, and these in turn evolve, either\ndecaying to ion-sound waves or scattering off plasma ions, both of which\ngenerate backwards propagating (negative wavenumber) Langmuir waves.\nThese may then coalesce with a wave from the forwards spectrum to\nproduce an electromagnetic wave at twice the plasma frequency.\nAlternatively, an ion sound wave and a Langmuir wave may coalesce, or a\nLangmuir wave may be scattered by an ion directly into an\nelectromagnetic wave, both of which produce emission at the local plasma\nfrequency.\n\n#### 1.5.3 Radio Burst Classifications\n\nHistorically, three types of bright, transient radio bursts were known,\nand these were labelled Types I through III in order of increasing rate\nof frequency drift @xmath . A schematic dynamic spectrum is shown in\nFigure 1.5 , which also includes the later added Type IV and V bursts,\nand some continuum emissions.\n\nThe origins of Type I emission are not yet certain, while Types II, III\nand V are due to propagating accelerated electrons. The Type II exciting\nbeams are accelerated in shocks, so the emission drifts slowly as the\nshock front moves. Type III exciting beams are accelerated in\nassociation with flares and move very rapidly, giving fast drifting\nbursts. Type V emission may be directly associated with a slow electron\nbeam, or may be due to Langmuir waves \u201cleft behind\u201d after the beam has\npassed (Kontar, 2001a ) . Type IV emission has several subtypes, all due\nto emission from trapped electrons, either via the plasma mechanism or\nincoherent gyrosynchrotron emission.\n\n#### 1.5.4 Type III Bursts\n\nType III radio bursts are the classic example of plasma emission from a\npropagating electron stream, and display many characteristic features,\nwhich are discussed in the following sections. Figure 1.6 shows a radio\ndynamic spectrum of a group of Type IIIs which displays several of these\nfeatures, and Figure 1.7 an expanded view of a Type III around 80\u00a0MHz\nshowing the frequency drift.\n\n##### Frequency Drift\n\nThe electron beams which generate Type III bursts propagate at a\nsignificant fraction of the speed of light, generally between 0.1 and\n0.6 @xmath . The beam therefore encounters plasma with a density, and\nhence plasma frequency, which is rapidly changing. An empirical relation\nfor the frequency drift rates of Type IIIs is @xmath for @xmath the\nfrequency in MHz and @xmath the drift in MHz\u00a0s @xmath (Alvarez &\nHaddock, 1973 ; McLean & Labrum, 1985 ) for bursts between 550\u00a0MHz and\n74\u00a0kHz. This corresponds to a value of about 900\u00a0MHz\u00a0s @xmath at 500\u00a0MHz\nand 170\u00a0MHz\u00a0s @xmath at 200\u00a0MHz.\n\n##### Brightness\n\nThe classic Type III bursts are characterised by very high brightness\ntemperatures, with the maximum observed @xmath being of the order of\n@xmath K and occurring at 1\u00a0MHz. For higher frequencies, typical\nmeasured brightness temperatures at 40\u00a0MHz are @xmath K, dropping to\nonly @xmath K by 169\u00a0MHz, while the brightest are @xmath K and @xmath K\nrespectively. For lower frequency IP bursts typical brightnesses at\n100\u00a0kHz are @xmath K and the brightest are around @xmath K (e.g. McLean\n& Labrum, 1985 ) . At very high frequencies bursts are rarer and less\nbright, reaching perhaps @xmath K at a few GHz.\n\n##### Source Sizes\n\nSource sizes steadily increase with decreasing frequency from a few\nhundred MHz down to kHz frequencies, measuring around @xmath at 169\u00a0MHz,\n@xmath at 43\u00a0MHz (e.g. McLean & Labrum, 1985 ) and around @xmath at\n1\u00a0MHz and @xmath at 100\u00a0kHz (Steinberg et\u00a0al., 1985 ) . At 432 MHz,\nSaint-Hilaire et\u00a0al. ( 2013 ) find sizes of @xmath .\n\n##### Harmonic Structure\n\nAt frequencies in the MHz and kHz ranges, the bursts may be observed in\nFundamental-Harmonic (F-H) pairs, occurring very close to @xmath and\n@xmath respectively. The exact observed F-H ratio is generally slightly\nbelow @xmath , explained by the time delay of the fundamental due to its\nlower group velocity. For example, Wild et\u00a0al. ( 1954 ) found a ratio\nbetween 1.85 and 2.0, while Stewart ( 1974 ) found a range from 1.6 to\n2.0 with an average of @xmath . The F component is almost never observed\nabove @xmath MHz, and often has a lower starting frequency than the\nharmonic, so that the ratio of their onset frequencies is closer to\n@xmath or @xmath (Suzuki & Sheridan, 1977 ) .\n\n##### Time Profile\n\nThis difference in starting frequency suggests that there are\nsignificant differences in the emission mechanisms that produce the F\nand H components, which is confirmed by measurements of their time\nprofiles and polarisation. At a single frequency, the emission shows a\ncharacteristic rapid rise and slow fall off, with different time\nconstants for the fundamental and harmonic components. Originally, the\ndecay phase was thought to be due purely to the collisional damping of\nthe Langmuir waves. However, Aubier & Boischot ( 1972 ) studied the\nrise-decay profiles of multiple bursts and found the two times were\ncorrelated, implying that the excitation continues alongside the decay.\n\nFor the harmonic component, collisional decay of Langmuir waves may be\nless important than their spectral evolution (Zhelezniakov & Zaitsev,\n1975 ) , as the emission can only occur for waves with sufficiently\nlarge wavenumber, and for fundamental emission involving ion-sound waves\nthe damping rate of these will also be important. Empirical estimates of\nthe decay rate were given by Alvarez & Haddock ( 1973 ) for kilometric\nwavelengths and confirmed for higher frequencies by e.g. Benz et\u00a0al. (\n1992 ) .\n\n##### Polarisation\n\nFundamental emission is observed to be O-mode polarised (see Section\n1.2.2 ) with a degree of polarisation anywhere from 0 up to @xmath .\nPolarisations below @xmath are rarer, and completely polarised emission\nis never seen (e.g Suzuki & Sheridan, 1977 ; Dulk & Suzuki, 1980 ;\nWentzel, 1984 ) . The harmonic is generally weakly O-mode polarised,\nbetween 0 and 30 @xmath and most commonly around 10 % (e.g. Suzuki &\nSheridan, 1977 ) . In F-H pairs the degrees of polarisation of the two\ncomponents are weakly correlated, with the harmonic always lower (e.g\nSuzuki & Sheridan, 1977 ; Dulk & Suzuki, 1980 ) . The degree of\npolarisation is not seen to correlate to the emission frequency, but\ndoes vary with the source location on the solar disk (e.g. Suzuki\net\u00a0al., 1980 ) .\n\n##### Reverse Slope and U or J Type Bursts\n\nIn a normal Type III burst, the beam is accelerated and propagates along\nan open magnetic field line outwards from the Sun, and therefore into\nplasma of decreasing density. Reverse slope (RS) bursts arise when the\nelectron beam propagates downwards along a field line, and thus travels\ninto plasma of increasing density. More complicated magnetic structures\ncan produce J or U type bursts, as seen in Figure 1.8 , where the beam\ntravels along a closed loop and the plasma density gradient, and thus\nthe frequency drift, reverses (e.g. Labrum & Stewart, 1970 ) . N bursts,\nnamed by Caroubalos et\u00a0al. ( 1987 ) are also occasionally seen, when a\nsecond reversal of the gradient occurs probably due to magnetic\nmirroring in the loop footpoints, as seen in the beam simulations by\nKarlicky et\u00a0al. ( 1996 ) .\n\nAs noted in Section 1.3 the location of the acceleration region of the\ngenerating electron beams can also be inferred from simultaneous\nobservations of normal and RS Type III bursts. Occasionally, false pairs\ncan arise due to observational effects, for example terrestrial\ninterference leading to a perfectly symmetric pair (Benz et\u00a0al., 2001 )\n. True pairs occur where two beams are produced, one moving upwards, the\nother downwards, and the emission is observed with opposite drifts and\nvery similar starting frequency (e.g. Robinson & Benz, 2000 ) . The\nexact background density of the acceleration region is then known, from\nwhich the location can be found using a model density profile.\n\n#### 1.5.5 Type V Bursts\n\nAt lower frequencies, 100\u00a0MHz and below, Type III bursts are often\nfollowed by Type V emission, diffuse emission in the tail of the burst.\nDulk et\u00a0al. ( 1980 ) summarise the observed properties of these bursts.\nThey are low frequency, rarely starting above 120\u00a0MHz, and long\nduration, lasting around 200 seconds at 20\u00a0MHz. They generally have a\nlow degree of polarisation, below 10 @xmath , but in contrast to the\naccompanying Type IIIs this is usually in the X-mode. The source sizes\nare usually comparable to Type III sources, and increase rapidly as\nfrequency decreases, while the heights are also similar to those of Type\nIIIs. However their locations are often, although not always, different.\nFinally, their brightness temperatures are also comparable to the\naccompanying Type III bursts. Plasma emission at the second harmonic\nappears to be the origin of Type V bursts, with the difference in\npolarisation between the Type Vs and the preceding Type IIIs explained\nby differences in the emission geometry, as discussed in Section 4.4 and\nWilles & Melrose ( 1997 ) .\n\n### 1.6 Observations of High Frequency Plasma Radio Emission\n\nAt frequencies of a few hundred MHz or more, Type III bursts occur that\nare similar in many respects to the bursts at lower frequencies. The\nmost significant difference is in respect to the harmonic structure,\nwith F-H pairs rarely observed above a few hundred MHz, and never above\n500\u00a0MHz. However the differences in density and temperature, and\nspecifically the ratio of @xmath mean that the mechanism proposed for IP\nbursts, and confirmed through observations of Langmuir, ion-sound and\nelectromagnetic waves, cannot simply be extrapolated to higher\nfrequencies (Benz, 2004 ) . In addition, there are several kinds of\nshort duration emission also ascribed to the plasma mechanism that show\nimportant differences from the lower frequency observations.\n\nIn Chapter 4 of this thesis we consider the simulation of plasma\nemission at GHz frequencies, and so in this section we give more\nspecific details of the features of GHz radio emission. We highlight\nwhere this differs from that at lower frequencies, and what can be\ninferred about the emission mechanism.\n\n#### 1.6.1 Classic Type III Radio Bursts\n\nThe statistical study of Type III bursts extending above 1000\u00a0MHz by\nMel\u00e9ndez et\u00a0al. ( 1999 ) is the most comprehensive of its type, and\nprovides key information about burst behaviour at high frequencies. 160\nbursts were analysed, two-thirds of which had an RS component, and 5\n@xmath of which were bidirectional (both normal and reverse drift\ncomponents). The peak fluxes were generally around 10\u00a0sfu (Solar Flux\nUnits, 1\u00a0sfu= @xmath erg s @xmath cm @xmath Hz @xmath ), and rarely over\n100\u00a0sfu. By 7\u00a0GHz even the maximum fluxes are barely 100\u00a0sfu (e.g. Benz\net\u00a0al., 1992 ) and the emission very rarely exceeds the background. The\ndurations, averaging a few 100\u00a0ms, were shorter than expected from the\nextrapolation of the data for metric bursts, with correspondingly low\nbandwidths of around 200\u00a0MHz.\n\nSource sizes are difficult to obtain at the very high frequencies. At\n432\u00a0MHz, Saint-Hilaire et\u00a0al. ( 2013 ) find values of @xmath , and\nextrapolating their observed trends in the size from 151 to 432 MHz\nsuggests sizes at 1\u00a0GHz of around @xmath . For comparison, the VLA\nobservations of Willson et\u00a0al. ( 1990 ) of unclassified bursts at\n1.4\u00a0GHz give source sizes around @xmath .\n\nFor comparison, bursts at 169\u00a0MHz have typical fluxes between 10 and a\nfew hundred sfu, which we note is significantly over the thermal level\ndue to the frequency dependence of this, shown in Figure 1.2 . They have\ndurations of a few seconds and source sizes around @xmath (Bougeret\net\u00a0al., 1970 ) .\n\nThe empirical formula for the burst durations given by Alvarez & Haddock\n( 1973 ) for kilometric wavelengths, and for higher frequencies by Benz\net\u00a0al. ( 1992 ) was shown by Mel\u00e9ndez et\u00a0al. ( 1999 ) not to apply at\nvery high frequencies. Instead the relation is given empirically by\n@xmath for @xmath the duration in ms and @xmath the emitting frequency\nin MHz. The relation found by Elgaroy & Lyngstad ( 1972 ) for bursts at\na few 100\u00a0MHz also overestimates the duration by a factor of 2 or more.\n\nThe lack of F-H pairs above 500\u00a0MHz and the difference in starting\nfrequency of the two components at lower frequencies suggest that that\nthere are significant differences in the emission mechanisms producing\nthe two components. Further evidence is offered by the polarisation of\nthe emission. Generally plasma emission occurs in regions where the\nmagnetic field is weak, and thus we can ignore its effects on the\nemission rates. However, because in magnetised plasma the right and left\nhand circular polarisations have different group velocities and\nlow-frequency cutoffs (see Section 1.2.2 ), polarised emission can be\ngenerated due to propagation effects.\n\nAs noted in the previous section, fundamental emission is observed to be\nO-mode polarised with a degree of polarisation anywhere from 0 up to\n@xmath in some cases, while the harmonic is generally weakly O-mode\npolarised, between 0 and 30 @xmath . Taking this together with the\npolarisation statistics from Ma et\u00a0al. ( 2012 ) in the range\n600-1500\u00a0MHz which suggest average values of around 20 @xmath , suggests\nthat the only observed component at high frequencies is the harmonic.\nThis supports the discussion in Section 4.6.4 where it is found that\nonly harmonic emission is able to escape dense parts of the corona. A\nfinal interesting feature of polarisation is a tendency at high\nfrequencies for polarisation degree to increase with frequency, which\ncan be explained by varying magnetic field strength (Mercier, 1990 ) .\n\n#### 1.6.2 Other Plasma Emission\n\nVarious spike-type emissions, characterised generally by their short\nduration and narrow bandwidths, are observed in the corona at high MHz\nand GHz frequencies (e.g. Guedel & Benz, 1988 ; Allaart et\u00a0al., 1990 ;\nIsliker & Benz, 1994 ) . The emission mechanism is inferred from the\nobserved characteristics and their correlations with better known types\nof emission. For example, one class of spikes at decimetric wavelengths\n(DCIM), are ascribed to electron-cyclotron maser emission primarily on\nthe basis of their frequency and polarisation, and occasionally observed\nharmonic structure (e.g. Guedel & Benz, 1990 ; Fleishman & Yastrebov,\n1994 ; Bastian et\u00a0al., 1998 ) .\n\nSome of these spike events may be generated by plasma emission from\nLangmuir waves, which provides another interesting direction for\nsimulations of plasma emission. Theoretically spikes are even more\nchallenging than Type III bursts due to their more complex structures.\nOn the other hand, if we have fast electrons and an instability to\nLangmuir wave generation we may expect that we should observe plasma\nemission, and can give analytical estimates of its minimum brightness.\nThe absence of emission is therefore also informative.\n\nTwo examples of high frequency, short duration emission which may be\neasily ascribed to the plasma emission mechanism are given by the\n\u201cblips\u201d of Benz et\u00a0al. ( 1983 ) at frequencies from 500\u00a0MHz to the low\nGHz range, which are similar in several respects to Type IIIs at MHz\nfrequencies and are now known as \u201cNarrowband Type IIIs\u201d (Guedel & Benz,\n1988 ) , and the \u201cmicrowave Type IIIs\u201d observed at 3-5\u00a0GHz by Staehli &\nBenz ( 1987 ) again similar to Type III emission. The latter have\ndurations of only 20-200\u00a0ms, which is however consistent with the\nempirical result of Alvarez & Haddock ( 1973 ) when adjusted for\nfrequency. Both of these have similar bandwidths, polarisations and\nfrequency drifts.\n\nNarrow-band Type IIIs at frequencies of 1-2\u00a0GHz were also studied by\nJi\u0159i\u010dka et\u00a0al. ( 2001 ) . These have bandwidths of around 150\u00a0MHz and\ntotal duration approximately 1 second, and are observed equally often as\nsingle bursts or in groups. They are identical to Type IIIs in drift\nrates, brightnesses, duration at a single frequency etc, differing only\nin bandwidth and therefore total duration. The statistical study of\nMel\u00e9ndez et\u00a0al. ( 1999 ) discussed above also includes these narrow\nbandwidth emissions.\n\n## Chapter 2 Langmuir Wave Diffusion in Inhomogeneous Plasma\n\n### 2.1 Introduction\n\nFast electron beams occur in many plasma physics contexts, from lab\nexperiments to solar flares. These beams can become unstable to the\ngeneration of Langmuir waves, in which case energy is transferred from\nthe beam into the waves and the instantaneous beam distribution will be\nchanged. If no other evolution occurs, these Langmuir waves are later\nreabsorbed by electrons at the same velocity as they were emitted, so\nthere is no net effect on the particle distribution (Hamilton &\nPetrosian, 1987 ; McClements, 1987 ) . However, as we will show in this\nchapter and the next, redistribution of the Langmuir waves in wavenumber\nspace can act to redistribute energy between electrons at different\nvelocities, which can lead to electron acceleration.\n\nIn the Sun, the fast electron beams accelerated during reconnection in\nsolar flares are known to produce Langmuir waves if the distribution\nattains a reverse-slope in velocity (see Section 1.4.1 ). Spectral\nevolution of these Langmuir waves can occur due to density variations in\nthe plasma, due to either wavemodes with wavelengths comparable to the\nDebye length (e.g Vedenov et\u00a0al., 1967 ; Goldman & Dubois, 1982 ; Yoon\net\u00a0al., 2005 ) , or longer wavelength inhomogeneities (e.g. Ryutov, 1969\n; Nishikawa & Ryutov, 1976 ; Smith & Sime, 1979 ; Kontar, 2001a ; Kontar\net\u00a0al., 2012 ) . Here we consider the treatment of the effects of long\nwavelength plasma density fluctuations using a new method based on a\ndiffusion equation.\n\nWhen an electron beam propagates into plasma of increasing or decreasing\ndensity, the generated Langmuir waves will be shifted towards smaller or\nlarger wavenumbers respectively. A randomly fluctuating density will\nlead to alternating shifts of the Langmuir waves to smaller and larger\nwavenumbers, and as we will show, when this is averaged over the\nensemble of fluctuations it results in diffusion of the Langmuir waves\nin wavenumber space.\n\nIn this chapter we develop a mathematical treatment of this diffusion\nprocess in both one and three dimensions. We first show the derivation\nof the diffusion equation and diffusion coefficients, then give examples\nof their functional form for different density fluctuation spectra. We\nend with a brief theoretical discussion of the effects of wavenumber\ndiffusion on the Langmuir waves and electrons. This work has been\npublished in Ratcliffe et\u00a0al. ( 2012 ) .\n\n### 2.2 Beam-Wave Interactions\n\nIn this work we address the problem of beam-plasma wave interactions in\nthe solar corona and wind. As discussed in Section 1.4.1 , the effects\nof the magnetic field on the electron-wave interactions are negligible\nas we are generally in the weak-field limit, @xmath , but the electron\nbeam must propagate along the magnetic field lines. Moreover, the beam\ndensities observed are often relatively small and so the situation is\nhandled well by the quasilinear approximation. We use equations based on\nthose given in e.g. Drummond & Pines ( 1964 ); Vedenov et\u00a0al. ( 1962 );\nVedenov & Velikhov ( 1963 ); Vedenov et\u00a0al. ( 1967 ); Tsytovich ( 1995 )\n, and add the effects of collisions, and wave-wave interactions, as\nnecessary.\n\nIn this chapter, we will consider the Langmuir wave evolution in both\none and three dimensions. However, in our simulations of the beam-plasma\ninteraction we use a 1-dimensional model, and neglect the effects of\nparticle transport. The physical situations where this model is\napplicable are discussed in Section 3.3 .\n\nIn this 1-dimensional model we write the electron distribution function\nas @xmath [electrons cm @xmath (cm\/s) @xmath ] and the spectral energy\ndensity of Langmuir waves at wavenumber @xmath as @xmath [ergs cm @xmath\n] respectively. These are normalised so that\n\n  -- -------- -- -------\n     @xmath      (2.1)\n  -- -------- -- -------\n\nwith @xmath the plasma density in cm @xmath and\n\n  -- -------- -- -------\n     @xmath      (2.2)\n  -- -------- -- -------\n\nthe total energy density of the waves in erg cm @xmath . The equations\ndescribing the electron-Langmuir wave interaction are\n\n  -- -------- -- -------\n     @xmath      (2.3)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (2.4)\n  -- -------- -- -------\n\nwhere @xmath is the local plasma frequency and @xmath the local plasma\ndensity.\n\nThe two terms on the right-hand side of the second equation correspond\nto spontaneous and stimulated emission of Langmuir waves respectively.\nThis emission (and the corresponding absorption) is resonant, meaning an\nelectron at velocity @xmath interacts only with a wave at wavenumber\n@xmath , or alternately that the particle velocity @xmath and the phase\nspeed of the wave, given by @xmath , are equal. This is the Cerenkov or\nVavilov-Cherenkov condition, and the equations are derived in the limit\nof a particle in constant rectilinear motion. We note that this requires\nthat the particles are unmagnetised, i.e the effects of magnetic field\non their motion are negligible.\n\nIn addition, we are restricted to the weak turbulence limit, where the\nenergy in Langmuir waves is far less than the energy of the background\nplasma, i.e.\n\n  -- -------- -- -------\n     @xmath      (2.5)\n  -- -------- -- -------\n\nFor beam generated Langmuir waves this leads to a restriction on the\nbeam density, but this is easily satisfied for the beam densities we\nconsider here.\n\nIt is easily seen that the electron distribution becomes unstable to the\ngeneration of Langmuir waves when @xmath . This may occur due to time of\nflight effects, where fast electrons overtake the slower ones, or it can\nbe due to collisional relaxation (discussed later in Section 3.3 ), as\nthe collision rate is roughly proportional to @xmath , and a \u201cgap\u201d\ndistribution (Melrose, 1975 ; Wentzel, 1985 ) can be produced from an\ninitially power-law beam (e.g. Emslie & Smith, 1984 ) .\n\nThe timescale for this beam-wave interaction can be found from Equation\n2.4 , and is known as the quasilinear time. We use the condition @xmath\nand approximate\n\n  -- -------- -- -------\n     @xmath      (2.6)\n  -- -------- -- -------\n\nAssuming a Maxwellian beam, with velocity @xmath , width @xmath and\ndensity @xmath , given by\n\n  -- -------- -- -------\n     @xmath      (2.7)\n  -- -------- -- -------\n\nwe find @xmath and evaluate the equation for a velocity of @xmath . The\nresult is\n\n  -- -------- -- -------\n     @xmath      (2.8)\n  -- -------- -- -------\n\n### 2.3 A Diffusion Treatment in 1-Dimension\n\nThe second term on the left-hand side of Equation 2.4 gives the effects\nof density gradients on the Langmuir waves. In the case of a constant\ndensity gradient (e.g. Kontar, 2001a ) this term becomes\n\n  -- -------- -- -------\n     @xmath      (2.9)\n  -- -------- -- -------\n\nwhere @xmath is the change in density over the scale length @xmath , and\nthe sign is positive for a decreasing density and negative for an\nincreasing one. We immediately see that an increasing gradient will\nshift the Langmuir waves to smaller wavenumbers, and vice versa, while\nalternating gradients will cause alternating shifts in wavenumber. In\nthe next section we will see that this leads to a diffusion of the\nLangmuir waves in wavenumber space.\n\n#### 2.3.1 The Diffusion Equation\n\nWe write the plasma density as\n\n  -- -------- -- --------\n     @xmath      (2.10)\n  -- -------- -- --------\n\nwith @xmath the constant background density and @xmath the relative\ndensity fluctuation. This relative fluctuation is assumed to be weak,\ni.e. @xmath , and long wavelength, @xmath , conditions often satisfied\nby the density perturbations the solar corona and the solar wind (see\nSection 1.1.4 ).\n\nThe conditions of weak, long-wavelength fluctuations mean the fractional\nchange in Langmuir wavenumber is small,\n\n  -- -------- -- --------\n     @xmath      (2.11)\n  -- -------- -- --------\n\nand so we can make the WKB, or geometric optics, approximation. The\nlong-wavelength condition also allows us to treat the Langmuir waves as\nquasi-particles, averaging over their spatial and time scales, which are\nfar shorter than those for the density fluctuations. In this case, we\ncan describe the wave motion using standard equations of motion\ndescribing their propagation and their momentum (equivalent to\nwavenumber) change due to the action of a density gradient. These\nequations are (e.g. Whitham, 1965 ; Vedenov et\u00a0al., 1967 ; Zakharov,\n1974 )\n\n  -- -------- -- --------\n     @xmath      (2.12)\n  -- -------- -- --------\n\n  -- -------- -- --------\n     @xmath      (2.13)\n  -- -------- -- --------\n\nwhere @xmath is the Langmuir wavenumber, @xmath their group velocity,\ngiven by @xmath and @xmath is the \u201cforce\u201d acting on the waves due to the\ndensity gradients, which for Langmuir waves is given by\n\n  -- -------- -- --------\n     @xmath      (2.14)\n  -- -------- -- --------\n\nThese equations are equivalent to the conservation equation describing\nthe evolution of the spectral energy density @xmath\n\n  -- -------- -- --------\n     @xmath      (2.15)\n  -- -------- -- --------\n\nAs noted above, we neglect the effects of spatial transport, i.e. a term\n@xmath . For convenience we also omit the source terms due to electrons\non the right-hand side (see Equation 2.4 ) during this derivation.\n\nFrom Equation 2.12 we can see that a random force, as arises due to\nrandom density fluctuations, will result in random changes in the\nLangmuir wavenumber and subsequently a diffusion of the Langmuir waves\nin wavenumber space. We can derive the equation describing this process\nvia standard procedures (e.g. Vedenov & Velikhov, 1963 ; Sturrock, 1966\n) , the outline of which follows.\n\nWe decompose the spectral energy density of Langmuir waves @xmath into\nthe sum of its average and fluctuating parts @xmath and substitute this\nexpression into Equation 2.15 to obtain\n\n  -- -------- -- --------\n     @xmath      (2.16)\n  -- -------- -- --------\n\nWe then average this, and use the facts that, by assumption @xmath and\nby definition @xmath . The result is\n\n  -- -------- -- --------\n     @xmath      (2.17)\n  -- -------- -- --------\n\nSubtracting this from Equation 2.16 gives\n\n  -- -------- -- --------\n     @xmath      (2.18)\n  -- -------- -- --------\n\nThis becomes\n\n  -- -------- -- --------\n     @xmath      (2.19)\n  -- -------- -- --------\n\nby neglecting the term containing the product of the fluctuation @xmath\nand the force @xmath as these are both small. Neglecting these products\nis the key feature of the quasilinear approximation.\n\nIntegrating the equation for the fluctuations, Equation 2.19 , gives\n\n  -- -- -- --------\n           (2.20)\n  -- -- -- --------\n\nwhich is substituted into Equation 2.17 to give the equation describing\nthe diffusion of wave energy in @xmath -space:\n\n  -- -------- -- --------\n     @xmath      (2.21)\n  -- -------- -- --------\n\nwhere @xmath is the diffusion coefficient. Now we may drop the notation\n@xmath for the average, and instead write simply\n\n  -- -------- -- --------\n     @xmath      (2.22)\n  -- -------- -- --------\n\n#### 2.3.2 The Diffusion Coefficient\n\nThe diffusion coefficient @xmath in Equation 2.22 is given by\n\n  -- -------- -- --------\n     @xmath      (2.23)\n  -- -------- -- --------\n\nwhere @xmath denotes the auto-correlation function of the force @xmath .\nIn practice it is often useful to express this in terms of the spectrum\nof the density fluctuations that are producing the force.\n\nTo do this, we Fourier transform @xmath in the the auto-correlation\nfunction,\n@xmath , from space and time, @xmath , to wavenumber and frequency,\ndenoted @xmath , using the definition\n\n  -- -------- -- --------\n     @xmath      (2.24)\n  -- -------- -- --------\n\nand find\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (2.25)\n  -- -------- -------- -- --------\n\nwhere @xmath . We assume the force is stationary (auto-correlation does\nnot vary in time) and homogeneous (auto-correlation does not vary in\nspace), and so the auto-correlation can depend only on the differences\n@xmath . We therefore require @xmath and so the spectrum of the force,\n@xmath , must be given by\n\n  -- -------- -- --------\n     @xmath      (2.26)\n  -- -------- -- --------\n\nand the diffusion coefficient is\n\n  -- -------- -- --------\n     @xmath      (2.27)\n  -- -------- -- --------\n\nThen using the definition\n\n  -- -------- -- --------\n     @xmath      (2.28)\n  -- -------- -- --------\n\nthis becomes\n\n  -- -------- -- --------\n     @xmath      (2.29)\n  -- -------- -- --------\n\nFinally, we relate the spectrum of the force to the spectrum of density\nfluctuations, @xmath . The force on Langmuir waves is @xmath and so its\ncorrelation function, assuming @xmath from the conditions of\nstationarity and homogeneity, is @xmath . Then using the Wiener\nKhintchine theorem (a standard result in Fourier theory), which says\nthat\n\n  -- -------- -- --------\n     @xmath      (2.30)\n  -- -------- -- --------\n\ntwice we find that\n\n  -- -------- -- --------\n     @xmath      (2.31)\n  -- -------- -- --------\n\nThe diffusion coefficient is therefore finally\n\n  -- -------- -- --------\n     @xmath      (2.32)\n  -- -------- -- --------\n\nwhere by definition\n\n  -- -------- -- --------\n     @xmath      (2.33)\n  -- -------- -- --------\n\nThe delta function, @xmath implies that this is a resonant interaction,\nwhile the factor of @xmath means that fluctuations at large wavenumbers,\ni.e. small spatial scales, will have a more significant effect than\nthose at longer wavelengths.\n\n#### 2.3.3 Wave Modes\n\nIn the previous section we outlined a standard mathematical derivation\nof a diffusion equation describing the effects of a fluctuating force\nwith arbitrary wavenumber and frequency, @xmath and @xmath respectively.\nNow we develop this theory, firstly to consider fluctuations due to a\ncompressive wave mode, for which these must be related by the wave\ndispersion relation, @xmath , and in the next section to find the\ncoefficient for specific fluctuation spectra. To incorporate the\nrestriction @xmath we define the spectrum as @xmath so that\n\n  -- -------- -- --------\n     @xmath      (2.34)\n  -- -------- -- --------\n\nSubstituting this into Equation 2.32 then gives\n\n  -- -------- -- --------\n     @xmath      (2.35)\n  -- -------- -- --------\n\nBecause of the delta function @xmath , we have some constraints on the\nwave modes we can consider in this model. For example, ion-sound waves\nhave a dispersion relation which is approximately @xmath , which would\nimply that the diffusion coefficient is non-zero only where @xmath , i.e\nat a single value of the Langmuir wavenumber. However, other wave modes\nmay be of interest, as are fluctuations with arbitrary spectrum.\n\n#### 2.3.4 The Diffusion Coefficient for Specific Spectra\n\nUsing Equation 2.32 we may evaluate the diffusion coefficient for some\ncommon density fluctuation spectra, and examine how this affects its\nfunctional form.\n\n##### Random Fluctuations\n\nIf we assume fluctuations that are random in space and time, their\ncorrelation function is Gaussian, and therefore from Equation 2.30 so is\nthe fluctuation spectrum. Taking a spectrum given by\n\n  -- -------- -- --------\n     @xmath      (2.36)\n  -- -------- -- --------\n\nwhere @xmath and @xmath are characteristic wavenumber and frequency,\nnormalised so that\n\n  -- -------- -- --------\n     @xmath      (2.37)\n  -- -------- -- --------\n\nthe diffusion coefficient reads\n\n  -- -------- -- --------\n     @xmath      (2.38)\n  -- -------- -- --------\n\nwhere @xmath is the characteristic velocity of the fluctuations.\n\nWe see immediately that for these random fluctuations there will be two\ndistinct regimes of diffusion, depending on whether the density\nfluctuation characteristic velocity @xmath is much larger than the\nLangmuir wave group velocity @xmath or vice versa.\n\nIn the former case, i.e @xmath , the diffusion coefficient becomes\n\n  -- -------- -- --------\n     @xmath      (2.39)\n  -- -------- -- --------\n\nand is independent of @xmath and therefore of the Langmuir wavenumber,\n@xmath . This case of a constant diffusion coefficient drives the system\ntowards the steady state of a flat Langmuir wave spectrum.\n\nIn the other extreme, i.e. @xmath , the coefficient is\n\n  -- -------- -- --------\n     @xmath      (2.40)\n  -- -------- -- --------\n\nand the diffusion is strongly dependent on the wavenumber @xmath .\nAssuming that initially @xmath is not everywhere zero then the steady\nstate solution, @xmath is proportional to @xmath , with more wave energy\nat large wavenumbers than the thermal case.\n\n##### A Power-law Fluctuation Spectrum\n\nAlso of interest are fluctuations with a turbulent power-law spectrum in\nwavenumber at a single characteristic frequency, @xmath with spectrum\n\n  -- -------- -- --------\n     @xmath      (2.41)\n  -- -------- -- --------\n\nfor @xmath and zero elsewhere, with spectral index @xmath . The lower\nlimit on @xmath is necessary for normalisation. Fluctuations of this\ntype have been observed in the solar wind (e.g. Cronyn, 1972 ; Celnikier\net\u00a0al., 1983 ; Robinson, 1983 ) , with spectral index around @xmath ,\nand were included in simulations of beam-wave interactions by Reid &\nKontar ( 2010 ) (see Section 1.4.2 ).\n\nThe diffusion coefficient is now\n\n  -- -------- -- --------\n     @xmath      (2.42)\n  -- -------- -- --------\n\nA power law index of @xmath will again lead to a constant diffusion\ncoefficient.\n\n### 2.4 Diffusion in 3-Dimensions\n\nIn many cases we wish to consider density fluctuations which are\nisotropic or angularly varying, and therefore we must treat the\nsituation in 3-D. In the 3-dimensional treatment the Langmuir wavenumber\nbecomes a wave vector , and the density fluctuation induced diffusion is\nnow able to change both its magnitude and orientation. The restrictions\non wave dispersion relation due to the condition @xmath found in 1-D are\nrelaxed in 3-D, allowing us to explicitly consider wave modes such as\nion-sound waves.\n\nPreviously, treatments of Langmuir wavenumber diffusion (e.g. Nishikawa\n& Riutov, 1976 ) were restricted to elastic scattering, where the\nfluctuation frequency is much less than the plasma frequency @xmath ,\nand so is neglected. The Langmuir wave energy is conserved by the\nscattering, and so the Langmuir wavevector can be modified only in\nangle.\n\nHere we derive the diffusion equation and coefficients for the general\ncase, and briefly discuss the differences between this and the elastic\nscattering case. For very low frequency waves the modifications are\nnegligible, but they are important in some cases. For ion-sound waves\nthe corrections due to inelasticity are small but non-zero, while for\nfluctuations with arbitrary frequency (rather than an explicit\ndispersion relation, @xmath ) and high frequency components the\ncorrections may be large.\n\n#### 2.4.1 The Diffusion Equation\n\nThe conservation equation for the 3-dimensional wave spectral energy\ndensity @xmath [erg], analogous to Equation 2.15 is\n\n  -- -------- -- --------\n     @xmath      (2.43)\n  -- -------- -- --------\n\nwhere @xmath is the group velocity, and the total energy density of the\nwaves is given by\n\n  -- -------- -- --------\n     @xmath      (2.44)\n  -- -------- -- --------\n\nWe proceed as above, again neglecting the spatial transport term, to\nfind the 3-dimensional diffusion equation,\n\n  -- -------- -- --------\n     @xmath      (2.45)\n  -- -------- -- --------\n\nThe coefficient is now a tensor, and is given in the general case by\n\n  -- -- -- --------\n           (2.46)\n  -- -- -- --------\n\nwhere @xmath is the spectrum of the density fluctuations. This spectrum\nis normalised so that\n\n  -- -------- -- --------\n     @xmath      (2.47)\n  -- -------- -- --------\n\nFor wave modes, with dispersion relation @xmath , we write @xmath and\nfind\n\n  -- -------- -- --------\n     @xmath      (2.48)\n  -- -------- -- --------\n\nHere we have a dot product @xmath , and therefore additional freedom to\nspecify a dispersion relation and still satisfy the resonant condition\n@xmath . So for example we may put @xmath as is the case for ion-sound\nwaves and still satisfy the condition @xmath for more than one value of\nthe group velocity. This may be contrasted with Section 2.3.3 where we\nhad @xmath which strongly restricted the possible wave dispersion\nrelations.\n\n#### 2.4.2 Diffusion in Spherical Coordinates\n\nIn the elastic scattering approximation previously considered in the\nliterature (e.g. Nishikawa & Ryutov, 1976 ; Goldman & Dubois, 1982 ;\nMuschietti et\u00a0al., 1985 ) , diffusion occurs in angle only, and the\nproblem is very easily treated using spherical polar coordinates. In our\nmore general case the diffusion tensor will have additional angular and\nmagnitude components. However, for the problem of beam-wave\ninteractions, and many other cases of interest, we may assume azimuthal\nsymmetry, so there is no diffusion in azimuth and the spherical\ncoordinate expression remains a useful simplification.\n\nWe begin by defining two sets of coordinates, one Cartesian and one\nspherical, as illustrated in Figure 2.1 . We can then transform the\ndiffusion equation and its coefficients. In Cartesian coordinates, we\ndefine one axis to be parallel to the beam direction, labelled as @xmath\n, and two mutually perpendicular axes labelled, @xmath , giving a\nstandard right-handed Cartesian coordinate system. In our spherical\ncoordinate system, @xmath is the angle to the beam direction, and @xmath\nthe azimuth, measured clockwise around the beam direction. We now have\nthe two equivalent representations of the Langmuir wavevector, namely\n@xmath and @xmath .\n\n##### The Diffusion Equation in Spherical Coordinates\n\nEquation 2.45 can also be written as\n\n  -- -------- -- --------\n     @xmath      (2.49)\n  -- -------- -- --------\n\nwhere @xmath denotes the diffusion tensor and @xmath is the gradient\noperator in @xmath space. Then using the definitions of @xmath and\n@xmath in spherical coordinates, and the assumption of azimuthal\nsymmetry which implies there can be no diffusion in @xmath we find\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (2.50)\n  -- -------- -------- -- --------\n\n##### The Components of @xmath\n\nThe diffusion coefficients @xmath in Equation 2.4.2 are derived from the\nCartesian components (Equation 2.46 or 2.48 ) using standard tensor\ncoordinate transforms. For a given Langmuir wavevector @xmath , using\nthe assumption of azimuthal symmetry, we may define coordinates such\nthat the azimuth of @xmath is zero. Then taking @xmath as an example, we\nfind\n\n  -- -------- -- --------\n     @xmath      (2.51)\n  -- -------- -- --------\n\nComparing this with the Cartesian expression in Equation 2.46 , we see\nthat by defining the new quantities\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (2.52)\n     @xmath   @xmath      (2.53)\n     @xmath   @xmath      (2.54)\n  -- -------- -------- -- --------\n\nwe may write simply\n\n  -- -------- -- --------\n     @xmath      (2.55)\n  -- -------- -- --------\n\nwhere @xmath and @xmath stands for @xmath and @xmath .\n\n##### Evaluating the Diffusion Coefficients\n\nEquation 2.55 is entirely general, but in many cases cannot be\nevaluated. One significant simplification is to introduce an isotropic\nwave dispersion relation @xmath . The spectrum is then @xmath and\nEquation 2.55 becomes\n\n  -- -------- -- --------\n     @xmath      (2.56)\n  -- -------- -- --------\n\nIn what follows, we introduce the notation @xmath to shorten the\nequations. Again, we note that the azimuth of the Langmuir wavevector,\n@xmath , is assumed to be zero. We evaluate the dot product,\n\n  -- -------- -- --------\n     @xmath      (2.57)\n  -- -------- -- --------\n\nand use the delta function to integrate over @xmath . This gives us\n\n  -- -------- -- --------\n     @xmath      (2.58)\n  -- -------- -- --------\n\nsubject to the condition\n\n  -- -------- -- --------\n     @xmath      (2.59)\n  -- -------- -- --------\n\nor using Equation 2.57\n\n  -- -------- -- --------\n     @xmath      (2.60)\n  -- -------- -- --------\n\nwhere @xmath , and @xmath .\n\nUsing this we evaluate the components @xmath in Equations 2.52 - 2.54\nfinding\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (2.61)\n     @xmath   @xmath      (2.62)\n     @xmath   @xmath      (2.63)\n  -- -------- -------- -- --------\n\nand so the non-zero diffusion coefficients are\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (2.64)\n                          \n     @xmath   @xmath      \n              @xmath      (2.65)\n  -- -------- -------- -- --------\n\nwhere the limits on the @xmath integrals are the solutions of @xmath i.e\n@xmath (noting that @xmath ).\n\n##### Isotropic Fluctuations\n\nIf we assume the fluctuations are isotropic, i.e. @xmath , then we can\nevaluate the @xmath angular integral and obtain\n\n  -- -------- -- --------\n     @xmath      (2.66)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (2.67)\n  -- -------- -- --------\n\nFrom the resonance condition we have @xmath and so @xmath is always\npositive.\n\n##### Elastic Scattering\n\nWe may recover the result for elastic scattering by setting @xmath ,\nmeaning there is no change in energy due to scattering, in Equations\n2.66 and 2.67 , finding\n\n  -- -------- -- --------\n     @xmath      (2.68)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (2.69)\n  -- -------- -- --------\n\nas given by Muschietti et\u00a0al. ( 1985 ) . Diffusion occurs in angle only,\nat a rate independent of the angle @xmath . Therefore it will tend to\nisotropise the Langmuir wave spectrum.\n\n### 2.5 Effects of Diffusion on Waves and Electrons\n\nThe detailed evolution of the beam-wave system may only be explored\nusing simulations, but we may infer the general behaviour by considering\nthe form of the diffusion coefficients, and looking at the limiting\ncases. We give here a brief theoretical discussion of the simplest\ncases.\n\n#### 2.5.1 1-Dimensional Diffusion\n\nIn 1-D the wave spectrum evolves according to Equation 2.4 ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nConsidering only the diffusion term and assuming a constant diffusion\ncoefficient @xmath , it is clear that the steady state solution is a\nflat Langmuir wave spectrum. The thermal level of Langmuir waves in\ncollisionless plasma (given by Equation 3.5 ) is plotted in Figure 2.2 .\nDiffusion due to density fluctuations will then tend to increase the\nLangmuir wave level at small wavenumbers. The analogous effect at large\nwavenumbers will not be seen, as above @xmath the waves are very rapidly\nLandau damped by the background electrons.\n\nWhen we include an electron beam generating Langmuir waves, we expect to\nsee spreading of their spectrum in wavenumber and consequently spreading\nof the beam in velocity space. The fraction of the waves which shift to\nsmaller wavenumbers will cause electron acceleration, which we\ninvestigate in the next chapter using numerical simulations.\n\n#### 2.5.2 Beam Aligned Fluctuations\n\nThe 1-dimensional case discussed previously can be derived from the\n3-dimensional equations by a suitable choice of the density fluctuation\nspectrum. We define\n\n  -- -------- -- --------\n     @xmath      (2.70)\n  -- -------- -- --------\n\nwith arbitrary frequency, and the components in Equations 2.53 and 2.52\nbecome @xmath and @xmath and so the diffusion coefficients are, using\nEquation 2.55 , @xmath and\n\n  -- -------- -- --------\n     @xmath      (2.71)\n  -- -------- -- --------\n\nWe may relate the 3-D spectrum to its 1-D counterpart via their\nrespective normalisations, Equations 2.33 and 2.47 , finding @xmath and\nthus we recover the diffusion coefficient as given by Equation 2.32 and\nthe diffusion equation as in Equation 2.22 . This confirms that the\n1-dimensional model discussed above exactly describes the case of beam\nparallel density fluctuations.\n\n#### 2.5.3 Angular Diffusion\n\nFor a well collimated electron beam, the Langmuir waves generated will\nbe confined to the region in wavenumber space given by @xmath . The\neffects of inelastic scattering in 3-D can then be considered in 1-D by\nrewriting Equation 2.4.2 in terms of the independent variables @xmath\nand @xmath where @xmath is the component of the wavevector parallel to\nthe beam direction, given by @xmath , and taking the limit @xmath , or\nequivalently @xmath , to obtain\n\n  -- -------- -- --------\n     @xmath      (2.72)\n  -- -------- -- --------\n\nThe first term here is a diffusion of waves in the parallel direction\ndue to the diffusion in magnitude of the wavenumber, while the second is\nadvection of the waves towards smaller parallel wavenumber caused by the\nangular diffusion. This latter term will be advective only in the limit\n@xmath , which becomes less applicable as angular diffusion proceeds.\nHowever, while the Langmuir wave angular spread remains small, both\nterms will lead to the transfer of energy from waves at larger parallel\nwavenumbers to those at smaller parallel wavenumbers, and therefore\ncause energy transfer from slower to faster electrons, leading to an\nacceleration effect.\n\nAngular diffusion due to elastic scattering (e.g. Nishikawa & Ryutov,\n1976 ; Goldman & Dubois, 1982 ; Muschietti et\u00a0al., 1985 ) has been shown\nto lead to suppression of the beam plasma instability by moving waves\nout of the resonant region in wavenumber space. In most treatments\nhowever, the electron distribution is assumed to be fixed. The\ncombination of angular diffusion and wave absorption is treated as\nsimple absorption with a constant coefficient, and the energy\ntransferred to electrons due to this absorption is ignored.\n\nFrom Equation 2.72 we may infer that in fact this energy reabsorption\ncan lead to electron acceleration and the formation of high energy tails\nin the electron distribution. The 3-D PIC simulations by Karlick\u00fd &\nKontar ( 2012 ) consider the effects of Langmuir wave scattering due to\nwave-wave interactions, and confirm that in this case, the reabsorption\nby the electrons of Langmuir waves at smaller wavenumbers indeed leads\nto an acceleration effect.\n\nWe can compare the effects of magnitude and angular diffusion by\nevaluating the diffusion coefficients in Equations 2.66 and 2.67 using a\nsimple example spectrum. We take\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (2.73)\n              @xmath      \n  -- -------- -------- -- --------\n\nwith @xmath a constant giving proper normalisation, and a dispersion\nrelation @xmath . We find the ratio of the coefficients to be\n\n  -- -------- -- --------\n     @xmath      (2.74)\n  -- -------- -- --------\n\nThen for plasma with equal ion and electron temperatures, @xmath and\nfluctuations with a velocity @xmath the sound speed, this ratio is\napproximately @xmath for beam generated Langmuir waves at wavenumbers\naround @xmath , and @xmath at @xmath . We therefore expect that\ncontributions from both effects may be visible even for relatively low\nfrequency fluctuations.\n\n#### 2.5.4 Timescales\n\nFinally, we may give some general predictions regarding when the\ndiffusion effects are important, and which effects may dominate. In all\ncases, we have two competing processes in operation: the quasilinear\ninteraction between the electrons and waves, and the diffusive process\ncausing wave evolution. Clearly, the relative importance of these\nprocesses will depend on their timescales. These are, for the former,\nthe quasilinear time (Equation 2.8 ),\n\n  -- -------- -- --------\n     @xmath      (2.75)\n  -- -------- -- --------\n\nand for the latter, the diffusive time which may be approximated as\n\n  -- -------- -- --------\n     @xmath      (2.76)\n  -- -------- -- --------\n\nwith @xmath the characteristic Langmuir wavenumber and @xmath the\nappropriate diffusion coefficient, either for 1-D diffusion (see\nEquation 2.22 ), magnitude diffusion in 3-D (see Equation 2.72 ) or\nconvection due to angular diffusion in 3-D (see Equation 2.72 )\nrespectively.\n\nWe expect the diffusive process to be significant for @xmath in each\ncase, and suppression of the beam-plasma instability to occur if @xmath\nfor a process which causes the transfer of wave energy out of the\nresonant region in @xmath space. We confirm this numerically for the 1-D\ndiffusion in Ratcliffe et\u00a0al. ( 2012 ) , and the next chapter.\n\n## Chapter 3 Quasilinear Simulations of Langmuir Wave Evolution\n\nAn accelerated electron population which propagates down to the solar\nchromosphere can produce HXR emission via bremsstrahlung (see Section\n1.3.4 ). However, as they propagate though the dense plasma, the\nelectrons can lose significant energy due to collisional effects and so\nto obtain a given electron distribution in the emission region, far more\nelectrons may have to be accelerated. Previously, wave generation was\nconsidered to be a pure energy loss process, and therefore expected to\nonly increase the initially required number of fast electrons. In\ngeneral however, observations of the HXR spectra can only reach down to\naround @xmath keV and the spectrum below this is unrecoverable from HXR.\nTherefore if we can transfer energy from energies below this into the\nobservable part of the spectrum, we will appear to have more energy in\nthe electrons.\n\nIn Section 2.5.2 we discussed the effects of beam parallel density\nfluctuations, and suggested that these could lead to the acceleration of\nbeam electrons. In addition we concluded that 3-D diffusion due to, for\nexample, isotropic fluctuations would include a similar parallel\ndiffusion component, and thus give a similar effect. In this chapter we\ninvestigate electron acceleration using the mathematical treatment\ndeveloped in Chapter 2 . We consider plasma similar to the solar corona,\nwith density fluctuations similar to those which have been observed, and\ntreat both a sample case of a Maxwellian beam, in order to investigate\nthe detailed effects, and the collisional relaxation of a power law\nbeam, to see the effects this acceleration may have in a physical\nsituations, and how it may be observed. A large part of this work has\nbeen previously published in Kontar et\u00a0al. ( 2012 ); Ratcliffe et\u00a0al. (\n2012 ) .\n\n### 3.1 The Simulation Equations\n\nIn Section 2.2 we gave the quasilinear equations in homogeneous\ncollisionless plasma, Equations 2.3 and 2.4 , as originally derived by\nVedenov & Velikhov ( 1963 ); Vedenov et\u00a0al. ( 1967 ) . However, in the\ndense plasma of the solar corona, collisional effects are important for\nboth electrons and waves, and so we must add terms describing these. The\ncollisional operator for electrons is given by (e.g. Lifshitz &\nPitaevskii, 1981 )\n\n  -- -------- -- -------\n     @xmath      (3.1)\n  -- -------- -- -------\n\nwhere @xmath , with @xmath the Coulomb logarithm. For the temperatures\nand densities of the corona and solar wind, the empirical formulae of\nSivukhin ( 1966 ) give values for @xmath of approximately 15-20. The\ncollisional damping rate for Langmuir waves is @xmath . For the\nparameters we use below, the collisional time is @xmath s for electrons\nat @xmath .\n\nWe include the diffusion operator describing the effects of beam-aligned\ndensity fluctuations on the Langmuir waves from Equation 2.22 , and\nobtain\n\n  -- -------- -- -------\n     @xmath      (3.2)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (3.3)\n  -- -------- -- -------\n\nThe coefficient of diffusion, @xmath , is given by Equations 2.38 or\n2.42 , depending on the density fluctuation spectrum assumed.\n\nThe initial value problem, which is sufficient to reproduce the physics\nimportant here, is solved using finite difference methods, discussed in\ngeneral for partial differential equations in the books by e.g. Smith (\n1985 ); Thomas ( 1995 ) , and for the specific case of beam-plasma\ninteraction in Takakura ( 1982 ); Kontar ( 2001b ) . We use explicit\nfinite difference schemes, first order in time and second order in\nvelocity, or equivalently wavenumber, space.\n\nThe code is written in FORTRAN 90, and based on that used in Kontar (\n2001a ) with additional modifications from Kontar & P\u00e9cseli ( 2002 );\nHannah et\u00a0al. ( 2009 ) describing collisional effects and the\ninteraction of Langmuir waves with ion-sound waves. In Chapter 4 we add\nadditional subroutines for the generation of electromagnetic emission.\nWe use a variable timestep according to the stability criterion for the\nquasilinear equations. The accuracy of the numerical schemes used is\ndiscussed in Kontar ( 2001b ) .\n\n### 3.2 Simulations of a Maxwellian Beam\n\nIn order to illustrate the effects of Langmuir wave evolution it is\nuseful to first consider the simplest possible case of beam-wave\ninteraction, by assuming a Maxwellian electron beam. This case offers\nthree significant simplifications. Firstly, the timescale for beam-wave\ninteraction is @xmath s and so collisional effects are negligible for\nelectrons of velocity @xmath . Secondly, the condition @xmath for\nLangmuir wave growth is immediately satisfied by such a beam, so waves\nare rapidly produced. Finally, the plateau in the electron distribution\nproduced due to the energy transfer from electrons to waves (Melrose,\n1980b ) does not significantly evolve in time, in contrast to the case\nof a beam formed either due to transport effects (e.g. Ginzburg &\nZhelezniakov, 1958 ; Melrose, 1975 ) or collisional relaxation (e.g.\nEmslie & Smith, 1984 , or Section 3.3 ) .\n\n#### 3.2.1 Initial Conditions\n\nThe initial electron distribution function @xmath [electrons cm @xmath\n(cm\/s) @xmath ] is the superposition of a Maxwellian background and a\nMaxwellian beam:\n\n  -- -------- -- -------\n     @xmath      (3.4)\n  -- -------- -- -------\n\nwhere @xmath is the beam density, @xmath its average velocity and @xmath\nits velocity space width.\n\nThe initial spectral energy density of Langmuir waves @xmath [ergs cm\n@xmath ] is set to the thermal level. This is found from the\nsimultaneous steady state solution of Equations 3.2 and 3.3 , ignoring\nthe collisional terms and is\n\n  -- -------- -- -------\n     @xmath      (3.5)\n  -- -------- -- -------\n\nwhich agrees with the thermal level of plasma waves in a collisionless\nMaxwellian plasma as given by (Kaplan & Tsytovich, 1973 ; Tsytovich,\n1995 ) .\n\nIn our first set of simulations, we fix the parameters of the beam and\nbackground plasma, and vary only those of the density fluctuations. We\nconsider plasma similar to that in dense coronal loops. The electron and\nion temperatures are approximately equal here, in contrast to solar wind\nregions where generally the ion temperature is lower (e.g. Newbury\net\u00a0al., 1998 ; Gurnett et\u00a0al., 1979 ) , and we take @xmath MK. The\nbackground density is relatively high, @xmath cm @xmath , which\ncorresponds to a local plasma frequency of @xmath GHz. We take a beam of\ndensity @xmath , which as will be seen leads to high levels of Langmuir\nwaves, @xmath over the thermal level or more. The beam velocity is set\nto @xmath cm\u00a0s @xmath and @xmath , in the mid range of observed\nvelocities of solar fast electron beams.\n\nWe begin by considering random density fluctuations, with Langmuir\nwavenumber diffusion coefficient @xmath given by Equation 2.38 . This\ncoefficient contains three free parameters, @xmath , @xmath and @xmath .\nHowever @xmath appears only in the coefficient magnitude, arising due to\nthe normalisation of the RMS average density fluctuation. Qualitatively,\nthe effects of varying @xmath are therefore identical to those of\nchanging the RMS fluctuation level @xmath , so we may fix @xmath without\nloss of generality. We set @xmath .\n\nThe magnitude of relative density fluctuations @xmath ranges between\n@xmath and @xmath covering the range of values commonly observed in the\ncorona (Cronyn, 1972 ; Smith & Sime, 1979 ) . If we assume the\nfluctuations are due to ion-sound waves, which may exist (subject to\n@xmath ) in the corona at appropriate frequencies, the characteristic\nvelocity will be the sound speed, @xmath cm\u00a0s @xmath for the plasma\nparameters as stated, or approximately @xmath . We consider a range of\nvelocities around this, varying @xmath between @xmath and @xmath .\n\n#### 3.2.2 Electron and Wave Distributions\n\nFigure 3.1 shows the evolution of the electron and the wave\ndistributions during the initial quasilinear relaxation of the beam over\nthe first few quasilinear times, and the relaxed state reached at @xmath\n. The top left panel shows the results in homogeneous density plasma.\nLangmuir waves grow rapidly over the first few quasilinear times,\nforming a flat plateau after around @xmath . For this beam velocity and\ndensity, the plateau in the electron distribution spans from @xmath (\n@xmath keV) to @xmath ( @xmath keV). This plateau remains at @xmath , as\nshown by the red line, and will persist until collisional effects begin\nto be important. Plateau destruction occurs on a timescale given by\n@xmath where @xmath is the collisional rate. This is approximately 1\nsecond at @xmath , of the order of @xmath or @xmath quasilinear times,\nand is far longer than the duration of the simulations, so these effects\nwill not be seen.\n\n##### Density Fluctuations\n\nThe other panels in Figure 3.1 show the electron and wave spectra in\nplasma with fluctuating density. The bottom left panel, showing a\nmoderate level of fluctuations, @xmath , gives the best illustration of\nthese effects. The waves generated by the beam spread rapidly in\nwavenumber space, with subsequent slight decrease of their peak\nintensity. This spreading is mirrored in the electron distribution, and\nformation of the plateau is slowed.\n\nThis may also be expressed as broadening the resonance between the waves\nand electrons, since the process of generation of a wave at wavenumber\n@xmath , its shift via diffusion to a new wavenumber @xmath , and\nsubsequent absorption at velocity @xmath can also be thought of as a\nresonant interaction at @xmath and @xmath , but with finite width, as\nopposed to the delta function resonance seen in the quasilinear\nequations. Dupree ( 1966 ) originally showed this for the case of\nparticle diffusion in velocity, but Langmuir wavenumber diffusion\naffects the resonance in a similar manner.\n\nAt large velocities we see an increase in the electron distribution\n@xmath from the upper edge of the plateau to the highest velocities in\nthe simulation. In other words, electrons have been accelerated. Because\nwaves diffuse to both larger and smaller wavenumbers, we also see\nchanges in the electron distribution down to @xmath . Below this, the\nenergy in background electrons is significantly more than that in the\nLangmuir waves (the weak turbulence assumption, defined in Equation 2.5\n) and their effect is not visible.\n\nThe other two panels in Figure 3.1 show the effects of stronger and\nweaker fluctuations. For very weak fluctuations, @xmath , there is\nslight spreading of the Langmuir wave spectrum, giving a wider electron\nplateau and therefore slight acceleration. Otherwise the relaxation\nproceeds as in the homogeneous case.\n\nWhen the inhomogeneity becomes very strong, as illustrated by the bottom\nright panel where @xmath , diffusion transports the waves out of their\nregion of excitation in @xmath -space on a timescale which is much\nsmaller than their growth timescale, so the wave level is barely\nincreased above the thermal level. As we can see, by time @xmath the\nelectron distribution remains essentially unchanged from the initial\ndistribution. Waves are produced and reabsorbed, but the broadening of\ntheir spectrum due to diffusion occurs so rapidly that this absorption\nis mainly by the thermal electrons at a few @xmath , corresponding to\nwavenumbers near @xmath , where there is far more energy than is in the\nwaves (see Equation 2.5 giving the limit of weak turbulence theory).\nThus we get suppression of the beam-plasma instability.\n\nElsewhere, the effects of suppression have been considered mainly in the\ncontext of elastic angular scattering of Langmuir waves, as discussed in\nSection 2.5.3 . Our treatment confirms a related suppression effect due\nto diffusion in the Langmuir wavenumber magnitude, rather than a direct\nshift @xmath . Moreover, although we have assumed here density\nfluctuations aligned with the electron beam, as noted in Section 2.5.3\nisotropic fluctuations, or indeed any angular distribution with\ncomponent along the beam propagation direction will lead to diffusion in\nboth angle and magnitude of the wavenumber. Our treatment of inelastic\nscattering considers both possible effects simultaneously, allowing\ntheir relative importance to be easily assessed.\n\n#### 3.2.3 Parametrising the Effects of Diffusion\n\nTo find the timescale associated with wavenumber diffusion, we\napproximate the diffusion equation, Equation 2.22 , as\n\n  -- -------- -- -------\n     @xmath      (3.6)\n  -- -------- -- -------\n\nfor @xmath the shift of the Langmuir waves from the generation region\nout of resonance with the beam, and @xmath evaluated at a characteristic\nLangmuir wavenumber @xmath . For a Maxwellian electron beam centred at\n@xmath , these can be evaluated using the resonance condition, @xmath\nand are\n\n  -- -------- -- -------\n     @xmath      (3.7)\n  -- -------- -- -------\n\nThe parameters @xmath and @xmath are given above, and the timescale is\ntherefore\n\n  -- -------- -- -------\n     @xmath      (3.8)\n  -- -------- -- -------\n\nThe other important timescale in the system is that for beam wave\ninteraction, namely the quasilinear time, @xmath . These two timescales\nindicate the rates of energy transfer by the two processes and thus the\nrelative strength of wave generation and wave diffusion. Therefore it is\nnatural to consider their ratio\n\n  -- -------- -- -------\n     @xmath      (3.9)\n  -- -------- -- -------\n\nwhen discussing the strength of the wave diffusion rather than the\nabsolute magnitude of the diffusion coefficient.\n\nIn the electron distributions in Figure 3.1 we see three distinct\nregions in velocity space, illustrated in Figure 3.2 . Below around\n@xmath is the core region, where little or no effect from diffusion is\nseen. From @xmath and up is the \u201cbeam\u201d region, containing the beam\nelectrons. Above @xmath is the \u201ctail\u201d region, where we see the\naccelerated electrons appearing. We set the upper limit in velocity at\n@xmath . Thus the energy of the initial Maxwellian beam is\n\n  -- -------- -- --------\n     @xmath      (3.10)\n  -- -------- -- --------\n\nand we define the total energy in beam electrons at time @xmath as\n\n  -- -------- -- --------\n     @xmath      (3.11)\n  -- -------- -- --------\n\nand the tail electrons as\n\n  -- -------- -- --------\n     @xmath      (3.12)\n  -- -------- -- --------\n\nIn the homogeneous case at time @xmath , the beam energy is @xmath and\nthe tail energy @xmath respectively. Generally, although not always, a\nbeam energy greater than this implies slowed relaxation of the beam,\nwhile an increased tail energy implies electron acceleration, and so the\nratios @xmath , @xmath can be used as a measure of the extent of\nsuppression and\/or acceleration. Also of interest is the quantity @xmath\n, the average energy of a single electron in the tail region, giving a\nmeasure of the average energy gain of an individual tail electron. In\nthe homogeneous case this is @xmath keV.\n\nIn Figure 3.3 , we plot these ratios as functions of the parameter\n@xmath for a range of values of @xmath and @xmath . The three cases of\ndiffusion in Figure 3.1 are marked by asterisks, and represent three\ndistinct regions in @xmath . In the strong inhomogeneity case, with\n@xmath and @xmath , the beam-plasma instability is suppressed, so the\nbeam remains close to its initial Maxwellian form and we find @xmath and\n@xmath , while the average tail electron energy is unchanged.\n\nVery weak inhomogeneity, with @xmath and @xmath , has little effect on\nthe beam relaxation, so the beam energy is close to the homogeneous\nvalue, but the tail energy is slightly increased due to the broadened\nplateau, giving @xmath and @xmath . Comparing the total tail region\nenergy to the average tail electron energy suggests in this case we have\naccelerated a reasonable number of electrons, but not to very large\nvelocities, as seen in Figure 3.1 . The intermediate case, with @xmath\nand @xmath , gives @xmath and @xmath , and a significantly increased\naverage tail electron energy.\n\nTo summarise these findings, for @xmath the density fluctuations are\nweak and relaxation proceeds as in homogeneous plasma with no change to\nthe beam energy and no electron acceleration. As the diffusion\ncoefficient is increased and @xmath approaches 1, we begin to see\nsubstantial electron acceleration, quantified by the tail energy @xmath\n, due to the energy transfer from slower to faster electrons through\nLangmuir wave diffusion. Finally, when @xmath we have strong diffusive\nbroadening of the wave spectrum, and thus suppression of the beam-plasma\ninstability as wave energy is lost from the resonant region on a much\nshorter timescale than @xmath . Moreover, in the region of strong\nacceleration, the total tail electron energy is almost doubled, and is\nincreased by more than half over around 2 orders of magnitude in @xmath\naround this.\n\n#### 3.2.4 Effects of Fluctuation Characteristic Velocity\n\nFor random density fluctuations we saw in Section 2.3.4 that there are\ntwo simple regimes of diffusion when @xmath or vice versa. However, the\nvalues of @xmath of interest here lie primarily in the transitional\nregion where @xmath and thus the diffusion coefficient shape is strongly\ndependent on this value. In Figure 3.4 we plot the diffusion coefficient\nas a function of wavenumber @xmath for three values of the fluctuation\ncharacteristic velocity, @xmath . Significant dependence is seen around\nthe main region of Langmuir wave excitation, @xmath (Equation 3.7 ),\nwhich is largely accounted for in our definition of the diffusive\ntimescale, @xmath .\n\nTo confirm that this is so, we can minimise the diffusive timescale with\nrespect to @xmath , finding that this occurs at @xmath . Substituting\n@xmath for our parameters, we find the maximum acceleration should occur\nfor @xmath . In Figure 3.5 we plot the total and average tail electron\nenergies as a function of @xmath for a fixed level of fluctuations,\n@xmath , and see a clear peak at exactly this value of @xmath . The\ndependence of the acceleration effect on characteristic velocity\ntherefore accounts for the vertical scatter of the points in Figure 3.3\n, which is confirmed by comparing the range in 3.5 , approximately\n@xmath and @xmath keV, to that in Figure 3.3 .\n\n#### 3.2.5 Power-law Fluctuations\n\nIn Section 2.3.4 we calculated the diffusion coefficient for a turbulent\npower-law spectrum of density fluctuations. This coefficient is given by\nEquation 2.42 , and was seen to be similar in some respects to the\ncoefficient for random fluctuations given by Equation 2.38 . In Figure\n3.6 we compare the acceleration effects due to these two coefficients\nfor a range of fluctuation parameters. We use power-law indices of\n@xmath and @xmath , similar to those observed in the solar corona and\nwind (e.g. Cronyn, 1972 ; Celnikier et\u00a0al., 1983 ; Robinson, 1983 ) .\nThe effects of acceleration for the two fluctuation spectra are seen to\nbe similar for the parameters considered here, but it must be noted that\nonly a few test cases have been run.\n\n#### 3.2.6 The Effects of Beam and Plasma Parameters\n\nThus far we have considered only the effects of changing the fluctuation\nparameters, but we can expect the trends established for the chosen beam\nand plasma parameters to hold true when these quantities are also\nvaried. The simulations presented in this section show that this is\nindeed the case, but only within certain ranges.\n\nFirstly, both of the relevant timescales, @xmath and @xmath , obey the\nsame relation with respect to the local plasma density, and thus varying\nthis has no effect on the parameter @xmath . We show two cases of\ndiffusion with @xmath MHz in Figure 3.7 , and confirm that the same\nrelationships with @xmath hold in this case.\n\nThe beam density, @xmath , controls the level of Langmuir waves\ngenerated, and therefore could be expected to affect the acceleration\nprocess. However, as shown in Figure 3.7 , the effect is almost entirely\naccounted for by the dependence of @xmath on the timescale @xmath , and\nthe same regimes of acceleration and suppression are seen. On the other\nhand, the results for a beam density of @xmath cm @xmath at 1\u00a0GHz (not\nshown in the figure) do not behave as expected, showing neither\nacceleration nor suppression. This is due partly to the influence of\ncollisional effects on the beam and waves over the longer timescale for\nrelaxation of such a weak beam, and also to the small level of Langmuir\nwaves such a beam can generate. The acceleration relies on the\nredistribution of energy between different Langmuir wavenumbers, and is\nthus limited by the amount of energy available in waves.\n\n#### 3.2.7 Conclusions\n\nTo summarise this section, for the test case of a Maxwellian beam, we\nhave found that plasma density fluctuations can lead to a significant\nelectron acceleration or suppression of the beam-plasma instability.\nThese effects occur for broad range of beam, plasma and fluctuation\nparameters. The details of the density fluctuations change the effects\nin relatively small ways, but their extent is controlled almost entirely\nby the single quantity @xmath , the ratio of the quasilinear and wave\ndiffusion timescales. When @xmath is small, the diffusion process\ndominates, and the beam-plasma instability is suppressed. When @xmath is\nclose to 1, there is significant acceleration. When @xmath is much\nlarger than 1, there is no effect as the beam-plasma interaction is far\nmore rapid than the diffusion process. However, as the effect is due to\nenergy transfer between different velocities by means of Langmuir wave\nevolution, a sufficiently large level of Langmuir waves must be\ngenerated, and so we require a sufficiently dense beam.\n\n### 3.3 Simulations of the Collisional Relaxation of a Power-Law Beam\n\nIn the previous section we looked in detail at the effects of Langmuir\nwavenumber diffusion for a simple test case of a Maxwellian beam. This\nserved as a useful \u201cshortcut\u201d for the production of Langmuir waves, as\nthe initial beam distribution was already unstable to their generation.\nHowever, in physical situations the accelerated electrons often obey a\npower law distribution, with @xmath at all velocities, which only\nbecomes unstable to wave generation due to subsequent evolution.\n\nIn some situations, this instability arises due to \u201ctime-of-flight\u201d\neffects. The faster electrons outpace the slower ones, producing a\ndistribution with more electrons at high velocities than at lower ones\nand therefore a reverse slope. Coronal electron beams typically have\nvery high velocities, between 0.1 and 0.6 @xmath . An electron beam\nmoving upwards from the acceleration region may be estimated to become\nunstable after a minimum distance of approximately @xmath or @xmath cm\n(Kane et\u00a0al., 1982 ; Reid et\u00a0al., 2011 ) . The timescale to become\nunstable is then between @xmath s and a few seconds.\n\nA reverse slope distribution can also be generated due to collisional\neffects. The collisional term in Equation 3.2 is\n\n  -- -------- -- --------\n     @xmath      (3.13)\n  -- -------- -- --------\n\nwhich is roughly proportional to @xmath , and so slower electrons will\nlose energy more rapidly than faster ones. The result is called a \u201cgap\ndistribution\u201d (Melrose, 1975 ; Wentzel, 1985 ) . At a plasma frequency\nof 2\u00a0GHz the collisional timescale for electrons around @xmath , which\nis given by @xmath , is approximately @xmath s. A reverse slope can\ntherefore be generated at velocities around @xmath after at time of\n@xmath or approximately @xmath s.\n\nIn dense plasma it can therefore be interesting to consider the\ncollisional relaxation of the beam, as the timescale for this is shorter\nthan that for transport effects to become important, especially for the\nslightly slower beams. We use a 1-D model and consider the evolution at\na single spatial location. This provides a good model of, for example, a\nvery dense coronal loop. The results in this section have been published\nin Kontar et\u00a0al. ( 2012 ) : the discussion as presented here has been\nwritten specifically for this thesis.\n\n#### 3.3.1 Initial Conditions\n\nWe use the quasilinear equations, Equations 3.2 and 3.3 , as in the\nprevious section and a diffusion coefficient given by Equation 2.38 .\nThe initial electron distribution is now a Maxwellian background plasma\nplus a power law beam smoothly fitted to this:\n\n  -- -------- -- --------\n     @xmath      (3.14)\n  -- -------- -- --------\n\nHere, @xmath denotes the gamma function and appears due to the\nnormalisation of the distribution, while @xmath is the power law index\nfor the energetic particles in energy space and @xmath the number\ndensity of non-thermal electrons, @xmath .\n\nThis distribution is a power law @xmath at high velocities @xmath and\nflattens below this. This helps to fit the beam smoothly to the\nMaxwellian core, and also means that collisional relaxation can more\nquickly lead to Langmuir wave generation, as there are less electrons at\nlow velocities than for a pure power law.\n\nThe initial electron distribution is normalised to the electron number\ndensity [electrons cm @xmath ], so that\n\n  -- -------- -- --------\n     @xmath      (3.15)\n  -- -------- -- --------\n\nThe thermal level of Langmuir waves when collisions are included is\ncalculated as in Section 3.2.1 by finding the steady state solution of\nEquation 3.3 . We ignore the beam electrons and consider only the\nMaxwellian core to obtain\n\n  -- -------- -- --------\n     @xmath      (3.16)\n  -- -------- -- --------\n\nas used in the previous simulations.\n\nWe consider again dense coronal regions, in this case a slightly larger\ndensity of @xmath cm @xmath , corresponding to a local plasma frequency\nof @xmath GHz. The electron and ion temperature are again equal, @xmath\nMK. The power law index of the initial beam is @xmath , corresponding to\nan index of 8 in velocity space.\n\nDuring the collisional relaxation of the beam, a large fraction of the\ninitial energy will be lost. To obtain a sufficiently large reverse\nslope @xmath , and therefore high levels of Langmuir waves, we must take\nan initial beam density far higher than in the case of a Maxwellian\nbeam. We therefore take @xmath cm @xmath , which leads to Langmuir wave\nlevels of @xmath over thermal at their peak, sufficient for their\nmodification to have a strong effect on the beam evolution.\n\nThe simulations here require much longer run times than those in the\nprevious section as the evolution occurs on large multiples, several\nthousand or so, of the collisional timescale. We therefore consider the\nevolution over @xmath s which can require a simulation run-time of\nseveral days, depending on which effects are considered. Thus we cannot\nexplore the parameter space in the same way as for the Maxwellian beam,\nand instead present only a few sample cases. We begin with homogeneous\nplasma, then add a constant plasma density gradient, then show a few\nexamples of the effects of Langmuir diffusion. Finally we directly\nconsider the effects of wave-wave interactions for which the\nparticipating wavenumbers are approximately equal, in addition to the\ndiffusion caused by small wavenumber fluctuations.\n\n#### 3.3.2 Homogeneous Plasma\n\nWhen wave generation is ignored, the initial electron distribution of\nEquation 3.14 will evolve due to collisions as shown in the left panel\nof Figure 3.8 . The electrons lose energy, the beam distribution\ndecreases, and a reverse slope is generated over the first @xmath s. The\nregion of reverse slope gradually widens and moves to higher velocities\nas time progresses, but at the same time the number density of electrons\nin the reverse slope region decreases.\n\nWhen we include the effects of wave generation, this reverse slope is\nquickly flattened, as seen in the right panel of Figure 3.8 . The\ncollisional effects continually reform the reverse slope, generating\nmore Langmuir waves, and the combination gives a flat plateau and high\nLangmuir wave level, with the plateau height gradually decreasing as\nenergy is lost due to collisions. At long times, the beam density\nbecomes so low that few waves are generated and eventually, on\ntimescales of several seconds, the wave level becomes so low that the\ndistribution returns towards that of the collisions only case. On even\nlonger time scales all energy is lost from the beam electrons, and the\ndistribution returns to a Maxwellian at a slightly higher temperature\nthan the initial distribution.\n\n##### Time Integrated Electron Distribution\n\nBecause the slope in the electron distribution changes over time, and\nthe reverse slope region moves to higher velocity, we cannot define a\nsimple beam-wave interaction time like the quasilinear time in Equation\n2.8 , as this will be time dependent. This makes it difficult to\nquantify when the diffusion of Langmuir waves in wavenumber will lead to\nelectron acceleration, and how the density fluctuation parameters affect\nthis.\n\nInstead we consider the time-averaged electron distribution as function\nof energy, defined by\n\n  -- -------- -- --------\n     @xmath      (3.17)\n  -- -------- -- --------\n\nwhere\n\n  -- -------- -- --------\n     @xmath      (3.18)\n  -- -------- -- --------\n\nis the electron distribution as a function of energy. Here we consider\nthe average over @xmath s. This time-averaged flux can be directly\nrelated to the HXR emission from the electrons, as discussed later in\nSection 3.5 . Here we simply note that changes in this flux due to\nLangmuir wave evolution will be visible observationally via this HXR\nemission.\n\nIn Figure 3.9 we show this time-averaged flux for the initial beam, and\nfor the collisional evolution with and without wave generation. The\nlatter are almost identical, confirming the results in Hamilton &\nPetrosian ( 1987 ); McClements ( 1987 ); Hannah et\u00a0al. ( 2009 ); Hannah\n& Kontar ( 2011 ) that Langmuir wave generation only very weakly affects\nthe time integrated electron flux.\n\n#### 3.3.3 A Constant Density Gradient\n\nThe role of a density gradient in electron self-acceleration was\noriginally considered by e.g. Bre\u01d0zman & Ryutov ( 1969 ); Ryutov ( 1969\n) in order to explain experimental observations of electron acceleration\nduring beam relaxation. In the context of solar electron beams, the\nrecent 1-D simulations by Kontar & P\u00e9cseli ( 2002 ) found such an\nelectron acceleration effect due to an increasing plasma density. We\nreproduce this case here as it is a useful test for our simulations, and\nalso calculate the time-averaged electron flux to compare to the\nhomogeneous case. It is also interesting to compare this density\ngradient case to the fluctuating density considered in the next section.\n\nConsider the Liouville equation, Equation 2.15 :\n\n  -- -------- -- --------\n     @xmath      (3.19)\n  -- -------- -- --------\n\nIn the case of an increasing density gradient we have\n\n  -- -------- -- --------\n     @xmath      (3.20)\n  -- -------- -- --------\n\nwhere\n\n  -- -------- -- --------\n     @xmath      (3.21)\n  -- -------- -- --------\n\nis the characteristic scale of density inhomogeneity. The fractional\nchange in Langmuir wavenumber @xmath due to the inhomogeneity must be\nsmall, @xmath in order that we remain in the geometric optics (WKB)\napproximation (e.g. Vedenov et\u00a0al., 1967 ) .\n\nThe shift in wavenumber experienced by the Langmuir waves is\n\n  -- -------- -- --------\n     @xmath      (3.22)\n  -- -------- -- --------\n\nFrom this we can estimate the required density gradient for a\nsignificant shift in @xmath . For a timescale of the order of the\ncollisional time, @xmath s, and a plasma frequency of 2\u00a0GHz, taking\n@xmath we find @xmath cm.\n\nIn Figure 3.10 we show the electron and wave spectra in plasma with a\nconstant density gradient of length scale @xmath cm, and also the\nhomogeneous case for comparison. Several interesting features may be\nseen. Firstly, as expected we see the advection of Langmuir waves\ntowards smaller wavenumbers, and the consequent transfer of energy from\nsmall to large velocities. The plateau in the electron distribution is\nbroadened. The rate of energy loss from the beam is also decreased, with\nthe widened plateau decreasing in height significantly slower than in\nthe homogeneous or collisions-only cases. Also of interest is the fact\nthat the increased electron number density seen between @xmath and\n@xmath not only exceeds the number in the homogeneous case but also the\nnumber in the initial power law beam. After @xmath s, at @xmath we have\na tenfold or more increase in the electron distribution above this\ninitial value.\n\nIn the left panel of Figure 3.11 we show the time averaged electron flux\nfor the homogeneous case and the case of a constant density gradient.\nAgain there are several features of interest. We see a clear increase in\nelectron flux between around @xmath and @xmath keV, reaching perhaps an\norder of magnitude over the homogeneous case at its peak. The flux also\nsignificantly exceeds that from the initial beam distribution. In\naddition, there is a distinctive kink in the flux spectrum, which shows\na relatively linear distribution from 10 to 200\u00a0keV then drops sharply\nback to be the same as in the homogeneous case.\n\nWe may conclude that the presence of a density gradient in the plasma is\nable to produce electron self-acceleration in our simulation model, and\nmoreover that this change in the electron distribution has significant\neffects on the time-averaged electron flux, and therefore the HXR\nemission.\n\n#### 3.3.4 Density Fluctuations\n\nIn the previous section we considered the effects of plasma density\nfluctuations on a Maxwellian electron beam in detail, and saw a\nsignificant electron acceleration effect, controlled primarily by the\nparameter @xmath , the ratio of the beam-plasma interaction and Langmuir\nwavenumber diffusion timescales. In the current case of a power-law beam\nrelaxing due to collisions, we cannot define a simple analog of the\nbeam-plasma interaction timescale found in Equation 2.8 , as the actual\nLangmuir wave growth rate is the convolution of wave growth and the\ngrowth of the reverse slope @xmath . However, we can still infer that\nthe maximum acceleration effect will occur when the two processes\noperate at approximately equal rates.\n\nIn addition, we saw that the details of the density fluctuation spectrum\nand parameters were comparatively unimportant. Therefore we consider\nhere only random fluctuations, with a diffusion coefficient given by\nEquation 2.38 , assume as before that @xmath and take their\ncharacteristic velocity to be @xmath cm\u00a0s @xmath and the density\nfluctuation magnitude to be @xmath . These parameters were found by a\nfew trials to lead to the most significant acceleration for these beam\nparameters.\n\nThe resulting electron and wave distributions are shown in Figure 3.12 .\nIn comparison to the homogeneous or density gradient cases, we see that\na fluctuating density leads to spreading of the Langmuir waves to both\nlarger and smaller wavenumbers, with a consequent decrease in their peak\nvalue. However, compared to the density gradient case, as expected, the\nacceleration effect is neither as significant, nor as sharply cut off.\nThe time-averaged electron flux shown in the right panel of Figure 3.11\nagain shows a significant increase from around 20\u00a0keV up to 300\u00a0keV in\nthis example, with a kink around 200\u00a0keV, similar to the case of a\nconstant density gradient shown in the left panel.\n\nOne final point may be mentioned here. Because in this case the\ncondition for strong acceleration, @xmath , cannot be satisfied for the\nentire beam relaxation process, it may be of interest to consider a\ntime-varying level of fluctuations. The density fluctuations will be\ndamped by their interaction with Langmuir waves, and therefore decay. A\nself consistent treatment of the problem is possible in the framework in\nthe previous chapter, by including the evolution of the density\nfluctuations. This has been done in the past by, for example, Vedenov\net\u00a0al. ( 1967 ); Vedenov ( 1968 ) , and would be interesting to include\nin future simulations.\n\n#### 3.3.5 Wave-wave Interactions\n\nLangmuir waves are subject to various scattering and decay processes and\ncan themselves excite other wave modes. For instance, scattering off\nthermal ions can backscatter a Langmuir wave, or transform it into an\nelectromagnetic wave, as will be discussed in the next chapter.\nThree-wave interactions of the form @xmath are the primary source of\nion-sound waves in the plasma, as their large damping rates mean they\ncannot persist and must be rapidly generated. In general there are two\nkinematically allowed processes which can generate an ion-sound wave\n(denoted @xmath ) from a Langmuir wave (denoted @xmath ), decay to a\nscattered Langmuir wave @xmath : @xmath and decay or coalescence giving\nan electromagnetic wave (transverse, denoted @xmath ) @xmath .\n\nThe latter process will be considered in the following chapter as it is\nan essential component in the plasma emission mechanism, but for the\nparameters considered here may be shown to have negligible effect on the\nLangmuir waves. For the former process, energy and momentum conservation\nstate that the parent Langmuir wave at wavenumber @xmath will scatter to\napproximately the opposite wavenumber @xmath and produce an ion-sound\nwave at wavenumber @xmath . More precisely, the scattered wavenumber is\ndecreased by a small increment @xmath ,\n\n  -- -------- -- --------\n     @xmath      (3.23)\n  -- -------- -- --------\n\nand so successive scatterings will lead to the generation of Langmuir\nwaves at smaller and smaller wavenumbers. Eventually this forms a\nso-called Langmuir wave condensate (e.g. Ziebell et\u00a0al., 2001 ; Kontar &\nP\u00e9cseli, 2002 ; Ziebell et\u00a0al., 2011 ) at very small wavenumbers.\n\nFor waves with comparable wavenumbers, the quasi-particle treatment of\nSection 2.3.1 is no longer valid, and so we must consider these decays\nindividually, using the three-wave equations (e.g. Melrose, 1980b ;\nTsytovich, 1995 ) . In practise, these equations may be reduced to 1-D\nin a similar manner to the quasilinear equations. Here we use an\nimplementation and simulation code as in Kontar & P\u00e9cseli ( 2002 ) . We\nadd a source term @xmath due to the decay @xmath to the right hand side\nof Equation 3.3 and a new equation to the set describing the evolution\nof the ion-sound waves, described by their spectral energy density\n@xmath :\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      \n              @xmath      (3.24)\n  -- -------- -------- -- --------\n\nwhere @xmath is the initial Langmuir wavenumber and @xmath is the\nscattered wave.\n\nThe source term for the Langmuir waves is\n\n  -- -------- -- --------\n     @xmath      \n     @xmath      \n     @xmath      (3.25)\n  -- -------- -- --------\n\nwhere we distinguish between @xmath and @xmath , and the constants\n@xmath and the sound wave damping rate are\n\n  -- -------- -- --------\n     @xmath      (3.26)\n  -- -------- -- --------\n\n  -- -------- -- --------\n     @xmath      (3.27)\n  -- -------- -- --------\n\n##### Prescribed Ion-sound Wave Level\n\nWe begin with the simple situation of a fixed level of ion-sound waves,\ngenerated by some external source. We set this to the thermal level,\n\n  -- -------- -- --------\n     @xmath      (3.28)\n  -- -------- -- --------\n\nand neglect its evolution.\n\nThe results are shown in Figures 3.13 and 3.14 . The strong variations\nin Langmuir wave level at small wavenumbers are due to repeated\nscatterings by the ion-sound waves, the thermal level of which is\nrelatively large at small wavenumbers. We see from Equation 3.23 that\nthe Langmuir wavenumber @xmath decreases by @xmath on each scattering.\nAs will be seen in the next subsection, when the ion-sound waves are\nallowed to evolve self-consistently these strong variations are not\nseen.\n\nIt should be noted that at the extreme high energies a relativistic\ntreatment is required, and so the effect above around 300\u00a0keV is not\nmeaningful. The most significant differences in the two cases are seen\nat large energies, 100 to 300\u00a0keV, where we see significantly more\nacceleration. The Langmuir wave scattering is particularly effective at\nthe small wavenumbers corresponding to these high velocities. The other\ninteresting feature of Figure 3.13 is the appearance of electrons at\nnegative velocities. These correspond to electrons accelerated by the\nback-scattered Langmuir waves.\n\n##### Self-Consistent 3-Wave Scattering\n\nFixing the level of ion-sound waves can lead to energy being gained by\nthe Langmuir waves and not lost from the sound waves, but as the energy\nin sound waves is far less than that in Langmuir waves, this effect is\ngenerally small. The self-consistent treatment does however lead to\nslightly slower scattering because of the strongly peaked sound wave\nspectrum, and the resulting Langmuir wave spectrum does not show as\nclearly the successive scattering peaks. On the other hand, the main\nfeatures of the acceleration are preserved, although the exact spectral\nshape can be altered.\n\nAn example of self-consistent ion-sound wave scattering with significant\ndensity fluctuation induced wavenumber diffusion included is shown in\nFigures 3.15 and 3.14 . The main differences between the fixed and self\nconsistent cases are seen to occur around very small wavenumbers, or\nenergies above 300\u00a0keV. In this regime, these simulations start to\nbecome invalid due to relativistic effects, so the significance of this\nis small.\n\n#### 3.3.6 The Effects of Beam Density\n\nAs the acceleration effect we are considering relies on the transfer of\nenergy via Langmuir waves, we expect that a denser beam would allow more\nacceleration to occur. This was confirmed already for the case of a\nMaxwellian beam. In Figure 3.16 we show examples of the acceleration for\nbeam densities of @xmath cm @xmath and @xmath cm @xmath . In both cases,\nthe \u201cmost effective\u201d acceleration was found by a few trials: as expected\nfrom the Maxwellian case the corresponding fluctuation parameters depend\non beam density in order that the timescales for the processes are\ncomparable. We see that the acceleration in both cases occurs in a\nsimilar region in energy: 20 to 200\u00a0keV in the weaker beam case and 20\nto 300\u00a0keV in the stronger beam case, but the magnitude of the effect is\nstrongly dependent on the beam density.\n\n### 3.4 Energy Transfer Due to Diffusion\n\nThe acceleration process which we discuss is due to energy transfer\nbetween electrons at different velocities, with the total energy of the\nsystem remaining constant. Therefore, if we sum the energy loss and gain\nrate across electrons at all energies the result cannot be positive. In\nthe purely collisional case, the effective energy loss rate, @xmath can\nbe calculated analytically. This is done by assuming a single particle\nevolution (e.g. Brown et\u00a0al., 2009 ) , and writing a continuity equation\nfor the energy distribution function in Equation 3.18 . In Kontar et\u00a0al.\n( 2012 ) this is given as\n\n  -- -------- -- --------\n     @xmath      (3.29)\n  -- -------- -- --------\n\nwith solution in the purely collisional case\n\n  -- -------- -- --------\n     @xmath      (3.30)\n  -- -------- -- --------\n\nWe can also calculate numerically the effective energy loss rates for\nthe various simulation models used. These are plotted in Figure 3.17 .\n\nThe changes in energy loss rate are consistent with the observed\nacceleration. For purely collisional evolution, this is small and\nnegative, and varies slowly with energy. Once density variations are\nconsidered, we see that the losses at small energy increase, but those\nat larger energies decrease, and in fact become positive, i.e particles\nat large energies are gaining energy. Density fluctuations lead to\nincreased energy in fast electrons, but net losses over the energy range\nshown in the figure. Ion-sound wave interactions similarly show\nsignificantly increased overall losses, partly due to energy transfer to\nbackwards propagating electrons.\n\n### 3.5 Hard X-ray Flux\n\nThe electron flux averaged over the collisional lifetime of the\nelectrons, @xmath , is directly related to the observed HXR emission via\nthe cross-section for bremsstrahlung (Brown et\u00a0al., 2003 ) , and\nalthough recovering the electron flux from the photon distribution is\ndifficult mathematically, it requires no assumptions about the physical\nprocesses which may cause evolution of the electron distribution. In the\nprevious few sections we have seen that the evolution of Langmuir waves\ndue to their interaction with plasma density fluctuations can\nsignificantly affect this time-averaged electron flux, in contrast to\nthe situation in homogeneous plasma (Figure 3.8 ) where the changes are\nnegligible. We thus conclude that the Langmuir wave evolution will\naffect the observed HXR emission.\n\nSpecifically, we see significant changes in the electron flux above\n20\u00a0keV, up to around 200\u00a0keV. Below around 10-20\u00a0keV the HXR emission is\ndominated by the thermal spectrum, and so this evolution transfers\nenergy from the unobservable part of the distribution to the observable\nenergies. Thus the energy and number of electrons required in the beam\nas a whole is reduced when compared to the purely collisional case.\nStated another way, we may obtain more intense HXR emission above 20\u00a0keV\nfrom a less dense initial beam. Therefore, the processes discussed here\nare an important consideration when interpreting such HXR spectra.\n\n### 3.6 Conclusions\n\nFor a collisionally relaxing electron beam, the generation of Langmuir\nwaves, and their subsequent evolution due to variations in the plasma\ndensity, has been shown to lead to a significant electron acceleration\neffect. This follows the conclusions for a Maxwellian beam, where\nacceleration was also seen. We may extrapolate from the result in the\nMaxwellian test case that the strongest acceleration occurs for @xmath\nthat smaller scale and or more intense density fluctuations will lead to\nmore acceleration.\n\nIn the power law beam case, we may expect suppression of the beam plasma\ninstability due to very rapid diffusion to lead to the return of the\nelectron spectrum to the collisions only case, which is\nindistinguishable observationally from that of homogeneous plasma\nincluding Langmuir wave generation.\n\nSmall wavenumber ( @xmath ) ion-sound waves are generated automatically\ndue to the presence of high levels of Langmuir waves, and cause\nscattering of Langmuir waves to smaller wavenumbers and therefore a\nsimilar acceleration effect. In this case the acceleration can reach\nmuch larger velocities. However, in general, there is no significant\ndistinction observationally between the acceleration due to a density\ngradient, a fluctuating density or ion-sound wave scattering, and the\ndifferences are only in degree.\n\nFor the plasma density and beam parameters chosen, the acceleration\nincreases the time-averaged electron flux in exactly the important range\nfor observations, namely between 20 and 200\u00a0keV, and can increase the\nflux by a few or perhaps ten times in the most effective cases. Finally,\nwe see that as the extent of acceleration is constrained by the level of\nLangmuir waves generated, the acceleration will be more effective for\nmore intense beams. In other words, ignoring the effects of Langmuir\nwave generation and evolution will lead to a significant overestimate of\nthe required number of initially accelerated electrons, and the\nmagnitude of the overestimate will be larger the more electrons there\nare in the initial beam.\n\n## Chapter 4 Simulations of Radio Emission from Dense Coronal Loops\n\nThe high levels of Langmuir waves which can be generated by a fast\nelectron beam can, as discussed in Section 1.5.2 , lead to intense radio\nemission. The classic example of emission via this \u201cplasma emission\u201d\nmechanism is given by the radio bursts known as Type IIIs. Their intense\nbrightnesses indicate a coherent emission mechanism, and their wide\nfrequency range, with bursts observed from the low kHz up to 500\u00a0MHz,\nand occasionally up to a few GHz, means that this mechanism must operate\nover a very broad range of parameters. For example, in a high frequency\ncoronal burst we may have a density around @xmath cm @xmath and a\ntemperature of 1\u00a0MK, while for an interplanetary burst at 1\u00a0MHz we have\na density of @xmath cm @xmath and a temperature of perhaps 10000\u00a0K.\n\nGinzburg & Zhelezniakov ( 1958 ) first proposed a mechanism by which\nthese bursts could be produced, and this has been subsequently discussed\nand modified by various authors (e.g. Sturrock, 1964 ; Zheleznyakov &\nZaitsev, 1970 ; Smith, 1970 ; Smith et\u00a0al., 1976 ; Melrose, 1980c ;\nGoldman, 1983 ; Dulk, 1985 ; Melrose, 1987 ) . Yet in spite of the large\namounts of work invested in the problem, the exact details of their\nproduction are still not fully understood. It is known that they occur\ndue to an accelerated electron beam propagating in the decreasing\ndensity plasma of the corona and solar wind, which generates Langmuir\nwaves and subsequently electromagnetic emission at the plasma frequency.\n\nThere are thus three main factors which influence their production.\nFirstly, the details of electron beam acceleration and propagation;\nsecondly, the production of the Langmuir waves and their spectral\nevolution; and finally, the process of converting some fraction of the\nLangmuir wave energy into electromagnetic emission. In addition to these\nfactors, when considering remotely observed radiation we must account\nfor the effects of propagation, such as time delay in the emission,\nscattering and absorption.\n\nIn the solar wind it is possible to make in situ measurements of\nelectric field, and so infer the levels of Langmuir waves, and also to\nmeasure the electron distribution function. Low frequency compressive\nelectrostatic modes are also found in association with these Langmuir\nwaves, which may be identified as ion-sound waves (e.g. Lin et\u00a0al., 1986\n; Gurnett & Anderson, 1977 ; Gurnett & Frank, 1978 ; Thejappa &\nMacDowall, 1998 ) , and provide further evidence regarding the evolution\nof the Langmuir waves, and the production of radio emission. However,\ndeeper in the corona, the observed radio emission is the primary\ndiagnostic of the Langmuir waves. Where such emission occurs, we can\nfind a lower limit on the Langmuir wave levels required, but in general\nit is very difficult if not impossible to analytically relate the level\nof Langmuir waves to the level of radio emission.\n\nSimulations are therefore essential to address the details of the\nLangmuir wave evolution, and the inclusion of radio emission in these is\nnecessary to relate this to observations. In this chapter, we first\ndevelop a model of plasma radio emission, and subroutines allowing this\nto be incorporated into our code from the previous chapter. We then\nconsider effects of plasma density inhomogeneities on radio emission due\nto their effects on the Langmuir waves and electrons, for the model of a\ncollisionally relaxing electron beam in dense plasma.\n\n### 4.1 The Plasma Emission Mechanism\n\nThe mechanism behind plasma emission was outlined in Section 1.5.2 . For\nemission at GHz frequencies which we consider here, only harmonic\nemission will be of interest. This is largely due to the very large\noptical depth for fundamental emission (see Section 4.6.4 ), and also\nthe low efficiency of the fundamental emission mechanisms. Thus, the\nprocesses of interest are the decay @xmath and scattering by ions @xmath\nof Langmuir waves, and the coalescence of two Langmuir waves to produce\nemission at twice the local plasma frequency, @xmath . The observational\nfeatures of the emission at these frequencies were outlined in Section\n1.6 .\n\n#### 4.1.1 Simulating Plasma Radio Emission\n\nWe know that the production of plasma radio emission depends intimately\non three related processes: the production and evolution of an electron\nbeam, the subsequent Langmuir wave generation and evolution, and the\nfinal step of conversion into electromagnetic emission. Thus,\nsimulations of Type III bursts may approach the problem from several\nperspectives. For example, considering only the beam transport allows us\nto find the frequency drift of the burst, and explore how its\nfrequency-time profile depends on factors such as the beam velocity and\nthe geometry of the magnetic field lines along which the beam\npropagates. This has been done by several authors and provides\ninteresting results (e.g. Karlicky et\u00a0al., 1996 ; Robinson & Benz, 2000\n; Ledenev et\u00a0al., 2004 ) .\n\nConsidering Langmuir wave generation provides some additional\ninformation on the brightness of the radio emission. However, in general\nthis depends on the exact spectrum of the Langmuir waves, and therefore\nto see the details of the time profile at even a single frequency, and\nexplain the rise-decay profiles and the exact shape of the dynamic\nspectrum, we must address all three factors simultaneously. On the other\nhand treating any one possible effect in full is a significant\nundertaking, both theoretically and from a computational perspective.\nTherefore, there is a trade-off between the level of detail in any one\nstep, and the ability to consider the whole process for a variety of\nparameters. Here we employ simple but well justified models of each\nstep, in order to investigate specifically the effects of plasma\ninhomogeneity on the emission.\n\nThe most significant simplification, which we have discussed in previous\nchapters, is to assume the dynamics of the electrons and Langmuir waves\nlie along a single spatial dimension. Detailed simulations of beam\npropagation and Langmuir wave production were performed by Kontar et\u00a0al.\n( 1998 ); Mel\u2019Nik et\u00a0al. ( 1999 ) and have recently been extended\n(Kontar & Reid, 2009 ; Reid & Kontar, 2010 ) to follow a beam from the\nsun all the way to 1AU. The evolution of the Langmuir waves due to\ndensity fuctuations was shown to have significant effects on the\nLangmuir wave spectrum. Similar effects for the downwards moving beams\nwhich generate HXR emission were found by Hannah et\u00a0al. ( 2013 ) .\n\nFor a weak beam, with a small initial angular spread, the magnetic field\nof the corona and solar wind is sufficient to maintain a\nquasi-one-dimensional beam (Muschietti, 1990 ) , as the electrons will\npropagate along the field lines. In this case, the ion-sound waves\ngenerated from Langmuir wave decays will also be restricted to this same\ndirection. However, the electromagnetic emission occurs primarily at a\nsignificant angle to the parent Langmuir wave, specifically around\n@xmath for harmonic and @xmath for the fundamental. Moreover, the\nemission probabilities have strong angular dependence, as do the\nparticipating wavenumbers. Our first step is therefore to define a model\nof the emission geometry, and use this to derive a mathematical\ntreatment of the emission. This is the topic of the next section.\n\n### 4.2 3-D Equations for Scattering and Decay\n\nIt is necessary to distinguish between processes described as\n\u201cscattering\u201d and those described as \u201cdecay\u201d or \u201ccoalescence\u201d, the former\ninvolving the interaction of a wave with an individual plasma particle,\neither an electron or an ion, while the latter involve coherent motions\nof the plasma, i.e another wave mode. The equations describing the\nscattering and decay\/fusion processes in 3-D are given in the books by\nMelrose ( 1980b ); Tsytovich ( 1995 ) and are reproduced in the next\nsections.\n\nA weak magnetic field, where @xmath , has little or no effect on the\nemission probabilities for plasma emission processes (e.g. Melrose & Sy,\n1972 ) and so we use the equations for unmagnetised plasma. However, as\nwe will discuss in Section 4.4 , the field cannot be completely\nneglected in plasma emission, as it affects the polarisation states of\nthe resulting waves.\n\n#### 4.2.1 Ion Scattering Processes\n\nDescribed by @xmath , where @xmath denote wave modes, these describe the\naction of scattering by an individual plasma particle, for our purposes\nan ion, @xmath , averaged over their distribution, which in this case is\nthermal and described by a Maxwellian. The change in momentum of the\nwave during scattering is absorbed by the ion, but this is small and so\nwe may neglect the evolution of the ion distribution, instead assuming\nit very rapidly returns to thermal. The product wave can be of the same\nspecies, or a different species.\n\nWriting @xmath for the spectral energy density, wavevector and frequency\nof wave type @xmath , the equations in 3-D describing the process @xmath\nare:\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      (4.1)\n  -- -------- -------- -- -------\n\nand\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      (4.2)\n  -- -------- -------- -- -------\n\nThe probability @xmath depends on the wave modes involved, but for\nscattering of Langmuir waves it is\n\n  -- -------- -- -------\n     @xmath      (4.3)\n  -- -------- -- -------\n\nwith the constant\n\n  -- -------- -- -------\n     @xmath      (4.4)\n  -- -------- -- -------\n\nand @xmath a unit vector in the direction of the electric field of the\nwave mode @xmath . Langmuir waves are longitudinal so that @xmath ,\nwhile electromagnetic waves are transverse so @xmath .\n\n#### 4.2.2 3-wave Decays\n\nDescribed by @xmath , the three wave processes describe either decay due\nto the presence of another wave mode, or fusion of two existing wave\nmodes. We write @xmath for the spectral energy density, wavevector and\nfrequency of waves in mode @xmath . Then energy and momentum\nconservation are described by the equations @xmath and @xmath and we\nhave\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      (4.5)\n  -- -------- -------- -- -------\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      (4.6)\n  -- -------- -------- -- -------\n\nand\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      (4.7)\n  -- -------- -------- -- -------\n\nwhere @xmath is the emission probability. The form of this depends\nstrongly on the wave modes involved, and again is dependent on their\nelectric field directions, @xmath . The probabilities for relevant\nprocesses are given in the following derivations (Equations A.1 and 4.11\n).\n\n#### 4.2.3 Decay versus Scattering\n\nCoherent oscillations of the plasma particles can exist only when their\ndamping rate is far less than their frequency. For ion-sound waves,\nwhich are oscillations of the electrons and ions, the requirement that\n@xmath requires that we have @xmath , and we cannot speak of a decay\nprocess involving ion-sound waves unless this condition is satisfied. On\nthe other hand, scattering by individual ions, neglecting plasma\ncollective effects, is also important, and this is particularly\nefficient when @xmath . The two processes are not entirely distinct:\nboth are scattering by plasma ions but the former involves collective\nmotion of these, and is therefore a resonant interaction. It turns out\nthat the effects of decay when @xmath and of scattering when @xmath are\nvery similar, to within a numerical factor of 4 or so (Tsytovich, 1995 )\n.\n\nIn addition to this, when @xmath the wavenumber matching conditions for\ndecay may mean that this cannot proceed, and scattering may be\nimportant, although its efficiency is small for this ratio. Thus, in\norder to consider the full range of temperature ratios observed in the\nsolar corona and solar wind (e.g. Newbury et\u00a0al., 1998 ; Gurnett et\u00a0al.,\n1979 ) , which range from @xmath to @xmath or even 2, we must consider\nboth the decay and scattering formulations, and employ the correct one\nfor the parameters chosen, to avoid overestimating the effects on\nLangmuir waves.\n\n### 4.3 A Model for Plasma Emission\n\n#### 4.3.1 Langmuir Wave Evolution\n\nIn the previous chapters we described a model of Langmuir wave\ngeneration from a collisionally relaxing beam including the effects of\nion-sound wave scattering, and perturbations in the ambient plasma\ndensity. However, we focused on the effects on the beam-generated\nLangmuir waves with @xmath and the consequent effects on the electron\ndistribution. For plasma emission, we are specifically interested both\nin the backscattered Langmuir waves with @xmath and the exact spectrum\nof ion-sound waves (when @xmath and these can exist).\n\nTherefore, here we combine Equations 3.2 and 3.3 for the beam-wave\ninteractions including the effects of plasma density fluctuations, with\nEquations 3.3.5 and 3.3.5 describing scattering by ion-sound waves, and\nin addition consider a term in the Langmuir wave equation describing\nscattering by individual ions. Beginning from Equation 4.1 , noting that\nas @xmath and @xmath are the same species we sum the contributions from\nthe two equations, we substitute a 1-dimensional Langmuir wave spectrum,\nwhich is non-zero only along the direction of the electron beam, given\nby\n\n  -- -------- -- -------\n     @xmath      (4.8)\n  -- -------- -- -------\n\nThen we have @xmath and the ion scattering is described by\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      (4.9)\n  -- -------- -------- -- -------\n\nFrom a computational perspective, this equation is cumbersome to\nsimulate because of the remaining integral over @xmath . However, the\nexponential factor means the integrand is sharply peaked around @xmath ,\nwhich allows us to consider the integral over only a small range in\n@xmath and thus speed this up considerably.\n\n#### 4.3.2 Fundamental Emission\n\nFundamental emission at @xmath generally does not occur at frequencies\nabove a few hundred MHz. Our simulations consider the situations of\nequal or almost equal electron and ion temperatures, where ion-sound\nwaves are strongly damped and thus contributions to the Langmuir wave\nspectrum from the processes @xmath can be ignored. Direct scattering of\nLangmuir waves into fundamental emission, @xmath also has negligible\neffect on the Langmuir waves. An angle-averaged model for the radio\nemission is given in Appendix A, as this will be important for future\nwork on lower frequency emission, but is omitted here for brevity.\n\n#### 4.3.3 Harmonic Emission\n\nWe focus instead on the process of harmonic emission due to the\ncoalescence of two Langmuir waves, i.e @xmath . Writing the\nparticipating wave vectors as @xmath for the Langmuir waves and @xmath\nfor the electromagnetic wave, and further writing @xmath , the general\nequation for the process is\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (4.10)\n  -- -------- -------- -- --------\n\nwith probability\n\n  -- -------- -- --------\n     @xmath      (4.11)\n  -- -------- -- --------\n\nand the condition @xmath .\n\nThe \u201chead-on-approximation\u201d (HOA) where the coalescing Langmuir waves\nare almost parallel was proposed in early models of plasma emission\n(e.g. Melrose & Stenhouse, 1979 ) . This implies that @xmath , as @xmath\nmust be at a non-zero angle to the parent Langmuir wave or the emission\ncannot occur. However, if we consider an electromagnetic wave at\napproximately twice the local plasma frequency we have @xmath and\ntherefore the typical wavenumber is @xmath . For beam generated Langmuir\nwaves we have typical wavenumbers of @xmath , so for a typical beam\nvelocity of @xmath we have @xmath which is by no means small. Therefore\nwe wish to find a better approximation than the HOA.\n\n##### An Approximate Emission Geometry\n\nFirstly, we define the angle @xmath to be the angle between the forwards\nLangmuir wave with wavenumber @xmath and the electromagnetic wave with\nwavenumber @xmath , as shown in the vector diagrams in Figure 4.1 . The\ncomplications then become clear if we consider the emission equation. In\nthe HOA we have to good accuracy that @xmath and also that @xmath , so\nthe entire angular dependence of the probability is via a term like\n@xmath . Relaxing the HOA introduces additional angular dependence into\nthe probability because, as shown in Figure 4.1 , the solution for\n@xmath from the wavenumber matching also depends on @xmath .\n\nTaking the conservation conditions @xmath and @xmath we can find their\nsolutions as a function of @xmath . Then we can find the exact emission\nprobability from Equation 4.11 . In Figure 4.2 we plot this for several\nvalues of the electromagnetic wavenumber @xmath , along with the\nprobability in the HOA approximation. In all cases the probability shows\nquadrupolar forms, and the differences from the simple HOA solution\ndecrease as the electromagnetic wavenumber increases. Most importantly,\nboth the angle of the peak, and the width of the probability remain\nsimilar. If we also consider the average of the two lobes, there is very\nlittle difference from the simple HOA.\n\nTherefore, it seems reasonable to assume, when solving the wavenumber\nmatching, that all emission occurs at @xmath , which is the angle of\nmaximum emission probability in the HOA and very close to it in the\nexact solution. Then we independently calculate an angle-averaged\nprobability using these solutions. From the width of the emission\nprobability curves, it is reasonable to assume emission occurs only\nwithin the angular range @xmath , which covers its\nfull-width-half-maximum (FWHM).\n\nFor a particular electromagnetic wavenumber there will be a range of\nvalues for @xmath depending on the angle of emission @xmath , whereas\nour approximation assumes that @xmath . We now calculate the size of the\nvariation in @xmath for emission within the angular range @xmath . In\nFigure 4.3 we plot the difference in value at @xmath and @xmath ,\ndivided by the value at @xmath , i.e. @xmath , as a function of the\nelectromagnetic frequency. Clearly, for frequencies very close to @xmath\nthe similarity in magnitude of @xmath and @xmath means that the angular\neffects become more important. However, above around @xmath we have a\nreasonable approximation, with variation of less than @xmath in @xmath .\nThe ratio @xmath is even more dependent on the angle @xmath , but again,\nabove @xmath the variation is below @xmath .\n\nThe implications of this variation in @xmath may be summarised as\nfollows. We consider emission to come from Langmuir waves at a\nwavenumber @xmath , where in fact the emission is from a weighted\naverage over a band of @xmath , the weighting in the average has a form\nsimilar to @xmath , and @xmath is of the order @xmath or less. On the\nother hand, for the purposes of our simulations, the average need only\nbe taken over two, or perhaps a few grid points. For example, for a\n@xmath simulation grid of @xmath points covering @xmath from 0 to 0.4\n@xmath we require averaging over only @xmath grid points at @xmath and\nfor a slightly more coarse gridding no averaging is needed at all.\n\nThe final consideration relates to the angular distribution of the\nLangmuir waves. In the previous paragraphs we assumed that a wave\nexisted at the calculated wavevector @xmath , regardless of the angle\nbetween @xmath and @xmath . At a value of @xmath and @xmath , the angle\nbetween @xmath and @xmath is @xmath and at @xmath this has decreased to\nless than @xmath . Thus, provided we have Langmuir waves with an angular\nspread of half-angle at least @xmath there are waves with the necessary\nwavevectors for coalescence to proceed.\n\nTo further account for these angular effects, we can calculate the\nfraction of the waves within the angular spread that can take part in\nthe coalescence, which will depend on the assumed angular spread, and\nthe required angle between @xmath and @xmath , and therefore the\nelectromagnetic frequency @xmath . This is plotted in Figure 4.4 for\nvarious values of the angles involved. Above @xmath this fraction is\nabove approximately @xmath for the values considered, so a half angle of\nat least @xmath in the Langmuir waves is sufficient to ensure our\nestimate is within a factor of around 2 of the true value.\n\nTaking all this into account, we can say that the approximation of\ntaking @xmath for energy and momentum conservation and using an angular\naveraged probability as found in the next section, we will obtain a good\nagreement in magnitude with the angular averaged true 3-D emission\nprovided that the emission frequency is above approximately @xmath , the\nLangmuir wave spectrum does not contain very narrow spikes, of width\n@xmath in Langmuir wavenumber, and the Langmuir waves are fairly\nisotropic over an angular spread with half angle at least @xmath . The\nsecond two conditions are generally satisfied for our purposes as we\nconsider the presence of ambient plasma density fluctuations, which will\ntend to smooth out any spikes and produce an angular spread, as\ndescribed in Section 2.5.3 .\n\n##### Harmonic Emission Equations\n\nNow we use the geometry just described to derive angle-averaged\nequations for the coalescence process. For clarity, we label the\nLangmuir wave spectrum with wavenumbers parallel to the beam direction\nas the forwards spectrum, and those antiparallel as backwards. We assume\nthese both cover a small angular spread @xmath , with a half angle of at\nleast @xmath . Then we define\n\n  -- -------- -- --------\n     @xmath      (4.12)\n  -- -------- -- --------\n\nwithin @xmath , and zero elsewhere, while the electromagnetic emission\nis assumed to cover a cone of half angle @xmath in each lobe of the\nemission probability, and therefore a solid angle of @xmath , so we have\n\n  -- -------- -- --------\n     @xmath      (4.13)\n  -- -------- -- --------\n\nNow we proceed exactly as for the case of fundamental emission, by\ndefining the angle averaged probability as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand substituting the definitions in Equations 4.12 and 4.13 then\nconsidering in turn each term in the square brackets in Equation 4.3.3 .\n\nThe result is\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n                          (4.14)\n  -- -------- -------- -- --------\n\nThe final integral over @xmath is evaluated using the delta function\n@xmath , which leads to a factor of\n\n  -- -------- -- --------\n     @xmath      (4.15)\n  -- -------- -- --------\n\nAs a simple approximation to the probability, we can take the value\nassuming @xmath to solve for the @xmath values, and then take the peak\nvalue of the probability multiplied by its fractional FWHM, which is\n@xmath . Taking @xmath we have\n\n  -- -------- -- --------\n     @xmath      (4.16)\n  -- -------- -- --------\n\nCombining all of these factors we finally obtain\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n                          (4.17)\n  -- -------- -------- -- --------\n\nwhich describes electromagnetic emission due to Langmuir wave\ncoalescence in our approximation, with the angle-averaged spectral\nenergy densities given by Equations 4.12 and 4.13 .\n\n### 4.4 Polarisation and the Weak Field Limit\n\nIn the preceding discussion we neglected the magnetic field, because in\nthe weak field limit, @xmath , the emission probabilities are\neffectively the same as in the unmagnetised case. However, as we briefly\nmentioned earlier, even a weak magnetic field has significant effects on\nthe polarisation of the electromagnetic emission.\n\nFor fundamental emission, it was originally proposed that the\npolarisation should be 100 @xmath in the O-mode, because the X-mode has\na cutoff at @xmath . Considering the intrinsic bandwidth of the emission\ndue to the dispersion, the necessary magnetic field strength to obtain\n100 @xmath polarised emission can be estimated, and at 100\u00a0MHz this\nvalue is well below the inferred fields (e.g Melrose, 1980b ) .\n\nThe observed polarisation values for lower frequency fundamental Type\nIII emission of between 30 and 70 @xmath (Section 1.6.1 ) therefore\nrequire explanation. Scattering during propagation is certainly able to\nreduce the degree of polarisation, but cannot explain why fully\npolarised emission is never seen. Wentzel ( 1984 ) therefore proposed\nthat the emission was depolarised to some extent within the source\nregion itself, and that this was inherent to the emission process.\nFurther change during scattering can then explain the range of observed\nvalues.\n\nThe case of harmonic emission is more complicated. Melrose & Sy ( 1972\n); Melrose et\u00a0al. ( 1978 ) and the correction by Melrose et\u00a0al. ( 1980 )\ntreated the case of head-on Langmuir wave coalescence, and found that\nthe angular spectrum of the Langmuir waves dictates whether the emission\nis O or X-mode. However, as was shown by Willes & Melrose ( 1997 ) ,\nwhen the HOA is relaxed the percentage polarisation is very different,\nand when the difference in forwards and backwards Langmuir wavenumbers\nare accounted for, emission tends to favour the O-mode. However the\nLangmuir wavenumber and angular distributions are essential to decide\nboth the mode and the degree of polarisation. While some geometries of\nharmonic emission may allow weakly X-mode polarised emission to be\nproduced, very strong X-mode polarisation is not possible. On the other\nhand, for emission occurring at an angle of @xmath to the ambient\nmagnetic field, as we assume in the model of the previous section, the\nresults of Willes & Melrose ( 1997 ) suggest polarisation of around 10\nto 15 % in the O-mode, consistent with the observations.\n\n#### 4.4.1 Polarisation Change During Transport\n\nWe also note that further changes in the degree of polarisation can\noccur during propagation from source to observer. For example, mode\ncoupling due to magnetic fields (e.g. Zheleznyakov & Zlotnik, 1964 ) ,\nand scattering due to low-frequency waves (Wentzel, 1984 ; Melrose, 1989\n) , or kinetic Alfven waves (Sirenko et\u00a0al., 2002 ) have all been\nconsidered, and can all lead to significant changes in polarisation\ndegree.\n\n### 4.5 Thermal Emission\n\nIn thermal plasma, there will be electromagnetic emission due to thermal\nbremsstrahlung, giving a thermal source term\n\n  -- -------- -- --------\n     @xmath      (4.18)\n  -- -------- -- --------\n\n(e.g. Melrose, 1980a , Equation 3.81) , for the power radiated per unit\nvolume, per unit frequency over all angles. Now for electromagnetic\nwaves we have @xmath and in plasma we can approximate @xmath from\nquasineutrality. We have, assuming @xmath is isotropic,\n\n  -- -------- -- --------\n     @xmath      (4.19)\n  -- -------- -- --------\n\nand so with @xmath we obtain\n\n  -- -------- -- --------\n     @xmath      (4.20)\n  -- -------- -- --------\n\nFinally, assuming isotropy, we can change this to an angle-averaged\nspectral energy density by multiplying by @xmath , finding\n\n  -- -------- -- --------\n     @xmath      (4.21)\n  -- -------- -- --------\n\nNow by Kirchoff\u2019s law, in optically thick plasma in thermal equilibrium\nthe emission must be balanced by an absorption with coefficient @xmath\ngiven by\n\n  -- -------- -- --------\n     @xmath      (4.22)\n  -- -------- -- --------\n\nThen we find\n\n  -- -------- -- --------\n     @xmath      (4.23)\n  -- -------- -- --------\n\nAs expected we then have that\n\n  -- -------- -- --------\n     @xmath      (4.24)\n  -- -------- -- --------\n\ni.e. the emission and absorption are in equilibrium for the thermal\nspectrum. We add these two terms to our equations for electromagnetic\nevolution: a thermal source term @xmath given by 4.21 and a damping term\n@xmath .\n\n### 4.6 Observed Fluxes\n\nIn order to relate the results of our simulations to observed emission,\nwe must first convert the angle-averaged spectral energy densities into\nfluxes, which requires that we specify the size of the emitting source.\nThen we must add the effects of absorption or scattering in the source\nand during propagation. For harmonic emission these effects are smaller\nthan for the fundamental, and the time delay experienced by the\nradiation during propagation is also less, but these effects cannot be\nneglected.\n\n#### 4.6.1 Conversion of Energy Density to Flux\n\nThe total flux is given by\n\n  -- -------- -- --------\n     @xmath      (4.25)\n  -- -------- -- --------\n\nwhere @xmath is the energy density of the source, @xmath its area,\n@xmath its length (along the direction of the beam) and @xmath is its\ndistance from the observer, and @xmath is the group velocity of the\nradiation. The flux as a function of frequency @xmath is then given by\n@xmath . The energy density @xmath relates to the angle-averaged\nspectral energy density by\n\n  -- -------- -- --------\n     @xmath      (4.26)\n  -- -------- -- --------\n\nand we have\n\n  -- -------- -- --------\n     @xmath      (4.27)\n  -- -------- -- --------\n\nTherefore\n\n  -- -------- -- --------\n     @xmath      (4.28)\n  -- -------- -- --------\n\nFor emission at GHz frequencies the source is small (see Section 4.6.2\n), and located at approximately 1\u00a0AU from the observer, so we may apply\nthe small angle approximation and find @xmath where @xmath is the\nhalf-angle of the source in radians. In this case we have\n\n  -- -------- -- --------\n     @xmath      (4.29)\n  -- -------- -- --------\n\n#### 4.6.2 Source Size\n\nSource size measurements were discussed in Section 1.6.1 where it was\nconcluded that sizes observed at 1\u00a0GHz are around @xmath . We can also\nmake a reasonable estimate of the linear size of the emitting region,\nand calculate the angular size. This is sufficiently accurate for the\npurposes of estimating the observed flux from our simulations. Taking a\nlinear size of @xmath cm, located at a distance of 1\u00a0AU, and using the\nsmall angle approximation we obtain an angular extent of @xmath , in\nreasonable agreement with the measurements, as some angular scattering\nmay be expected.\n\n#### 4.6.3 Propagation Losses\n\nLangmuir waves have a very small group velocity, and so the loss of\nwaves from the emission region due to propagation is negligible.\nHowever, electromagnetic radiation has a group velocity given by\n\n  -- -------- -- --------\n     @xmath      (4.30)\n  -- -------- -- --------\n\nwhere @xmath is the frequency of the emission and @xmath the local\nplasma frequency, and this approaches @xmath for @xmath .\n\nFor radiation in plasma of changing density this becomes\n\n  -- -------- -- --------\n     @xmath      (4.31)\n  -- -------- -- --------\n\nwhere @xmath is the frequency of the original emission, and @xmath is\nthe local plasma frequency, which depends on position.\n\nWe model the effects of radiation escape by adding a term\n\n  -- -------- -- --------\n     @xmath      (4.32)\n  -- -------- -- --------\n\nwhere @xmath is the size of the emitting region, to our equation for the\nevolution of the electromagnetic wave spectral energy densities.\n\n#### 4.6.4 Collisional Damping\n\nIn the corona, inverse bremsstrahlung is a significant cause of\nattenuation of electromagnetic radiation, with damping rate as given in\nEquation 4.23 , namely\n\n  -- -------- -- --------\n     @xmath      (4.33)\n  -- -------- -- --------\n\nwhich depends on position via the local plasma frequency. Assuming\nisothermal plasma between the radiation source and the observer \u00b9 \u00b9 1 As\nwill be seen, given an exponential density profile, the damping is only\nsignificant for a relatively short fraction of the total path length,\nand therefore this assumption is in general reasonable. and writing the\nfrequency and wavenumber of the emission at the source as @xmath ,\n@xmath , we have the group velocity as in the previous section, and an\noptical depth given by definition as\n\n  -- -------- -- --------\n     @xmath      (4.34)\n  -- -------- -- --------\n\nSubstituting the expression for @xmath the optical depth becomes\n\n  -- -------- -- --------\n     @xmath      (4.35)\n  -- -------- -- --------\n\nClearly this diverges as @xmath because the group velocity goes to zero.\n\nNow the plasma frequency relates to the density via\n\n  -- -------- -- --------\n     @xmath      (4.36)\n  -- -------- -- --------\n\nand so\n\n  -- -------- -- --------\n     @xmath      (4.37)\n  -- -------- -- --------\n\nNow we assume an exponential density profile with a fixed scale height\n@xmath , so that @xmath where @xmath is the density at the source, and\nfind\n\n  -- -------- -- --------\n     @xmath      (4.38)\n  -- -------- -- --------\n\nIn Figure 4.5 we plot the optical depth as a function of frequency for a\ngiven scale height, @xmath cm, and also the optical depth as a function\nof scale height for a frequency of 1\u00a0GHz. Clearly, at frequencies much\nabove 0.6\u00a0GHz there can be no escaping fundamental emission for this\nchoice of scale height @xmath , and at 1\u00a0GHz no escape of fundamental\nemission for any reasonable choice of @xmath . For the harmonic the\nsituation is better, but there will still be significant collisional\ndamping, and at frequencies much larger than 1\u00a0GHz the escape fraction\nis rather small.\n\nA similar conclusion was reached by e.g. Benz et\u00a0al. ( 1992 ) and\nKarlicky ( 1998 ) for an exponential density profile, who suggest that\nharmonic emission can be the only escaping component, and moreover even\nthis likely requires fibrous structures in the corona, with emission\noccurring in dense areas with small cross sectional area and escaping\nthrough the less dense surrounding plasma.\n\nFor our purpose, which is an estimation of the observed flux due to a\ngiven spectral energy density of emission, this exponential density\nprofile, with fixed scale length, is sufficient. For the corona,\nreasonable values of @xmath are around 1 to @xmath cm.\n\n#### 4.6.5 Time Delay\n\nThe time delay experienced by electromagnetic emission in propagating\nfrom where it is emitted to where it is observed also depends on\nfrequency\n\n  -- -------- -- --------\n     @xmath      (4.39)\n  -- -------- -- --------\n\nwhere @xmath is the distance from the source to the observer.\nSubstituting for the group velocity gives\n\n  -- -------- -- --------\n     @xmath      (4.40)\n  -- -------- -- --------\n\nAgain assuming an exponential density profile @xmath , we use the\nsubstitution, @xmath . Then @xmath with @xmath . Now we have\n\n  -- -------- -- --------\n     @xmath      (4.41)\n  -- -------- -- --------\n\nThis may be evaluated using partial fractions. We assume\n\n  -- -------- -- --------\n     @xmath      (4.42)\n  -- -------- -- --------\n\nand find the constants @xmath , which gives\n\n  -- -------- -- --------\n     @xmath      (4.43)\n  -- -------- -- --------\n\nPerforming this integral gives\n\n  -- -------- -- --------\n     @xmath      (4.44)\n  -- -------- -- --------\n\nNow the distance @xmath for a coronal source is approximately 1AU and\nmuch larger than @xmath , and so we can apply the binomial expansion to\nthe upper limit,\n\n  -- -------- -- --------\n     @xmath      (4.45)\n  -- -------- -- --------\n\nand use this in the argument of @xmath .\n\nThe time delay is therefore finally\n\n  -- -- -- --------\n           (4.46)\n  -- -- -- --------\n\nwith @xmath the frequency of the emission and @xmath the local plasma\nfrequency in the emitting region.\n\n#### 4.6.6 Angular Scattering\n\nRadio observations at microwave and decimetre wavelengths rarely show\nfine structure on spatial scales below around @xmath at 1.5\u00a0GHz and\naround @xmath at 300\u00a0MHz, which can be explained by angular scattering\nof the radiation during propagation (Bastian, 1994 ) . Density\nfluctuations on a variety of scales have been measured in the corona at\na few solar radii by various techniques (e.g. Coles & Harmon, 1989 ;\nSpangler et\u00a0al., 1996 ; Grall et\u00a0al., 1997 ) , and in the solar wind\n(e.g. Cronyn, 1972 ; Celnikier et\u00a0al., 1983 ; Robinson, 1983 ) . Various\nanalytical (e.g. Bastian, 1994 ; Cairns, 1998 ; Arzner & Magun, 1999 )\nand numerical (e.g. Riddle, 1972 ; Itkina & Levin, 1992 ) treatments of\ntheir effects have been attempted, with the general conclusion that at\nhigh MHz and GHz frequencies, scattering will produce sources of size at\nleast @xmath to @xmath . The extent of this effect is far larger for\nemission at the fundamental, and tends to increase at lower frequencies,\nbecoming very significant for IP bursts, where the source size can be\napproximately doubled (Steinberg et\u00a0al., 1985 ) .\n\nHowever, for harmonic radiation the effects of angular scattering are\nlikely to be small with respect to the size of the source itself,\nalthough any spatial structure within the source will be smeared out.\nAngular scattering is therefore unimportant for our purposes, although\nit will certainly occur due to the small-scale density fluctuations\nwhich we consider in our emission model.\n\n### 4.7 Simulations of 2\u00a0GHz Plasma Emission\n\nCombining the model for plasma radio emission derived in the previous\nsections with the model of beam-wave interactions used in Chapters 2 and\n3 , we now simulate the radio emission from a collisionally relaxing\nbeam in inhomogeneous plasma. This work is currently begin prepared for\npublication as Ratcliffe & Kontar ( 2013 ) . As discussed in Section 3.3\n, the formation of a reverse slope in the electron distribution will be\nmainly due to collisional effects for the case of dense plasma,\nconsidered over short spatial scales. Because of the high density we\nconsider, the emission is purely at the harmonic, with the fundamental\ncomponent produced inefficiently and unable to escape.\n\nThe effects of plasma density fluctuations on the Langmuir waves in this\nmodel were considered in the previous chapter. In general, we found a\ndecrease in the peak wave level, but significant increases at small\nwavenumbers. We also saw that collisional relaxation leads to a Langmuir\nwave spectrum which drifts to smaller wavenumbers over time. As\nmentioned in Section 1.5.4 and by e.g. Zhelezniakov & Zaitsev ( 1975 )\nthe spectral evolution of the Langmuir waves is a significant factor in\nthe rise and decay of the harmonic emission due to the strong\nconstraints on participating wavenumber. We therefore expect the\nspectral evolution due to density fluctuations will play an important\nrole in the emission.\n\n#### 4.7.1 Complete Simulation Model\n\n##### Equations for Electron and Wave Evolution\n\nWe state here the entire set of equations which we simulate, dropping\nthe superscripts @xmath as all spectral energy densities are now\nangle-averaged . Only plasma emission at the harmonic is considered,\nbecause the fundamental is very weak, and cannot escape from plasma of\nsuch high density (see Section 4.6.4 ).\n\nFor the electrons we have (Equation 3.2 )\n\n  -- -------- -- --------\n     @xmath      (4.47)\n  -- -------- -- --------\n\nwhile for the Langmuir waves we have (Equation 3.3 )\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (4.48)\n  -- -------- -------- -- --------\n\nwith the coefficient of diffusion, @xmath , given by Equation 2.38 . The\nsource term due to ion scattering is (Equation 4.3.1 )\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (4.49)\n  -- -------- -------- -- --------\n\nand that due to ion-sound wave decays is (Equation 3.3.5 )\n\n  -- -------- -- --------\n     @xmath      \n     @xmath      \n     @xmath      (4.50)\n  -- -------- -- --------\n\nwhere we distinguish between @xmath and @xmath . For the ion-sound waves\n(where these can exist) we have (Equation 3.3.5 )\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      \n              @xmath      (4.51)\n  -- -------- -------- -- --------\n\nwhere @xmath is the initial Langmuir wavenumber and @xmath is the\nscattered wave and the constants @xmath and the sound wave damping rate\nare given by (Equations 3.26 and 3.27 respectively):\n\n  -- -------- -- --------\n     @xmath      (4.52)\n  -- -------- -- --------\n\n  -- -------- -- --------\n     @xmath      (4.53)\n  -- -------- -- --------\n\nFor the harmonic emission we have\n\n  -- -------- -- --------\n     @xmath      (4.54)\n  -- -------- -- --------\n\nwhere @xmath is the collisional damping rate (Section 4.6.4 )\n\n  -- -------- -- --------\n     @xmath      (4.55)\n  -- -------- -- --------\n\nthe thermal emission is (Section 4.5 )\n\n  -- -------- -- --------\n     @xmath      (4.56)\n  -- -------- -- --------\n\nand the term @xmath , where @xmath is the size of the emitting region,\naccounts for propagation losses (Section 4.6.3 ). The source term is\ngiven by 4.3.3 :\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (4.57)\n  -- -------- -------- -- --------\n\n##### Initial Conditions\n\nWe take a plasma density of @xmath cm @xmath , corresponding to a plasma\nfrequency of @xmath GHz.\n\nThe initial beam and Langmuir wave distributions are as in Section 3.3 ,\nnamely\n\n  -- -------- -- --------\n     @xmath      (4.58)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (4.59)\n  -- -------- -- --------\n\nand the initial radio spectral energy density @xmath is set to the\nthermal level, i.e.\n\n  -- -------- -- --------\n     @xmath      (4.60)\n  -- -------- -- --------\n\n##### Propagation Effects and Observed Fluxes\n\nFrom the angle-averaged spectral energy density @xmath for harmonic\nemission, we can estimate an observed flux, given by\n\n  -- -------- -- --------\n     @xmath      (4.61)\n  -- -------- -- --------\n\nwhere @xmath is the frequency, @xmath , @xmath is the observed angular\nextent of the source, which we take as @xmath (see Section 4.6.2 ) and\n@xmath is the optical depth from Equation 4.38 . The density scale\nheight is @xmath cm, as in Table 4.1 .\n\n#### 4.7.2 Scattering by Ions\n\nWe begin by considering the emission in plasma with equal ion and\nelectron temperatures, @xmath MK. In this case, ion-sound wave\ninteractions cannot occur, and the generation of backscattered Langmuir\nwaves is due to scattering by individual ions, given by Equation 4.7.1 .\nWe take a beam density of @xmath cm @xmath , a velocity of @xmath cm\u00a0s\n@xmath and a velocity space power law index of @xmath . Collisional\nrelaxation proceeds as in the previous chapter on the collisional\ntimescale @xmath , and we consider the evolution over one to two\nthousand @xmath , after which the levels of backscattered Langmuir waves\nhave decreased and the radio emission peaked.\n\nIn Figure 4.6 we show the electron distribution, the Langmuir wave\nspectral energy density and the harmonic radiation brightness\ntemperature for the case of homogeneous plasma. The exponential factor\nin the backscattering probability in Equation 4.7.1 means that only\nwavenumbers of magnitude close to the wavenumber under consideration can\ncontribute to the backscattering. Spontaneous scattering, described by\nthe first two terms in square brackets in Equation 4.3.1 , proceeds\nfairly slowly, and gives a smooth backwards Langmuir wave spectrum. Once\na small level of backscattered waves is present, stimulated emission can\noccur, as given by the third term in square brackets, involving the\nproduct @xmath . This proceeds much more rapidly but because of the\nfactor of @xmath in this term, only regions with a locally positive\ngradient @xmath can contribute. The resulting backscattered Langmuir\nwave spectrum is therefore irregular.\n\nThis effect is seen clearly in the plots of the Langmuir wave spectral\nenergy density and radio flux shown in Figure 4.8 , giving the observed\nradio emission in sfu calculated using Equation 4.61 with parameters as\nin Table 4.1 . The calculated fluxes of a few to a few hundred sfu in\nthe strongest case are in good agreement with the observed fluxes of\nhigh frequency plasma emission (Section 1.6.1 ). On the other hand, we\nnote that these fluxes are calculated assuming a simple exponential\ndensity profile, which for the parameters chosen gives a factor @xmath\nof approximately @xmath . More efficient escape can therefore lead to\nfluxes up to @xmath times larger.\n\nIn Figure 4.8 we show three cases of density fluctuations, chosen using\nthe results of the previous chapter, as well as the homogeneous case.\nThe characteristic velocity and wavenumber of the fluctuations are fixed\nat @xmath cm\u00a0s @xmath and @xmath respectively. For the RMS fluctuation\nmagnitude, \u201cweak\u201d diffusion has @xmath , \u201cmoderate\u201d diffusion has @xmath\nand \u201cstrong\u201d diffusion has @xmath . Although this range is small, it\ncovers the interesting cases for these beam and plasma parameters.\n\nAs the strength of the Langmuir wavenumber diffusion increases we see\nmore and more smoothing of the backscattered emission, and a reduction\nin its peak magnitude. At the same time, the removal of waves from the\nforwards spectrum is also suppressed, and the levels of emission\nsignificantly reduced.\n\nTo quantify the reductions, we calculate the non-thermal energy in the\nLangmuir waves, backwards Langmuir waves and electromagnetic emission,\ngiven by\n\n  -- -------- -- --------\n     @xmath      (4.62)\n  -- -------- -- --------\n\nand\n\n  -- -- -- --------\n           (4.63)\n  -- -- -- --------\n\nWe plot these in Figure 4.9 . The saw-tooth oscillations seen around 0.3\nto 0.4\u00a0s are a numerical effect due to the finite wavenumber grid used\nin the simulations. The relation between the harmonic emission and the\nbackscattered Langmuir waves is clearly seen, as the rise of @xmath\nclosely tracks @xmath . However, at later stages, the drift of the\nmaximum Langmuir wave level towards smaller wavenumbers, where the\nconversion to harmonic emission occurs more rapidly, can become\nimportant and the emission level can increase despite continuing\ndecrease of the total and backwards Langmuir wave energy. This is\nclearly seen around 0.15 to 0.3\u00a0s for fluctuations of weak or moderate\nstrength.\n\nOn the other hand, for the strongest fluctuations shown, we see that the\nonset of rapid stimulated scattering is strongly suppressed and the\nlevel of backwards waves is decreased by more than an order of\nmagnitude. Figure 4.10 shows the peak energy in backscattered waves as a\nfunction of the RMS fluctuation magnitude, and displays a very sharp\nreduction for a level of @xmath . The energy in radio emission is\nsimilarly decreased, and remains above the thermal level for only a very\nshort time, in contrast to the 0.4\u00a0s or more duration in the less\ninhomogeneous cases. Thus, despite having the same energy in initial\nelectrons, and a very similar energy in the forwards Langmuir waves, the\nLangmuir wavenumber diffusion can suppress the backscattering and\ntherefore the emission.\n\nFinally we note that the intrinsic band width of the emission due to\nion-scattering is rather large, 50\u00a0MHz at 1\u00a0GHz plasma frequency, and\nthe emission shows an intrinsic frequency drift due to the drift of the\nLangmuir wave peak to lower frequencies during the collisional\nrelaxation process.\n\n#### 4.7.3 Wave-wave Interactions\n\nFor plasma with a larger electron temperature than ion temperature, the\nbackscattering of Langmuir waves can occur due to interactions with ion\nsound waves. We consider here a temperature ratio of @xmath , for which\nion-sound waves are still heavily damped, but the 3-wave decay process\nare allowed. The decay @xmath gives more efficient Langmuir wave\nbackscattering than the ion-scattering process and so for simplicity we\nswitch off the latter and consider only the former.\n\nIn Figures 4.11 and 4.12 we show the resulting electron distributions,\nand the Langmuir, ion-sound and electromagnetic wave distributions over\ntime for a beam density of @xmath cm @xmath , including the effects of\ndecay @xmath , for plasma inhomogeneities of RMS magnitude @xmath and\n@xmath respectively. As before, we see a slow drift of the Langmuir wave\npeak from large to small wavenumbers due to the collisional relaxation,\nbut now there is additional scattering of the Langmuir waves to small\nwavenumbers. The Langmuir waves backscatter to smaller wavenumbers,\n@xmath (see Section 3.3.5 ) and so the radio emission occurs for\nslightly smaller wavenumbers, giving an intrinsic bandwidth of only\nabout 25\u00a0MHz, half that seen in the ion-scattering case.\n\nOn the other hand, for ion-sound wave decays, even much stronger\ninhomogeneity, with @xmath , does not drastically decrease the\nbackscattering, and we obtain emission reaching a brightness temperature\nof @xmath K, corresponding to a flux of around 20\u00a0sfu.\n\n### 4.8 Conclusions\n\nA collisionally relaxing electron beam of initial density @xmath or\n@xmath cm\u00a0s @xmath will produce harmonic radio emission due to the\nplasma mechanism. Our simulations show emission at a single value of the\nlocal plasma frequency with brightness and duration in good agreement\nwith observations. The above quoted fluxes are derived by assuming a\nsimple model for the escape of emission, and so could be increased by up\nto perhaps 10 times if the escape were more efficient. Using the results\nof Willes & Melrose ( 1997 ) we infer the emission will be weakly O-mode\npolarised, up to around 15 %, also in good agreement with observations.\n\nFor equal temperature plasma, @xmath , the only source of backscattered\nLangmuir waves is the process of scattering by plasma ions. Spontaneous\nscattering is a slow process, but stimulated scattering can occur\nrapidly. However, as we have seen, plasma density fluctuations lead to\nthe diffusion of the Langmuir waves in wavenumber space, and can prevent\nthe onset of rapid stimulated scattering. In this case, very few\nbackscattered Langmuir waves are produced and consequently very little\nradio emission. This is seen to occur for a very low level of\nfluctuations, @xmath for the parameters considered here.\n\nThe magnitude of relative density fluctuations @xmath commonly observed\nin the corona and solar wind range from @xmath and @xmath (e.g. Cronyn,\n1972 ; Smith & Sime, 1979 ; Coles & Harmon, 1989 , and Section 1.1.4 ) .\nAssuming equal ion and electron temperatures, we infer that only in the\nleast inhomogeneous case will radio emission be seen. Clearly this is\nonly proven in cases where our model of a collisionally relaxing beam\nadequately captures the Langmuir waves dynamics: however the effects of\ndensity inhomogeneity on the onset of stimulated ion scattering may\nextrapolate to other situations.\n\nOn the other hand, if @xmath we can consider scattering due to ion-sound\nwaves, which occurs much more rapidly, and is less affected by\ninhomogeneities. However, the ion temperature in the corona at the\nfrequencies we consider is generally thought to be equal to the electron\ntemperature, and so the ion sound waves cannot exist and scattering must\nbe due to ions.\n\nThus, in the case where @xmath , our model suggests that it is possible\nto obtain a large number of Langmuir waves at positive wavenumbers, but,\ndue to their diffusion in wavenumber caused by plasma inhomogeneity, not\nobtain very high levels of waves at negative wavenumber and thus not\nproduce visible levels of harmonic radio emission.\n\n## Chapter 5 Conclusions\n\nDuring solar flares, vast amounts of energy are released from the Sun\u2019s\nmagnetic field, a fraction of which goes into accelerating electrons.\nThis thesis has considered the propagation of such a fast electron beam\nin the plasma of the solar corona, and its visible signatures in the\nform of hard X-ray and radio emission. When a beam propagates along a\nmagnetic field line downwards into the dense chromosphere, it can\nproduce hard X-rays via bremsstrahlung, and the spectrum of these will\nbe affected by the evolution of the electron distribution during\ntransport. Radio emission can be produced during propagation via the\ngeneration of Langmuir waves, and the spectrum of this will therefore\ndepend strongly on the electron and Langmuir wave distributions.\n\nIt has long been known that a propagating beam can become unstable to\nthe generation of high levels of Langmuir waves, either due to transport\neffects, where faster electrons outpace slower ones, or to collisional\neffects due to the velocity dependence of the collisional operator. It\nis also well known that Langmuir waves are strongly affected by density\ninhomogeneities, and that this can potentially lead both to\nelectron-self acceleration in certain experimental setups, and to\nsuppression of the beam-plasma instability, and thus the relaxation of\nthe electron beam to a plateau.\n\n##### Langmuir Wavenumber Diffusion\n\nWe have considered here primarily the effects of a fluctuating plasma\ndensity, with long wavelength and small relative density change, such as\nis observed in the solar corona and solar wind. Chapter 2 outlined the\ndevelopment of a mathematical model for the interaction of such\nfluctuations with Langmuir waves, previously published in Ratcliffe\net\u00a0al. ( 2012 ) , both in the full 3-D treatment of inelastic\nscattering, an extension of the previously considered elastic scattering\ntreatment in the literature, and also for the 1-D situation of beam\naligned density fluctuations.\n\nWe found that the Langmuir waves will diffuse in wavenumber space. In\n3-D this wavenumber diffusion occurs both in angle, as for the elastic\nscattering case, and also in magnitude, resulting in a significant\nmodification of the parallel wavenumber, that is the wavenumber\nprojected onto the beam direction. When the back reaction of Langmuir\nwaves on the beam electrons is considered, this will result in electron\nacceleration.\n\n##### Electron Acceleration\n\nWe also expect to see an electron acceleration effect due to\nbeam-aligned density fluctuations. Chapter 3 presented quasi-linear\nsimulations of the beam-Langmuir wave interactions, including the\nLangmuir wavenumber diffusion, and confirmed that this indeed occurs. We\nconsidered first the test case of a Maxwellian initial beam, as in\nRatcliffe et\u00a0al. ( 2012 ) , where the beam distribution is given by\n@xmath with @xmath the beam velocity and @xmath its width. This is\nunstable to Langmuir wave generation and thus quickly relaxes to form a\nplateau. We simulated the effects of Langmuir wavenumber diffusion over\na very broad range of parameters for the beam, the background plasma,\nand the density fluctuations, and considered both random fluctuations,\nand those obeying a power-law distribution with wavenumber, as observed\nin the corona.\n\nOverall, we found that the acceleration depends primarily on the ratio\nof the timescales for the wavenumber diffusion and for the beam-plasma\ninteraction, with most effect when these are approximately equal. When\nthe wavenumber diffusion is the faster process, we see suppression of\nthe beam-plasma instability, as the waves are removed very rapidly from\nresonance with the beam electrons, and so no acceleration can occur. The\nexact spectral shape of the density fluctuations and their\ncharacteristic velocity, @xmath , were found to have small additional\neffects on the extent of the electron acceleration. For example, for a\ngiven level of fluctuation intensity, the strongest acceleration occurs\nwhen @xmath . These effects are not accounted for simply by the ratio of\nthe diffusion and beam-wave interaction timescales.\n\n##### Beam Generated Hard X-Ray Emission\n\nNext, we considered the case of a power-law electron beam, relaxing due\nto collisional interactions, as in Kontar et\u00a0al. ( 2012 ) . In very\ndense plasma, this relaxation can produce instability to Langmuir wave\ngeneration significantly more rapidly than the electron time-of-flight\neffects that dominate in less dense plasma. Our model therefore applies\nto, for example, a beam in a very dense coronal loop, with background\nplasma density @xmath cm @xmath , over timescales of around 0.1\u00a0s or so.\nLangmuir waves are generated by the beam, but later reabsorbed, and so\nthe electron distribution averaged over the electron\u2019s collisional\nlifetime is unaffected.\n\nHowever, when the evolution of the Langmuir waves due either to a\ndensity gradient, a fluctuating plasma density, or to wave-wave\ninteractions is considered, the time-averaged electron flux is strongly\naffected. Energy is shifted from electrons at energies below around\n20\u00a0keV to the region between 20 and 200\u00a0keV. Above 200\u00a0keV the effects\nare small. The time-averaged electron flux is directly related to the\nhard X-ray emission generated by the beam, which is generally observed\nonly above around 20\u00a0keV, as thermal emission dominates below this\nenergy. Thus, the Langmuir wave evolution is seen to shift significant\nnumbers of electrons in energy space from the unobservable part of the\ndistribution to the HXR emitting part.\n\nThe time-averaged electron flux can be increased by an order of\nmagnitude or more at around 100\u00a0keV. Thus if we ignore the effects of\nLangmuir wave generation and evolution and assume an accelerated\nelectron beam evolving purely collisionally, the number of initially\naccelerated electrons derived from hard X-ray observations will be\noverestimated by up to this amount. Moreover, it was found that the\nacceleration effect was strongly dependent on the initial beam density,\nand so this overestimate is more significant the more electrons there\nare in the initial beam.\n\n##### Radio Emission\n\nThe high levels of Langmuir waves generated by fast electron beams in\nplasma can also lead to very bright radio emission. The mechanism for\nthis was discussed in the Introduction, and in Chapter 4 we developed a\nsimulation model for this emission at the second harmonic of the local\nplasma frequency. Emission also occurs at the plasma frequency, but in\ndense plasma, as considered here, this is generated inefficiently, and\ncannot escape as the optical depth is very large.\n\nEmission at the second harmonic relies on the generation of an initial\nLangmuir wave population by the electron beam, and the subsequent\nbackscattering of these to negative wavenumbers. A wave from the\nforwards and backwards population may then coalesce to produce radio\nemission. However, the emission probability is strongly angularly\ndependent, and so we must average over assumed distributions of the\nangles of the Langmuir wavenumbers to the direction of beam propagation.\nThe processes may then be included in our simulations from Chapter 3 .\n\nWe used this model to simulate the radio emission at 2\u00a0GHz for a\ncollisionally relaxing beam in very dense plasma, considering both the\nbackscattering of Langmuir waves due to individual plasma ions, which is\nimportant in plasma of equal ion and electron temperatures, and also the\ndecay of a Langmuir wave to an ion-sound wave and a backscattered\nLangmuir wave, as in Chapter 3 . This work is currently being prepared\nfor publication (Ratcliffe & Kontar, 2013 ) .\n\nWe found that the brightness and duration of the simulated radio\nemission for both homogeneous and weakly inhomogeneous plasma are in\ngood agreement with observations, and moreover the theoretical\npredictions for the polarisation of the emission in our model also agree\nwell with observed values for high frequency plasma emission.\n\nHowever, the process of scattering by plasma ions was seen to be\nstrongly affected by the wavenumber diffusion of Langmuir waves due to\nplasma density inhomogeneities. Significant suppression of the\nbackscattering, and consequently the radio emission, was seen to occur\nfor fluctuations of very low magnitude. The observed strengths of\ninhomogeneity in the corona often exceed this limit, and in this case\nour simulations suggest it is possible to have high levels of beam\ngenerated Langmuir waves without generating significant radio emission,\nas the backscattered wave population remains small.\n\nOn the other hand, when the assumption of equal temperatures is relaxed,\nthe additional backscattering process due to the decay to ion-sound\nwaves can operate, and this leads to high levels of backwards Langmuir\nwaves even in strongly inhomogeneous plasma, and corresponding levels of\nradio emission.\n\n##### Closing Remarks\n\nTo conclude, we have considered the effects of plasma density\ninhomogeneities on Langmuir waves, and consequently on propagating fast\nelectron beams, and their hard X-ray and radio emission. Strong effects\nof electron acceleration and enhancement of the hard X-ray emission were\nseen. We have also simulated beam-generated radio emission, finding\nresults that are in good agreement with observations. The inclusion of\ndensity inhomogeneities in these simulations show that in inhomogeneous\nplasma, this radio emission can be suppressed, despite the presence of\nhigh levels of Langmuir waves. Density inhomogeneities are generally\nagreed to commonly exist in the corona, and so the generation of\nLangmuir waves by fast electrons and their subsequent evolution have\nbeen shown to be vitally important considerations in the evolution of\ncoronal fast electron beams and their emission.\n","output":["This thesis considers the propagation of accelerated electron beams in\nplasma. We consider the wave particle interactions these undergo which cause\ntheir evolution, the effects of plasma density inhomogeneities on these\ninteractions, and the effects this may have on the production of hard X-ray and\nradio emission by the beam. ...","This thesis considers the propagation of accelerated electron beams in\nplasma. We consider the wave particle interactions these undergo which\ncause their evolution, the effects of plasma density inhomogeneities on\nthese interactions, and the effects this may have on the production of\nhard X-ray and radio emission by the beam.\n\nCGS units are used throughout.\n\nChapter 1 introduces the important background material on the Sun and\nsolar flares, and some basic plasma physics. We discuss the acceleration\nand propagation of electrons beams and their production of hard X-ray\nemission, and the various observed types of radio emission from the Sun.\nWe end by discussing details of the mechanism by which radio emission\ncan be produced by beam generated Langmuir waves at GHz frequencies.\n\nChapter 2 contains the mathematical derivation of the effects of plasma\ndensity fluctuations on Langmuir waves. This is found to be described by\na diffusion of the waves in wavenumber space. We consider the situation\nin both one and three dimensions, for elastic and inelastic scattering\nof the Langmuir waves, discussing how our model expands on that\npreviously considered in the literature, and develop a model for the\nfluctuations applicable to the electron beams we consider in this\nthesis. We derive the relevant diffusion coefficients for a few commonly\nobserved density fluctuation spectra, then end with a brief discussion\nof the expected effects of the Langmuir wavenumber diffusion on the\nwaves and electrons for a few representative cases.\n\nChapter 3 uses the model derived in Chapter 2 in quasi-linear\nsimulations of electron beam evolution. We consider two initial electron\nbeam distributions, either a Maxwellian or a power law, and simulate the\nLangmuir wave generation and evolution, and the back-reaction of this on\nthe electron beam. We find an electron acceleration effect to occur, and\nexplore the parameters for which this is strongest. In addition we\nconsider the production of hard X-ray emission from an initially power\nlaw beam, and the effects of the electron acceleration on this.\n\nChapter 4 considers the radio emission from an electron beam via the\ngeneration of Langmuir waves. We first derive an angle-averaged model\nfor emission at the second harmonic of the plasma frequency, and combine\nthis with the simulations from the previous chapters. We include the\neffects of density fluctuations on the Langmuir waves, and discuss how\nthis affects the radio emission produced.\n\nChapter 5 concludes the thesis with a summary of the effects of density\ninhomogeneity on Langmuir waves, and consequently on fast electron beams\nand their hard X-ray and radio emissions in the solar corona.\n\nAppendix A contains the derivation of a mathematical model for radio\nemission from an electron beam at the fundamental of the local plasma\nfrequency, which is unimportant in the parameter ranges considered in\nChapter 4 , but essential for radio bursts in the higher corona and\nsolar wind.\n"]}
{"input":"##### Contents\n\n-    A Introduction\n    -    A.1 State of art\n        -    A.1.1 Contact manifolds and quaternion-K\u00e4hler manifolds\n        -    A.1.2 Lines on contact Fano manifold\n        -    A.1.3 Legendrian subvarieties of projective space\n    -    A.2 Topics of the dissertation\n    -    A.3 Open problems\n-    B Notation and elementary properties\n    -    B.1 Vector spaces and projectivisation\n    -    B.2 Bilinear forms and their matrices\n    -    B.3 Complex and algebraic manifolds\n    -    B.4 Vector bundles, sheaves and sections\n    -    B.5 Derivatives\n    -    B.6 Homogeneous differential forms and vector fields\n    -    B.7 Submersion onto image\n    -    B.8 Tangent cone\n    -    B.9 Secant, tangent and dual varieties\n-    C Vector fields, forms and automorphisms\n    -    C.1 Vector fields, Lie bracket and distributions\n    -    C.2 Automorphisms\n    -    C.3 Line bundles and @xmath -bundles\n    -    C.4 Distributions and automorphisms preserving them\n    -    C.5 Lifting and descending twisted forms\n-    D Elementary symplectic geometry\n    -    D.1 Linear symplectic geometry\n        -    D.1.1 Symplectic vector space\n        -    D.1.2 Subspaces in a symplectic vector space\n        -    D.1.3 Symplectic reduction of vector space\n        -    D.1.4 Symplectic automorphisms and weks-symplectic matrices\n        -    D.1.5 Standard symplectic structure on @xmath\n    -    D.2 Symplectic manifolds and their subvarieties\n        -    D.2.1 Subvarieties of a symplectic manifold\n        -    D.2.2 Examples\n    -    D.3 The Poisson bracket\n        -    D.3.1 Properties of Poisson bracket\n        -    D.3.2 Homogeneous symplectic form\n        -    D.3.3 Example: Veronese map of degree 2\n-    E Contact geometry\n    -    E.1 Projective space as a contact manifold\n    -    E.2 Legendrian subvarieties of projective space\n        -    E.2.1 Decomposable and degenerate Legendrian subvarieties\n    -    E.3 Contact manifolds\n        -    E.3.1 Symplectisation\n        -    E.3.2 Contact automorphisms\n    -    E.4 Legendrian subvarieties in contact manifold\n-    F Projective automorphisms of a Legendrian variety\n    -    F.1 Discussion of assumptions\n    -    F.2 Preservation of contact structure\n    -    F.3 Some comments\n-    G Toric Legendrian subvarieties in projective space\n    -    G.1 Classification of toric Legendrian varieties\n    -    G.2 Smooth toric Legendrian surfaces\n    -    G.3 Higher dimensional toric Legendrian varieties\n-    H Examples of quasihomogeneous Legendrian varieties\n    -    H.1 Notation and definitions\n    -    H.2 Main results\n        -    H.2.1 Generalisation: Representation theory and further\n            examples\n    -    H.3 @xmath -action and its orbits\n        -    H.3.1 Invariant subsets\n        -    H.3.2 Action of @xmath\n    -    H.4 Legendrian varieties in @xmath\n        -    H.4.1 Classification\n        -    H.4.2 Degenerate matrices\n        -    H.4.3 Invertible matrices\n-    I Hyperplane sections of Legendrian subvarieties\n    -    I.1 Hyperplane section\n        -    I.1.1 Construction\n        -    I.1.2 Proof of smoothness\n    -    I.2 Linear sections of decomposable Legendrian varieties\n    -    I.3 Extending Legendrian varieties\n    -    I.4 Smooth varieties with smooth dual\n\n### Acknowledgements\n\nThe monograph is built on the author\u2019s PhD thesis [ Buc08a ] .\n\nThe author was supported by the research project N20103331\/2715 funded\nby Polish financial means for science from 2006 to 2008.\n\nThe author would like to thank especially his patient advisor Jaros\u0142aw\nWi\u015bniewski for his comments, support and for answering numerous\nquestions. Parts of the thesis were written while the author enjoyed the\nhospitality of Insong Choe at KIAS (Korea Institute for Advanced Study),\nMark Gross at University of California, San Diego and Joseph\nM.\u00a0Landsberg at Texas A&M University. The author is grateful for their\ninvitation, financial support and for creating a stimulating atmosphere.\nAlso the author acknowledges many enlightening discussions with Michel\nBrion, Stephen Coughlan, Zbigniew Jelonek, Grzegorz Kapustka, Micha\u0142\nKapustka, Micha\u0142 Krych, Joseph M.\u00a0Landsberg, Adrian Langer, Laurent\nManivel, Sung Ho Wang and Andrzej Weber. Finally, the author is grateful\nto the referees of the thesis: S\u0142awomir Cynk, Laurent Manivel, Henryk\n\u017bo\u0142\u0105dek and the anonymous referee of this mongraph \u2014 their comments have\nhelped to improve the presentation.\n\n## Chapter A Introduction\n\n]\n\n### a.1 State of art\n\nIn this monograph we study algebraic and geometric properties of complex\nLegendrian subvarieties. The main motivation for our research comes from\nthe classification problem of contact Fano manifolds \u00b9 \u00b9 1 A complex\nmanifold @xmath is called a contact manifold if there exists a rank\n@xmath vector subbundle @xmath of the tangent bundle, such that the map\n@xmath determined by the Lie bracket is nowhere degenerate (see Chapter\nE for more details). A projective manifold is Fano if its anticanonical\nline bundle is ample. .\n\n#### a.1.1 Contact manifolds and quaternion-K\u00e4hler manifolds\n\nThere are two known families of complex projective contact manifolds:\nprojectivisations of cotangent bundles to projective manifolds (see\nExample E.8 ) and certain homogeneous spaces, namely the unique closed\norbit of the adjoint action of a simple Lie group @xmath on @xmath ,\nwhere the @xmath is the Lie algebra of @xmath (see \u00a7 D.2.2 and Example\nE.7 and for more details). These orbits are also called the adjoint\nvarieties . The following theorem summarises works of Demailly [ Dem02 ]\nand Kebekus, Peternell, Sommese and Wi\u015bniewski [ KPSW00 ] :\n\n###### Theorem A.1.\n\nIf @xmath is a complex projective contact manifold, then either @xmath\nis a projectivisation of the cotangent bundle to some projective\nmanifold @xmath or @xmath is a Fano manifold with second Betti number\n@xmath .\n\nThe following conjecture would be an important classification result in\nalgebraic geometry and it claims that known examples are all existing\nexamples:\n\n###### Conjecture A.2 (LeBrun, Salamon).\n\nIf @xmath is a Fano complex contact manifold, then @xmath is an adjoint\nvariety.\n\nThis conjecture originated with a famous problem in Riemannian geometry.\nIn 1955 Berger [ Ber55 ] gave a list of all possible holonomy groups \u00b2 \u00b2\n2 Given an @xmath -dimensional Riemannian manifold @xmath , the holonomy\ngroup of @xmath is the subgroup of orthogonal group @xmath generated by\nparallel translations along loops through @xmath . of simply connected\nRiemannian manifolds. The existence problem for all the cases has been\nsolved locally. Compact non-homogeneous examples with most of the\npossible holonomy groups were constructed, for instance the two\nexceptional cases @xmath and @xmath were constructed by D.\u00a0Joyce \u2014 see\nan excellent review on the subject [ Joy00 ] . Since then all the cases\nfrom Berger\u2019s list have been illustrated with compact non-homogeneous\nexamples, with the unique exception of the quaternion-K\u00e4hler manifolds \u00b3\n\u00b3 3 A Riemannian @xmath -dimensional manifold @xmath is called\nquaternion-K\u00e4hler if its holonomy group is a subgroup of @xmath . .\nAlthough there exist non-compact, non-homogeneous examples, it is\nconjectured that the compact quaternion-K\u00e4hler manifolds must be\nhomogeneous (see [ LeB95 ] and references therein).\n\n###### Conjecture A.3 (LeBrun, Salamon).\n\nLet @xmath be a compact quaternion-K\u00e4hler manifold. Then @xmath is a\nhomogeneous symmetric space (more precisely, it is one of the Wolf\nspaces \u2014 see [ Wol65 ] ).\n\nThe relation between the two conjectures is given by the construction of\na twistor space @xmath , an @xmath -bundle of complex structures on\ntangent spaces to a quaternion-K\u00e4hler manifold @xmath . If @xmath is\ncompact, it has positive scalar curvature, and then @xmath has a natural\ncomplex structure and is a contact Fano manifold with a K\u00e4hler-Einstein\nmetric. In particular, the twistor space of a Wolf space is an adjoint\nvariety. Hence Conjecture A.2 implies Conjecture A.3 . Conversely,\nLeBrun [ LeB95 ] observed that if @xmath is a contact Fano manifold with\nK\u00e4hler-Einstein metric, then it is a twistor space of a\nquaternion-K\u00e4hler manifold.\n\nA number of attempts have been undertaken to prove the above\nconjectures. They were proved in low dimension: for @xmath by N.\u00a0Hitchin\n[ Hit81 ] and Y.\u00a0Ye [ Ye94 ] , @xmath by Y.S.\u00a0Poon and S.M.\u00a0Salamon [\nPS91 ] and S.\u00a0Druel [ Dru98 ] and Conjecture A.3 for @xmath by\nH.&R.\u00a0Herrera [ HH02 ] . Moreover A.\u00a0Beauville, J.\u00a0Wi\u015bniewski,\nS.\u00a0Kebekus, T.\u00a0Peternell, A.\u00a0Sommese, J.P.\u00a0Demailly, C.\u00a0LeBrun,\nJ-M.\u00a0Hwang and many other researchers have worked on this problem.\n\n#### a.1.2 Lines on contact Fano manifold\n\nIf @xmath is a contact complex manifold, then a subvariety @xmath of\npure dimension @xmath is Legendrian if it is maximally @xmath\n-integrable \u2014 see Chapter E for the details.\n\nLet @xmath be a contact Fano manifold not isomorphic to a projective\nspace. A rational curve @xmath is a contact line if its intersection\nwith the anticanonical line bundle is minimal possible, i.e.\u00a0equal to\n@xmath . Contact lines on @xmath are an instance of minimal rational\ncurve on uniruled manifold and they are extensively studied by numerous\nresearchers. Wi\u015bniewski [ Wi\u015b00 ] and Kebekus [ Keb01 ] , [ Keb05 ] have\nstudied geometric properties of contact lines. The following theorem is\ndue to Kebekus [ Keb05 ] , but some parts of it were known before:\n\n###### Theorem A.4.\n\nWith @xmath as above choose a point @xmath . Let\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nbe the subscheme parametrising contact lines through @xmath , let @xmath\nbe the locus of these lines (i.e.\u00a0the subset swept out by contact lines\nthrough @xmath ) and let @xmath be the projectivised tangent cone to\n@xmath at @xmath (so that @xmath is the set of tangent directions at\n@xmath to lines through @xmath ). Then:\n\n1.  @xmath is projective and @xmath is closed in @xmath .\n\n2.  @xmath is a Legendrian subvariety and @xmath and @xmath is a\n    non-degenerate Legendrian subvariety in @xmath .\n\n3.   If @xmath is a general point, then @xmath is isomorphic to @xmath\n    (in other words every line through @xmath is determined by its\n    tangent direction) and @xmath is smooth.\n\n4.   If @xmath is a general point, then @xmath is isomorphic to the\n    projective cone @xmath over @xmath . This isomorphism maps the\n    contact line through @xmath tangent to @xmath onto the line @xmath .\n    In particular two distinct lines through @xmath do not intersect\n    except at @xmath . Moreover the distinguished line bundle @xmath\n    restricted to @xmath is identified with @xmath via this isomorphism.\n\nNote that in [ Keb05 , Thm\u00a01.1] Kebekus also claims that a certain\nirreducibility holds for @xmath . However it was observed by Kebekus\nhimself together with the author that there is a gap in the proof \u2074 \u2074 4\nThis gap is on page 234 in Step\u00a02 of proof of Proposition\u00a03.2 where\nKebekus claims to construct \u201ca well defined family of cycles\u201d. This is\nnot necessarily a well defined family of cycles: condition (3.10.4) in [\nKol96 , \u00a7I.3.10] is not necessarily satisfied. As a consequence the map\n@xmath is not necessarily regular at non-normal points of @xmath . .\n\nThus contact lines through a general point behave very much like\nordinary lines in a projective space. Moreover their geometry is\ndescribed by a nondegenerate smooth Legendrian subvariety @xmath in\n@xmath . If @xmath is one of the adjoint varieties, then @xmath will be\na homogeneous Legendrian subvariety called a subadjoint variety (see [\nLM07 ] , [ Muk98 ] ). Proving that there is an embedding of @xmath into\na projective space which maps contact lines to ordinary lines would\nimply Conjecture A.2 . Moreover it is proved by Hong [ Hon00 ] , that if\n@xmath is homogeneous, then so is @xmath . Therefore contact lines and\nparticularly the Legendrian varieties determined by them are important\nobjects, useful in the study of Conjecture A.2 .\n\n#### a.1.3 Legendrian subvarieties of projective space\n\nPrior to the author\u2019s research the following were the only known\nexamples of smooth Legendrian subvarieties of projective space (see [\nBry82 ] , [ LM07 ] ):\n\n1.  linear subspaces;\n\n2.  some homogeneous spaces called subadjoint varieties (see Table A.1\n    ): the product of a line and a quadric @xmath and five exceptional\n    cases:\n\n    -   twisted cubic curve @xmath ,\n\n    -   Grassmannian @xmath of Lagrangian subspaces in @xmath ,\n\n    -   full Grassmannian @xmath ,\n\n    -   spinor variety @xmath (i.e.\u00a0the homogeneous @xmath -space\n        parametrising the vector subspaces of dimension @xmath contained\n        in a non-degenerate quadratic cone in @xmath ) and\n\n    -   the 27-dimensional @xmath -variety in @xmath corresponding to\n        the marked root: [] ;\n\n3.  every smooth projective curve admits a Legendrian embedding in\n    @xmath (see [ Bry82 ] );\n\n4.  a family of smooth surfaces birational to the Kummer @xmath\n    -surfaces (see [ LM07 ] ).\n\nThe subadjoint varieties are expected to be the only homogeneous\nLegendrian subvarieties in @xmath (for @xmath ). Many partial results\nare known. For instance the following Theorem is traditionally known:\n\n###### Theorem A.5.\n\nIf @xmath is homogeneous and Legendrian and the Legendrian embedding is\nequivariant (i.e.\u00a0the automorphisms of @xmath extend to linear\nautomorphisms of @xmath ), then @xmath is one of the subadjoint\nvarieties.\n\nTo the author\u2019s best knowledge the statement of the theorem has not been\nexplicitly written down before, but according to J.M.\u00a0Landsberg, already\nE.\u00a0Cartan have known which homogeneous spaces are Legendrian. Also the\ntheorem immediatelly follows from various resources. As one instance,\nthe subadjoint varieties are the only smooth irreducible Legendrian\nvarieties whose ideal is generated by quadratic polynomials (see [ Buc06\n] ). But it is a well known theorem of Kostant, that homogeneous space\nin its equivariant embedding has the ideal generated by quadrics (see\nfor instance [ Pro07 , \u00a710.6.6] ).\n\nAlso Landsberg and Manivel proved [ LM07 , Thm.\u00a011] :\n\n###### Theorem A.6.\n\nLet @xmath be a homogeneous space with Picard number one. Suppose that\n@xmath admits a Legendrian embedding into @xmath , not necessarily\nequivariant a priori. Then @xmath is subadjoint. In particular, the\nLegendrian embedding is the equivariant subadjoint embedding.\n\nThe subadjoint varieties are strongly related to the group they arise\nfrom. In Landsberg and Manivel [ LM02 ] use the subadjoint varieties to\nreconstruct the adjoint variety they arise from. And thus the subadjoint\nvarieties are one of essential ingridients of their proof of the\nclassification of simple Lie groups by means of projective geometry\nonly. Also Mukai [ Muk98 ] relates the subadjoint Legendrian varieties\nwith another algebraic structure: simple Jordan algebras. In [ LM01 ]\nthe authors give a uniform description of the exceptional cases (arising\nfrom @xmath , @xmath , @xmath and @xmath ).\n\nFor an arbitrary Legendrian subvariety in projective space, Landsberg\nand Manivel proved certain restrictions on its topology, the simpliest\nof which is:\n\n###### Theorem A.7.\n\nLet @xmath be a smooth Legendrian variety, let @xmath be the hyperplane\nclass and @xmath be the @xmath -th Chern class of @xmath . Then:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis gives in particular the following restrictions on @xmath :\n\n-   @xmath cannot be an abelian variety or parallelisable variety.\n\n-    If @xmath for @xmath , then @xmath is a linear subspace.\n\n-    Suppose that @xmath . Then @xmath and the Legendrian embedding is\n    the Segre embedding.\n\n-    If @xmath , the total space of a @xmath bundle over some smooth\n    variety @xmath , then @xmath .\n\nNote that the statement in [ LM07 , Prop.\u00a03] suggests that the Chern\nclass identities hold in @xmath , yet their proof uses cohomologies with\nrational coefficients (they use @xmath and Chern character @xmath ).\n\nFurther restrictions on topology of @xmath where derived if @xmath , see\n[ LM07 ] for details.\n\nAlso the authors there proved [ LM07 , Prop.\u00a017(2)] :\n\n###### Proposition A.8.\n\nLet @xmath be a non-degenerate Legendrian variety. Then:\n\n-    the secant variety @xmath fills out @xmath (i.e.\u00a0it is of expected\n    dimension).\n\n-    if @xmath is in addition smooth, then the tangent variety @xmath\n    and the dual variety @xmath are hypersurfaces isomorphic via @xmath\n\nSee \u00a7 B.9 for definitions of secant, tangent and dual varieties. See \u00a7\nB.2 for definition of @xmath . Here the symplectic form @xmath is the\nform associated with the contact structure on @xmath (see Example E.10\n). The statement about secant variety is contained in the proof [ LM07 ,\nProp.\u00a017(2)] .\n\nFor tangent and dual varieties, we note that original formulation in [\nLM07 ] omits the smoothness assumption. If @xmath is not smooth however,\ntheir proof does not work and the decomposable Legendrian varieties (see\n\u00a7 E.2.1 ) are counterexamples. In the proof the authors freely\ninterchange the tangent variety @xmath (which by definition is the union\nof the limits of secants through two points approaching a third fixed\npoint) and the closure of the union of embedded tangent spaces at smooth\npoints. These are the same for @xmath smooth. The tangent variety @xmath\nis indeed a hypersurface in the secant variety @xmath . The closure of\nthe embedded tangent spaces at smooth points is indeed isomorphic to\n@xmath .\n\n### a.2 Topics of the dissertation\n\nThis dissertation addresses two complementary problems regarding\nLegendrian varieties:\n\n-   write explicit restrictions on the properties of Legendrian\n    varieties;\n\n-   give examples of smooth Legendrian varieties.\n\nThe first problem we address by giving a very precise understanding of\nthe embedded automorphism group of a Legendrian variety. The second\nproblem is solved by proving that a general hyperplane section of a\nsmooth Legendrian variety admits a Legendrian embedding.\n\nIn [ Buc03 ] , we prove that the quadratic part of the ideal of a\nLegendrian subvariety @xmath of projective space @xmath produces a\nconnected subgroup of projective automorphisms of @xmath . In [ Buc06 ]\nwe improve this result by observing that this group is actually the\nmaximal connected subgroup of automorphisms of the contact structure on\n@xmath preserving the Legendrian subvariety. This relation is\nexplicitely defined:\n\n###### Theorem A.9.\n\nLet @xmath be a Legendrian subvariety. Consider the following map @xmath\n:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is the matrix of @xmath and @xmath is the matrix of the\nsymplectic form on @xmath associated with the contact structure on\n@xmath . Let @xmath be the vector space of quadrics containing @xmath .\nThen:\n\n-   @xmath is a Lie subalgebra of @xmath tangent to a closed subgroup\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n-    We have the natural action of @xmath on @xmath . The group @xmath\n    is the maximal connected subgroup in @xmath which under this action\n    preserves @xmath .\n\nFor proof see [ Buc06 , Cor.\u00a04.4, Cor.\u00a05.5, Lem.\u00a05.6] .\n\nIn the present dissertation we extend this result further. Firstly, we\nreplace projective space @xmath with an arbitrary contact manifold\n@xmath :\n\n###### Theorem A.10.\n\nLet @xmath be a compact contact manifold and let @xmath be a Legendrian\nsubvariety. Then the connected component of the subgroup of @xmath that\npreserves both the contact structure and @xmath , is completely\ndetermined by those sections of a distinguished line bundle @xmath on\n@xmath that vanish on @xmath .\n\nSee Corollary E.23 for proof. In Theorem E.13 (quoted from [ Bea98 ] )\nwe also make explicit how to obtain an infinitesimal automorphism of\n@xmath from a given section of @xmath (the analogue of the map @xmath in\nTheorem A.9 ).\n\nSecondly, we try to remove the assumption that the automorphisms\npreserve the contact structure. By applying the results of [ LeB95 ] and\n[ Keb01 ] on the uniqueness of contact structures we can deal with this\nproblem for most projective contact Fano manifolds (see Corollary E.23\n). The remaining cases are the projectivised cotangent bundles and the\nprojective space. The first case is not very interesting, as all the\nLegendrian subvarieties are classified for these contact manifolds (see\nCorollary E.17 ). On the other hand the case of projective space is the\nmost important and interesting. It is described precisely in Chapter F .\nWe present there the following theorem originally proved in [ Buc07 ] :\n\n###### Theorem A.11.\n\nIf @xmath is a smooth irreducible Legendrian subvariety which is not a\nlinear subspace and @xmath is a connected subgroup preserving @xmath ,\nthen the action of @xmath on @xmath necessarily preserves the contact\nstructure. Thus in this case the group @xmath from Theorem A.9 is also\nthe maximal connected subgroup in @xmath which preserves @xmath .\n\nOur methodology for finding new examples of smooth Legendrian\nsubvarieties is the following. We pose questions of classification of\nsmooth Legendrian varieties satisfying certain additional conditions.\nFor instance, we assume that the variety is toric (see Chapter G , which\nfollows [ Buc07 ] ):\n\n###### Theorem A.12.\n\nEvery smooth toric Legendrian variety of dimension at least @xmath in a\nprojective space, whose embedding is torus equivariant is isomorphic to\none of the following:\n\n-    a linear subspace,\n\n-   @xmath ,\n\n-   @xmath\n\n-    or @xmath blown up in three non-colinear points.\n\nFor proofs see Corollaries G.6 and G.10 . The linear subspace is not\nreally interesting, the products @xmath and @xmath are well known (see \u00a7\nA.1.3 ). The last case of blow up was an original example of [ Buc07 ] .\n\nWe also classify those smooth Legendrian varieties, which are contained\nin a specific @xmath -cointegrable variety (see Chapter H , which\nfollows [ Buc09 ] ). In this way we produce a few new smooth examples\nincluding a quasihomogeneous Fano 8-fold:\n\n###### Theorem A.13.\n\nA general hyperplane section of @xmath admits a Legendrian embedding\ninto @xmath .\n\nFinally following [ Buc08b ] we generalise this and prove that a general\nhyperplane section of a smooth Legendrian variety admits a Legendrian\nembedding into a smaller projective space:\n\n###### Theorem A.14.\n\nLet @xmath be an irreducible Legendrian subvariety, which is smooth or\nhas only isolated singularities. Then a general hyperplane section of\n@xmath admits a Legendrian embedding into a projective space of\nappropriate dimension via a specific subsystem of the linear system\n@xmath .\n\nMore generally, assume @xmath is an irreducible Legendrian subvariety\nwith singular locus of dimension @xmath and @xmath is a general\nhyperplane. Then there exists a variety @xmath whose singular locus has\ndimension at most @xmath and which has an open subset isomorphic to the\nsmooth locus of @xmath such that @xmath admits a Legendrian embedding.\n\nThe specific linear system and construction of @xmath is described in \u00a7\nI.1.1 and there we prove that the resulting variety is Legendrian. The\nproof that for a general section the result has the required smoothness\nproperty is presented in \u00a7 I.1.2 .\n\nThis simple observation has quite strong consequences. Many researchers,\nincluding Landsberg, Manivel, Wi\u015bniewski, Hwang and the author of this\ndissertation, believed that the structure of smooth Legendrian\nsubvarieties in projective space had to be somehow rigid at least in\nhigher dimensions. So far the only non-rational examples known were in\ndimensions 1 and 2 (see \u00a7 A.1.3 ) and these were also the only known to\ncome in families. Already by a naive application of the theorem to the\nsubadjoint varieties we get many more examples with various properties:\n\n###### Example A.15.\n\nThe following smooth varieties and families of smooth varieties admit\nLegendrian embedding:\n\n-    a family of @xmath surfaces of genus 9;\n\n-    three different types of surfaces of general type;\n\n-    some Calabi-Yau 3-folds, some Calabi-Yau 5-folds and some\n    Calabi-Yau 9-folds;\n\n-    some varieties of general type in dimensions 3, 4 (two families for\n    every dimension), 5,6,7 and 8 (one family per dimension);\n\n-    some Fano varieties, like the blow up of a quadric @xmath in a\n    codimension 2 hyperplane section @xmath , a family of Del Pezzo\n    surfaces of degree 4 and others;\n\n-    infinitely many non-isomorphic, non-homogeneous Legendrian\n    varieties in every dimension arising as a codimension @xmath linear\n    section of @xmath .\n\nExample (a) agrees with the prediction of [ LM07 , \u00a72.3] . Examples (b)\nand (d) give a partial answer to the question of a possible Kodaira\ndimension of a Legendrian variety (also see [ LM07 , \u00a72.3] ). Example\n(f) is a counterexample to the naive expectation that Legendrian variety\nin a sufficiently high dimension must be homogeneous.\n\nWe also note that the previous non-homogeneous examples also arise in\nthis way. Example (e) for @xmath is the toric example described in\nExample G.4 . Hyperplane sections of @xmath , @xmath , @xmath are\nstudied in more details in Chapter H . Also non-homogeneous examples of\nthe other authors, Bryant [ Bry82 ] , Landsberg and Manivel [ LM07 ] can\nbe reconstructed by Theorem A.14 from some varieties with only isolated\nsingularities (see \u00a7 I.3 ).\n\nIn this monograph we also demonstrate a more refined construction, using\nthe decomposable Legendrian varieties, which also uses Theorem A.14 (see\n\u00a7 E.2.1 ). This makes even bigger list of examples, in particular we\nobtained varieties of general type in every dimension:\n\n###### Theorem A.16.\n\nAsume @xmath and @xmath are two integers such that either:\n\n-   @xmath and @xmath or\n\n-   @xmath and @xmath .\n\nThen there exist a smooth irreducible projective variety @xmath of\ndimension @xmath , Kodaira dimension @xmath and rank of Picard group\n@xmath which admits Legendrian embedding into projective space @xmath .\n\nWith this method we are also able to give new examples from old ones\nwithout dropping the dimension. This is described in detail in \u00a7 I.2 .\n\nAll the varieties arising from Theorem A.14 and our construction in \u00a7\nI.1.1 are embedded by a non-complete linear system. Therefore a natural\nquestion arises: can the construction be inverted? So for a given\nLegendrian but not linearly normal embedding of some variety @xmath ,\ncan we find a bigger Legendrian variety @xmath , such that @xmath is a\nprojection of a hyperplane section of @xmath ?\n\nFollowing [ Buc08b ] and building upon ideas of Bryant, Landsberg and\nManivel we suggest a construction that provides some (but far from\nperfect) answer for this question in \u00a7 I.3 :\n\n###### Theorem A.17.\n\nLet @xmath be an irreducible Legendrian subvariety. Then there exist a\nLegendrian subvariety @xmath , a hyperplane @xmath and a irreducible\ncomponent of @xmath , such that @xmath is the image of this component\nunder the projection described in \u00a7 I.1.1 .\n\nThis theorem is a simplified version of Theorem I.9 .\n\nIn particular, we represent the example of Landsberg and Manivel as a\nhyperplane section of a 3-fold with only isolated singularities and the\nexamples of Bryant as hyperplane sections of surfaces with at most\nisolated singularities.\n\nChapter B is devoted to introducing our notation and presenting some\nelementary algebro-geometric facts.\n\nChapter C revises the differential geometric properties of infinitesimal\nautomorphisms that are necessary for Chapter E , but can be expressed\nwithout any explicit reference to the contact structure.\n\nChapter D is a brief revision of symplectic geometry that will be used\nin our discussion of contact manifolds. Also some statements from [\nBuc06 ] are generalised to this context.\n\nChapter E contains an independent review of local geometry of contact\nmanifolds, with emphasis on their infinitesimal automorphisms. There we\ncompare (after [ LeB95 ] and [ Bea07 ] ) two natural Lie algebra\nstructures related to a contact manifold @xmath : the Lie bracket of\nvector fields and the Poisson bracket on the structure sheaf of the\nsymplectisation of @xmath . We use this comparison to prove the first\ntheorem on embedded automorphisms of Legendrian subvarieties (see\nTheorem A.10 ).\n\nIn Chapters F \u2013 I we turn our attention to Legendrian subvarieties of a\nprojective space.\n\nIn Chapter F we continue the topic of automorphisms of Legendrian\nvarieties. We prove the second theorem on embedded automorphisms of\nLegendrian subvarieties in a projective space (see Theorem A.11 ). The\nresults of this chapter are published in [ Buc07 ] .\n\nIn Chapter G we illustrate, in the case of subvarieties of projective\nspace, how to classify toric Legendrian subvarieties and we give the\nlist of all smooth cases (see Theorem A.12 ) Also the results of that\nchapter are published in [ Buc07 ] .\n\nChapter H contains the classification of Legendrian varieties, which are\ncontained in a specific @xmath -cointegrable variety. Another new\nexample arises in this way: the smooth quasihomogeneous 8-fold (see\nTheorem A.13 ). Also we present two other variants of the construction,\nproducing a smooth 5-fold and a smooth 14-fold. The contents of that\nchapter are published in [ Buc09 ] .\n\nFinally Chapter I describes a Legendrian embedding of a hyperplane\nsection of a Legendrian variety (see Theorem A.14 ). Also a variant of\nan inverse construction (i.e.\u00a0to describe a bigger Legendrian variety\nfrom a given one, such that a hyperplane section of the big one is the\noriginal one) is presented and is applied to Bryant\u2019s, Landsberg\u2019s and\nManivel\u2019s examples of smooth Legendrian varieties (see Theorem A.17 ).\nParts of that chapter are published in [ Buc08b ] . The new parts of\nthis chapter are \u00a7 I.2 , where we construct a new series of examples\n(see Theorem A.16 ) and \u00a7 I.4 , where we explain the relation of certain\nLegendrian varieties with smooth varieties with smooth dual.\n\n### a.3 Open problems\n\nKeeping in mind the elegant results sketched in \u00a7 A.1 and having many\nnew examples of smooth Legendrian varieties (as well as families of\nsuch), several natural questions remain unanswered.\n\n##### New contact manifolds?\n\nCan we construct a new example of a contact manifold, whose variety of\ntangent directions to contact lines is one of the new Legendrian\nvarieties (or is in the given family)? If Conjecture A.2 is true, then\nthe answer is negative. If the answer is negative, then what are the\nobstructions, i.e., what conditions should we require on the Legendrian\nvariety to make the reconstruction of contact manifold possible?\n\n##### Further applications to algebra?\n\nCan the new Legendrian varieties be used in a similar manner as the\nsubadjoint cases and will they prove themselves to be equally\nextraordinary varieties? The first tiny piece of evidence for this is\nexplained in \u00a7 H.2.1 . On the other hand, it is unlikely that such a big\nvariety of examples can have analogous special properties.\n\n##### Self-dual varieties?\n\nAnother problem we want to mention here is a classical question in\nprojective geometry: what are the smooth subvarieties of projective\nspace, whose dual variety \u2075 \u2075 5 Given a subvariety @xmath , the dual\nvariety @xmath is the closure of the set of hyperplanes tangent to\n@xmath , see \u00a7 B.9 for details. is also smooth? So far the only examples\nof these are the self-dual varieties. Thanks to L.\u00a0Ein [ Ein86 ] , the\nclassification of smooth self-dual varieties @xmath is known when @xmath\n. In Corollary I.16 we prove that the problem of classifying smooth\nvarieties with smooth dual can be expressed in terms of Legendrian\nvarieties and possibly we can apply the techniques of Legendrian\nvarieties to finish the classification.\n\n##### Projectively and linearly normal Legendrian varieties?\n\nWe dare to conjecture:\n\n###### Conjecture A.18.\n\nLet @xmath be a smooth linearly normal \u2076 \u2076 6 A subvariety @xmath is\nlinearly normal if it is embedded by a complete linear system.\nLegendrian variety. Then @xmath is one of the subadjoint varieties.\n\nIn the view of Theorems A.14 and A.17 , the classification of linearly\nnormal Legendrian varieties might be a necessary step towards a\nclassification of Legendrian varieties.\n\nFurthermore, the conjecture might also contribute to the proof of\nConjecture A.2 . For instance assume Conjecture A.18 holds and @xmath is\na contact Fano manifold, for which the variety cut out by contact lines\nthrough a general point is normal. Then by applying Theorem A.4 we get\nthat the associated Legendrian variety @xmath is projectively normal \u2077 \u2077\n7 A subvariety @xmath is projectively normal if its affine cone is\nnormal. If @xmath is projectively normal, then it is also linearly\nnormal by [ Har77 , Ex.\u00a0II.5.14(d)] and by the conjecture and results of\n[ Hon00 ] the manifold @xmath is an adjoint variety.\n\nThe author is able to prove Conjecture A.18 if @xmath , but this is not\nan elegant argument nor does it have important applications. We omit the\nproof here until we manage to improve the argument or to generalise it\nto higher dimensions.\n\n## Chapter B Notation and elementary properties\n\nIn the present monograph we always work over the field of complex\nnumbers @xmath .\n\n### b.1 Vector spaces and projectivisation\n\nLet @xmath be a vector space over @xmath . By @xmath we mean the naive\nprojectivisation of @xmath , i.e.\u00a0the quotient @xmath .\n\nIf @xmath , then by @xmath we denote the line spanned by @xmath .\n\nAnalogously, if @xmath is a vector bundle, by @xmath we denote the naive\nprojectivisation of @xmath . Let @xmath be the zero section of @xmath .\nIf @xmath , then by @xmath we denote the line spanned by @xmath in the\nappropriate fibre of @xmath .\n\n### b.2 Bilinear forms and their matrices\n\nLet @xmath be a complex vector space of dimension @xmath and @xmath a\nbilinear form on @xmath . Fix a basis @xmath of @xmath and let @xmath be\nthe @xmath -matrix such that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath and @xmath are arbitrary column vectors of @xmath . We say\nthat @xmath is the matrix of @xmath in the basis @xmath .\n\nIn particular if @xmath is a symplectic form (see \u00a7 D.1.1 ), @xmath and\n@xmath is a symplectic basis, then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nMoreover in such a case @xmath is also the matrix of the linear map\n@xmath :\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nin the basis @xmath on @xmath and the dual basis on @xmath .\n\nSimilarly, if @xmath is a quadratic form on @xmath , then we denote by\n@xmath the matrix of @xmath in the basis @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n### b.3 Complex and algebraic manifolds\n\nOur main concern is with complex projective manifolds and varieties.\nThis is where two categories meet: complex algebraic varieties and\nanalytic spaces (see [ Gri74 ] ). Since the author\u2019s origins lie in\nalgebraic geometry, this monograph\u2019s intention is to study algebraic\nLegendrian varieties. However, for some statements there is no reason to\nlimit to the algebraic case, so we state them also for the analytic\nsituation.\n\nSo @xmath will be usually the ambient manifold (for example contact or\nsymplectic manifold), either a complex manifold or smooth algebraic\nvariety. Some statements are local for @xmath (in the analytic\ntopology), hence it is enough to prove them for @xmath , where @xmath is\na complex disc.\n\nOur main interest is in @xmath , which will be either an analytic\nsubspace (if @xmath is a complex manifold), or an algebraic subvariety\n(if @xmath is algebraic). For short, will always say @xmath is a\nsubvariety.\n\n### b.4 Vector bundles, sheaves and sections\n\nGiven an analytic space or algebraic variety @xmath , we denote by\n@xmath both the structure sheaf (consisting of either holomorphic or\nalgebraic functions on @xmath in the appropriate analytic or Zariski\ntopology) and the trivial line bundle. If @xmath is a subvariety, then\nby @xmath we mean the sheaf of ideals in @xmath defining @xmath .\n\nGiven a vector bundle @xmath on @xmath we will use the same letter\n@xmath for the sheaf of sections of @xmath . To avoid confusion and too\nmany brackets (for example @xmath ) given an open subset @xmath and a\nsheaf (or vector bundle) @xmath , we will write @xmath rather than\n@xmath to mean the value of the sheaf at the open subset @xmath (or\nsections of vector bundle). By @xmath we mean the sheaf (or vector\nbundle) restriction of @xmath to the open subset @xmath .\n\nWhere there can be no confusion, given a sheaf @xmath which does not\nhave any natural vector bundle structure we will write @xmath to mean:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nOn the other hand, if @xmath is a vector bundle, then by @xmath , we\nmean that @xmath is a vector in the bundle.\n\nGiven a vector bundle @xmath , we denote by @xmath the dual vector\nbundle:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath is a map of sheaves or vector bundles and @xmath , then by\n@xmath we mean the image section of @xmath .\n\n### b.5 Derivatives\n\nGiven a complex manifold or smooth algebraic variety @xmath and a\nholomorphic or algebraic @xmath -form @xmath by @xmath we denote the\nexterior derivative of @xmath . This convention is also valid for @xmath\n-forms:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy @xmath we mean the tangent vector bundle. Nevertheless we keep in\nmind, that a vector field @xmath can also be interpreted as a derivation\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn particular, we can define the Lie bracket of two vector fields @xmath\nas:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis convention is in agreement with [ Arn74 ] .\n\nGiven a holomorphic or algebraic map @xmath , by @xmath we mean the\nderivative map:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath and @xmath , then by @xmath we mean the contracted @xmath\n-form. For example, if @xmath for 1-forms @xmath , then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n### b.6 Homogeneous differential forms and vector fields\n\nLet @xmath , @xmath be two complex manifolds and let @xmath be a\nholomorphic map. For a @xmath -form @xmath , by @xmath we denote the\npull-back of @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNow assume we have a @xmath -action on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe say that @xmath is homogeneous of weight @xmath if\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor example, assume @xmath and @xmath acts via homotheties. We say\n@xmath is constant , if it is a @xmath -linear combination of @xmath .\nConstant @xmath forms are homogeneous of weight @xmath (not of weight 0\nas one could possibly expect). Conversely, if @xmath is homogeneous of\nweight @xmath , then it is constant, because every global form can be\nwritten as @xmath . Since @xmath are already of weight @xmath , it\nfollows that @xmath are constant functions.\n\nLet @xmath be a vector field. We say @xmath is homogeneous of weight\n@xmath if\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Lemma B.1.\n\nLet @xmath , @xmath be complex manifolds, both with a @xmath -action.\nMoreover assume @xmath is a @xmath -equivariant map, @xmath is a\nhomogeneous @xmath -form for some @xmath and @xmath , @xmath are two\nhomogeneous vector fields.\n\n1.  @xmath is homogeneous and @xmath ;\n\n2.  @xmath is homogeneous of weight @xmath and @xmath is homogeneous of\n    weight @xmath ;\n\n3.  @xmath is homogeneous of weight @xmath .\n\nProof. This is an immediate calculation. For instance (i) :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n@xmath\n\n### b.7 Submersion onto image\n\nWe recall the standard fact, that every algebraic map is generically a\nsubmersion on the closure of the image.\n\n###### Lemma B.2.\n\nLet @xmath and @xmath be two algebraic varieties over an algebraically\nclosed field of characteristic 0 and let @xmath be a map such that\n@xmath . Then for a general @xmath , the derivative @xmath is\nsurjective.\n\nProof. See [ Har77 , Cor.\u00a0III.10.7] .\n\n@xmath\n\nAs a corollary, we prove an easy proposition about subvarieties of\nproduct manifolds.\n\n###### Proposition B.3.\n\nLet @xmath and @xmath be two smooth algebraic varieties and suppose\n@xmath is a closed irreducible subvariety. Let @xmath be the closure of\nthe image of @xmath under the projection @xmath onto @xmath . Assume\nthat for a Zariski open dense subset of smooth points @xmath the tangent\nbundle to @xmath decomposes as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\na sum of two vector bundles. Then @xmath .\n\nProof. Since @xmath is irreducible, so is @xmath and @xmath and clearly\n@xmath . So it is enough to prove that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHowever, the maps @xmath are surjective onto @xmath and hence applying\nLemma B.2 :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n@xmath\n\n### b.8 Tangent cone\n\nWe recall the notion of the tangent cone and a few among many of its\nproperties. For more details and the proofs we refer to [ Har95 ,\nLecture\u00a020] and [ Mum99 , III.\u00a73,\u00a74] .\n\nFor an irreducible Noetherian scheme @xmath over @xmath and a closed\npoint @xmath we consider the local ring @xmath and we let @xmath be the\nmaximal ideal in @xmath . Let\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is just the whole of @xmath . Now we define the tangent\ncone @xmath at @xmath to @xmath to be @xmath .\n\nIf @xmath is a subscheme of an affine space @xmath (which we will\nusually assume to be an affine piece of a projective space), the tangent\ncone at @xmath to @xmath can be understood as a subscheme of @xmath .\nIts equations can be derived from the ideal of @xmath . For simplicity\nassume @xmath and then the polynomials defining @xmath are the lowest\ndegree homogeneous parts of the polynomials in the ideal of @xmath .\n\nAnother interesting point-wise definition is that @xmath is a closed\npoint if and only if there exists a holomorphic map @xmath from the disc\n@xmath to @xmath , such that @xmath and the first non-zero coefficient\nin the Taylor expansion in @xmath of @xmath is @xmath , i.e.:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe list some of the properties of the tangent cone, which will be used\nfreely in the proofs:\n\n-   The dimension of every component of @xmath is equal to the dimension\n    of @xmath .\n\n-   @xmath is naturally embedded in the Zariski tangent space to @xmath\n    at @xmath and @xmath spans (as a scheme) the tangent space.\n\n-   @xmath is regular at @xmath if and only if @xmath is equal (as a\n    scheme) to the tangent space.\n\n### b.9 Secant, tangent and dual varieties\n\nLet @xmath be a vector space of dimension @xmath . Let @xmath be any\nsubvariety.\n\nWe denote by @xmath its secant variety , i.e., closure of the union of\nall projective lines through @xmath and @xmath , where @xmath vary\nthrough all pairs of different points of @xmath .\n\nBy @xmath we denote the tangent variety of @xmath , i.e.\u00a0the closure of\nthe union of limits of secant lines as @xmath converges to @xmath .\n\nAlso:\n\n###### Definition.\n\nWe let @xmath be the closure of the set of hyperplanes tangent to @xmath\nat some point:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe say @xmath is the dual variety to @xmath .\n\n## Chapter C Vector fields, forms and automorphisms\n\nIn the course of this dissertation, particularly in Chapter E we use\nsome differential geometric facts, which we summarise in this chapter.\nAlthough all these facts are standard or follow easily from the standard\nmaterial, we reproduce or at least sketch most of the proofs. We do this\nfor the sake of completeness of the material presented in the monograph\nand also because various authors of textbooks use various notations and\ncombining them one can get very confused (at least this has happened to\nthe author of this monograph).\n\n### c.1 Vector fields, Lie bracket and distributions\n\nLet @xmath be a complex manifold or a smooth algebraic variety, let\n@xmath be a corank @xmath subbundle \u00b9 \u00b9 1 One could also consider @xmath\nto be a corank @xmath subbundle for any @xmath . Some of the statements\nbelow can be generalised to any @xmath (not necessary @xmath ), but the\nproofs get more complicated, especially in notation. We restrict our\nconsiderations to the @xmath case, as this is the only one used in the\ndissertation. and let @xmath be the quotient map, so that the following\nsequence is exact:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nAlso assume @xmath is an open subset. We say that a (possibly singular)\nsubvariety @xmath with its smooth locus @xmath is @xmath -integrable if\n@xmath is contained in @xmath .\n\n###### Proposition C.1.\n\nWith the assumptions as above:\n\n1.  @xmath gives a well defined map of @xmath -modules:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    We refer to this map as the twisted 2-form @xmath .\n\n2.   Assume @xmath and @xmath are two vector fields on @xmath , both\n    contained in @xmath . Then @xmath . In particular @xmath does not\n    depend on the vector fields, but only on their values at @xmath .\n\n3.   Again assume @xmath and @xmath are two vector fields on @xmath ,\n    but now only @xmath is contained in @xmath . Then again @xmath\n    depends only on the value of @xmath at @xmath , but not on the whole\n    vector field. In other words the map of sheaves @xmath given by\n    @xmath is @xmath -linear and hence it determines a map of vector\n    bundles @xmath .\n\n4.   If @xmath is @xmath -integrable, then @xmath . In particular:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\nProof. All the statements are analytically local, so it is enough to\nassume that @xmath is a disc @xmath with coordinates @xmath , @xmath ,\n@xmath and that @xmath is a nowhere vanishing section of @xmath (the\nchoice of the trivialisation of @xmath is of course not unique):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere the collection @xmath (respectively @xmath ) we denote by @xmath\n(respectively @xmath ). Then:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTo prove (i) note that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe must check that this does not depend on the choice of the\ntrivialisation @xmath of @xmath . So assume @xmath is a different\ntrivialisation, so there exists @xmath such that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe must prove that @xmath restricted to @xmath transforms in the same\nmanner:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTo prove (ii) let\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nfor some holomorphic functions @xmath and @xmath . Since @xmath and\n@xmath are contained in @xmath we have:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTherefore for every @xmath or @xmath we have:\n\n  -- -------- -------- -- --------\n                          \n     @xmath   @xmath      (C.2a)\n     @xmath   @xmath      (C.2b)\n  -- -------- -------- -- --------\n\nSince\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nhence:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe note that the above calculation is a special case of [ KN96 ,\nProp.\u00a0I.3.11] , though the reader should be careful, as the notation in\n[ KN96 ] is different than ours and as a consequence a constant factor\n@xmath is \u201cmissing\u201d in our formula.\n\nThe proof of (iii) is identical as the beginning of the proof of (ii) .\n\nFinally to prove (iv) just use (ii) and the fact that the Lie bracket of\ntwo vector fields tangent to @xmath must be tangent to @xmath .\n\n@xmath\n\n### c.2 Automorphisms\n\nHere we introduce the notation about several types of automorphisms of a\nmanifold @xmath and its subvariety @xmath . Also we recall some standard\nproperties and relations between them.\n\nLet @xmath be a complex manifold (or respectively, smooth algebraic\nvariety) and let @xmath be an open subset in analytic (or respectively,\nZariski) topology. By @xmath (respectively, @xmath ) we denote the group\nof holomorphic (respectively, algebraic) automorphisms of @xmath . By\n@xmath we mean either @xmath or @xmath , whenever specifying is not\nnecessary.\n\nAssume that a complex Lie group (respectively, an algebraic group)\n@xmath acts on @xmath , i.e.\u00a0we have a group homomorphism @xmath . Also\nlet @xmath be the Lie algebra of @xmath . By @xmath we denote the the\nconnected component of identity in @xmath .\n\nAn infinitesimal automorphism of @xmath is a vector field @xmath .\nDifferentiating the action map @xmath by the first coordinate we get the\ninduced map @xmath or more precisely @xmath . This map preserves the Lie\nbracket (see [ Akh95 , Thm in \u00a71.7] ) and if the action is faithful,\nthen it is injective (see [ Akh95 , Thm in \u00a71.5] ).\n\nThe particular case is when @xmath . Then we get a map @xmath and we set\n@xmath to be the image of @xmath under this map. We say @xmath is the\nvector field related to the @xmath -action. Note that @xmath is\nhomogeneous of weight @xmath .\n\nThe infinitesimal automorphisms make a sheaf @xmath of Lie algebras,\nwhich at the same time is an @xmath -module. The two multiplication\nstructures are related by the following Leibniz rule:\n\n  -- -------- -- -------\n     @xmath      (C.3)\n  -- -------- -- -------\n\nThe following theorem comparing infinitesimal, algebraic and holomorphic\nautomorphisms for a projective variety is well known and standard:\n\n###### Theorem C.4.\n\nLet Y be a projective variety. Then:\n\n1.  @xmath is a complex Lie group.\n\n2.   Every holomorphic automorphism of @xmath is algebraic and hence\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n3.   By @xmath we denote the tangent Lie algebra to @xmath . Every\n    infinitesimal automorphism is tangent to some 1-parameter subgroup\n    of @xmath , so that @xmath .\n\nProof. Part (i) is proved in [ Akh95 , \u00a72.3] . Part (ii) is a\nconsequence of [ Gri74 , Thm\u00a0IV.A] . Part (iii) is explained in [ Akh95\n, Prop. in \u00a71.5 & Cor.\u00a01 in \u00a71.8] .\n\n@xmath\n\nClearly @xmath is a representation of @xmath and hence also of @xmath .\nWe also have the following Lie algebra action of the sheaf of\ninfinitesimal automorphisms:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhich is given by the derivation in the direction of the vector field.\n\nThe action of @xmath on @xmath is the composition\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nLet @xmath be a subvariety. By @xmath we denote the respective subgroup\nof @xmath preserving the intersection @xmath . If @xmath is projective,\nthen by @xmath we mean the Lie algebra tangent to @xmath . By @xmath we\ndenote the Lie algebra of infinitesimal automorphisms of @xmath\npreserving @xmath , i.e.:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is the sheaf of ideals of @xmath .\n\nClearly, if @xmath preserves @xmath , then the image of @xmath is\ncontained in @xmath . Conversely, if the image is contained in @xmath ,\nthen the action of the connected component @xmath preserves @xmath .\n\n###### Corollary C.5.\n\nIf @xmath is projective, then @xmath .\n\n@xmath\n\nMoreover @xmath makes in @xmath a subsheaf of Lie algebras and @xmath\n-modules.\n\n### c.3 Line bundles and @xmath-bundles\n\nLet @xmath be complex manifold or a smooth algebraic variety and let\n@xmath be a line bundle on @xmath . By @xmath we denote the principal\n@xmath -bundle over @xmath obtained as the line bundle @xmath with the\nzero section removed. Let @xmath be the projection @xmath .\n\nLet @xmath be the sheaf of graded @xmath -algebras @xmath on @xmath .\nGiven an open subset @xmath the ring @xmath consists of all the\nalgebraic functions on @xmath , i.e. @xmath . Therefore\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nMoreover, @xmath is the set of homogeneous functions of weight @xmath\n(see \u00a7 B.6 ).\n\n###### Lemma C.6.\n\nLet @xmath be a smooth algebraic variety and let @xmath be a line bundle\non @xmath . Then @xmath and the map @xmath is induced by the projection\n@xmath .\n\nProof. The Picard group of the total space of @xmath is isomorphic to\n@xmath and the isomorphisms are given by the projection and the zero\nsection @xmath . Further, @xmath is a Cartier divisor linearly\nequivalent to any other rational section @xmath . Therefore @xmath and\nhence by [ Har77 , Prop.\u00a06.5(c)] the following sequence is exact:\n\n  -- -- --\n        \n  -- -- --\n\n@xmath\n\nThe relative tangent bundle, i.e. @xmath is trivialised by the vector\nfield @xmath related to the action of @xmath (see \u00a7 C.2 ) and hence we\nhave the short exact sequence:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn particular @xmath .\n\n### c.4 Distributions and automorphisms preserving them\n\nLet @xmath be a corank 1 vector subbundle. Our particular interest will\nbe in the case where @xmath is a contact distribution - see \u00a7 E.3 for\nthe definition. But what follows holds true for any @xmath . By @xmath ,\n@xmath , @xmath , @xmath , @xmath and @xmath we denote the appropriate\nautomorphisms or infinitesimal automorphisms preserving @xmath and\npossibly the subvariety @xmath .\n\nFor instance,\n\n  -- -------- -- -------\n     @xmath      (C.7)\n  -- -------- -- -------\n\nAlso @xmath makes a sheaf of Lie algebras, but usually it is not an\n@xmath -submodule of @xmath . To see that take any @xmath for @xmath\nsmall enough. Assume for all @xmath we have @xmath . Then by Leibniz\nrule (see Equation C.3 ):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis can only happen if either:\n\n-   @xmath or\n\n-   @xmath , i.e. @xmath is the rank 0 bundle.\n\nWe will see that the first case does not happen if @xmath is a contact\ndistribution (unless @xmath , see Theorem E.13 (1) ). In fact, one can\nprove that it never happens for all @xmath (remember that @xmath is\nsmall enough), unless @xmath .\n\nIf @xmath acts on @xmath and preserves the distribution @xmath , then\nthe map @xmath factors through @xmath . Conversely, if @xmath is\nconnected, it acts on @xmath and the map @xmath factors through @xmath ,\nthen the action of @xmath preserves @xmath . As a consequence we get:\n\n###### Corollary C.8.\n\nIf @xmath is projective and @xmath is a subvariety, then:\n\n1.  @xmath\n\n2.  @xmath\n\nProof. This follows from the above considerations and from Theorem C.4 .\n\n@xmath\n\nFurther, let @xmath be the quotient bundle and @xmath be the quotient\nmap:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf the action of @xmath on @xmath extended to @xmath preserves @xmath ,\nthen in the obvious way we get the induced action of @xmath on the total\nspaces of @xmath and @xmath . These actions preserve the zero sections.\n\nLet @xmath and @xmath be as in \u00a7 C.3 .\n\nBy analogy with above we want to define the action of @xmath on @xmath .\nIn other words, we define a special lifting of the vector fields from\n@xmath to vector fields on @xmath .\n\nFirst observe that the sheaf of Lie algebras @xmath acts on the sheaf\n@xmath : if @xmath , then choose an open subset @xmath small enough and\nany lifting @xmath , @xmath and let @xmath act on @xmath locally by\n\n  -- -------- -- -------\n     @xmath      (C.9)\n  -- -------- -- -------\n\nBy Equation\u00a0( C.7 ) defining @xmath , this does not depend on the choice\nof @xmath and hence, by elementary properties of sheaves, it glues\nuniquely to an element of @xmath . Hence we get a Lie algebra\nrepresentation @xmath .\n\nSecondly, we can extend the action of @xmath on the locally free sheaf\n@xmath defined in Equation\u00a0( C.9 ) to an action on @xmath , by\nrequesting that the action must satisfy the Leibniz rule:\n\n  -- -------- -- --------\n     @xmath      (C.10)\n  -- -------- -- --------\n\n\u2014 locally every section of @xmath can be written as a sum of products of\nsections of @xmath (or their inverses, if @xmath ).\n\nFinally, we can extend this action to @xmath , again requesting the\nLeibniz rule. Eventually, we get the action, which we will call the\ninduced action of @xmath on @xmath . The following property justifies\nthe name:\n\n###### Proposition C.11.\n\nIf the action of @xmath preserves @xmath , then the tangent action to\nthe induced action of @xmath on @xmath is the composition of @xmath and\nthe induced action of @xmath on @xmath .\n\n@xmath\n\nFor a fixed @xmath , the induced map @xmath is a derivation, so it\ncorresponds to a vector field @xmath , such that\n\n  -- -------- -- --------\n     @xmath      (C.12)\n  -- -------- -- --------\n\nBy construction we also have @xmath .\n\n### c.5 Lifting and descending twisted forms\n\nIn this section we explain how to lift the twisted form @xmath to a form\n@xmath on @xmath . Later we study the derivative @xmath and show its\nrelation to @xmath . Finally we prove the homogeneity of @xmath and\n@xmath and thus explicitly set conditions when a @xmath -bundle together\nwith a @xmath -form @xmath arises as @xmath from some distribution\n@xmath .\n\nWith the notation and assumptions as in the previous sections, we have a\ncanonical isomorphism of line bundles @xmath : if @xmath , @xmath ,\n@xmath , then we set\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe let @xmath : \u00b2 \u00b2 2 In [ Bea98 ] , [ LeB95 ] the authors denote @xmath\nsimply as @xmath , since the other maps are natural. This is a bit\nconfusing to some people (including the author of this monograph, but\nsee also a comment in [ SCW04 ] about a small mistake in [ KPSW00 ] )\nand therefore we underline that @xmath is the composition of three maps.\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Lemma C.13.\n\nFor every @xmath the induced infinitesimal automorphism @xmath preserves\n@xmath , i.e.:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is the Lie derivative operator and @xmath is the local\n1-parameter group of transformations of @xmath determined by @xmath .\n\nProof. For the simplicity of notation assume @xmath is a global\ntransformation. The following diagram of vector bundles is commutative:\n\n  -- -- --\n        \n  -- -- --\n\nwhere by @xmath we mean the automorphism of @xmath , which is determined\nby @xmath and @xmath ; similarly @xmath is determined by @xmath and\n@xmath . The composition of the whole upper row is equal to @xmath . The\ncomposition of the left most vertical arrow and the whole lower row is\nequal to @xmath . Since the right arrow is the identity on the second\ncomponent @xmath and since the diagram is commutative, both forms take\nthe same values on every vector @xmath , hence are equal and the claim\nfollows.\n\n@xmath\n\nWe also give a local description of @xmath and @xmath . So now assume\n@xmath and let @xmath be some coordinates on @xmath . Let @xmath be a\nlinear coordinate on the fibre of @xmath . This means that @xmath\ndetermines a section of @xmath which trivialises @xmath over @xmath . So\nwe can think of @xmath as of a holomorphic @xmath -form on @xmath\ndepending only on @xmath \u2019s and @xmath \u2019s. Let @xmath be any point of\n@xmath and let @xmath be any vector tangent to @xmath at @xmath . We\nwrite @xmath , where @xmath is the component tangent to @xmath , while\n@xmath is tangent to @xmath . Then:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nor more concisely (in local coordinates)\n\n  -- -------- -- --------\n     @xmath      (C.14)\n  -- -------- -- --------\n\nand therefore\n\n  -- -------- -- --------\n     @xmath      (C.15)\n  -- -------- -- --------\n\nSince in this notation @xmath is a homogeneous 1-form of weight @xmath\nand @xmath , @xmath and @xmath are homogeneous forms of weight 1 (see \u00a7\nB.6 ).\n\nIn the above coordinates, the vector field @xmath related to the @xmath\n-action can be expressed as follows:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proposition C.16.\n\nLet @xmath be a complex manifold or smooth algebraic variety and let\n@xmath be a line bundle on @xmath . Also let @xmath be the principal\n@xmath -bundle over @xmath as in \u00a7 C.3 and let @xmath be the vector\nfield on @xmath associated to the action of @xmath . Finally, let @xmath\nbe a homogeneous closed 2-form on @xmath of weight @xmath . Then:\n\n1.  @xmath ;\n\n2.   There exists a unique twisted 1-form @xmath , such that @xmath ,\n    where @xmath is defined from @xmath as above;\n\n3.   Moreover, @xmath is nowhere vanishing if and only if @xmath is\n    nowhere vanishing. If this is the case, then @xmath is\n    non-degenerate if and only if @xmath is non-degenerate.\n\nProof. To prove (i) let @xmath be a local coordinate linear on the\nfibres of @xmath . Since @xmath is closed, locally it is exact, so\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor some function @xmath and 1-form @xmath , both homogeneous of weight\n0. However,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSet @xmath , so that @xmath . Note that although @xmath and @xmath are\nnot uniquely determined, @xmath is the unique homogeneous 1-form of\nweight 0 such that @xmath . Then,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath , as claimed in (i) .\n\nTo prove (ii) , define @xmath to be locally the form @xmath from the\nabove argument. One must verify that @xmath glues uniquely to a twisted\n1-form @xmath .\n\nPart (iii) follows from the local descriptions of @xmath and @xmath ,\nsee Equations\u00a0( C.14 ) and ( C.15 ). For instance, if @xmath , then:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTherefore @xmath is non-degenerate at a given point if and only if\n@xmath does not vanish at that point and @xmath is non-degenerate on the\nkernel of @xmath .\n\n@xmath\n\n###### Lemma C.17.\n\nLet @xmath be any subvariety and @xmath its smooth locus. Then @xmath is\n@xmath -integrable if and only if @xmath vanishes identically on the\ntangent space to @xmath .\n\nProof. First assume @xmath is @xmath -integrable. Then @xmath vanishes\non @xmath by Proposition C.1 (iv) and @xmath vanishes by definition.\nHence from the local description of @xmath (see Equation\u00a0( C.15 )) we\nget the result.\n\nOn the other hand if @xmath , since\n\n  -- -- --\n        \n  -- -- --\n\nthen in particular\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBut @xmath (see Proposition C.16 (ii) ), hence @xmath is @xmath\n-integrable and therefore @xmath is @xmath -integrable.\n\n@xmath\n\nFor @xmath , by @xmath we denote the lifting of @xmath , i.e. @xmath .\n\nHence we have two different possibilities of lifting an infinitesimal\nautomorphism @xmath to an object on @xmath : either we lift it to vector\nfield @xmath (see Equation\u00a0( C.12 )) or we lift @xmath to function\n@xmath . We will compare these two liftings and how they behave with\nrespect to the Lie bracket of vector fields in the following statements.\n\n###### Lemma C.18.\n\nWe have:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nProof. By Equation\u00a0( C.9 ):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand hence @xmath . By Equation\u00a0( C.12 ), this is equal to @xmath .\n\n@xmath\n\n###### Proposition C.19.\n\nIf @xmath , then:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nProof. The following proof is quoted from [ Bea98 , Prop.\u00a01.6] . Since\n@xmath (see Lemma C.13 ), by [ KN96 , Prop.\u00a0I.3.10(a)] we have:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nOn the other hand:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nCombining the two equalities, we get the result.\n\n@xmath\n\n###### Corollary C.20.\n\nIf @xmath , then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nProof. This combines Lemma C.18 and Proposition C.19 .\n\n@xmath\n\n## Chapter D Elementary symplectic geometry\n\nWe introduce some elementary facts from symplectic geometry, having in\nmind the needs of subsequent chapters. Most of this material is\ncontained in (or can be easily deduced from) classical textbooks on\nsymplectic geometry, such as [ MS98 ] , although we rewrite this over\nthe ground field @xmath rather than @xmath .\n\n### d.1 Linear symplectic geometry\n\nIn this section we study linear algebra of vector space, which has a\nsymplectic form. Although it is elementary, it is very important for our\nconsiderations as it has threefold application: Firstly, the content of\nthis section describes the local behaviour of symplectic manifolds (see\n\u00a7 D.2 ), particularly the symplectisations of contact manifolds (see \u00a7\nE.3.1 ). Secondly, it describes very much of global geometry of\nprojective space as a contact manifold (see Example E.10 , but also look\nthrough Chapters F \u2013 I ). Finally, it explains the fibrewise behaviour\nof contact distribution (see \u00a7 E.3 ).\n\n#### d.1.1 Symplectic vector space\n\nA symplectic form on a vector space @xmath is a non-degenerate\nskew-symmetric bilinear form. So @xmath is a symplectic form if and only\nif\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nor equivalently the map\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis an isomorphism.\n\nIf a vector space @xmath has a symplectic form @xmath , we say that\n@xmath (or @xmath if specifying the form is important) is a symplectic\nvector space . In such a case the dimension of @xmath is even and there\nexists a basis @xmath (where @xmath ) of @xmath such that @xmath ,\n@xmath and @xmath for @xmath . Such a basis is called a symplectic basis\n.\n\nBy @xmath we denote the corresponding symplectic form on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNote that if @xmath , @xmath is a symplectic basis of @xmath and @xmath\n, @xmath is the dual basis of @xmath , then @xmath is a symplectic basis\nof @xmath . In such a case @xmath are also called symplectic coordinates\non @xmath .\n\n#### d.1.2 Subspaces in a symplectic vector space\n\nAssume @xmath is a vector space of dimension @xmath and @xmath is a\nsymplectic form on @xmath . Now suppose @xmath is a linear subspace. By\n@xmath we denote the @xmath perpendicular complement of @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nDenote by @xmath the natural projection @xmath . We say that the\nsubspace @xmath is:\n\n  isotropic                                       @xmath   @xmath                                         @xmath   @xmath   @xmath   @xmath is coisotropic;\n  ----------------------------------------------- -------- ---------------------------------------------- -------- -------- -------- ------------------------\n  coisotropic (or sometimes called involutive )   @xmath   @xmath                                         @xmath   @xmath   @xmath   @xmath is isotropic;\n  Lagrangian                                      @xmath   @xmath is isotropic or involutive and @xmath   @xmath   @xmath   @xmath   @xmath is Lagrangian;\n  symplectic                                      @xmath   @xmath is a symplectic form on @xmath          @xmath   @xmath   @xmath   @xmath is symplectic.\n\n#### d.1.3 Symplectic reduction of vector space\n\nWith the assumptions as above let @xmath be any linear subspace and let\n@xmath . Define @xmath to be the following bilinear form on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen @xmath is a symplectic vector space.\n\nThe particular case we are mostly interested in is when @xmath is a\nhyperplane or more generally a coisotropic subspace.\n\nNote the following elementary properties of this construction:\n\n###### Proposition D.1.\n\nFor a subspace @xmath let @xmath be the image of @xmath in @xmath .\n\n1.   If @xmath is isotropic (resp.\u00a0coisotropic or Lagrangian) in @xmath\n    , then @xmath is isotropic (resp.\u00a0coisotropic or Lagrangian) in\n    @xmath .\n\n2.   Conversely, if @xmath is coisotropic, @xmath and @xmath is\n    isotropic (resp.\u00a0coisotropic or Lagrangian) in @xmath , then @xmath\n    is isotropic (resp.\u00a0coisotropic or Lagrangian) in @xmath .\n\n@xmath\n\n#### d.1.4 Symplectic automorphisms and weks-symplectic matrices\n\nA linear automorphism @xmath of a symplectic vector space @xmath is\ncalled a symplectomorphism if @xmath i.e.:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe denote by @xmath the group of all symplectomorphisms of @xmath and by\n@xmath its Lie algebra:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nA linear automorphism @xmath of @xmath is called a conformal\nsymplectomorphism if @xmath for some constant @xmath . We denote by\n@xmath the group of all conformal symplectomorphisms of @xmath and by\n@xmath the tangent Lie algebra.\n\nFix a basis @xmath of @xmath and note that a matrix @xmath is in the\nsymplectic algebra @xmath if and only if\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath . For the sake of Chapter F we also need to define a\ncomplementary linear subspace to @xmath :\n\n###### Definition.\n\nA matrix @xmath is weks-symplectic \u00b9 \u00b9 1 A better name would be\nskew-symplectic or anti-symplectic , but these are reserved for some\ndifferent notions. if and only if it satisfies the equation:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe vector space of all weks-symplectic matrices will be denoted by\n@xmath (even though it is not a Lie subalgebra of @xmath ).\n\nWe immediately see that a matrix is weks-symplectic if and only if it\ncorresponds to a linear endomorphism @xmath , such that for every @xmath\n:\n\n  -- -------- -- -------\n     @xmath      (D.2)\n  -- -------- -- -------\n\nThis is a coordinate free way to describe @xmath .\n\nAssume that our basis @xmath is symplectic. In particular @xmath .\n\n###### Remark D.3.\n\nFor a matrix @xmath we have:\n\n-   @xmath is a symmetric matrix;\n\n-   @xmath is a skew-symmetric matrix.\n\n@xmath\n\nNote that if @xmath , then we can write:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand the first component @xmath is in @xmath , while the second @xmath is\nin @xmath . Obviously, this decomposition corresponds to expressing the\nmatrix @xmath as a sum of symmetric and skew-symmetric matrices.\n\nWe list some properties of @xmath :\n\n###### Proposition D.4.\n\nLet @xmath . The following properties are satisfied:\n\n-    Write the additive Jordan decomposition for @xmath :\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    where @xmath is semisimple and @xmath is nilpotent. Then both @xmath\n    and @xmath .\n\n-    For @xmath , denote by @xmath the @xmath -eigenspace of @xmath .\n    For any @xmath two different eigenvalues @xmath is @xmath\n    -perpendicular to @xmath .\n\n-    If @xmath is semisimple, then each space @xmath is symplectic.\n\n@xmath\n\n#### d.1.5 Standard symplectic structure on @xmath\n\nLet @xmath be any finite dimensional vector space. Set @xmath and there\nis a canonical symplectic form on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath is any basis of @xmath and @xmath is the dual basis of @xmath\n, then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a symplectic basis of @xmath . In particular, we have the natural\nembedding\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nWe note the following elementary lemma:\n\n###### Lemma D.5.\n\nLet @xmath be any linear subspace. Then @xmath is a Lagrangian subspace.\n\n@xmath\n\n### d.2 Symplectic manifolds and their subvarieties\n\nSymplectic manifolds will serve us to understand some geometric and\nalgebraic structures of the symplectisations of contact manifolds (see \u00a7\nE.3.1 ).\n\nA complex manifold or a smooth complex algebraic variety @xmath is a\nsymplectic manifold if there exists a global closed holomorphic 2-form\n@xmath with @xmath which restricted to every fibre is a symplectic form\non the tangent space. In other words, @xmath is a nowhere vanishing\nsection of @xmath . The form @xmath is called a symplectic form on\n@xmath .\n\nSimilarly as in the case of the vector space, the symplectic form\ndetermines an isomorphism:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe theory of compact (or projective) complex symplectic manifolds is\nwell developed and has a lot of beautiful results (see for example [\nLeh04 ] , [ Huy03 ] and references therein). Yet here we will only use\nsome non-compact examples as a tool for studying contact manifolds and\nwe will only need a few of their basic properties. Also some extensions\nof the symplectic structure to the singularities of @xmath are studied,\nbut we are interested only in the case where @xmath is smooth.\n\n#### d.2.1 Subvarieties of a symplectic manifold\n\nLet @xmath be a symplectic manifold. For a subvariety @xmath we say\n@xmath is respectively\n\n1.   isotropic ,\n\n2.   coisotropic ,\n\n3.   Lagrangian ,\n\nif and only if there exists an open dense subset @xmath (equivalently,\nfor any open dense subset @xmath ) of smooth points of @xmath , such\nthat for every @xmath the tangent space @xmath is respectively\n\n1.  isotropic,\n\n2.  coisotropic,\n\n3.  Lagrangian.\n\nOr equivalently, for every @xmath the conormal space @xmath is\nrespectively\n\n1.  coisotropic,\n\n2.  isotropic,\n\n3.  Lagrangian.\n\nNote that a subvariety is Lagrangian if and only if it is isotropic (or\ncoisotropic) and the dimension is equal to @xmath .\n\n#### d.2.2 Examples\n\nThe following examples are important for our considerations, as they\nwill appear as symplectisations of projective contact manifolds (see \u00a7\nE.3.1 ).\n\n##### The affine space\n\nOur key example is the simplest possible: an affine space of even\ndimension. So assume @xmath is a symplectic vector space of dimension\n@xmath . Then take the affine space @xmath of the same dimension, whose\ntangent space at every point is @xmath and globally @xmath . Then @xmath\ntrivially extends to the product and it is a symplectic form on @xmath .\n\nBy an abuse of notation, we will denote the affine space by @xmath as\nwell (so in particular a @xmath is fixed in the affine space and the\naction of @xmath by homotheties is chosen). In this setup, the form\n@xmath is homogeneous of weight 2 (see \u00a7 B.6 ).\n\n##### Products\n\nAssume @xmath and @xmath are two symplectic manifolds with symplectic\nforms @xmath and @xmath respectively. Clearly @xmath is a symplectic\nmanifold with the symplectic form @xmath , where the @xmath \u2019s are the\nappropriate projections.\n\nNext, let @xmath be two subvarieties. Both the @xmath \u2019s are\nrespectively\n\n1.  isotropic,\n\n2.  coisotropic,\n\n3.  Lagrangian,\n\nif and only if the product @xmath is respectively\n\n1.  isotropic\n\n2.  coisotropic,\n\n3.  Lagrangian.\n\n##### Cotangent Bundle\n\nLet @xmath be a complex manifold or a smooth algebraic variety of\ndimension @xmath . Set @xmath to be the total space of the cotangent\nvector bundle @xmath and let @xmath be the projection map. If @xmath are\nlocal coordinates on @xmath , then @xmath form the local coordinates on\n@xmath . Then we can set:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand these glue to a well defined symplectic form @xmath . This\nsymplectic form is homogeneous of weight @xmath with respect to the\nusual @xmath -action on the cotangent spaces.\n\nSince for @xmath , @xmath we have @xmath this example of symplectic\nmanifold, generalises the standard symplectic structure on @xmath (see \u00a7\nD.1.5 ). The following example generalises Lemma D.5 :\n\n###### Example D.6.\n\nLet @xmath be any subvariety. Define @xmath to be the conormal variety\nto @xmath , i.e.\u00a0the closure of the union of conormal spaces to smooth\npoints of @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen @xmath is a Lagrangian subvariety in @xmath .\n\nProof. Let @xmath be a smooth point and let @xmath . Then one can choose\nappropriate local coordinates on @xmath around @xmath and an appropriate\nlocal trivialisation of the cotangent bundle @xmath , such that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis is a Lagrangian subspace by Lemma D.5 .\n\n@xmath\n\n###### Lemma D.7.\n\nConversely, assume @xmath is a smooth algebraic variety and @xmath is\nthe total space of @xmath . Moreover assume @xmath is an irreducible\nclosed Lagrangian subvariety invariant under the @xmath -action on\n@xmath . If @xmath , then @xmath .\n\nProof. Let @xmath be a general point and let @xmath . So @xmath is a\npoint in @xmath and\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath is @xmath -invariant, under the above identification\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe want to prove that @xmath and this will follow if we prove\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy Lemma B.2 the map @xmath is surjective, so\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath is Lagrangian, we also have the dual equality:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nHence @xmath as claimed and therefore @xmath . Since @xmath was a\ngeneral point of @xmath and both @xmath and @xmath were irreducible, we\nhave @xmath and by dimension counting @xmath .\n\n@xmath\n\n##### Adjoint and coadjoint orbits\n\nLet @xmath be a semisimple complex Lie group and consider the coadjoint\naction on the dual of its Lie algebra @xmath . Let @xmath be an orbit of\nthis action. The tangent space at @xmath is naturally isomorphic to\n@xmath , where\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHere @xmath denotes the Lie algebra operation in @xmath . For @xmath let\n@xmath and @xmath be the corresponding vector fields on @xmath\ndetermined by @xmath and @xmath . We define:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen @xmath is a symplectic form on @xmath , which is called the\nKostant-Kirillov form, see for instance [ Bea98 , (2.1)] .\n\nNow assume @xmath is simple and @xmath is invariant under homotheties\n(for instance @xmath is the unique minimal nonzero orbit \u2014 see [ Bea98 ,\nProp.\u00a02.2 and Prop.\u00a02.6] ). Then the actions of @xmath and @xmath\ncommute (because @xmath acts on @xmath by linear automorphisms, @xmath\nvia homotheties and every linear map commutes with a homothety).\nTherefore the vector fields of the form @xmath for some @xmath are\nhomogeneous of weight 0 and hence:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\ni.e. @xmath is homogeneous of weight @xmath .\n\nWe can identify @xmath and @xmath by Killing form (see [ Hum75 ] ), so\nequally well we can consider adjoint orbits. Therefore if @xmath is as\nabove, then it is isomorphic to a @xmath -bundle over an adjoint variety\n(see \u00a7 A.1.1 ). More precisely @xmath is a symplectisation (see \u00a7 E.3.1\n) of the adjoint variety.\n\n##### Open subsets\n\nLet @xmath be a symplectic manifold and let @xmath be an open subset.\nThen @xmath is again a symplectic manifold.\n\n### d.3 The Poisson bracket\n\nThe Poisson bracket is an important algebraic structure of a symplectic\nmanifold. In Corollary E.12 we observe that given a contact manifold and\nits symplectisation, the Poisson bracket descents from the\nsymplectisation to a bracket on a specific sheaf of rings on the contact\nmanifold. Moreover, this descended structure is strictly related to the\nautomorphisms of the contact manifold (see Theorem E.13 ).\n\nLet @xmath be a symplectic manifold and let @xmath be the sheaf of\nholomorphic (or algebraic) functions on @xmath . Given @xmath let @xmath\nbe the unique vector field such that @xmath . Then we set:\n\n  ------------------ -------- -------- -- --\n                     @xmath   @xmath      \n  or equivalently:                        \n                     @xmath   @xmath      \n  ------------------ -------- -------- -- --\n\nThe bilinear skew-symmetric map @xmath is called the Poisson bracket .\n\n###### Lemma D.8.\n\nThe Poisson bracket satisfies the Jacobi identity and therefore makes\n@xmath into a sheaf of Lie algebras. The compatibility between the\nPoisson bracket and the standard ring multiplication on @xmath is given\nby the following Leibniz rule:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nProof. See for example [ Arn74 , \u00a740] \u2014 the proof is identical to the\nreal case.\n\n@xmath\n\nThe Poisson bracket is determined by the symplectic form and moreover it\nis defined locally. Hence we have the following property:\n\n###### Proposition D.9.\n\nAssume @xmath and @xmath are two symplectic manifolds of dimension\n@xmath . Assume moreover, that we have a finite covering map:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nsuch that @xmath . Then the Poisson structures are compatible: for\n@xmath we have:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n@xmath\n\n###### Theorem D.10.\n\nAssume @xmath is a symplectic manifold.\n\n1.   Suppose @xmath is a coisotropic subvariety. Then the sheaf of\n    ideals @xmath is a subalgebra with respect to the Poisson bracket.\n\n2.   Conversely, suppose @xmath is a closed, generically reduced\n    subscheme and that @xmath is preserved by the Poisson bracket. Then\n    the corresponding variety @xmath is coisotropic.\n\nVersions of the theorem can be found in [ Cou95 , Prop.\u00a011.2.4] and in [\nBuc06 , Thm 4.2] . We follow more or less the proof from [ Buc06 ] :\n\nProof. Let @xmath be the locus of smooth points of @xmath . We must show\nthat @xmath if and only if @xmath is a Lie subalgebra sheaf in @xmath .\n\nSuppose that @xmath is any point, @xmath is an open neighbourhood of\n@xmath and that @xmath are some functions vanishing on @xmath . Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath , then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\ni.e. @xmath , so extending the equality to the closure of @xmath we get\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath is a Lie subalgebra.\n\nConversely, if @xmath is a Lie subalgebra, then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince the map\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis an epimorphism of vector spaces for each @xmath and for @xmath\nsufficiently small, we have @xmath .\n\n@xmath\n\n#### d.3.1 Properties of Poisson bracket\n\nIn our considerations on contact manifolds and their various\nsubvarieties we will need the three lemmas that are explained in this\nsubsection. These lemmas refer to Proposition D.10 \u2014 we have seen that\nthere is a relation between coisotropic varieties and Lie subalgebras of\n@xmath that are ideals under the standard ring multiplication.\n\nThe first lemma claims that to test if an ideal is a subalgebra it is\nenough to test it on an appropriate open cover of @xmath .\n\n###### Lemma D.11.\n\nLet @xmath be a symplectic manifold and let @xmath be a coherent sheaf\nof ideals. In such a case @xmath is preserved by the Poisson bracket if\nand only if there exists an open cover @xmath of @xmath such that for\neach @xmath :\n\n-    if @xmath is another open subset, then the functions in @xmath are\n    determined by the functions in @xmath \u2014 this means that if @xmath is\n    algebraic variety (respectively, analytic space), then the elements\n    of @xmath can all be written as quotients (respectively, Taylor\n    series) of elements of @xmath ; such property holds for instance if\n    @xmath is affine or if @xmath is biholomorphic to a disk @xmath or\n    it is biholomorphic to @xmath ;\n\n-    and the ideal @xmath is preserved by the Poisson bracket.\n\nProof. One implication is obvious, while the other follows from the\nLeibniz rule (see Lemma D.8 ) and from elementary properties of coherent\nsheaves.\n\n@xmath\n\nThe second lemma asserts that for an isotropic subvariety @xmath , only\nfunctions constant on @xmath can preserve @xmath by Poisson\nmultiplication.\n\n###### Lemma D.12.\n\nAssume @xmath is a symplectic manifold, @xmath is a closed irreducible\nisotropic subvariety. Let @xmath be any function such that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen @xmath is constant on @xmath .\n\nProof. Choose an arbitrary @xmath , a small enough open neighbourhood\n@xmath of @xmath , and take any @xmath .\n\nSince @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand since @xmath can be taken so small that @xmath span the conormal\nspace we have:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath vanishes on @xmath and hence @xmath is constant on @xmath .\n\n@xmath\n\nFinally the third lemma states that for isotropic @xmath , very few\nsubvarieties @xmath can have the property that @xmath .\n\n###### Lemma D.13.\n\nAssume @xmath is a symplectic manifold, @xmath is a closed irreducible\nisotropic subvariety and @xmath is a closed subvariety. If @xmath , then\neither @xmath is contained in the singular locus of @xmath or @xmath is\nLagrangian and @xmath .\n\nProof. The proof goes along the lines of the proof of [ Buc06 , Thm\u00a05.8]\n. Suppose @xmath is not contained in the singular locus of @xmath , so\nthat a general point @xmath is a smooth point of both @xmath and @xmath\n. Let @xmath be an open neighbourhood of @xmath . Then for all @xmath\nand @xmath\n\n  -- -------- -- --------\n     @xmath      (D.14)\n  -- -------- -- --------\n\nso\n\n  -- -------- -------- -- --\n     @xmath   @xmath      \n              @xmath      \n              @xmath      \n              @xmath      \n  -- -------- -------- -- --\n\nTherefore we have all inclusions becoming equalities and in particular\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand hence @xmath . Moreover @xmath , where @xmath is a general point of\n@xmath , so @xmath is Lagrangian.\n\n@xmath\n\n#### d.3.2 Homogeneous symplectic form\n\n###### Lemma D.15.\n\nAssume @xmath is a symplectic manifold with a @xmath -action and that\n@xmath is homogeneous. Let @xmath be a @xmath -invariant open subset and\nlet @xmath be some homogeneous functions. Then @xmath is homogeneous of\nweight @xmath .\n\nProof. Let @xmath be such a vector field, that @xmath . By Lemma B.1 (i)\nwe have @xmath and since @xmath , the claim follows from Lemma B.1 (i)\nand (iii) .\n\n@xmath\n\n#### d.3.3 Example: Veronese map of degree 2\n\nThe following example is important for our considerations, as it proves\nthat for the contact manifold @xmath , we can equally well consider the\nPoisson structure on @xmath (as we do in [ Buc03 ] and [ Buc06 ] ) and\nthe Poisson structure on @xmath (as naturally will arise from the point\nof view of contact manifolds \u2014 see \u00a7 E.3.1 ). Also this example will be\nused to illustrate that every contact structure on @xmath comes from a\nsymplectic structure on @xmath . Moreover @xmath defined below is the\nminimal adjoint orbit (see \u00a7 D.2.2 ) for the simple group @xmath . This\nsimple Lie group and its minimal adjoint orbit have quite exceptional\nbehaviour (see Table A.1 ) and thus we find it worth to explain this\nexample in more detail.\n\nLet @xmath be a symplectic vector space. We let\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nbe the coordinate ring of @xmath . Also consider\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand let @xmath . Then we have the following @xmath covering map:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhich is the restriction of the map induced by @xmath . This is the\nunderlying map of the second Veronese embedding of @xmath . In the\nlanguage of \u00a7 C.3 , we have @xmath and @xmath .\n\nThe symplectic form @xmath is @xmath invariant:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nhence it descents to a symplectic form @xmath on @xmath , making @xmath\na symplectic manifold, such that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe natural gradings on @xmath and on @xmath induce the actions of\n@xmath on @xmath and on @xmath (note that the action on @xmath is not\nfaithful, its kernel is @xmath ) and @xmath is equivariant with respect\nto these actions.\n\n###### Corollary D.16.\n\nWith the setup as above, the form @xmath is homogeneous of weight @xmath\nwith respect to the @xmath -action described above, so it is of weight\n@xmath with respect to the faithful action of @xmath . Conversely, if\n@xmath is a homogeneous symplectic form on @xmath of weight @xmath ,\nthen @xmath is a constant symplectic form on @xmath .\n\nProof. This follows from Lemma B.1 (ii) and the characterisation of\nconstant forms on an affine space in \u00a7 B.6 .\n\n@xmath\n\n###### Corollary D.17.\n\nThe Poisson bracket on @xmath induced by @xmath is the restriction of\nthe Poisson bracket on @xmath induced by @xmath .\n\nProof. This follows immediately from Proposition D.9 .\n\n@xmath\n\n## Chapter E Contact geometry\n\nA projective space seems to be the most standard example of a projective\nvariety. Yet, as a contact manifold, the projective space of odd\ndimension is the most exceptional among exceptional examples. As a\nconsequence, the study of its Legendrian subvarieties is quite\ncomplicated and very interesting. We start our considerations by\nintroducing this case. Further we generalise to the other contact\nmanifolds.\n\n### e.1 Projective space as a contact manifold\n\nLet @xmath be a symplectic vector space and let @xmath be its naive\nprojectivisation. Then for every @xmath the tangent space @xmath is\nnaturally isomorphic to the quotient @xmath . Let @xmath be a corank 1\nvector subbundle defined fibrewise:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nAlso let @xmath be the quotient line bundle, so that we have the\nfollowing short exact sequence:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe say that @xmath (respectively @xmath ) is the contact distribution\n(respectively the contact form ) associated with the symplectic form\n@xmath .\n\nBy \u00a7 D.1.3 the vector space @xmath carries a natural symplectic\nstructure @xmath . By Proposition C.1 (i) @xmath gives a well defined\ntwisted 2-form on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proposition E.1.\n\nWith an appropriate choice of local trivialisation of @xmath , for every\n@xmath one has @xmath . In particular @xmath is nowhere degenerate and\nit determines an isomorphism:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nMoreover @xmath .\n\nProof. See also [ LeB95 , Ex.\u00a02.1] .\n\nLet @xmath be some symplectic coordinates on @xmath . Then the @xmath\n-perpendicular space to @xmath is given by the equation\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe look for a twisted @xmath -form @xmath on @xmath whose kernel at each\npoint is exactly as above. This is for instance satisfied by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe ambiguity is only in the choice of the scalar coefficient \u2014 we\nchoose @xmath in order to acquire the right formula for @xmath . Choose\nan affine piece @xmath , say where @xmath . On @xmath we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand then:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nOn the other hand, fixing @xmath , @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTherefore @xmath is the image under the projection @xmath of:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTo see that @xmath take a section of @xmath , for instance @xmath . Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a section of @xmath and hence @xmath .\n\n@xmath\n\n### e.2 Legendrian subvarieties of projective space\n\nAssume @xmath is a symplectic vector space of dimension @xmath .\n\nThe author in his previous articles [ Buc03 ] , [ Buc06 ] , [ Buc07 ] ,\n[ Buc09 ] and [ Buc08b ] found convenient to use the following\ndefinition:\n\n###### Definition.\n\nWe say that a subvariety @xmath is Legendrian if the affine cone @xmath\nis a Lagrangian subvariety (see \u00a7 D.2.1 ).\n\nYet the original definition is formulated in a slightly different, but\nequivalent manner:\n\n###### Proposition E.2.\n\nLet @xmath be a subvariety. The following conditions are equivalent:\n\n-   @xmath is Legendrian;\n\n-   @xmath is @xmath -integrable and it is of pure dimension @xmath .;\n\nProof. If @xmath is @xmath -integrable, then @xmath is Legendrian by\nPropositions E.1 and C.1 (iv) . The other implication is follows from\ndefinition of @xmath .\n\n@xmath\n\n#### e.2.1 Decomposable and degenerate Legendrian subvarieties\n\n###### Definition.\n\nLet @xmath and @xmath be two symplectic vector spaces and let @xmath and\n@xmath be two Legendrian subvarieties. Now assume @xmath and @xmath ,\ni.e. @xmath is the join of @xmath and @xmath meaning the union of all\nlines from @xmath to @xmath . Now, clearly, the affine cone @xmath is\nthe product @xmath (where @xmath is the affine cone of @xmath ), so by \u00a7\nD.2.2 @xmath is Legendrian. In such a situation we say that @xmath is a\ndecomposable Legendrian subvariety . We say that a Legendrian subvariety\nin @xmath is indecomposable , if it is not of that form for any\nnon-trivial symplectic decomposition @xmath .\n\nThe indecomposable Legendrian subvarieties have more consistent\ndescription of their projective automorphisms group (see Chapter F ). On\nthe other hand, decomposable Legendrian varieties (which usually\nthemselves are badly singular) will be used to provide some very\ninteresting families of examples of smooth Legendrian varieties (see\nChapter I ).\n\nWe say a subvariety of projective space is degenerate if it is contained\nin some hyperplane. Otherwise, we say it is non-degenerate . The\nfollowing easy proposition in some versions is well known. The presented\nversion comes from [ Buc06 , Thm\u00a03.4] but see also [ LM07 , Prop.\u00a017\n(1)] or [ Buc03 , Tw.\u00a03.16] .\n\n###### Proposition E.3.\n\nLet @xmath be a Legendrian subvariety. Then the following conditions are\nequivalent:\n\n-   @xmath is degenerate.\n\n-    There exists a symplectic linear subspace @xmath of codimension 2,\n    such that @xmath is a Legendrian subvariety in @xmath and @xmath is\n    a cone over @xmath .\n\n-   @xmath is a cone over some variety @xmath .\n\nIn particular degenerate Legendrian subvarieties are decomposable.\n\n@xmath\n\n### e.3 Contact manifolds\n\n###### Definition.\n\nLet @xmath be a complex manifold or smooth algebraic variety and fix a\nshort exact sequence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is a corank @xmath subbundle of the tangent bundle. We say\nthat @xmath is a contact manifold if the twisted 2-form\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n(see Proposition C.1 (i) ) is nowhere degenerate, so that @xmath is a\nsymplectic form on @xmath for every @xmath . In such a case @xmath is\ncalled the contact distribution on @xmath and @xmath is the contact form\non @xmath .\n\n###### Example E.4.\n\nBy Proposition E.1 , the projective space with the contact distribution\nassociated with a symplectic form is a contact manifold.\n\nThe following properties are standard, well known (see for instance [\nBea98 ] ):\n\n###### Proposition E.5.\n\nWe have the following properties of contact manifold @xmath :\n\n1.   The dimension of @xmath is odd.\n\n2.   Let @xmath be an open subset, let @xmath be any section and let\n    @xmath be a map of sheaves:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    Then @xmath is a map of @xmath -modules and the assignment @xmath is\n    an isomorphism of @xmath -modules:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n3.   The canonical divisor @xmath is isomorphic to @xmath . In\n    particular @xmath is a Fano variety if and only if @xmath is ample.\n\nProof. We only prove (ii) , the other parts follow easily. Map @xmath is\na map of @xmath -modules by Proposition C.1 (iii) . By Propsition C.1\n(ii) we have equality:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath is non-degenerate, it follows that @xmath is indeed an\nisomorphism.\n\n@xmath\n\n#### e.3.1 Symplectisation\n\nThe following construction is standard \u2014 see for instance [ Arn74 ] , [\nKPSW00 ] , [ Bea98 ] .\n\nLet @xmath be the principal @xmath -bundle as in \u00a7 C.3 . In \u00a7 C.4 and \u00a7\nC.5 we studied in details the properties of @xmath and an extension of\nthe twisted form @xmath to @xmath . We have an equivalence between\ncontact structures on @xmath and symplectic homogeneous weight 1\nstructures on @xmath :\n\n###### Theorem E.6.\n\nLet @xmath be a complex manifold or smooth algebraic variety with a line\nbundle @xmath and the principal @xmath -bundle @xmath as in \u00a7 C.3 .\n\n-    If @xmath is a contact form, then @xmath (see \u00a7 C.5 ) is a\n    homogeneous symplectic form on @xmath of weight 1.\n\n-    Conversely, assume @xmath is a symplectic form on @xmath , which is\n    homogeneous of weight 1. Then there exists a unique contact form\n    @xmath on @xmath , such that @xmath .\n\nProof. See Proposition C.16 .\n\n@xmath\n\nIf @xmath is a contact manifold, then the symplectic manifold @xmath\nfrom the theorem is called the symplectisation of @xmath .\n\nUsing the theorem and \u00a7 D.2.2 we have following examples of contact\nmanifolds:\n\n###### Example E.7.\n\nLet @xmath be a simple group and let @xmath be the closed orbit in\n@xmath . Then @xmath is a contact manifold (compare with Conjecture A.2\n).\n\n###### Example E.8.\n\nIf @xmath , then let @xmath and hence @xmath , where @xmath is the zero\nsection and @xmath is a contact manifold.\n\n###### Example E.9.\n\nIf @xmath is a contact Fano manifold, then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nwhere @xmath is the point corresponding to the maximal ideal @xmath (see\n[ Gro61 , \u00a72.3] ).\n\n###### Example E.10.\n\nIf @xmath , then by Proposition E.5 (iii) we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTherefore @xmath is a @xmath to @xmath unramified cover of @xmath , see\n\u00a7 D.3.3 . In particular, from Theorem E.6 and Corollary D.16 we conclude\nthat every contact structure on @xmath is associated to some constant\nsymplectic form @xmath on @xmath (see \u00a7 E.1 ).\n\nRecall Theorem A.1 that every contact projective manifold @xmath is\neither isomorphic to @xmath or it is Fano with @xmath . In the second\ncase by Proposition E.5 (iii) and the Kobayashi-Ochiai characterisation\nof projective space [ KO73 ] either @xmath or @xmath .\n\n#### e.3.2 Contact automorphisms\n\nAutomorphisms of contact manifolds preserving the contact structure were\nalso studied by LeBrun [ LeB95 ] and Beauville [ Bea98 ] . We use their\nmethods to state slightly more general results about infinitesimal\nautomorphisms. In the end we globalise the automorphisms for projective\ncontact manifolds.\n\nLet @xmath be a contact manifold and let @xmath be the symplectisation\nas in \u00a7 E.3.1 . Also let @xmath be as in \u00a7 C.3 .\n\n###### Example E.11.\n\nIf @xmath is a contact Fano manifold, then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath (see Example E.9 ), all the structure of @xmath as well as\nits global and local behaviour is determined by this ring of global\nsections. Hence in this case whatever is stated below for the sheaf\n@xmath can be deduced from the analogous statement about @xmath only.\n\n###### Corollary E.12.\n\n1.   Let @xmath be two functions on @xmath homogeneous with respect to\n    the action of @xmath . Then @xmath is also homogeneous and @xmath\n\n2.   The Poisson bracket descends to @xmath and determines a bilinear\n    map:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\nProof. This follows from Corollary D.15 . See also [ LeB95 , Rem.\u00a02.3] .\n\n@xmath\n\nWe will refer to the Lie algebra structure on @xmath defined above also\nas Poisson structure and denote the bracket by @xmath . For @xmath let\n@xmath be the corresponding element in @xmath .\n\nBy Corollary E.12 the invertible sheaf @xmath has a Lie algebra\nstructure and it is crucial for our considerations, that it is\nisomorphic to the sheaf @xmath of infinitesimal automorphisms of @xmath\npreserving @xmath (see \u00a7 C.4 for more details):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Theorem E.13.\n\nLet @xmath be a contact manifold, @xmath be the contact distribution,\n@xmath be the contact form and let @xmath be an open subset. Using the\nnotation of \u00a7 C.2 and \u00a7 C.4 we have:\n\n1.  @xmath as sheaves of Abelian groups.\n\n2.   The map of sheaves @xmath maps isomorphically the Lie algebra\n    structure of @xmath onto the Lie algebra structure of @xmath given\n    by the Poisson bracket.\n\n3.   The following two Lie algebra representations of @xmath on @xmath\n    are equal:\n\n    -    The induced representation of @xmath on @xmath (see \u00a7 C.4 ).\n\n    -    The representation induced by the adjoint representation:\n\n          -- -------- --\n             @xmath   \n          -- -------- --\n\nProof. The following proof of (1) is taken from [ Bea98 , Prop.\u00a01.1] ,\nbut see also [ LeB95 , Prop.\u00a02.1] .\n\nTo prove (1) , take any @xmath and consider the map of sheaves:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy Proposition C.1 (iii) the above map is a map of @xmath -modules,\nhence it is an element of @xmath . Let @xmath be the corresponding\nelement of @xmath (see Proposition E.5 (ii) ). By the definition of the\nisomorphism @xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor every @xmath , hence @xmath . Therefore @xmath , so\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\ngives the required splitting.\n\nFor (2) see also [ Bea98 , Prop.\u00a01.6] and [ LeB95 , Rem.\u00a02.3] . By (1) ,\nthe map @xmath is an isomorphism of sheaves of Abelian groups. So it is\nenough to prove that @xmath preserves the Lie algebra structures. For\nevery @xmath denote by @xmath and @xmath the induced infinitesimal\nautomorphisms of @xmath (see \u00a7 C.4 ). We have:\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n     @xmath   @xmath            \n     @xmath   @xmath            \n     @xmath   @xmath   @xmath   \n  -- -------- -------- -------- --\n\nHence @xmath preserves the Lie algebra structures.\n\nPart (3) is local and since both representations satisfy the Leibniz\nrule (see Equation\u00a0( C.12 ) and Lemma D.8 ), it is enough to check the\nequality for multiplicative generators of @xmath . Locally, these might\nbe taken for instance as sections of @xmath and so (3) follows from (2)\n.\n\n@xmath\n\nWe underline, that @xmath , as a subsheaf of @xmath is not a @xmath\n-submodule (see \u00a7 C.4 ). So in particular the obtained splitting of the\nshort exact sequence of sheaves of Abelian groups\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis not a splitting of vector bundles.\n\nTurning to global situation assume @xmath is projective and let @xmath ,\n@xmath and @xmath , @xmath denote, respectively, the group of\nautomorphisms of @xmath , the group of automorphisms of @xmath\npreserving the contact structure and their Lie algebras.\n\nLeBrun [ LeB95 ] and Kebekus [ Keb01 ] observed that in the case of\nprojective contact Fano manifolds with Picard group generated by @xmath\n, the global sections of @xmath are isomorphic to @xmath :\n\n###### Corollary E.14.\n\nLet @xmath be a projective contact manifold with contact distribution\n@xmath .\n\n1.   Then @xmath maps isomorphically @xmath onto @xmath .\n\n2.   If moreover @xmath is Fano with @xmath , then @xmath and hence the\n    Lie algebra @xmath is naturally isomorphic to @xmath .\n\nProof. By Corollary C.8 we have @xmath , so (i) follows from Theorem\nE.13 (2) .\n\nOn the other hand (ii) follows from [ Keb01 , Cor.\u00a04.5] .\n\n@xmath\n\n### e.4 Legendrian subvarieties in contact manifold\n\n###### Definition.\n\nLet @xmath be a complex contact manifold with a contact distribution\n@xmath . A subvariety @xmath is Legendrian if @xmath is @xmath\n-integrable (i.e., @xmath ) and @xmath (i.e., @xmath has maximal\npossible dimension).\n\nIf @xmath , then the above definition agrees with the definition in \u00a7\nE.2 by Proposition E.2 . In general, we have analogous properties with\n@xmath replaced by @xmath :\n\n###### Proposition E.15.\n\nLet @xmath be a contact manifold with a contact distribution @xmath and\nwith its symplectisation @xmath . Assume @xmath is a subvariety. Then:\n\n1.  @xmath is @xmath -integrable if and only if @xmath is isotropic.\n\n2.  @xmath is Legendrian if and only if @xmath is Lagrangian.\n\nProof. Part (a) follows from Lemma C.17 and Part (b) follows from (a) .\n\n@xmath\n\nIn the case of subvarieties of a symplectic manifold, we have three\nimportant types of subvarieties (isotropic, Legendrian and coisotropic).\nAlso for subvarieties of contact manifold in addition to @xmath\n-integrable and Legendrian subvarieties, it is useful to consider the\nsubvarieties corresponding to the coisotropic case:\n\n###### Definition.\n\nIn the setup of Proposition E.15 , we say that @xmath is @xmath\n-cointegrable if @xmath is coisotropic.\n\n###### Example E.16.\n\nAssume @xmath is irreducible and Lagrangian and let @xmath be the\nclosure of @xmath . Then @xmath is @xmath -cointegrable. If moreover\n@xmath is not @xmath -invariant, then @xmath .\n\n###### Corollary E.17.\n\nIf @xmath for some smooth algebraic variety @xmath and @xmath is an\nalgebraic Legendrian subvariety, then @xmath is the conormal variety\n@xmath to some algebraic subvariety @xmath .\n\nProof. It follows from Proposition E.15 , Example E.8 and Lemma D.7 .\n\n@xmath\n\nLet @xmath be the sheaf of rings on @xmath defined in \u00a7 C.3 . For a\nsubvariety @xmath , let @xmath be the sheaf of ideals generated by those\nlocal sections of @xmath that vanish on @xmath . Then:\n\n  -- -------- -- --------\n     @xmath      (E.18)\n  -- -------- -- --------\n\nwhere @xmath is the ideal sheaf of @xmath . In this context, the meaning\nof Lemma D.11 is the following:\n\n###### Lemma E.19.\n\nWith the notation as above, let @xmath be a coherent sheaf of ideals.\nThen @xmath is preserved by the Poisson bracket on @xmath if and only if\n@xmath is preserved by the Poisson bracket on @xmath .\n\n@xmath\n\nHence we get the description of @xmath -cointegrable subvarieties in\nterms of the Poisson bracket on @xmath :\n\n###### Proposition E.20.\n\nWith the assumptions as above, a subvariety @xmath is @xmath\n-cointegrable if and only if @xmath is preserved by the Poisson bracket\non @xmath .\n\nProof. The proposition combines Equation\u00a0( E.18 ), Theorem D.10 together\nwith Lemma E.19 .\n\n@xmath\n\nGiven a subvariety @xmath , we define @xmath to be the sheaf of Lie\nalgebras of those infinitesimal automorphisms of @xmath , which preserve\n@xmath and contact distribution @xmath (see also \u00a7 C.4 ):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFurther, let @xmath be the degree @xmath part of the sheaf of\nhomogeneous ideals @xmath . Since @xmath is a line bundle with the\naction of @xmath (see \u00a7 C.4 ), choosing a local trivialisation and using\nthe gluing property of sheaves we can replace @xmath in the definition\nof @xmath with @xmath :\n\n  -- -- -- --------\n           (E.21)\n  -- -- -- --------\n\nwhere @xmath denotes the induced action of @xmath on @xmath described in\n\u00a7 C.4 .\n\nThe following theorem establishes a connection between the infinitesimal\nautomorphisms of a Legendrian variety and its ideal:\n\n###### Theorem E.22.\n\nLet @xmath be a contact manifold with a contact distribution @xmath and\nlet @xmath be the quotient map. Also let @xmath be an open subset.\nAssume @xmath is an irreducible subvariety.\n\n1.   If @xmath is @xmath -integrable, then @xmath .\n\n2.   If @xmath is @xmath -cointegrable, then @xmath .\n\n3.   If @xmath is Legendrian, then @xmath .\n\nProof. In the case of A , choose arbitrary @xmath . We must prove that\n@xmath or, equivalently, that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n(recall that for a section @xmath by @xmath we denote the corresponding\nelement in @xmath ).\n\nBy Equation\u00a0( E.21 ) the action of @xmath preserves @xmath and hence\nalso it preserves @xmath . By Theorem E.13 (3) this means that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nMoreover @xmath is isotropic by Proposition E.15 .\n\nBy Lemma D.12 function @xmath is constant on @xmath . But @xmath is also\na @xmath -homogeneous function of weight 1, so it must vanish on @xmath\n. Therefore @xmath as claimed.\n\nTo prove B let @xmath be an infinitesimal automorphism such that @xmath\n. By Proposition E.20\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nso by Theorem E.13 (3) we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n(where @xmath denotes the induced representation of @xmath on @xmath ,\nsee \u00a7 C.4 ). Hence by Equation\u00a0( E.21 ) the infinitesimal automorphism\n@xmath is contained in @xmath and @xmath as claimed.\n\nPart C is an immediate consequence of A and B .\n\n@xmath\n\nThe following corollary says that in the case when @xmath is projective\nalso the global automorphisms of a Legendrian subvariety can be\nunderstood in terms of the ideal of the variety. In particular, in (i)\nbelow, we generalise Theorem A.9 .\n\n###### Corollary E.23.\n\nLet @xmath be a projective contact manifold, let @xmath be the contact\ndistribution and let @xmath be a Legendrian subvariety. Let @xmath\n(resp. @xmath ) be the Lie algebra of group of automorphisms of @xmath\npreserving @xmath (resp.\u00a0preserving @xmath and @xmath ). Then:\n\n1.  @xmath ;\n\n2.   If in addition @xmath , then @xmath .\n\nProof. It follows from Corollary E.14 and Theorem E.22 C .\n\n@xmath\n\nIn Chapter F we discuss the extension of Corollary E.23 (ii) to @xmath .\n\nThe following corollary generalises [ Buc06 , Thm 5.8] :\n\n###### Corollary E.24.\n\nIf @xmath is a projective contact manifold and @xmath is an irreducible\nLegendrian subvariety such that @xmath is generated by @xmath , then\n@xmath acts transitively on the smooth locus of @xmath . In particular,\nif @xmath is in addition smooth, then @xmath is a homogeneous space.\n\nProof. If @xmath is a closed subvariety invariant under the action of\n@xmath , then by Theorem E.13 (3) and by Corollary E.23 (i) :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence by the Leibniz rule and since @xmath is generated by @xmath , we\nhave:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo by Lemma D.13 , variety @xmath is contained in the singular locus of\n@xmath .\n\nNow let @xmath be an orbit of a smooth point under the action of @xmath\n. Then the closure @xmath is not contained in the singular locus so by\nabove it must be equal to all of @xmath . Moreover @xmath is a closed\nsubset invariant under the action and not equal to @xmath , so it is\ncontained in the singular locus. So @xmath is the whole smooth locus of\n@xmath .\n\n@xmath\n\nWe conclude this chapter by underlining that, unfortunately, the above\nresults are proved only for automorphisms of @xmath , that preserve\nLegendrian subvariety @xmath , not simply for automorphisms of @xmath .\n\n## Chapter F Projective automorphisms of a Legendrian variety\n\nThe content of this chapter is published in [ Buc07 ] .\n\nWe are interested in the following conjecture:\n\n###### Conjecture F.1.\n\nLet @xmath be an irreducible indecomposable Legendrian subvariety and\nlet @xmath be a connected subgroup of linear automorphisms preserving\n@xmath . Then @xmath is contained in the image of the natural map @xmath\n.\n\nIt is quite natural to believe, that if a linear map preserves a form on\na big number of linear subspaces, then it actually preserves the form\n(at least up to scalar). With this approach, Janeczko and Jelonek proved\nthe conjecture in the case where the image of @xmath under the Gauss map\nis non-degenerate in the Grassmannian of Lagrangian subspaces in @xmath\n\u2014 see [ JJ04 , Cor.\u00a06.4] . Unfortunately, this is not enough - for\nexample @xmath has a degenerate image under the Gauss map and this is\none of the simplest examples of smooth Legendrian subvarieties.\n\nIn \u00a7 F.2 we prove Theorem A.11 , i.e.\u00a0that the conjecture holds for\nsmooth @xmath . This theorem, combined with Corollary E.23 gives us a\ngood understanding of the group of projective automorphisms of a smooth\nLegendrian subvariety in @xmath .\n\n### f.1 Discussion of assumptions\n\nOne obvious remark is that homotheties act trivially on @xmath , but in\ngeneral are not symplectic on @xmath . Therefore, it is more convenient\nto think of conformal symplectomorphisms (see \u00a7 D.1.4 ).\n\nIt is clear, that if we hope for a positive answer to the question\nwhether a projective automorphism of a Legendrian subvariety necessarily\npreserves the contact structure, then we must assume that our Legendrian\nvariety is non-degenerate.\n\nAnother natural assumption is that @xmath is irreducible \u2014 one can also\neasily produce a counterexample if we skip this assumption. Yet still\nthis is not enough.\n\nLet @xmath be a decomposable Legendrian variety. Then we can act via\n@xmath on @xmath and via @xmath on @xmath - such an action will preserve\n@xmath and in general it is not conformal symplectic. This explains why\nthe assumptions of our conjecture F.1 are necessary.\n\n### f.2 Preservation of contact structure\n\nLet @xmath be an irreducible, indecomposable Legendrian subvariety, let\n@xmath be the affine cone over @xmath and @xmath be the smooth locus of\n@xmath . Assume that @xmath is the maximal connected subgroup in @xmath\npreserving @xmath . Let @xmath be the Lie algebra tangent to @xmath . To\nprove the conjecture it would be enough to show that @xmath is contained\nin the Lie algebra @xmath tangent to conformal symplectomorphisms,\ni.e.\u00a0the Lie algebra spanned by @xmath and the identity matrix @xmath .\n\nRecall from \u00a7 D.1.4 the notion of weks-symplectic matrices.\n\n###### Theorem F.2.\n\nWith the above notation the following properties hold:\n\n-    The underlying vector space of @xmath decomposes into symplectic\n    and weks-symplectic part:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n-    If @xmath , then @xmath preserves every tangent space to @xmath :\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    and hence also\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n-    If @xmath is semisimple, then @xmath for some @xmath .\n\n-    Assume @xmath is nilpotent and let @xmath be an integer such that\n    @xmath and @xmath . Then @xmath is always non-zero and is contained\n    in the singular locus of @xmath . In particular, @xmath is singular.\n\nIn what follows we prove the four parts of Theorem F.2 .\n\n##### I.\u00a0Decomposition into symplectic and weks-symplectic part\n\nProof. Take @xmath to be an arbitrary element. Then for every @xmath one\nhas\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand therefore\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence the quadratic polynomial @xmath is identically zero on @xmath and\nhence it is in the ideal of @xmath . Therefore by maximality of @xmath\nand Theorem A.9 the map @xmath is also in @xmath . However,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nso @xmath and both symplectic and weks-symplectic components @xmath and\n@xmath are in @xmath .\n\n@xmath\n\nFrom the point of view of the conjecture, the symplectic part is fine.\nWe would only need to prove that @xmath . So from now on we assume\n@xmath .\n\n##### II.\u00a0Action on tangent space\n\nProof. Let @xmath for @xmath . Then @xmath and hence it acts on @xmath .\nChoose a point @xmath and two tangent vectors in the same tangent space\n@xmath . Then clearly also @xmath and @xmath are contained in one\ntangent space, namely @xmath . Hence:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nIn particular the part of the expression linear in @xmath vanishes,\nhence @xmath . Combining this with Equation\u00a0( D.2 ) we get that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHowever, this implies that @xmath . Therefore @xmath preserves the\ntangent space at every smooth point of @xmath and hence also @xmath\npreserves that space.\n\n@xmath\n\n##### III.\u00a0Semisimple part\n\nSince @xmath is an algebraic subgroup in @xmath , hence @xmath has the\nnatural Jordan decomposition inherited from @xmath , i.e.\u00a0if we write\nthe Jordan decomposition for @xmath , then @xmath (see [ Hum75 ,\nThm\u00a015.3(b)] ). Therefore by Proposition D.4 (i), proving that for\n@xmath we have @xmath and @xmath would be enough to establish the\nconjecture.\n\nHere we deal with the semisimple part.\n\nProof. Argue by contradiction. Let @xmath be an arbitrary eigenspace of\n@xmath and let @xmath be the sum of the other eigenspaces. If @xmath ,\nthen both @xmath and @xmath are non-zero and by Proposition D.4 (ii) and\n(iii) they are @xmath -perpendicular, complementary symplectic subspaces\nof @xmath . Let @xmath be any point. Since @xmath preserves @xmath by\npart II it follows that @xmath . But then both @xmath are Lagrangian\nsubspaces, hence have constant (independent of @xmath ) dimensions.\nHence @xmath is a sum of two vector bundles and from Proposition B.3 we\nget that @xmath is a product of two Lagrangian subvarieties,\ncontradicting our assumption that @xmath is indecomposable.\n\n@xmath\n\n##### IV.\u00a0Nilpotent part \u2014 @xmath is singular\n\n###### Lemma F.3.\n\nAssume @xmath is any closed subvariety preserved by the action of @xmath\nfor some nilpotent endomorphism @xmath . If @xmath is a point of the\naffine cone over @xmath and @xmath is an integer such that @xmath and\n@xmath , then @xmath is in @xmath .\n\nProof. Point @xmath is just the limit of @xmath as @xmath goes to @xmath\n.\n\n@xmath\n\n###### Lemma F.4.\n\nAssume @xmath is nilpotent and @xmath , @xmath for an integer @xmath .\nLet @xmath be an affine cone over some irreducible projective subvariety\nin @xmath , which is preserved by the action of @xmath , but is not\ncontained in the set of the fixed points. Assume that this action\npreserves the tangent space @xmath at every smooth point @xmath of\n@xmath . If there exists a non-zero vector in @xmath which is a smooth\npoint of @xmath contained in @xmath , then @xmath is a linear subspace.\n\nProof. Step\u00a00 - notation. We let @xmath to be the closure of @xmath , so\nin particular @xmath is irreducible. By Lemma F.3 , we know that @xmath\n. Let @xmath be a general point of @xmath . Then by our assumptions\n@xmath is a smooth point of both @xmath and @xmath .\n\nNext denote by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nYou can think of @xmath as union of those lines in @xmath (or points in\nthe projective space @xmath ), which under the action of @xmath converge\nto the line spanned by @xmath (or @xmath ) \u00b9 \u00b9 1 This statement is not\nperfectly precise, though it is true on an open dense subset. There are\nsome other lines, which converge to @xmath , namely those generated by\n@xmath , but @xmath for some @xmath . We are not interested in those\npoints. as @xmath goes to @xmath . We also note that the closure @xmath\nis a linear subspace spanned by an arbitrary element @xmath and @xmath .\n\nAlso we let @xmath , so that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFinally, @xmath from now on will always denote an arbitrary point of\n@xmath .\n\nStep\u00a01 - tangent space to @xmath at points of @xmath . Since @xmath is a\nsmooth point of @xmath also @xmath consists of smooth points of @xmath .\nThis is because the set of singular points is closed and @xmath\ninvariant. By our assumptions @xmath preserves every tangent space to\n@xmath and thus for every @xmath we have:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo the tangent space to @xmath is constant over the @xmath and in\nparticular @xmath .\n\nStep\u00a02 - dimensions of @xmath and @xmath . From the definitions of\n@xmath and @xmath and by Step\u00a01 we get that for any point @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath .\n\nSince @xmath was a general point of @xmath , we have that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath .\n\nStep\u00a03 - the closure of @xmath is a linear subspace. From the definition\nof @xmath and Step\u00a01 we know that @xmath and\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath , so the closure of @xmath is exactly @xmath and clearly\nthis closure is contained in @xmath . In particular @xmath .\n\nStep\u00a04 - @xmath is contained in @xmath . Let @xmath be @xmath . By\nStep\u00a03 we know that @xmath . Now we calculate the local dimension of\n@xmath at @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince the first and the last entries are identical, we must have all\nequalities. In particular the local dimension of @xmath at @xmath is\nequal to the dimension of the tangent space to @xmath at @xmath . So\n@xmath is a smooth point of @xmath and therefore there is a unique\ncomponent of @xmath passing through @xmath , namely the linear space\n@xmath . Since @xmath is contained in @xmath (because @xmath ) and\n@xmath , we must have @xmath .\n\nStep\u00a05 - vary @xmath . Recall, that by Step\u00a01 the tangent space to\n@xmath is the same all over @xmath . So also it is the same on every\nsmooth point of @xmath , which falls into the closure of @xmath . But by\nStep\u00a04, @xmath is a subset of @xmath , which is in the closure of @xmath\nby Step\u00a03. So the tangent space to @xmath is the same for an open subset\nof points in @xmath . Now apply again Step\u00a01 for different @xmath \u2019s in\nthis open subset and we get that @xmath has constant tangent space on a\ndense open subset of @xmath . This is possible if and only if @xmath is\na linear subspace, which completes the proof of the lemma.\n\n@xmath\n\nNow part IV of the theorem follows easily:\n\nProof. By the assumptions of the theorem @xmath is not contained in any\nhyperplane, so in particular @xmath is not contained in @xmath . So by\nLemma F.3 the image @xmath contains points other than @xmath . Next by\nLemma F.4 and part II of the theorem, since @xmath cannot be a linear\nsubspace, there can be no smooth points of @xmath in @xmath .\n\n@xmath\n\n##### Smooth case\n\nWe conclude that parts I, III and IV of Theorem F.2 together with\nProposition D.4 (i) and [ Hum75 , Thm.\u00a015.3(b)] imply Theorem A.11 . We\nonly note that a smooth Legendrian subvariety is either a linear\nsubspace or it is indecomposable.\n\n### f.3 Some comments\n\nConjecture F.1 is now reduced to the following special case not covered\nby Theorem F.2 :\n\n###### Conjecture F.5.\n\nLet @xmath be an irreducible Legendrian subvariety. Let @xmath be a\nnilpotent endomorphism and @xmath be an integer such that @xmath and\n@xmath . Assume that the action of @xmath preserves @xmath . Assume\nmoreover, that @xmath is singular at points of the image of the rational\nmap @xmath . Then @xmath is decomposable.\n\nWe also note the improved relation between projective automorphisms of a\nLegendrian subvariety and quadratic equations satisfied by its points:\n\n###### Corollary F.6.\n\nLet @xmath be an irreducible Legendrian subvariety for which Conjecture\nF.1 holds (for example @xmath is smooth). If @xmath is the maximal\nsubgroup preserving @xmath , then @xmath , where @xmath is the space of\nhomogeneous quadratic polynomials vanishing on @xmath .\n\nProof. It follows immediately from the statement of the conjecture and\nTheorem A.9 .\n\n@xmath\n\nFinally, it is important to note, that Theorem F.2 part III does not\nimply that every torus acting on an indecomposable, but singular\nLegendrian variety @xmath is contained in the image of @xmath . It only\nsays that the intersection of such a torus with the weks-symplectic part\nis always finite. Therefore if there is a non-trivial torus acting on\n@xmath , there is also some non-trivial connected subgroup of @xmath\nacting on @xmath and also some quadratic equations in the ideal of\n@xmath .\n\n## Chapter G Toric Legendrian subvarieties in projective space\n\nThe content of this chapter is published in [ Buc07 ] .\n\nWe apply Theorem A.11 to classify smooth toric Legendrian subvarieties.\nWe choose appropriate coordinates to reduce this problem to some\ncombinatorics (for surface case \u2014 see \u00a7 G.2 ) and some elementary\ngeometry of convex bodies (for higher dimensions \u2014 see \u00a7 G.3 ).\nEventually the proof of Theorem A.12 is obtained in Corollaries G.6 and\nG.10 .\n\n### g.1 Classification of toric Legendrian varieties\n\nWithin this chapter @xmath is a toric subvariety of dimension @xmath in\na projective space of dimension @xmath . We assume it is embedded\ntorically, so that the action of @xmath on @xmath extends to an action\non the whole @xmath , but we do not assume that the embedding is\nprojectively normal. The notation is based on [ Stu97 ] though we also\nuse techniques of [ Oda88 ] . We would like to understand when @xmath\ncan be Legendrian with respect to some contact structure on @xmath and\nin particular, when it can be a smooth toric Legendrian variety.\n\nThere are two reasons for considering non projectively normal toric\nvarieties here. The first one is that the new example we find is not\nprojectively normal. The second one is the conjecture [ Stu97 ,\nConj.\u00a02.9] , which says that a smooth, toric, projectively normal\nvariety is defined by quadrics. We do not expect to produce a\ncounterexample to this conjecture and on the other hand all smooth\nLegendrian varieties defined by quadrics are known to be just the\nsubadjoint varieties (see [ Buc06 , Thm\u00a05.11] ).\n\nIn addition we assume that either @xmath is smooth or at least the\nfollowing condition is satisfied:\n\n-   The action of the torus @xmath on @xmath preserves the contact\n    structure on @xmath . In other words, the image of @xmath is\n    contained in the image of @xmath .\n\nIn the case where @xmath is smooth, the ( @xmath ) condition is always\nsatisfied by Theorem A.11 . But for some statements below we do not need\nnon-singularity, so we only assume ( @xmath ).\n\n###### Theorem G.1.\n\nLet @xmath be a toric (in the above sense) non-degenerate Legendrian\nsubvariety satisfying ( @xmath ). Then there exists a choice of\nsymplectic coordinates on @xmath and coprime integers @xmath such that\n@xmath is the closure of the image of the following map:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn other words, @xmath is the closure of the orbit of a point\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nunder the torus action with weights\n\n  -- -------- --\n     @xmath   \n     @xmath   \n     @xmath   \n  -- -------- --\n\nMoreover every such @xmath is a non-degenerate toric Legendrian\nsubvariety.\n\nWe are aware that for many choices of the @xmath \u2019s from the theorem,\nthe action of the torus on @xmath (and on @xmath ) is not faithful, so\nthat for such examples a better choice of coordinates could be made.\nHowever, we are willing to pay the price of taking a quotient of @xmath\nto get a uniform description. One advantage of the description given in\nthe theorem is that a part of it is almost independent of the choice of\nthe @xmath \u2019s. This part is the @xmath -dimensional \u201coctahedron\u201d @xmath\n.\n\nProof. Assume @xmath is Legendrian with respect to a symplectic form\n@xmath , that @xmath is non-degenerate, that the torus @xmath acts on\n@xmath preserving @xmath and satisfies ( @xmath ). Replacing if\nnecessary @xmath by some covering we may assume that @xmath factorises\nthrough a maximal torus @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis implies, that for an appropriate symplectic basis the variety\n@xmath is the closure of the image of the map @xmath given by:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath , @xmath and for @xmath we let @xmath . This means that\n@xmath is the closure of the @xmath -orbit of the point \u00b9 \u00b9 1 Note that\nusually one assumes that this point is just [1,\u2026,1]. In our case we\nwould have to consider non-symplectic coordinates. We prefer to deal\nwith a point with more complicated coordinates. @xmath where @xmath acts\nwith weights @xmath .\n\nSince @xmath is non-degenerate, the weights are pairwise different. Also\nthe weights are not contained in any hyperplane in @xmath , because the\ndimension of @xmath is equal to the dimension of @xmath and we assume\n@xmath has an open orbit of the @xmath -action. So there exists exactly\none (up to scalar) linear relation:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe assume that the @xmath \u2019s are coprime integers. Permuting coordinates\nappropriately we can assume that @xmath . After a symplectic change of\ncoordinates, we can assume without loss of generality that all the\n@xmath \u2019s are non negative by exchanging @xmath with @xmath (and @xmath\nwith @xmath ) if necessary. Clearly not all the @xmath \u2019s are zero, so\nin particular @xmath and hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTherefore, if we set @xmath for @xmath , the points @xmath form a basis\nof a lattice @xmath containing all @xmath \u2019s. The lattice @xmath might\nbe finer than the one generated by the @xmath \u2019s. Replacing again @xmath\nby a finite cover, we can assume that the action of @xmath is\nexpressible in the terms of weights in @xmath . Then:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n              @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nIt remains to prove three things: that @xmath , that the @xmath \u2019s might\nbe chosen as in the statement of the theorem and finally that every such\nvariety is actually Legendrian. We will do all three together.\n\nThe torus acts symplectically on the projective space, thus the tangent\nspaces to the affine cone are Lagrangian if and only if just one tangent\nspace at a point of the open orbit is Lagrangian. So take the point\n@xmath . The affine tangent space is spanned by the following vectors:\n\n  -- -------- -------- -------- -------- -------- -------- -------- -- -------- -------- -------- -------- -------- --\n     @xmath   @xmath   @xmath   @xmath   @xmath   @xmath   @xmath      @xmath   @xmath   @xmath   @xmath   @xmath   \n     @xmath   @xmath   @xmath   @xmath   @xmath   @xmath   @xmath      @xmath   @xmath   @xmath   @xmath   @xmath   \n     @xmath   @xmath   @xmath   @xmath   @xmath   @xmath   @xmath      @xmath   @xmath   @xmath   @xmath   @xmath   \n              @xmath                                                                                                \n     @xmath   @xmath   @xmath   @xmath   @xmath   @xmath   @xmath      @xmath   @xmath   @xmath   @xmath   @xmath   \n  -- -------- -------- -------- -------- -------- -------- -------- -- -------- -------- -------- -------- -------- --\n\nNow the products are following:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nTherefore the linear space spanned by @xmath and the @xmath \u2019s is\nLagrangian if and only if:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn particular, since @xmath , the @xmath cannot be zero either. After\nanother conformal symplectic base change, we can assume that @xmath and\nthen @xmath . On the other hand, the above equation is satisfied for the\nvariety in the theorem. Hence the theorem is proved.\n\n@xmath\n\nOur next goal is to determine for which values of the @xmath \u2019s the\nvariety @xmath is smooth. The curve case is not interesting at all and\nalso very easy, so we start from @xmath , i.e.\u00a0Legendrian surfaces.\n\n### g.2 Smooth toric Legendrian surfaces\n\nWe are interested in knowing when the toric projective surface with\nweights of torus action\n\n  -- -------- -------- -------- -------- -------- -------- --\n     @xmath   @xmath   @xmath   @xmath   @xmath   @xmath   \n     @xmath   @xmath   @xmath   @xmath   @xmath   @xmath   \n  -- -------- -------- -------- -------- -------- -------- --\n\nis smooth. Our assumptions on the @xmath \u2019s are following:\n\n  -- -------- -- -------\n     @xmath      (G.2)\n  -- -------- -- -------\n\nand @xmath are coprime integers.\n\n###### Example G.3.\n\nLet @xmath and @xmath (see Figure G.1 ). Then @xmath is the product of\n@xmath and a quadric plane curve @xmath .\n\n###### Example G.4.\n\nLet @xmath (see Figure G.1 ). Although the embedding is not projectively\nnormal (we lack the weight @xmath in the middle), the image is smooth\nanyway. Then @xmath is the blow up of @xmath in three non-colinear\npoints.\n\nWe will prove there is no other smooth example.\n\nWe must consider two cases (see Figure G.2 ): either @xmath (which means\nthat @xmath is in the interior of the square @xmath ) or @xmath (so that\n@xmath is outside or on the border of the square).\n\nGeometrically, case @xmath means, that the normalisation of @xmath is\n@xmath . It is just an easy explicit verification that @xmath is not\nsmooth with these additional weights in the interior.\n\nIn the other case, for a vertex @xmath of the polytope\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwe define the sublattice @xmath to have the origin at @xmath and to be\ngenerated by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath is smooth, for every vertex @xmath the vectors of the edges\nmeeting at @xmath must form a basis of @xmath (compare with [ Stu97 ,\nProp.\u00a02.4 & Lemma\u00a02.2] ). In particular, if @xmath (it is immediate from\nInequalities\u00a0( G.2 ) that @xmath is indeed a vertex), then @xmath can be\nexpressed as an integer combination of @xmath and @xmath (see the right\nhand side of Figure G.2 ). So write:\n\n  -- -------- -- -------\n     @xmath      (G.5)\n  -- -------- -- -------\n\nfor some integers @xmath and @xmath . It is obvious that @xmath and\n@xmath must be strictly positive, since @xmath is in the cone generated\nby @xmath and @xmath with the vertex at @xmath . But then (since @xmath\n) from Equation\u00a0( G.5 ) on the second coordinate we get that either\n@xmath or @xmath .\n\nIf @xmath , then we easily get that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath and by Inequalities\u00a0( G.2 ) we get @xmath and therefore\n(since the @xmath \u2019s are coprime) @xmath , which is Example G.3 .\n\nOn the other hand, if @xmath , then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand hence by Inequalities\u00a0( G.2 ) and since the @xmath \u2019s are coprime,\nwe get @xmath , which is Example G.4 .\n\n###### Corollary G.6.\n\nIf @xmath is smooth toric Legendrian surface, then it is either @xmath\nor @xmath blown up in three non-colinear points or plane @xmath .\n\n@xmath\n\n### g.3 Higher dimensional toric Legendrian varieties\n\nIn this section we assume that @xmath . By means of the geometry of\nconvex bodies we will prove there is only one smooth toric\nnon-degenerate Legendrian variety in dimension @xmath and no more in\nhigher dimensions. We use Theorem G.1 so that we have a toric variety\nwith weights:\n\n  -- -------- --\n     @xmath   \n     @xmath   \n     @xmath   \n     @xmath   \n     @xmath   \n  -- -------- --\n\nwhere the @xmath \u2019s are coprime positive integers with @xmath .\n\n###### Example G.7.\n\nLet @xmath and @xmath . Then the related toric variety is @xmath (see\nFigure G.3 ).\n\nFurther, let @xmath be the polytope defined by the weights:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Lemma G.8.\n\nLet @xmath be two complementary subsets of indexes.\n\n-    Assume @xmath and @xmath . If\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    then the interval @xmath is an edge of @xmath .\n\n-    Assume @xmath and @xmath . If\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    then both intervals @xmath and @xmath are edges of @xmath .\n\n-    If @xmath and @xmath , then @xmath is an edge of @xmath .\n\nProof. Fix @xmath small enough, set @xmath and define the following\nhyperplanes in @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nAssuming the inequality of (a), @xmath is equal to @xmath and the rest\nof @xmath lies on one side of @xmath . So @xmath is a supporting\nhyperplane for the face @xmath , which is a simplex of dimension @xmath\nand therefore all its edges are also edges of @xmath as claimed in (a).\n\nNext assume that the inequality of (b) holds. Then @xmath (respectively\n@xmath ) is a supporting hyperplane for the edge @xmath (respectively\n@xmath ).\n\nSimilarly, in the case of (c), @xmath is a supporting hyperplane for\n@xmath .\n\n@xmath\n\n###### Theorem G.9.\n\nLet @xmath be a toric non-degenerate Legendrian variety of dimension\n@xmath satisfying ( @xmath ) (see page G.1 ). If @xmath and\nnormalisation of @xmath has at most quotient singularities, then @xmath\nand @xmath .\n\nProof. Since the normalisation of @xmath has at most quotient\nsingularities, it follows that the polytope @xmath is simple, i.e.\u00a0every\nvertex has exactly @xmath edges (see [ Ful93 ] or [ Oda88 , \u00a72.4,\np.\u00a0102] ). We will prove this is impossible, unless @xmath and @xmath .\n\nIf @xmath , then @xmath is just equal to @xmath and clearly in such a\ncase every vertex of @xmath has @xmath edges. Hence more than @xmath for\n@xmath .\n\nThus from now on we can assume that @xmath . yB Lemma G.8 (b), @xmath is\nan edge for every @xmath .\n\nChoose any @xmath and set @xmath .\n\nIf either\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthen using Lemma G.8 we can count the edges at either @xmath or @xmath\nand see that there is always more than @xmath of them. We note that\n@xmath never happens due to our assumptions on the @xmath \u2019s.\n\nTherefore the remaining case to consider is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere the equality holds for every @xmath . This implies:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince the @xmath \u2019s are positive integers and coprime, we must have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhich is exactly Example G.7 for @xmath . Otherwise, if @xmath we can\ntake @xmath for any two different @xmath and set @xmath to be the\ncomplement of @xmath . Then @xmath and by Lemma G.8 (a) and (c) there\nare too many edges at the @xmath \u2019s.\n\n@xmath\n\n###### Corollary G.10.\n\nIf @xmath is a smooth toric Legendrian subvariety and @xmath , then it\nis either a linear subspace or @xmath and @xmath .\n\n@xmath\n\n## Chapter H Examples of quasihomogeneous Legendrian varieties\n\nThe content of this chapter is published in [ Buc09 ] .\n\nWe construct a family of examples of Legendrian subvarieties in\nprojective spaces. Although most of them are singular, a new example of\na smooth Legendrian variety in dimension 8 is in this family. The 8-fold\nhas interesting properties: it is a compactification of the special\nlinear group, a Fano manifold of index 5 and Picard number 1 (see\nTheorem H.4 (b)). Also we show how this construction generalises to give\nnew smooth examples in dimensions 5 and 14 (see \u00a7 H.2.1 ).\n\nIn \u00a7 H.1 we introduce the notation for this chapter. In \u00a7 H.2 we\nformulate the results and make some comments on possible\ngeneralisations. In \u00a7 H.3 we study the structure of a group action\nrelated to the problem. In \u00a7 H.4 we finally prove the results.\n\n### h.1 Notation and definitions\n\nFor this chapter we fix an integer @xmath .\n\n##### Vector space @xmath\n\nLet @xmath be a vector space over complex numbers @xmath of dimension\n@xmath , which we interpret as a space of pairs of @xmath matrices. The\ncoordinates are: @xmath and @xmath for @xmath . By @xmath we denote the\nmatrix @xmath and similarly for @xmath and @xmath .\n\nGiven two @xmath matrices @xmath and @xmath , by @xmath we denote the\npoint of the vector space @xmath , while by @xmath we denote the point\nof the projective space @xmath .\n\nSometimes, we will represent some linear maps @xmath and some 2-linear\nforms @xmath as @xmath matrices. In such a case we will assume the\ncoordinates on @xmath are given in the lexicographical order:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n##### Symplectic form @xmath\n\nOn @xmath we consider the standard symplectic form\n\n  -- -------- -- -------\n     @xmath      (H.1)\n  -- -------- -- -------\n\nFurther we set @xmath to be the matrix of @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n##### Varieties @xmath, @xmath and @xmath\n\nWe consider the following subvariety of @xmath :\n\n  -- -------- -- -------\n     @xmath      (H.2)\n  -- -------- -- -------\n\nThe square at @xmath seems to be irrelevant here, but it slightly\nsimplifies the notation in the proofs of Theorem H.4 (b) and Proposition\nH.10 (ii). Although it is not essential for the content of this chapter,\nwe note that @xmath is @xmath -cointegrable.\n\nFurther we define two types of subvarieties of @xmath :\n\n  -- -------- --\n     @xmath   \n     @xmath   \n  -- -------- --\n\nwhere @xmath . The varieties @xmath have been also studied by [ Str82 ]\nand [ MT99 ] . @xmath (especially @xmath ) is the main object of this\nchapter.\n\n##### Automorphisms @xmath\n\nFor any @xmath we let @xmath be the following linear automorphism of\n@xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nAlso the induced automorphism of @xmath will be written in the same way:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n##### Groups @xmath and @xmath, Lie algebra @xmath and their\nrepresentation\n\nWe set @xmath and let it act on @xmath by:\n\n  -- -------- --\n     @xmath   \n     @xmath   \n  -- -------- --\n\nThis action preserves the symplectic form @xmath .\n\nWe will mostly consider the restricted action of @xmath .\n\nWe also set @xmath to be the Lie algebra of @xmath and we have the\ntangent action of @xmath on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThough we denote the action of the groups @xmath , @xmath and the Lie\nalgebra @xmath by the same @xmath we hope it will not lead to any\nconfusion. Also the induced action of @xmath and @xmath on @xmath will\nbe denoted by @xmath .\n\n##### Orbits @xmath and @xmath\n\nWe define the following sets:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nso that @xmath and @xmath .\n\nClearly, if @xmath , then @xmath is empty, so whenever we are\nconsidering @xmath we will assume @xmath .\n\n##### Elementary matrices @xmath and points @xmath and @xmath\n\nLet @xmath be the elementary @xmath matrix with unit in the @xmath row\nand the @xmath column and zeroes elsewhere.\n\nWe distinguish two points @xmath and @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThese points will be usually chosen as nice representatives of the\nclosed orbits @xmath and @xmath .\n\n##### Submatrices - extracting rows and columns\n\nAssume @xmath is an @xmath matrix and @xmath are two sets of indices of\ncardinality @xmath and @xmath respectively:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nThen we denote by @xmath the @xmath submatrix of @xmath obtained by\nremoving rows of indices @xmath and columns of indices @xmath . Also for\na set of indices @xmath we denote by @xmath the set of @xmath indices\ncomplementary to @xmath .\n\nWe will also use a simplified version of the above notation when we\nremove only a single column and single row: @xmath denotes the @xmath\nsubmatrix of @xmath obtained by removing @xmath -th row and @xmath -th\ncolumn, i.e. @xmath\n\nAlso in the simplest situation where we remove only the last row and the\nlast column, we write @xmath , so that @xmath .\n\n### h.2 Main results\n\nIn this chapter we give a classification \u00b9 \u00b9 1 This problem was\nsuggested by Sung Ho Wang. of Legendrian subvarieties in @xmath that are\ncontained in @xmath .\n\n###### Theorem H.3.\n\nLet projective space @xmath , varieties @xmath , @xmath , @xmath and\nautomorphisms @xmath be defined as in \u00a7 H.1 . Assume @xmath is an\nirreducible subvariety. Then @xmath is Legendrian and contained in\n@xmath if and only if @xmath is one of the following varieties:\n\n-   @xmath for some @xmath or\n\n-   @xmath for some @xmath .\n\nThe idea of the proof of Theorem H.3 is based on the observation that\nevery Legendrian subvariety that is contained in @xmath must be\ninvariant under the action of the group @xmath . This is explained in \u00a7\nH.3 . A proof of the theorem is presented in \u00a7 H.4.1 .\n\nAlso we analyse which of the above varieties appearing in 1.\u00a0and 2.\u00a0are\nsmooth:\n\n###### Theorem H.4.\n\nWith the definition of @xmath as in \u00a7 H.1 , the family @xmath contains\nthe following varieties:\n\n-   @xmath is a linear subspace.\n\n-   @xmath is smooth, its Picard group is generated by a hyperplane\n    section. Moreover @xmath is a compactification of @xmath and it is\n    isomorphic to a hyperplane section of Grassmannian @xmath . The\n    connected component of @xmath is equal to @xmath and @xmath is not a\n    homogeneous space.\n\n-   @xmath is the 15 dimensional spinor variety @xmath .\n\n-    For @xmath , the variety @xmath is singular.\n\nA proof of the theorem is explained in \u00a7 H.4.3 .\n\nVariety @xmath is an original example of [ Buc09 ] . Also it is the\nfirst described example of a smooth non-homogeneous Legendrian variety\nof dimension bigger than @xmath (see \u00a7 A.1.3 ). This example is very\nclose to a homogeneous one, namely it is isomorphic to a hyperplane\nsection of @xmath , a well known subadjoint variety. So a natural\nquestion arises, whether general hyperplane sections of other Legendrian\nvarieties admit a Legendrian embedding. The answer is yes and we explain\nit (as well as many conclusions from this surprisingly simple\nobservation) in Chapter I .\n\n###### Theorem H.5.\n\nWith the definition of @xmath as in \u00a7 H.1 , variety @xmath is smooth if\nand only if @xmath , @xmath or @xmath . In the first two cases, @xmath\nand @xmath are linear spaces, while @xmath .\n\nA proof of the theorem is presented in \u00a7 H.4.2 .\n\n#### h.2.1 Generalisation: Representation theory and further examples\n\nThe interpretation of Theorem H.4 (b) and (c) can be following: We take\nthe exceptional Legendrian variety @xmath , slice it with a linear\nsection and we get a description, which generalised to matrices of\nbigger size, gives the bigger exceptional Legendrian variety @xmath . A\nsimilar connection can be established between other exceptional\nLegendrian varieties (see \u00a7 A.1.3 ).\n\nFor instance, assume that @xmath is a vector space of dimension @xmath ,\nwhich we interpret as the space of pairs of @xmath symmetric matrices\n@xmath . Now in @xmath consider the subvariety @xmath , which is the\nclosure of the following set:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Theorem H.6.\n\nAll the varieties @xmath are Legendrian and we have:\n\n-   @xmath is a linear subspace.\n\n-   @xmath is smooth and it is isomorphic to a hyperplane section of\n    Lagrangian Grassmannian @xmath .\n\n-   @xmath is smooth and it is Grassmannian variety @xmath .\n\n-    For @xmath , the variety @xmath is singular.\n\nThe proof is exactly as the proof of Theorem H.4 .\n\nSimilarly, we can take @xmath to be a vector space of dimension @xmath ,\nwhich we interpret as the space of pairs of @xmath skew-symmetric\nmatrices @xmath . Now in @xmath consider subvariety @xmath , which is\nthe closure of the following set:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Theorem H.7.\n\nAll the varieties @xmath are Legendrian and we have:\n\n-   @xmath is a linear subspace.\n\n-   @xmath is smooth and it is isomorphic to a hyperplane section of the\n    spinor variety @xmath .\n\n-   @xmath is smooth and it is the 27 dimensional @xmath variety.\n\n-    For @xmath , the variety @xmath is singular.\n\nHere the only difference is that we replace the determinants by the\nPfaffians of the appropriate submatrices and also for the previous cases\nwe will be picking some diagonal matrices as nice representatives. Since\nthere is no non-zero skew-symmetric diagonal matrix, we must modify our\ncalculations a little bit, but there is essentially no difference in the\ntechnique.\n\nPrior to [ Buc09 ] neither @xmath nor @xmath have been identified as\nsmooth Legendrian subvarieties.\n\nTherefore we have established a connection between the subadjoint\nvarieties of the 4 exceptional groups @xmath , @xmath , @xmath and\n@xmath . A similar connection was obtained by [ LM02 ] .\n\nWe note that @xmath symmetric matrices, @xmath matrices and @xmath\nskew-symmetric matrices naturally correspond to @xmath Hermitian\nmatrices with coefficients in @xmath , where @xmath is the field of,\nrespectively, real numbers @xmath , complex numbers @xmath and\nquaternions @xmath (see [ LM01 ] and references therein). An algebraic\nrelation (analogous to Parts\u00a0(c) of Theorems H.4 , H.6 and H.7 ) between\nLie algebras of types @xmath , @xmath and @xmath and @xmath Hermitian\nmatrices with coefficients in @xmath is described in [ BK94 ] .\n\n### h.3 @xmath-action and its orbits\n\nRecall the definition of @xmath in \u00a7 H.1 .\n\nThe following polynomials are in the homogeneous ideal of @xmath (the\nindices @xmath below run through @xmath , @xmath is a summation index):\n\n  -- -------- -- --------\n                 \n     @xmath      (H.8a)\n     @xmath      (H.8b)\n     @xmath      (H.8c)\n     @xmath      (H.8d)\n  -- -------- -- --------\n\nThese equations simply come from eliminating @xmath from the defining\nequation of @xmath \u2014 see Equation\u00a0( H.2 ).\n\nFor the statement and proof of the following proposition, recall our\nnotation of \u00a7 H.1 .\n\n###### Proposition H.9.\n\nLet @xmath be a Legendrian subvariety. If @xmath is contained in @xmath\n, then @xmath is preserved by the induced action of @xmath on @xmath .\n\nProof. Let @xmath be as in the Theorem A.9 and define @xmath\nanalogously. Clearly @xmath . Also let @xmath be the map described in\nTheorem A.9 . By Theorem A.9 it is enough to show that @xmath or that\nthe images of the quadrics ( H.8a )\u2013( H.8d ) under @xmath generate\n@xmath .\n\nWe write out the details of the proof only for @xmath . There is no\ndifference between this case and the general one, except for the\ncomplexity of notation.\n\nLet us take the quadric\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor any @xmath . Also let @xmath be the @xmath symmetric matrix\ncorresponding to @xmath . For instance:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nChoose an arbitrary @xmath and at the moment we want to think of it as\nof a single vertical @xmath -vector: @xmath , so that the following\nmultiplication makes sense:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSimilar calculations show that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNext in the ideal of @xmath we have the following quadrics: @xmath for\n@xmath (see Equation\u00a0( H.8b )) and @xmath (see Equation\u00a0( H.8a )). By\ntaking images under @xmath of the linear combinations of those quadrics\nwe can get an arbitrary traceless matrix @xmath acting on @xmath in the\nfollowing way:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nExponentiate this action of @xmath to get the action of @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis proves that the action of subgroup @xmath preserves @xmath as\nclaimed in the proposition. The action of the other component @xmath is\ncalculated in the same way, but using quadrics ( H.8c )\u2013( H.8d ).\n\n@xmath\n\n#### h.3.1 Invariant subsets\n\nHere we want to decompose @xmath into a union of some @xmath -invariant\nsubsets, most of which are orbits.\n\n###### Proposition H.10.\n\n-    The sets @xmath , @xmath and @xmath are @xmath -invariant and they\n    are all contained in @xmath .\n\n-   @xmath is equal to the union of all @xmath (for @xmath ) and all\n    @xmath (for integers @xmath , @xmath ).\n\n-    Every @xmath is an orbit of the action of @xmath . If @xmath is\n    odd, then @xmath is isomorphic (as algebraic variety) to @xmath .\n    Otherwise if @xmath is even, then @xmath is isomorphic to @xmath .\n    In both cases\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\nProof. The proof of part (i) is an explicit verification from the\ndefinitions in \u00a7 H.1 .\n\nTo prove part (ii), assume @xmath is a point of @xmath , so @xmath .\nFirst assume that the ranks of both matrices are maximal:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen @xmath must be non-zero and @xmath . Let @xmath so that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand let @xmath . Then we have:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nTherefore @xmath .\n\nNext, if either of the ranks is not maximal:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthen by Equation\u00a0( H.2 ) we must have @xmath . So @xmath for @xmath and\n@xmath .\n\nNow we prove (iii). The action of @xmath commutes with @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo to prove @xmath is an orbit it is enough to prove that @xmath is an\norbit, which follows from the definitions of the action and @xmath .\n\nWe have the following epimorphic map:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath , then we must have @xmath and @xmath for some @xmath . Hence\n@xmath and @xmath . If @xmath is odd and @xmath , then @xmath so @xmath\n. So @xmath is either isomorphic to @xmath or to @xmath as stated.\n\n@xmath\n\nFrom Proposition H.10 (ii) we conclude that @xmath is an equivariant\ncompactification of @xmath (if @xmath is odd) or @xmath (if @xmath is\neven). See [ Tim03 ] and references therein for the theory of\nequivariant compactifications. In the setup of [ Tim03 , \u00a78] , this is\nthe compactification corresponding to the representation @xmath , where\n@xmath is the standard representation of @xmath . Therefore some\nproperties of @xmath could also be read from the general description of\ngroup compactifications.\n\n###### Proposition H.11.\n\n-    The dimension of @xmath is @xmath . In particular, if @xmath , then\n    the dimension is equal to @xmath .\n\n-   @xmath is an orbit of the action of @xmath , unless @xmath is even\n    and @xmath .\n\n-    If @xmath , then there are exactly two closed orbits of the action\n    of @xmath : @xmath and @xmath .\n\nProof. Part (i) follows from [ Str82 , Prop.\u00a02.10] .\n\nFor part (ii) let @xmath be any point. By Gaussian elimination and\nelementary linear algebra, we can prove that there exists @xmath such\nthat @xmath is a pair of diagonal matrices. Moreover, if @xmath , then\nwe can choose @xmath and @xmath such that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath and this finishes the proof in the case @xmath .\n\nSo assume @xmath . Then we can choose @xmath such that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor some @xmath . If @xmath , then set @xmath and let\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nClearly @xmath and:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo rescaling we get:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand this finishes the proof of (ii).\n\nFor part (iii), denote by @xmath (respectively, @xmath ) the standard\nrepresentation of the first (respectively, the second) component of\n@xmath with the trivial action of the other component. Then @xmath as a\nrepresentation of @xmath is isomorphic to @xmath . For @xmath the\nrepresentation @xmath is not isomorphic to @xmath and therefore @xmath\nis a union of two irreducible non-isomorphic representations. It is a\nstandard fact from the representation theory, that the closed orbits of\nthe action of a semisimple group on a projectivised representation are\nin one to one correspondence with the irreducible subrepresentations. So\nthere are exactly two closed orbits of the action of @xmath on @xmath .\nThese orbits are simply @xmath and @xmath .\n\n@xmath\n\n#### h.3.2 Action of @xmath\n\nThe action of @xmath extends the action of @xmath , but it does not\npreserve @xmath . So we will only consider the action of @xmath when\nspeaking of @xmath .\n\nWe have properties analogous to Proposition H.11 (ii) and (iii) but with\nno exceptional cases:\n\n###### Proposition H.12.\n\n-    Every @xmath is an orbit of the action of @xmath .\n\n-    For every @xmath there are exactly two closed orbits of the action\n    of @xmath : @xmath and @xmath .\n\nProof. This is exactly as the proof of Proposition H.11 (ii) and (iii).\n\n@xmath\n\n### h.4 Legendrian varieties in @xmath\n\nIn this section we prove the main results of the chapter.\n\n#### h.4.1 Classification\n\nWe start by proving the Theorem H.3 .\n\nProof. First assume @xmath is Legendrian and contained in @xmath . If\n@xmath contains a point @xmath where both @xmath and @xmath are\ninvertible, then by Proposition H.9 it must contain the orbit of @xmath\n, which by Proposition H.10 (ii) and (iii) is equal to @xmath for some\n@xmath . But the dimension of @xmath is @xmath which is exactly the\ndimension of @xmath (see Proposition H.10 (iii)), so\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nOn the other hand, if @xmath does not contain any point @xmath where\nboth @xmath and @xmath are invertible, then in fact @xmath is contained\nin the locus @xmath . This locus is just the union of all @xmath and its\nirreducible components are the closures of @xmath , which are exactly\n@xmath . So in particular every irreducible component has dimension\n@xmath (see Proposition H.11 (i)) and hence @xmath must be one of these\ncomponents.\n\nTherefore it remains to show that all these varieties are Legendrian.\n\nThe fact that @xmath is a Legendrian variety follows from [ Str82 ,\npp524\u2013525] . Strickland proves there that the affine cone over @xmath\n(or @xmath in the notation of [ Str82 ] ) is the closure of a conormal\nbundle. Conormal bundles are classical examples of Lagrangian varieties\n(see Example D.6 ).\n\nSince @xmath preserves the symplectic form @xmath , it is enough to\nprove that @xmath is Legendrian.\n\nThe group @xmath acts symplectically on @xmath and the action has an\nopen orbit on @xmath \u2014 see Proposition H.10 (iii). Thus the tangent\nspaces to the affine cone over @xmath are Lagrangian if and only if just\none tangent space at a point of the open orbit is Lagrangian.\n\nSo we take @xmath . Now the affine tangent space to @xmath at @xmath is\nthe linear subspace of @xmath spanned by @xmath and the image of the\ntangent action of the Lie algebra @xmath . We must prove that for every\nfour traceless matrices @xmath we have:\n\n  -- -------- -------- -- ---------\n                          \n     @xmath   @xmath      (H.13a)\n     @xmath   @xmath      (H.13b)\n  -- -------- -------- -- ---------\n\nEquality\u00a0( H.13a ) is true without the assumption on the trace of the\nmatrices:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor Equality\u00a0( H.13b ) we calculate:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence we have proved that the closure of @xmath is Legendrian.\n\n@xmath\n\n#### h.4.2 Degenerate matrices\n\nBy [ Str82 , Prop.\u00a01.3] the ideal of @xmath is generated by the\ncoefficients of @xmath , the coefficients of @xmath , the @xmath -minors\nof @xmath and the @xmath -minors of @xmath . In short, we will say that\nthe equations of @xmath are given by:\n\n  -- -------- -- --------\n     @xmath      (H.14)\n  -- -------- -- --------\n\n###### Lemma H.15.\n\nAssume @xmath and @xmath . Then:\n\n-    The tangent cone to @xmath at @xmath is a product of a linear space\n    of dimension @xmath and the affine cone over @xmath .\n\n-    The tangent cone to @xmath at @xmath is a product of a linear space\n    of dimension @xmath and the affine cone of @xmath .\n\n-   @xmath is smooth at @xmath if and only if @xmath .\n\n-   @xmath is smooth at @xmath if and only if @xmath .\n\nProof. We only prove (i) and (ii), while (i\u2019) and (ii\u2019) follow in the\nsame way by exchanging @xmath and @xmath . Consider Equations\u00a0( H.14 )\nof @xmath restricted to the affine neighbourhood of @xmath obtained by\nsubstituting @xmath . Taking the lowest degree part of these equations\nwe get some of the equations of the tangent cone at @xmath (recall our\nconvention on the notation of submatrices \u2014 see \u00a7 H.1 ):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThese equations define the product of the linear subspace @xmath and the\naffine cone over @xmath embedded in the set of those pairs of matrices,\nwhose last row and column are zero: @xmath . So the variety defined by\nthose equations is irreducible and its dimension is equal to @xmath .\nSince this contains the tangent cone we are interested in and by \u00a7 B.8\n(1), they must coincide as claimed in (i).\n\nNext (ii) follows immediately, since for @xmath the equations above\nreduce to\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand hence the tangent cone is just the tangent space, so @xmath is a\nsmooth point of @xmath . Conversely, if @xmath , then @xmath is not a\nlinear space, so by (i) the tangent cone is not a linear space either\nand @xmath is singular at @xmath \u2014 see \u00a7 B.8 (3).\n\n@xmath\n\nNow we can prove Theorem H.5 :\n\nProof. It is obvious from the definition of @xmath , that @xmath and\n@xmath , so these are indeed linear spaces.\n\nTherefore assume @xmath . But @xmath is @xmath invariant (see\nProposition H.12 (i)) and so is its singular locus @xmath . Hence @xmath\nis singular if and only if @xmath contains a closed orbit of @xmath .\n\nSo @xmath is smooth, if and only if it is smooth at both @xmath and\n@xmath (see Proposition H.12 (ii)), which by Lemma H.15 (ii) and (ii\u2019)\nholds if and only if @xmath and @xmath .\n\nTo finish the proof, it remains to verify what kind of variety is @xmath\n. Consider the following map:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nClearly this is the Segre embedding in appropriate coordinates. The\nimage of this embedding is contained in @xmath (see Equation\u00a0( H.14 ))\nand since dimension of @xmath is equal to the dimension of @xmath we\nconclude the above map gives an isomorphism of @xmath and @xmath .\n\n@xmath\n\n#### h.4.3 Invertible matrices\n\nWe wish to determine some of the equations of @xmath . Clearly the\nequations of @xmath (see Equation\u00a0( H.8 )) are quadratic equations of\n@xmath . To find other equations, we recall that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHowever, for a matrix @xmath with determinant 1 we know that the entries\nof @xmath consist of the appropriate minors (up to sign) of @xmath .\nTherefore we get many inhomogeneous equations satisfied by every pair\n@xmath (recall our convention on the notation of submatrices \u2014 see \u00a7 H.1\n):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTo make them homogeneous, multiply two such equations appropriately:\n\n  -- -------- -- --------\n     @xmath      (H.16)\n  -- -------- -- --------\n\nThese are degree @xmath equations, which are satisfied by the points of\n@xmath and we state the following theorem:\n\n###### Theorem H.17.\n\nLet @xmath . Then the quadratic polynomials ( H.8a )\u2013( H.8d ) and the\ncubic polynomials ( H.16 ) generate a homogeneous ideal @xmath in @xmath\nwhich defines @xmath as a subscheme of @xmath . Moreover @xmath is\nsmooth.\n\nProof. It is enough to prove that the scheme @xmath defined by @xmath is\nsmooth, because the reduced subscheme of @xmath coincides with @xmath .\n\nThe scheme @xmath is @xmath invariant, hence as in the proof of Theorem\nH.5 and by Proposition H.11 (iii) it is enough to verify smoothness at\n@xmath and @xmath . Since we have the additional symmetry here\n(exchanging @xmath \u2019s with @xmath \u2019s) it is enough to verify the\nsmoothness at @xmath .\n\nNow we calculate the tangent space to @xmath at @xmath by taking linear\nparts of the polynomials evaluated at @xmath . From polynomials ( H.8 )\nwe get that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNow from Equations\u00a0( H.16 ) for @xmath and @xmath we get the following\nevaluated equations:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n(where @xmath is either @xmath or @xmath , which ever is different than\n@xmath and analogously for @xmath ) so the linear part is just @xmath .\nHence by varying @xmath and @xmath we can get\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTherefore the tangent space has codimension at least @xmath , which is\nexactly the codimension of @xmath \u2014 see Proposition H.10 (iii). Hence\n@xmath is smooth (in particular reduced) and @xmath .\n\n@xmath\n\n###### Remark H.18.\n\nThe ideal @xmath from Theorem H.17 could possibly be unsaturated (in\nother words, the affine subscheme in @xmath defined by this ideal could\nbe not reduced at @xmath ). Computer calculations show that this is not\nthe case and @xmath is saturated. We will only need that the saturated\nideal of @xmath has no other quadratic polynomials than @xmath and we\nwill prove it later.\n\nTo describe @xmath for @xmath we must find more equations.\n\nThere is a more general version of the above property of an inverse of a\nmatrix with determinant 1, which is less commonly known.\n\n###### Proposition H.19.\n\n-    Assume @xmath is a @xmath matrix of determinant @xmath and @xmath\n    are two sets of indices, both of cardinality @xmath (again recall\n    our convention on indices and submatrices \u2014 see \u00a7 H.1 ). Denote by\n    @xmath . Then the appropriate minors are equal (up to sign):\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n-    A coordinate free way to express these equalities is following:\n    Assume @xmath is a vector space of dimension @xmath , @xmath is a\n    linear automorphism of @xmath and @xmath . Let @xmath be the induced\n    automorphism of @xmath . If @xmath , then:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n-    Consider the induced action of @xmath on the polynomials on @xmath\n    . Then the vector space spanned by the set of equations of (i) for a\n    fixed @xmath is @xmath invariant.\n\nProof. Part (ii) follows immediately from (i), since if @xmath is a\nmatrix of @xmath , then the terms of the matrices of the maps @xmath and\n@xmath are exactly the appropriate minors of @xmath and @xmath .\n\nPart (iii) follows easily from (ii).\n\nAs for (i), we only sketch the proof, leaving the details to the reader.\nFirstly, reduce to the case when @xmath and @xmath are just @xmath and\nthe determinant of @xmath is possibly @xmath (which is where the sign\nshows up in the equality). Secondly if both determinants @xmath and\n@xmath are zero, then the equality is clearly satisfied. Otherwise\nassume for example @xmath . Then performing the appropriate row and\ncolumn operations we can change @xmath into a diagonal matrix, @xmath\nand @xmath into the zero matrices and all these operations can be done\nwithout changing @xmath nor @xmath . Then the statement follows easily.\n\n@xmath\n\nIn particular we get:\n\n###### Corollary H.20.\n\nAssume @xmath , @xmath and @xmath are as in Proposition H.19 (i).\n\n-    If @xmath is even and @xmath , then the equation\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    is homogeneous of degree @xmath and it is satisfied by points of\n    @xmath .\n\n-    If @xmath and @xmath , then\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    is a homogeneous equation of degree @xmath satisfied by points of\n    @xmath .\n\nProof. Clearly both equations are homogeneous. If @xmath and @xmath ,\nthen the following equations are satisfied:\n\n  -- -------- -- --------\n     @xmath      (H.21)\n  -- -------- -- --------\n\n  -- -------- -- --------\n     @xmath      (H.22)\n  -- -------- -- --------\n\n(Equation\u00a0( H.21 ) follows from Proposition H.19 (i) and Equation\u00a0( H.22\n) follows from @xmath ). Equation in (b) is just Equation\u00a0( H.21 )\nsquared multiplied side-wise by Equation\u00a0( H.22 ).\n\nSo both equations in (a) and (b) are satisfied by every pair @xmath and\nby homogeneity also by @xmath . Hence (a) and (b) hold on an open dense\nsubset of @xmath , so also on whole @xmath .\n\n@xmath\n\nWe know enough equations of @xmath to prove the Theorem H.4 :\n\n##### Case @xmath \u2014 linear subspace\n\nProof. To prove (a) just take the linear equations from Corollary H.20\n(a) for @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath .\n\n@xmath\n\n##### Case @xmath \u2014 hyperplane section of @xmath\n\nProof. For (b), @xmath is smooth by Theorem H.17 and it is a\ncompactification of @xmath by Proposition H.10 (i) and (iii).\n\n###### Picard group of @xmath.\n\nThe complement of the open orbit\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nmust be a union of some orbits of @xmath , each of them must have\ndimension smaller than @xmath . So by Propositions H.10 (ii), (iii),\nH.11 (i) and (ii) the only candidates are @xmath , @xmath , @xmath ,\n@xmath and @xmath . We claim that only @xmath , @xmath and @xmath are\ncontained in @xmath . To exclude @xmath consider the point:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis point is in @xmath and does not satisfy Equation\u00a0( H.16 ) for\n@xmath and @xmath and therefore it is not contained in @xmath . So\n@xmath is disjoint from @xmath .\n\nAnalogously, @xmath is disjoint from @xmath .\n\nIt only remains to prove that @xmath , since the other orbits are in the\nclosure of @xmath . Take the curve in @xmath parametrised by:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor @xmath the curve meets @xmath , and therefore @xmath is contained in\n@xmath and that finishes the proof of the claim.\n\nSince @xmath (see Proposition H.11 (i)), @xmath is a prime divisor. We\nhave @xmath and by [ Har77 , Prop.\u00a0II.6.5(c)] the Picard group of @xmath\nis isomorphic to @xmath with the ample generator @xmath .\n\nNext we check that @xmath is linearly equivalent (as a divisor on @xmath\n) to a hyperplane section @xmath of @xmath . Since we already know that\n@xmath , we must have @xmath for some positive integer @xmath . But\nthere are lines contained in @xmath (for example those contained in\n@xmath ) \u00b2 \u00b2 2 Actually, the reader could also easily find explicitly\nsome lines (or even planes) which intersect the open orbit and conclude\nthat @xmath is covered by lines. . So let @xmath be any line and we\nintersect:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBut the result must be an integer, so @xmath as claimed.\n\n###### Complete embedding.\n\nSince @xmath itself is definitely not a hyperplane section of @xmath ,\nthe conclusion is that the Legendrian embedding of @xmath is not given\nby a complete linear system. The natural guess for a better embedding is\nthe following:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n(we note that @xmath for @xmath with @xmath ) and one can verify that\nthe projection from the point @xmath restricted to @xmath gives an\nisomorphism with @xmath .\n\nThe Grassmannian @xmath in its Pl\u00fccker embedding can be described as the\nclosure of:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand we immediately identify @xmath as the section @xmath of the\nGrassmannian.\n\nThough it is not essential, we note that @xmath (see Kodaira vanishing\ntheorem [ Laz04 , Thm\u00a04.2.1] ; alternatively, it follows from the fact\nthat @xmath for Grassmannians) and hence the above embedding of @xmath\nis given by the complete linear system.\n\n###### Quadratic equations of @xmath.\n\nIn order to calculate the automorphism group of @xmath we need to know\nthat the quadratic part of its saturated ideal has no other polynomial\nthan linear combinations of polynomials ( H.8a )\u2013( H.8d ) (see also\nRemark H.18 ).\n\nThe ideal of grassmannian @xmath is generated by 35 quadratic equations,\nwhich in the above coordinates take form:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nAlthough at the first glance there are 36 equations above, the trace\nequality @xmath makes one of them redundant.\n\nThe homogeneous ideal @xmath is the same but with @xmath and the ideal\nof @xmath arises as the elimination ideal of @xmath with the @xmath\neliminated. In particular the quadratic polynomials in @xmath are\nexactly those quadrics in @xmath that do not contain any term with\n@xmath . No term in @xmath other than @xmath appears more than once in\nthe equations listed above. Therefore the quadratic part of the ideal\n@xmath arises by eliminating @xmath from:\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nTherefore polynomials ( H.8 ) span all the quadratic polynomials in\n@xmath .\n\n###### Automorphism group.\n\nIt remains to calculate @xmath \u2014 the connected component of the\nautomorphism group.\n\nThe tangent Lie algebra of the group of automorphisms of a complex\nprojective manifold is equal to the global sections of the tangent\nbundle, see Theorem C.4 . A vector field on @xmath is also a section of\n@xmath and we have the following short exact sequence:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe homogeneous vector bundle @xmath is isomorphic to @xmath , where\n@xmath is the universal subbundle in @xmath and @xmath is the universal\nquotient bundle. This bundle corresponds to an irreducible module of the\nparabolic subgroup in @xmath . Calculating explicitly its highest weight\nand applying Bott formula [ Ott95 ] we get that @xmath . Hence every\nsection of @xmath extends to a section of @xmath . In other words, if\n@xmath is the subgroup preserving @xmath , then the restriction map\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis epimorphic.\n\nThe action of @xmath on @xmath preserves the natural symplectic form\n@xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince the action of @xmath on @xmath preserves the hyperplane @xmath\ncontaining @xmath , it must also preserve @xmath , i.e. @xmath preserves\n@xmath . Therefore @xmath acts on the quotient @xmath and hence the\nrestriction map factorises:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy Theorem A.11 , group @xmath is contained in the image of @xmath , so\nby Theorem A.9 , Proposition H.9 and the above considerations about\nquadratic polynomials:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn particular @xmath cannot be homogeneous as it contains more than one\norbit of the connected component of automorphism group.\n\n@xmath\n\nWe note that the fact that @xmath is not homogeneous can be also proved\nwithout calculating the automorphism group. Since @xmath , it follows\nfrom Theorem A.6 , that @xmath could only be one of the subadjoint\nvarieties. But none of them has Picard group @xmath and dimension 8.\n\n##### Case @xmath \u2014 spinor variety @xmath\n\nProof. Similarly to Grassmannian @xmath the spinor variety can be\ndescribed in terms of matrices. Let @xmath be the vector space of all\n@xmath skew-symmetric matrices. Consider a map:\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (H.23)\n  -- -------- -------- -- --------\n\nIn coordinates, @xmath is just the matrix of all @xmath Pfaffians of\n@xmath and @xmath is the Pfaffian of @xmath . The spinor variety @xmath\nis the closure of the image of this map.\n\nFor a skew-symmetric matrix @xmath by @xmath denote the Pfaffian of\n@xmath with @xmath and @xmath rows and columns removed and by @xmath\ndenote the Pfaffian of @xmath . Now consider the following map:\n\n  -- -------- -- --------\n     @xmath      \n     @xmath      (H.24)\n     @xmath      \n  -- -------- -- --------\n\nThe image of this map is in an open neighbourhood of @xmath and\nsatisfies the equations of @xmath : 30 quadratic equations @xmath as in\n( H.8 ) and 36 quadratic equations from Corollary H.20 (a). So the image\nis contained in @xmath . Moreover, Map\u00a0( H.24 ) is just a linear\ncoordinate change different from Map\u00a0( H.4.3 ). Therefore, since @xmath\nand both varieties are irreducible it follows that (up to linear change\nof coordinates):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nas claimed in the theorem.\n\n@xmath\n\n##### Case @xmath \u2014 singular varieties\n\nProof. Finally we prove (d). We want to prove, that for @xmath variety\n@xmath is singular at @xmath . To do that, we calculate the reduced\ntangent cone\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFrom Equations\u00a0( H.8 ) we easily get the following linear and quadratic\nequations of @xmath (again we suggest to have a look at \u00a7 H.1 ):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor every @xmath and some @xmath .\n\nNext assume @xmath and @xmath are two sets of indices, both of\ncardinality @xmath and such that neither @xmath nor @xmath contains\n@xmath . Consider the equation of @xmath as in Corollary H.20 (b):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTo get an equation of @xmath , we evaluate at @xmath and take the lowest\ndegree part, which is simply @xmath . Since @xmath is reduced, by\nvarying @xmath and @xmath we get that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand therefore also:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath is contained in the product of the linear space @xmath and\nthe affine cone @xmath over the union of @xmath for @xmath . We claim\nthat @xmath . By Proposition H.11 (i), every component of @xmath has\ndimension @xmath , so by \u00a7 B.8 (1) the tangent cone must be a union of\nsome of the components. Therefore to prove the claim it is enough to\nfind for every @xmath a single element of @xmath that is contained in\nthe tangent cone.\n\nSo take @xmath and @xmath to be two strictly positive integers such that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand consider the curve in @xmath with the following parametrisation:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIt is easy to verify that this family is contained in @xmath for @xmath\nand as @xmath converges to @xmath , it gives rise to a tangent vector\n(i.e.\u00a0an element of the reduced tangent cone \u2014 see the point-wise\ndefinition in \u00a7 B.8 ) that belongs to @xmath .\n\nSo indeed @xmath , which for @xmath contains more than 1 component,\nhence cannot be a linear space. Therefore by \u00a7 B.8 (3) variety @xmath is\nsingular at @xmath .\n\n@xmath\n\n## Chapter I Hyperplane sections of Legendrian subvarieties\n\nThe content of \u00a7 I.1 and \u00a7 I.3 of this chapter is published in [ Buc08b\n] .\n\nThe Legendrian variety @xmath constructed in Chapter H is isomorphic to\na hyperplane section of another Legendrian variety @xmath . In this\nchapter we prove that general hyperplane sections of other Legendrian\nvarieties also admit a Legendrian embedding. This gives numerous new\nexamples of smooth Legendrian subvarieties.\n\n### i.1 Hyperplane section\n\n#### i.1.1 Construction\n\nThe idea of the construction is built on the concept of symplectic\nreduction (see \u00a7 D.1.3 ). Let @xmath be a hyperplane in @xmath . By\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwe denote the @xmath -perpendicular to @xmath subspace of @xmath , which\nin this case is a line contained in @xmath . We think of @xmath both as\na point in the projective space @xmath and a line in @xmath . We define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nto be the projection map and for a given Legendrian subvariety @xmath we\nlet @xmath .\n\nWe have the natural symplectic structure @xmath on @xmath determined by\n@xmath (see \u00a7 D.1.3 ). Also @xmath is always Legendrian by Proposition\nD.1 and Lemma B.2 .\n\nNote that so far we have not used any smoothness condition on @xmath .\n\n#### i.1.2 Proof of smoothness\n\nHence to prove Theorem A.14 it is enough to prove that for a general\n@xmath , the map @xmath gives an isomorphism of the smooth locus of\n@xmath onto its image, an open subset in @xmath .\n\nRecall the definition of secant variety from \u00a7 B.9 .\n\n###### Lemma I.1.\n\nLet @xmath , choose such a point @xmath that @xmath and let @xmath be\nthe projection map.\n\n-    If @xmath is smooth, then @xmath gives an isomorphism of @xmath and\n    @xmath .\n\n-    In general, @xmath is 1 to 1 and @xmath is an isomorphism of the\n    smooth part of @xmath onto its image. In particular, the dimension\n    of singular locus of @xmath is greater or equal to the dimension of\n    singular locus of @xmath .\n\nProof. See [ Har77 , Prop.\u00a0IV.3.4] \u2014 the proof is identical in general\nas for the curve case. We only note that if @xmath is smooth, then the\nsecant variety @xmath contains all the embedded tangent spaces of @xmath\n. They arise when limits @xmath approaches @xmath .\n\n@xmath\n\nNow we can prove Theorem A.14 :\n\nProof. By the lemma and the construction in \u00a7 I.1.1 it is enough to\nprove that there exists @xmath s.t. @xmath .\n\nGiven two different points @xmath and @xmath in a projective space we\ndenote by @xmath the projective line through @xmath and @xmath . Let\n\n  -------------------------------------------------------------------------------------------------------------------------------------- -------- -------- -- --\n                                                                                                                                         @xmath   @xmath      \n                                                                                                                                         @xmath   @xmath      \n  so that @xmath is the incidence variety for the secant variety of @xmath . Obviously, @xmath and @xmath is irreducible. Also we let:                        \n                                                                                                                                         @xmath   @xmath      \n                                                                                                                                         @xmath   @xmath      \n  -------------------------------------------------------------------------------------------------------------------------------------- -------- -------- -- --\n\nso that the image of the projection of @xmath onto the last coordinate\nis the locus of \u2018bad\u2019 points. More precisely, for a point @xmath there\nexist @xmath such that @xmath if and only if @xmath .\n\nWe claim that the image of @xmath under the projection is not the whole\n@xmath . To see this note that the condition defining @xmath , i.e.,\n@xmath is equivalent to @xmath and @xmath is an isotropic subspace of\n@xmath . Now either @xmath is a linear subspace and then both the claim\nand the theorem are obvious or there exist two points @xmath such that\n@xmath where by @xmath we mean some non-zero point in the line @xmath .\nTherefore @xmath is strictly contained in @xmath and\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nso the image of @xmath under the projection cannot be equal to @xmath \u00b9\n\u00b9 1 The inequality on the dimensions, although simple, is essential for\nthe proof. An analogous construction for Lagrangian subvarieties in\nsymplectic manifolds is known as symplectic reduction (see \u00a7 D.1.3 for\nlinear algebra baby version of this), but does not produce smooth\nLagrangian subvarieties. .\n\n@xmath\n\n###### Corollary I.2.\n\nLet @xmath be an irreducible Legendrian subvariety whose singular locus\nhas dimension at most @xmath . Let @xmath be the contact distribution on\n@xmath . If @xmath is a general @xmath -cointegrable linear subspace of\ncodimension @xmath , then @xmath does not intersect the singular locus\nof @xmath and @xmath is smooth and admits a Legendrian embedding via an\nappropriate subsystem of linear system @xmath into @xmath .\n\n@xmath\n\nWe sketch some proofs of Examples A.15 :\n\nProof. @xmath surfaces of (a) arise as codimension 4 linear sections of\nLagrangian Grassmannian @xmath . Since the canonical divisor @xmath (in\nother words @xmath is Fano of index 4), by the adjunction formula, the\ncanonical divisor of the section is indeed trivial. On the other hand,\nby [ LM07 , Prop.\u00a09] it must have genus\u00a09. Although we take quite\nspecial (F-cointegrable) sections, they fall into the 19 dimensional\nfamily of Mukai\u2019s @xmath -surfaces of genus 9 [ Muk88 ] and they form a\n13 dimensional subfamily.\n\nThe other families of surfaces as in (b) arise as sections of the other\nexceptional subadjoint varieties: @xmath , @xmath and @xmath . They are\nall Fano of index 6, 10 and 18 respectively and their dimensions are 9,\n15 and 27 hence taking successive linear sections we get to Calabi-Yau\nmanifolds as stated in (c). Further the canonical divisor is very ample,\nso we have examples of general type as stated in (b) and (d).\n\nThe Fano varieties arise as intermediate steps, before coming down to\nthe level of Calabi-Yau manifolds. Also @xmath is a subadjoint variety\nand its hyperplane section is the blow up of a quadric @xmath in a\ncodimension 2 linear section. The Del Pezzo surfaces are the hyperplane\nsections of the blow up of @xmath in a conic curve.\n\n@xmath\n\n### i.2 Linear sections of decomposable Legendrian varieties\n\nAssume @xmath and @xmath are two positive integers, @xmath . Let @xmath\nand @xmath be two symplectic vector spaces, and let @xmath and @xmath be\ntwo smooth, irreducible, non-degenerate, Legendrian subvarieties. In\nthis setup @xmath . Consider the decomposable variety @xmath . Clearly\n@xmath , hence @xmath , while\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTherefore a general codimension @xmath @xmath -cointegrable linear\nsection of @xmath will be smooth of @xmath and admit a Legendrian\nembedding. The purpose of this section is to explain that these newly\nconstructed varieties have essentially different properties than those\nof @xmath and @xmath . Hence our method also allows to produce new\nexamples without dropping the dimension.\n\nLet @xmath be the following line bundle on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nAlso let @xmath be the smooth locus of @xmath .\n\n###### Lemma I.3.\n\n@xmath is isomorphic to @xmath , the total space of the @xmath -bundle\nassociated to @xmath (see \u00a7 C.3 ).\n\nProof. Let @xmath act on @xmath with weight @xmath on @xmath and weight\n@xmath on @xmath . Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand the quotient map:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a principal @xmath -bundle obtained by removing the zero section from\nthe total space of the line bundle @xmath for some integers @xmath and\n@xmath . We have,\n\n  -------------------- -------- -------- -- --\n                       @xmath   @xmath      \n                                            \n  On the other hand,                        \n                       @xmath   @xmath      \n                                @xmath      \n  -------------------- -------- -------- -- --\n\nMoreover via the isomorphism\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthe class of line bundle @xmath is mapped to @xmath . Hence @xmath or\n@xmath . In both cases the total spaces of the line bundles are the same\nafter removing the zero sections (the difference is only in the sign of\nthe weights of the @xmath -action, which we ignore at this point).\n\nTo finish the proof just note that:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand the image of @xmath under the quotient map is equal to @xmath .\n\n@xmath\n\nHence by Lemma C.6 we have:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand the kernel of the epimorphic map is generated by @xmath . If @xmath\nand @xmath , by @xmath we will denote a line bundle on @xmath which\nrepresents the image of @xmath under the epimorphic map.\n\n###### Theorem I.4.\n\nLet @xmath , @xmath , @xmath , @xmath be as above. Let @xmath be the\ncontact distribution on @xmath and let @xmath be a general @xmath\n-cointegrable linear subspace of codimension @xmath . Then @xmath is\nsmooth, admits a Legendrian embedding and has the following properties:\n\n1.  @xmath ;\n\n2.  @xmath ;\n\n3.   We have the restriction map on the Picard groups:\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    If @xmath , then @xmath is an isomorphism. If @xmath , then @xmath\n    is injective.\n\nIn particular, we have:\n\n1.  @xmath is not projectively isomorphic to neither @xmath or @xmath .\n\n2.   If @xmath and @xmath , then @xmath ;\n\n3.   If @xmath and @xmath , where the @xmath \u2019s are line bundles\n    corresponding to some effective divisors, then\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n    for some @xmath corresponding to an effective divisor;\n\n4.   If @xmath , @xmath , @xmath and either @xmath or @xmath is simply\n    connected (for example Fano), then @xmath .\n\nProof. Since @xmath and @xmath are smooth, the singular locus of @xmath\nhas dimension @xmath . By Corollary I.2 , a general coisotropic linear\nsection of codimension @xmath (such as @xmath ) does not intersect the\nsingular locus of @xmath . Therefore @xmath is smooth and has natural\nLegendrian embedding into @xmath .\n\nPart (a) is immediate, since @xmath and neither linear section nor\nprojection changes the degree.\n\nPart (b) follows from Lemma I.3 , \u00a7 C.3 and the adjunction formula (see\n[ Har77 , Prop.\u00a0II.8.20] ).\n\nPart (c) follows from the following generalisation of\nGrothendieck-Lefschetz theorem due to Ravindra and Srinivas [ RS06 ] :\n\n###### Theorem I.5.\n\nLet @xmath be a subvariety of @xmath with singular locus of codimension\nat least 2. Let @xmath be its general hyperplane section and let @xmath\nand @xmath be the smooth locus of @xmath and @xmath respectively. Then\nthe restriction map @xmath is an isomorphism if dimension of @xmath is\nat least @xmath or is injective if @xmath .\n\nSince our variety @xmath arise as repeated hyperplane section and\nprojection of @xmath and the projection part is always an isomorphism of\nsmooth parts, we repeatedly apply the theorem of Ravindra and Sriniva to\nconclude our claim.\n\nPart (d) follows from (a) : @xmath and @xmath are not linear space,\nhence @xmath . Therefore @xmath for @xmath and the varieties cannot be\nprojectively isomorphic.\n\nParts (e) and (f) are immediate consequences of (b) and (c) , since\n@xmath is isomorphic to @xmath .\n\nFinally, Part (g) follows from (c) and from [ Har77 , Ex.\u00a0III.12.6] .\n\n@xmath\n\nTo conclude we give a further series of examples:\n\n###### Example I.6.\n\nApply the theorem to both @xmath and @xmath equal to the @xmath\n-variety. As a result we get @xmath which we denote by @xmath , a smooth\nLegendrian Fano variety of dimension 27, Picard group generated by a\nhyperplane section and of index 8. Now apply the theorem to @xmath being\nthe @xmath -variety again and @xmath . The result, @xmath again has the\nPicard group generated by a hyperplane section and @xmath , hence is\nvery ample. Analogously we construct @xmath and combining this result\nwith Corollary I.2 , we get infinitely many families of smooth\nLegendrian varieties of general type with Picard group generated by a\nvery ample class in every dimension @xmath , where @xmath .\n\n###### Example I.7.\n\nLet @xmath and @xmath be arbitrary. If @xmath and @xmath , then @xmath\nhas Picard group isomorphic to @xmath . Hence we can get a smooth\nLegendrian variety with arbitrarily big Picard rank.\n\n###### Example I.8.\n\nLet @xmath . Let the resulting @xmath be called @xmath . Then @xmath ,\nwhere @xmath is effective. Hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor an effective @xmath . Construct analogously @xmath by taking the\nsection of\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe get that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand for @xmath we get that the canonical divisor can be written as an\nample plus an effective, so it is big. Hence in every dimension, it is\npossible to construct many smooth Legendrian varieties with the maximal\nKodaira dimension.\n\n### i.3 Extending Legendrian varieties\n\nOur motivation is the example of Landsberg and Manivel [ LM07 , \u00a74] , a\nLegendrian embedding of a Kummer K3 surface blown up in 12 points. It\ncan be seen, that this embedding is given by a codimension 1 linear\nsystem. We want to find a Legendrian 3-fold in @xmath whose hyperplane\nsection is this example. Unfortunately, we are not able to find a smooth\n3-fold with these properties, but we get one with only isolated\nsingularities.\n\nWe recall the setup for the construction of the example. Let @xmath be\nthe conormal variety , i.e., the closure of the union of projectivised\nconormal spaces over smooth points of @xmath . Landsberg and Manivel\nstudy in details an explicit birational map\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhich depends on a hyperplane @xmath in @xmath and on a point @xmath .\nAfter Bryant [ Bry82 ] they observe that @xmath (if only makes sense) is\nalways a Legendrian subvariety, but usually singular. Next they study\nconditions under which @xmath is smooth. In particular, they prove that\nthe conditions are satisfied when @xmath is a Kummer quartic surface in\n@xmath in general position with respect to @xmath and @xmath and this\ngives rise to their example.\n\nWe want to modify the above construction just a little bit to obtain our\n3-fold. Instead of considering @xmath as a subvariety in\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwe consider a subvariety @xmath in\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nsuch that the underlying affine cone of @xmath in @xmath is the same as\nthe underlying affine pencil of @xmath . In other words, we take @xmath\nto be the closure of preimage of @xmath under the natural projection\nmap:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBoth @xmath and @xmath are naturally embedded into @xmath . Let @xmath\nbe a hyperplane in @xmath which does not contain @xmath nor @xmath . Set\n@xmath and @xmath to be the point in @xmath dual to @xmath . Assume\n@xmath is chosen in such a way that @xmath .\n\n###### Theorem I.9.\n\nLet @xmath be a subvariety constructed as above from any irreducible\nsubvariety @xmath . On @xmath consider the standard symplectic structure\n(see \u00a7 D.1.5 ) and on @xmath consider the associated contact structure.\nAlso assume @xmath , @xmath and @xmath are chosen as above. Then:\n\n-   @xmath is a Legendrian subvariety contained in the quadric @xmath .\n\n-    Let @xmath be the Legendrian variety in @xmath constructed from\n    @xmath and @xmath as in \u00a7 I.1.1 . Also consider the closure of\n    @xmath as in the construction of [ LM07 , \u00a74] . Then the two\n    constructions agree, i.e., the closure @xmath is a component of\n    @xmath .\n\n-    The singular locus of @xmath equal to the union of following:\n\n    on @xmath the singular points of @xmath ,\n\n    on @xmath the singular points of @xmath and\n\n    outside @xmath the preimage under @xmath of the singular locus of\n    the conormal variety @xmath .\n\nProof. For part (i) consider @xmath , the affine cone over @xmath . The\ncotangent bundle to @xmath is equal to @xmath . Furthermore, by our\ndefinition @xmath , the affine cone over @xmath is the conormal variety\nof @xmath , so a Lagrangian subvariety (see Example D.6 ).\n\nFor part (ii), we choose coordinates @xmath on @xmath and dual\ncoordinates @xmath on @xmath such that in the induced coordinates on\n@xmath the hyperplane @xmath has the equation @xmath . Now restrict to\nthe affine piece @xmath on both @xmath and @xmath . We see explicitly,\nthat the projection map @xmath\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nagrees with the map @xmath from [ LM07 , \u00a74] .\n\nTo find the singularities of @xmath on @xmath as in part (iii) note that\n@xmath is invariant under the following action of @xmath on @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn particular, points of @xmath are fixed points of the action. So let\n@xmath and then @xmath decomposes into the eigenspaces of the action:\n\n  -- -------- -- --------\n     @xmath      (I.10)\n  -- -------- -- --------\n\nwhere @xmath is the fibre of the projection @xmath , @xmath . Clearly\nthe image of @xmath under the projection @xmath is @xmath , so the\ndimension of a general fibre of @xmath is equal to @xmath . Therefore,\nsince the dimension of the fibre can only grow at special points, we\nhave:\n\n  -- -------- -- --------\n     @xmath      (I.11)\n  -- -------- -- --------\n\nAlso @xmath maps @xmath to 0 and @xmath onto @xmath . Therefore:\n\n  -- -------- -- --------\n     @xmath      (I.12)\n  -- -------- -- --------\n\nNow assume @xmath is a smooth point of @xmath . Then adding Equations\u00a0(\nI.11 ) and ( I.12 ) we get:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy (i) the @xmath is equal to the @xmath , so in Equations\u00a0( I.11 ) and\n( I.12 ) all the inequalities are in fact equalities. In particular\n@xmath , so @xmath is a smooth point of @xmath .\n\nConversely, assume @xmath is a smooth point of @xmath , then the tangent\nspace\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\ntherefore clearly @xmath is a smooth point of @xmath .\n\nExactly the same argument shows that @xmath is singular at @xmath if and\nonly if @xmath is singular at @xmath .\n\nFor the last part of (iii) it is enough to note that @xmath is a locally\ntrivial @xmath -bundle when restricted to @xmath .\n\n@xmath\n\n###### Corollary I.13.\n\nGiven a Legendrian subvariety @xmath we can take\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nto construct a Legendrian subvariety in @xmath . Such a variety must be\nthe conormal variety to some variety @xmath (see Corollary E.17 ). Let\n@xmath be the Legendrian variety constructed from @xmath as above. By\nTheorem I.9 (ii), a component of a hyperplane section of @xmath can be\nprojected onto @xmath .\n\nUnfortunately, in the setup of the theorem @xmath is almost always\nsingular (see \u00a7 I.4 ).\n\n###### Example I.14.\n\nIf @xmath is a Kummer quartic surface in @xmath , then @xmath is a\n3-fold with 32 isolated singular points (it follows from Theorem I.9\n(iii) because the Kummer quartic surface has 16 singular points, it is\nisomorphic to its dual and it has smooth conormal variety in @xmath ).\nTherefore by Theorem A.14 a general hyperplane section of @xmath is\nsmooth and admits a Legendrian embedding. By Theorem I.9 the example of\nLandsberg and Manivel is a special case of this hyperplane section. Even\nthough the condition @xmath is a closed condition, it satisfies the\ngenerality conditions of Theorem A.14 and therefore this hyperplane\nsection consists of a unique smooth component that is projected\nisomorphically onto @xmath .\n\n###### Example I.15.\n\nSimilarly, if @xmath is a curve in @xmath satisfying the generality\nconditions of Bryant [ Bry82 , Thm\u00a0G] , then @xmath is a surface with\nonly isolated singularities and its hyperplane section projects\nisomorphically onto a Bryant\u2019s Legendrian curve.\n\n### i.4 Smooth varieties with smooth dual\n\nFurthermore we observe that a classical problem of classifying smooth\nvarieties with smooth dual variety can be expressed in terms of\nLegendrian varieties:\n\n###### Corollary I.16.\n\nUsing the notation of the previous section, let @xmath be the quadric\n@xmath \u2014 see Theorem I.9 (i). On @xmath consider the standard symplectic\nstructure (see \u00a7 D.1.5 ) and on @xmath consider the associated contact\nstructure (see \u00a7 E.1 ).\n\n1.   Let @xmath be a smooth subvariety with @xmath smooth. Let @xmath be\n    as in the above construction. Then @xmath is a smooth Legendrian\n    variety contained in @xmath .\n\n2.   Conversely, assume @xmath is irreducible, Legendrian and contained\n    in @xmath . Let @xmath . Then @xmath and the variety arising from\n    @xmath in the above construction is exactly @xmath . Moreover, if\n    @xmath is smooth, then @xmath and @xmath are smooth.\n\nWe underline that although all the smooth quadrics of a given dimension\nare projectively isomorphic, the classification of quadrics relatively\nto the contact structure is more complicated. The quadric @xmath can\ntherefore be written as @xmath in some symplectic coordinates @xmath on\n@xmath . We note (without proof), that such quadric @xmath determines\nuniquely the pair of Lagrangian subspaces @xmath and @xmath .\n\nProof. Part (i) follows immediately from Theorem I.9 (i) and (iii).\n\nTo prove Part (ii) , consider @xmath . By Lemma B.2 and Proposition D.1\n@xmath is Legendrian. By Corollary E.17 , @xmath is a conormal variety\nto some subvariety @xmath . The next thing to prove is that @xmath\ncoincides with the variety constructed above from @xmath , i.e.\u00a0that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nEquivalently, it is enough to prove that @xmath is @xmath -invariant.\nThis is provided by Theorem A.9 since the quadric @xmath produces\nexactly the required action. Finally, it follows that @xmath . Moreover,\n@xmath is also the conormal variety to @xmath and hence @xmath . If\n@xmath is in addition smooth, then @xmath and @xmath are smooth by\nTheorem I.9 (iii).\n\n@xmath\n\nTherefore the classification of smooth varieties with smooth dual is\nequivalent to the classification of pairs @xmath , where @xmath is a\nquadric which can be written as @xmath in some symplectic coordinates\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\non @xmath and @xmath is a smooth Legendrian variety, which is contained\nin @xmath . So far the only known examples of smooth varieties with\nsmooth dual are the smooth self-dual varieties (see [ Ein86 ] ). From\nthese we get some of the homogeneous Legendrian varieties (see Table I.1\n). Therefore we cannot hope to produce new examples of smooth Legendrian\nvarieties in this way. What we hope for is to classify the pairs @xmath\nas above and hence finish the classification of smooth varieties with\nsmooth dual.\n\n]","output":["Real Legendrian subvarieties are classical objects of differential geometry\nand classical mechanics and they have been studied since antiquity. However,\ncomplex Legendrian subvarieties are much more rigid and have more exceptional\nproperties. The most remarkable case is the Legendrian subvarieties of\nprojective space and prior to the author's research only few smooth examples of\nthese were known.\n  The first series of results of this thesis is related to the automorphism\ngroup of any Legendrian subvariety in any projective contact manifold. The\nconnected component of this group (under suitable minor assumptions) is\ncompletely determined by the sections of the distinguished line bundle on the\ncontact manifold vanishing on the Legendrian variety. Moreover its action\npreserves the contact structure.\n  The second series of results is devoted to finding new examples of smooth\nLegendrian subvarieties of projective space. The contribution of this thesis is\nin three steps: First we find an example of a smooth toric surface. Next we\nfind a smooth quasihomogeneous Fano 8-fold that admits a Legendrian embedding.\nFinally, we realise that both of these are special cases of a very general\nconstruction: a general hyperplane section of a smooth Legendrian variety,\nafter a suitable projection, is a smooth Legendrian variety of smaller\ndimension. By applying this result to known examples and decomposable\nLegendrian varieties, we construct infinitely many new examples in every\ndimension, with various Picard rank, canonical degree, Kodaira dimension and\nother invariants.","Real Legendrian subvarieties are classical objects of differential\ngeometry and classical mechanics and they have been studied since\nantiquity (see [ Arn74 ] , [ S\u0142a91 ] and references therein). However,\ncomplex Legendrian subvarieties are much more rigid and have more\nexceptional properties. The most remarkable case is the Legendrian\nsubvarieties of projective space and prior to the author\u2019s research only\nfew smooth examples of these were known (see [ Bry82 ] , [ LM07 ] ).\nStrong restrictions on the topology of such varieties have been found\nand studied by Landsberg and Manivel ( [ LM07 ] ).\n\nThis dissertation reviews the subject of Legendrian varieties and\nextends some of recent results.\n\nThe first series of results is related to the automorphism group of any\nLegendrian subvariety in any projective contact manifold. The connected\ncomponent of this group (under suitable minor assumptions) is completely\ndetermined by the sections of the distinguished line bundle on the\ncontact manifold vanishing on the Legendrian variety. Moreover its\naction preserves the contact structure. The relation between the Lie\nalgebra tangent to automorphisms and the sections is given by an\nexplicit formula (see also [ LeB95 ] , [ Bea07 ] ). This summarises and\nextends some earlier results of the author.\n\nThe second series of results is devoted to finding new examples of\nsmooth Legendrian subvarieties of projective space. The examples found\nby other researchers were some homogeneous spaces, many examples of\ncurves and a family of surfaces birational to some K3 surfaces. Further\nthe author found a couple of other examples including a smooth toric\nsurface and a smooth quasihomogeneous Fano 8-fold. Finally, the author\nproved both of these are special cases of a very general construction: a\ngeneral hyperplane section of a smooth Legendrian variety, after a\nsuitable projection, is a smooth Legendrian variety of smaller\ndimension. We review all of those examples and also add another\ninfinitely many new examples in every dimension, with various Picard\nrank, canonical degree, Kodaira dimension and other invariants.\n\nThe original motivation for studying complex Legendrian varieties comes\nfrom a 50 year old problem of giving compact examples of\nquaternion-K\u00e4hler manifolds (see [ Ber55 ] , [ LS94 ] , [ LeB95 ] and\nreferences therein). Also Legendrian varieties are related to some\nalgebraic structures (see [ Muk98 ] , [ LM01 ] , [ LM02 ] ). A new\npotential application to classification of smooth varieties with smooth\ndual arises in this dissertation.\n"]}
{"input":"## Chapter \\thechapter Introduction\n\n### 1 Overview of the research in the field\n\nThe discovery of new materials based on condensed matter systems led to\na large number of technological applications mainly because it was\npossible to identify, characterise and classify matter in different\nstates. In all these states, matter is formed by a substantial number of\nconstituents ordered in different phases that correspond to different\ninternal structures or orders, which are associated with symmetries.\n\nThe common framework to describe and classify such emergent phases at\nthe quantum level is based on Landau\u2019s Fermi liquid theory [ 1 ] and the\nGinzburg-Landau theory of symmetry breaking [ 2 ] . In Landau\u2019s Fermi\nliquid theory, the low-energy excitations (near the Fermi surface) in an\ninteracting Fermi liquid can be considered as non-interacting\nquasiparticles with renormalised properties such as mass, velocity, etc.\nHowever, such picture is not longer valid at low temperatures because\nsome systems are unstable towards phases that are characterized by a\nlocal order parameter. At high temperature entropy dominates and leads\nto a disordered state, while at low temperature energy dominates and\nleads to an ordered state. Therefore, an ordered phase appears at low\ntemperature when the system spontaneously loses one of the symmetries\npresent at high temperatures: namely, phase transitions, described by\nGinzburg-Landau theory [ 1 ] , occur where some of the symmetries\npresented in the system are broken. Hence, based on a classification\nmade according to the concept of symmetry breaking, there exist many\npossible arrangements that originate states such crystalline solids,\nwhich break translation symmetry; liquid crystals, which break\nrotational but not translational symmetry; magnets, which break\ntime-reversal symmetry and rotational symmetry of the spin space;\nsuperconductors, which break the more subtle gauge symmetry leading to\nnovel phenomena such as flux quantisation and Josephson effects, among\nothers.\n\nDuring the last decades there has been a bunch of theoretical and\nexperimental discoveries, which do not fit into the above picture. These\nnew phases of matter do not break any symmetry but instead exhibit\nfundamental properties robust to smooth changes in materials parameters\nthat do not change unless the system experiments a quantum phase\ntransition. Such phases, referred to as topological phases , do not have\na local order parameter, but they rather posses a so-called topological\norder parameter [ 3 , 4 ] . Consequently, a description based on the\nGinzburg-Landau theory of symmetry-breaking fails.\n\nIn mathematics, topology studies whether objects can be deformed\nsmoothly into each other, without creating a hole in the deformation\nprocess [ 5 ] . The concept of topological invariance, and therefore\ntopological invariants, was introduced to classify different geometrical\nobjects into broad classes. For instance, 2D surfaces are classified by\ntheir number of holes. In condensed matter physics, on the other hand,\none considers Hamiltonians with an energy gap separating the ground\nstate from the excited states, where a smooth deformation is defined as\na change in the Hamiltonian that does not close the energy gap. If two\ngapped Hamiltonians can be continuously transformed into each other\nwithout closing the energy gap, then it is said that these two systems\nare topologically equivalent [ 6 ] . These classes are distinguished by\na topological invariant called the Chern number [ 5 ] . This Chern\nnumber is a well defined integer in the absence of band crossings\n(gapped subbands). It can therefore only change value when subbands\ncross, or reconnect, as an external parameter is varied. The process\nwhere two gapped Hamiltonians cannot be continuously transformed into\neach other without closing the energy gap, implies a change in the\ntopological invariant, the Chern number, and such process is called\ntopological phase transition . A fundamental consequence of the\ntopological classification of gapped band structures is the existence of\ngapless conducting states at interfaces where the topological invariant\nchanges [ 6 , 7 ] .\n\nIn the late 80\u2019s the discoveries of the Integer Quantum Hall effect\n(IQHE) [ 8 ] and later on its fractional (FQHE) counterpart [ 9 ] were\nwell described by the previous ideas. These experiments investigated the\nmotion of electrons confined to two dimensions and exposed to a strong\nperpendicular magnetic field at low temperatures. The experiments\nreported that this state is characterised by an energy gap between the\nground state and the excited states, a quantised Hall conductance,\n@xmath and a vanishing longitudinal resistance, where integer values of\n@xmath stands for the IQHE and fractional values of @xmath for the FQHE.\nIn the quantum Hall state the bulk of the two-dimensional sample is\ninsulating and the electric current is carried along the edge of the\nsample, only. The flow of this unidirectional current does not exhibit\ndissipation and leads to the quantisation of the Hall conductance.\nAstonishingly, the value of the Hall conductance is determined by the\nratio of two fundamental constants, and therefore is independent of any\nproperties of the material being measured, disorder or other macroscopic\ndetails. Afterwards, it was demonstrated that the quantisation of the\nHall conductance, is related to the Chern number [ 3 ] , and therefore\nthe Hall state is a result of a topological phase. As discussed above, a\nconsequence of the topological classification of gapped band structures\nis the existence of gapless conducting states at the interfaces where\nthe topological invariant changes [ 6 , 7 ] . The electronic states\nbetween the integer Hall effect and vacuum are chiral in the sense that\nthey propagate in one direction only along the edge. Physically, the\nChern number determines the number of these chiral states, which\npropagate along the edge of the sample. Due to this chirality, these\nchiral states are robust against disorder, due to the absence of\ncounter-propagating modes in which to backscatter, and carry electric\ncurrent without dissipation [ 6 , 7 ] .\n\nLater, the two-dimensional quantum spin Hall effect (QSHE) in HgTe\/CdTe\nquantum wells [ 10 , 11 ] and its three-dimensional counterpart in\nbismuth chalcogenides [ 12 , 13 ] were predicted and discovered. The QSH\nstate is the first example of the so-called two-dimensional topological\ninsulator. Unlike the Hall effect described before, which breaks\ntime-reversal symmetry, these new quantum states (QSHE) belong to a new\nclass of materials called topological insulators, which are invariant\nunder time-reversal and in which spin-orbit coupling plays a key role [\n6 , 7 ] . The QSH state is invariant under time-reversal, has a charge\nexcitation gap in the 2D bulk, but has topologically protected 1D\ngapless edge states that lie inside the bulk insulating gap [ 3 , 4 , 14\n] . Unlike the QHS, the edge states in the QSHS are distinct: two states\nin with opposite spin polarization counter propagate at a given edge [\n14 , 15 , 16 , 17 ] . For this reason, these states are also known as\nhelical , where the spin is correlated with the direction of motion [ 16\n] . In this case, time-reversal symmetry prevents the helical edge\nstates from backscattering [ 6 , 7 ] . The spectrum of a QSHS cannot be\nsmoothly deformed into another of a topologically trivial insulator\nwithout helical states, thus representing a new topologically distinct\nstate of matter. These topological insulators can be characterized by a\n@xmath topological invariant, which is determined from the band\nstructure [ 15 , 17 ] . The helical states in the QSHS can be viewed as\ntwo copies of chiral edge states of the QHS related by time-reversal\nsymmetry.\n\nThe search and study of topological phases in superconductors started\neven before topological insulators [ 18 ] , but it was until the\nclassification of topological insulators that similar ideas were used to\ntopologically classify superconductors [ 19 , 20 , 21 , 22 ] . Indeed,\nthere is a direct analogy between insulators and superconductors because\nthe equations that describe quasiparticles in a superconductor or\nsuperfluids like He @xmath , the so-called Bogoliubov-de Gennes (BdG)\nequations, have a similar mathematical formulation as the Dirac equation\nfor topological insulators, with the superconducting gap corresponding\nto the band gap of the insulator. In superconductors, additionally to\nthe time-reversal symmetry in topological insulators, one finds\ncharge-conjugation or electron-hole symmetry. These two symmetries and\nthe product of the two of them (chiral or sublattice symmetry) led to\nthe classification of topological superconductors [ 20 ] . As in\ntopological insulators, here we also find time-reversal invariant and\nbreaking topological superconductors, where the former is classified [\n19 , 20 , 21 , 22 ] by a @xmath invariant in 1D and 2D and a @xmath\ninvariant in 3D, while the latter are classified by an integer [ 23 ] in\na similar fashion as the Quantum Hall insulators [ 3 ] . It is important\nto mention here that when time-reversal is present the systems belong to\nthe BDI class, while for time-reversal breaking to the D class [ 19 , 21\n] . The ones that have attracted much attention during last years are\nthe time-reversal breaking topological superconductors, mainly because\nthey are related with non-Abelian statistics with potential application\nto topological quantum computation [ 24 ] .\n\nIn 2D, the integer classification of topological superconductors is very\nsimilar to that of topological insulators. Indeed, a QHS with Chern\nnumber @xmath has @xmath chiral edge states, while a chiral\nsuperconductor with topological number @xmath has @xmath chiral Majorana\nedge states, which resemble the ones in the QHS but with electron-hole\nredundancy [ 6 , 7 ] . The simplest platform in 2D for a topological\nsuperconductor consists of a spinless superconductor with @xmath\nsymmetry [ 25 , 26 ] , while a spinless superconductor with @xmath\nsymmetry is the simplest one in 1D [ 27 ] . These superconductors\nsupport topological phases that host chiral Majorana edge states\npropagating at the boundary of domain-walls (regions that break\ntime-reversal invariance), while a vortex binds a stable Majorana zero\nmode [ 28 , 23 , 29 ] . Similarly, in 1D the system hosts Majorana zero\nmodes bound at its boundaries with trivial (non-topological) regions\n(one Majorana bound state at each end of the 1D system). These modes\nwere named after Ettore Majorana, who introduced a similar concept in\nthe context of high energy physics, where a Majorana fermion is a\nfermionic particle that is identical to its own anti-particle [ 30 , 31\n] . In condensed matter, superconductors offer a natural platform for\nstudying these exotic modes, since non-degenerate quasiparticle\nexcitations in superconductors at zero energy indeed exhibit such\nMajorana character [ 32 , 29 ] , where a particle is identical to its\nanti-particle. These phenomena have attracted massive theoretical\ninterest during last years mainly because these zero modes represent the\nsimplest case of non-Abelian anyons with profound implications in\ntopological quantum computation [ 27 , 24 , 33 ] . Although the pairing\nsymmetry, @xmath in 1D and @xmath in 2D, of the required superconductors\ncan rarely emerge intrinsically, there are some important cases where\nnature does it for us. The first proposal was the fractional quantum\nHall effect state at filling fraction @xmath [ 23 ] and later experiment\non Sr @xmath RuO @xmath compound provided evidence as the best\nexperimental candidate for topological superconductivity with @xmath [\n34 ] , similar to the A-phase in a superfluid liquid He @xmath [ 35 , 36\n] . Despite the efforts, conclusive signatures of such exotic @xmath\n-wave superconductivity are still missing.\n\nEven though @xmath -wave and @xmath pairings are not robust against\ndisorder and thus scarce in nature, a number of platforms were proposed\nin order to engineer such non-trivial superconductivity. These ideas\nhave attracted enormous attention because they are based on combining\ntraditional well-known effects in condensed matter physics, where all\nexisting proposals are based on @xmath -superconductors, representing an\nadvantage over intrinsic non-trivial superconductivity. Indeed, Fu and\nKane [ 37 ] proposed to proximitize the surface of a 3D topological\ninsulator with an @xmath -wave superconductor, where below the\nsuperconductor critical temperature, the high transparency of the\ncontacts gives rise to proximity-induced superconductivity, thus\ngenerating a 2D topological superconductor. The surface of a topological\ninsulator hosts a single Dirac cone. Then, for any chemical potential\nresiding within the bulk gap there is only one single Fermi surface,\nsince the Dirac cone is non-degenerate, and therefore the spinless\nregime can be achieved. Electrons along this Fermi surface are not\nspin-polarised, so @xmath pairing can be effectively induced on the\nsurface of the 3D topological insulator by a conventional @xmath -wave\nsuperconductor via proximity effect. The key ingredient for inducing\nsuch non-trivial pairing is based on the strong spin-orbit interaction,\nan intrinsic property of topological insulators, which gives rise to\nspin-momentum locking. Time-reversal breaking of any form will generate\nchiral Majorana edge states at the boundary between topologically\nsuperconducting and magnetically gapped regions in the surface of a 3D\ntopological insulator. Moreover, a magnetic field creates a vortex on\nthe surface, which can trap midgap states, and therefore bind a stable\nMajorana zero mode. As it was pointed out previously, these zero modes\npossess special properties that can be used in topological quantum\ncomputation [ 27 , 24 , 33 ] . In fact, a well separated pair of\nMajorana bound states forms a fermionic two-level system, a qubit, which\ncan be either occupied or empty defining a non-local qubit. Remarkably,\nthe quantum information in this qubit is stored non-locally leading to\nlong coherence times, which is a necessary requirement for robust\nquantum computing [ 27 , 24 , 33 ] . The topological protection in these\nsystems relies on the presence of a non-zero gap for quasiparticle\nexcitations [ 24 ] . Following Fu and Kane\u2019s groundbreaking proposal\ndescribed above, many authors pursued alternative approaches towards\nengineering two one dimensional, @xmath and @xmath , superconductors,\nwhere semiconductor-based proposals are actively investigated [ 38 , 39\n] .\n\nAlong these lines, nanowire research has acquired another flavor due to\nthe possibility of creating one-dimensional counterparts of topological\nsurface states. The simplest model for engineering topological\nsuperconductivity in one-dimension is based on spinless fermions, an\nidea developed by Kitaev [ 27 ] . It consists of a chain of spinless\nfermions that supports a topological phase with Majorana bound states at\neach end. Interestingly, it was theoretically shown that it is possible\nto engineer the Kitaev\u2019s model only by considering traditional\ningredients such as s-wave superconductivity and a spin texture that can\nbe provided by strong Rashba spin-orbit and Zeeman interactions [ 40 ,\n41 ] , rotating Zeeman fields [ 42 ] , or RKKY interaction [ 43 ] .\nThese one-dimensional structures are thought to possess several distinct\nadvantages when it comes to fabrication and subsequent detection of the\nMajorana zero modes. Here, the system becomes spinless by applying a\nZeeman field that opens a gap, while strong spin-orbit interaction\nguarantees that there is a finite antiparallel spin component between\nopposite momenta within each electronic band and therefore the induced\nsuperconducting pairing opens a quasiparticle excitation gap. In quantum\nwires, Majoranas occur either at the wire ends or at a domain wall\nbetween topological and non-topological regions of the wire. Unlike\ntheir two-dimensional counterparts, Majorana bound states in nanowires\ndo not require the presence of a vortex in the system, eliminating\ndecoherence which arises from low lying vortex-core quasiparticle\nstates. Most importantly, the topological superconducting phase with\nMajoranas can be reached by varying the chemical potential, which can be\ntuned using gates, or by increasing the external magnetic field. This\ntunability makes nanowires the most promising scheme for the detection\nof Majorana bound states in condensed matter systems. Although a number\nof experiments have been reported [ 44 , 45 , 46 , 47 , 48 , 49 ] ,\nstill new geometries and studies are needed.\n\nIn this thesis we consider the platform based on nanowires with strong\nRashba spin-orbit coupling and Zeeman interaction [ 40 , 41 ] , and then\ninvestigate hybrid superconductor-semiconductor junctions made up of\nthese nanowires.\n\n### 2 Fermionic and Majorana operators\n\nSystems of many-body particles are appropriately described within the\nsecond quantisation formalism, where states are denoted by @xmath and\nidentified by the number of particles @xmath in each single-particle\nstate @xmath . For fermions, @xmath denotes an occupied or empty state.\nNow, we define the fermionic creation operator @xmath , for the single\nparticle state, as an operator which increases @xmath by one if the\nstate @xmath is empty, @xmath , and give zero otherwise, @xmath .\nLikewise, we define the fermionic annihilation operator @xmath , which\ndecreases @xmath by one if the state @xmath is occupied, @xmath , and\ngive zero otherwise, @xmath . Any state can be constructed by successive\napplications of creation operators on the states with no particles, the\nvacuum states. The occupation number operator is defined as @xmath ,\nwhich measures the number of particles in state @xmath . Due to the\nantisymmetry of the fermionic state @xmath , creation and annihilation\noperators fulfil the following anti-commutation relations [ 50 ] ,\n\n  -- -------- -- -----\n     @xmath      (1)\n  -- -------- -- -----\n\nwhere @xmath is the Kronecker delta. Any physical operator can be\nwritten in terms of the creation and annihilation operators we have\ndefined above [ 50 ] . Now, we introduce a new kind of operators based\non a decomposition of a Dirac (complex) fermion in terms of two real\noperators, known as Majorana operators [ 27 ] ,\n\n  -- -------- -- -----\n     @xmath      (2)\n  -- -------- -- -----\n\nwhere a Majorana operator is usually understood as half of a normal\nfermionic operator. In fact, any fermion operator can be defined in\nterms of Majorana operators, and a description in terms of these new\noperators is usually helpful in systems where the number of particles is\nonly conserved modulo @xmath [ 27 ] , as in superconducting systems.\n\nThe inverse transformation of Eqs.\u2009( 2 ) gives us the Majorana\noperators,\n\n  -- -------- -- -----\n     @xmath      (3)\n  -- -------- -- -----\n\nThese new operators @xmath satisfy the following algebra\n\n  -- -------- -- -----\n     @xmath      (4)\n  -- -------- -- -----\n\nAny fermionic operator that satisfies previous conditions is a Majorana\nfermion operator, where the second expression indeed expresses the\nessence of a Majorana fermion: a particle created by the operator @xmath\nis identical to its antiparticle created by @xmath . The term Majorana\nrefers to the real nature of such operators, as in the Majorana\u2019s\nrepresentation of the Dirac\u2019s equation in particle physics [ 30 ] . The\ncondensed matter counterparts, considered here, however, are not\nconnected with the Majorana\u2019s original idea and its application to\nneutrinos [ 30 ] . Despite the little connection between these two\nviews, the terminology is extensively used by the condensed matter\ncommunity. If additionally, the Majorana operator @xmath from Eq.\u2009( 3 )\ncommutes with the systems\u2019s Hamiltonian,\n\n  -- -------- -- -----\n     @xmath      (5)\n  -- -------- -- -----\n\nthen it represents a Majorana zero mode (MZM) and because these zero\nmodes emerge bound to defects it is also common to call them Majorana\nbound states (MBS) [ 51 , 29 , 52 , 53 , 54 ] . This phenomenon has no\nanalogy in particle physics and it is in condensed matter physics that\nsuch Majorana zero modes have acquired an enormous interest due to their\npotential application in topological quantum computation [ 27 ] . Later,\nin Sec. 4 , we will describe in more detail these zero modes in\none-dimensional systems. For now, the main condition for the emergence\nof a Majorana fermion in condensed matter systems is: a particle being\nits own anti-particle . Notice that Eqs.\u2009( 4 ) constitute a linear\ncombination of creation and annihilation operators, thus a natural\nplatform for investigating the emergence of these exotic physics\nincludes superconducting systems as we will see later. Previous\ndiscussion is rather ideal and in realistic physical systems, however,\nthe condition given by Eq.\u2009( 5 ) is hardly fulfilled, and in general one\nhas,\n\n  -- -------- -- -----\n     @xmath      (6)\n  -- -------- -- -----\n\nwhere @xmath represents the separation between two MBSs, and @xmath the\ncorrelation length associated with the Hamiltonian @xmath . Notice that\nfor long enough @xmath , Eq.\u2009( 6 ) indeed implies Eq.\u2009( 5 ), and the\ncondition for a Majorana zero mode is fulfilled.\n\nThe fermion (occupation) number operator, in terms of the Majorana\noperators, read\n\n  -- -------- -- -----\n     @xmath      (7)\n  -- -------- -- -----\n\nthen the expectation values of the number operator follow\n\n  -- -- -- -----\n           (8)\n  -- -- -- -----\n\nFor superconducting systems, the particle number operator @xmath does\nnot commute with the Hamiltonian. Instead, we define the number parity\noperator as\n\n  -- -------- -- -----\n     @xmath      (9)\n  -- -------- -- -----\n\nwhich anti-commutes with the Majorana operators @xmath , and commutes\nwith a Hamiltonian being quadratic in the fermionic creation and\nannihilation operators @xmath . Thus, taking into account Eq.\u2009( 8 ),\n\n  -- -------- -- ------\n     @xmath      (10)\n  -- -------- -- ------\n\nwhich implies that the eigenstates of @xmath can be divided in states\nwith even and odd parity.\n\n### 3 Bogoliubov-de Gennes formalism for superconductivity\n\nAs we have pointed out previously introduction, superconductivity\nprovides a natural platform for investigating Majorana physics in\ncondensed matter systems. Thus, in this part we describe the\nBogoliubov-de Gennes (BdG) formalism of the BCS \u00b9 \u00b9 1 Named after John\nBardeen, Leon Cooper, and John Robert Schrieffer (BCS) [ 55 ] theory of\nsuperconductivity [ 55 ] , which describes quasiparticle excitations in\nsuperconductors. The BCS Hamiltonian emerges from Eq.\u2009( 195 ) by making\nthe assumption that, at low temperatures even a weak attractive\ninteraction \u00b2 \u00b2 2 In conventional (singlet) superconductors, as the one\ndiscussed next, the attraction is due to an exchange of phonons.\nHowever, magnetic interactions, for instance, can also induce attraction\nbetween electrons favouring triplet pairing with a non-zero spin of the\npair. between electrons near the Fermi surface enables the formation of\nbound pairs of time-reversed states ( @xmath ) and ( @xmath ), called\nCooper pairs [ 56 ] . Then, considering only the terms decisive for\nsuperconductivity, we write down the so-called reduced Hamiltonian [ 57\n]\n\n  -- -------- -- ------\n     @xmath      (11)\n  -- -------- -- ------\n\nwhere the first term is the free electron term, @xmath with @xmath the\neffective electron\u2019s mass and @xmath the Planck\u2019s constant, second term\ndescribes the scattering of Cooper pairs with momenta @xmath into\nanother pair with momenta @xmath with amplitude @xmath . In the previous\nHamiltonian, we have introduced the second quantization representation,\nwhere @xmath ( @xmath ) is the creation (annihilation) operator which\ncreates (destroys) an electron with momentum @xmath and spin @xmath .\nExact analytical treatment of Eq.\u2009( 11 ) is complicated and therefore it\nis usual to follow the mean-field approach. This is justified by taking\ninto account the fact that the ground state of the BCS Hamiltonian is a\ncoherent many-body state, and therefore the pair of operators such as\n@xmath can have non-zero expectation values in such ground state, unlike\naveraging to zero in a normal metal. Moreover, since now we deal with a\nhuge number of particles, fluctuations about these expectation values\nare expected to be rather small, and therefore some really small terms\nare neglected. For details see Appendix A . Then, after some algebra, we\narrive at the Hamiltonian in the mean field approximation,\n\n  -- -- -- ------\n           (12)\n  -- -- -- ------\n\nwhere we have defined @xmath , which is in general complex and it\nrepresents the pairing potential or superconducting order parameter, and\n@xmath is taken over the BCS ground state. The symmetry of @xmath is\nintrinsic from the superconducting material, and it can give rise to\nsuperconductors with different properties. See Appendix A for a brief\ndiscussion on singlet and triplet superconducting pairings. Here, we\nconsider @xmath -wave pairing, where electrons of different spin and\nmomenta are paired together as given by Eq.\u2009( 12 ). From here on, we\nconsider @xmath as for @xmath -wave symmetry the pairing potential is\nindependent of @xmath . Now, when studying superconducting systems, it\nis standard to treat electrons and holes at the same footing. Therefore,\nit is appropriate to introduce a new set of spinors @xmath , where\nprevious Hamiltonian can be written as, see Appendix for more details,\n\n  -- -------- -- ------\n     @xmath      (13)\n  -- -------- -- ------\n\nwhere @xmath is known as the Nambu spinor [ 58 ] . Then, previous, and\n\n  -- -------- -- ------\n     @xmath      (14)\n  -- -------- -- ------\n\nis the so-called Bogoliubov-de Gennes Hamiltonian [ 59 ] , where @xmath\nand @xmath , @xmath , are Pauli matrices acting on the electron-hole and\nspin subspaces \u00b3 \u00b3 3 The matrices @xmath and @xmath act on the spin and\nparticle-hole degree of freedom, respectively:\n\n@xmath\n\n. Notice that we have considered the superconducting pairing as @xmath ,\nwhere @xmath is the superconducting phase. Moreover, due to inversion\nasymmetry, @xmath , the spectrum is invariant under @xmath , and the BdG\nHamiltonian can be written as\n\n  -- -------- -- ------\n     @xmath      (15)\n  -- -------- -- ------\n\nwhere @xmath denotes the complex conjugation operation and in the\nfollowing represented by the operator @xmath , and @xmath . Now, we aim\nat diagonalizing @xmath , which is done by finding the eigenvalues of\n@xmath , since the second term in Eq.\u2009( 13 ) is constant and therefore\ncan be neglected. The eigenvalue problem,\n\n  -- -------- -- ------\n     @xmath      (16)\n  -- -------- -- ------\n\ngives rise to the so-called Bogoliubov-de Gennes equations and @xmath is\na four component vector (two for electron and two for hole) [ 58 ] . The\nBogoliubov-de Gennes Hamiltonian, @xmath , is Hermitian and acts on\nspinors @xmath , whose first half is formed out of annihilation\noperators of electrons and the second half out of creation operators of\nthe same electrons. The second half with creation operators of the same\nelectrons can be viewed as annihilation operators of an extra set of\nholes, so that we introduce a redundant description, where the amount of\ndegrees of freedom are doubled in the system. The off-diagonal blocks of\n@xmath couple electrons and holes in opposite spins bands switched by\nthe spin Pauli matrix @xmath via the pairing potential @xmath [ 54 ] .\n\nThis relation between electrons and holes automatically imposes a\nsymmetry on @xmath : the so-called electron-hole or charge-conjugation\nsymmetry. In the spinor basis given by @xmath , each eigenfunction\n@xmath of @xmath at energy @xmath has a copy @xmath at @xmath , where\nthe Pauli matrix @xmath switches electrons and holes [ 54 ] . The action\nof such symmetry converts an electron into a hole and vice versa and it\nis represented by an anti-unitary operator @xmath , where the Pauli\nmatrix @xmath acts on the electron-hole subspaces, @xmath on the spin\nsector and @xmath is the complex conjugation operator. Then, one can\nshow that @xmath . Thus, due to the minus sign, the spectrum of @xmath\nmust be symmetric around zero energy: for every vector @xmath of @xmath\nwith energy @xmath , there is an electron-hole symmetric eigenvector\n@xmath with energy @xmath . Notice that the Hamiltonian given by Eq.\u2009(\n14 ) can also be written in the alternative basis given by @xmath . In\nthis basis, however, the particle-hole symmetry equals @xmath .\nImportant, although the explicit form of the particle-hole operator\ndepends on the spinor basis, both @xmath and @xmath are anti-unitary and\nsquare to @xmath and the physics discussed here does not depend on it.\n\nThe eigenvalues of @xmath , found after solving Eq.\u2009( 16 ), represent\nthe energy spectrum of quasiparticle excitations in a superconductor,\nknown in the literature as Bogoliubov quasiparticles [ 59 , 57 , 58 ] ,\n\n  -- -------- -- ------\n     @xmath      (17)\n  -- -------- -- ------\n\nwhere @xmath represent the dispersion of free electrons in a normal\nmetal, while @xmath represents the @xmath -wave superconducting pairing\npotential, which couples electrons and holes. After finding the\neigenvalues of @xmath , given by previous equations, one is now able to\nthink that there is a new basis in which the mean-field Hamiltonian is\ndiagonal, up to a constant term that we have dropped off, see second\nterm in Eq.\u2009( 13 ), and therefore we can write\n\n  -- -------- -- ------\n     @xmath      (18)\n  -- -------- -- ------\n\nwhere @xmath , @xmath . The operators @xmath are fermionic and create\nquasiparticles with energies @xmath , respectively. The relation between\noperators @xmath and @xmath is given by an unitary matrix formed by the\neigenvectors of @xmath , which gives rise to the Bogoliubov\ntransformation \u2074 \u2074 4 Bogoliubov-Valatin transformation in the Russian\nliterature, although along this thesis we will refer to as Bogoliubov\ntransformation, only. , see Appendix A for further details on the\nderivation,\n\n  -- -------- -- ------\n     @xmath      (19)\n  -- -------- -- ------\n\nwhere @xmath and @xmath are the so-called coherence factors and given\nby,\n\n  -- -------- -- ------\n     @xmath      (20)\n  -- -------- -- ------\n\nand satisfy @xmath . The quasiparticle operators given by Eqs.\u2009( 19 )\nare not independent and indeed one notices that @xmath is connected to\n@xmath , leading to only two independent quasiparticle operators, due to\nthe redundant description we have introduced with the Bogoliubov-de\nGennes description.\n\nThe spectrum shown in Fig. 1 , given by Eq.\u2009( 17 ), is two-fold\ndegenerate due to spin, so that in principle there are four bands. This\ndegeneracy can be lifted by applying a Zeeman magnetic field for\ninstance. At zero pairing potential, @xmath , the spectrum consists of\ntwo parabolas for electrons and two for holes. Superconductivity opens\nan energy gap of @xmath at the Fermi points in the spectrum, giving rise\nto energy bands, which are a mixture of electron and hole. This can be\nfurther seen from Eqs.\u2009( 19 ), where quasiparticles created (destroyed)\nby operators @xmath ( @xmath ) are a linear combination of electron and\nhole @xmath operators with opposite spins and represent the elementary\nexcitations in a superconductor. Notice that the spectrum shown in Fig.\n1 is similar to the one of a band insulator with fine-tuned\nparticle-hole symmetry, with the sole difference that quasiparticles in\na superconductor are mixture of electrons and holes, as given by Eqs.\u2009(\n19 ).\n\nThe energy @xmath is the lowest single-particle excitation energy in the\nsuperconducting state. Since particles are paired to form Cooper pairs\nin the ground state, it is not possible to excite individual\nquasiparticles with energy @xmath , but rather one must break such pairs\nand excite them to the sea of Bogolibov quasiparticles represented by\nthe band @xmath . The minimum of energy needed for breaking a Cooper\npair corresponds to @xmath , and it determines the pairing energy.\nCooper pairs maintain their correlation within a length called the\ncoherence length, and following the BCS theory it is defined as [ 59 ,\n57 , 58 ]\n\n  -- -------- -- ------\n     @xmath      (21)\n  -- -------- -- ------\n\nwhere @xmath is the Fermi velocity in the superconductor and @xmath is\nthe zero temperature superconducting pairing \u2075 \u2075 5 In general, we have\ndefined: @xmath . This equation can be written as @xmath , which\nconstitutes a self-consistency equation for the pairing potential @xmath\nand it is known as the BCS gap equation [ 59 , 57 , 58 ] . Within the\nBCS approach, @xmath , singlet pairing, which do no depend on momentum\n@xmath . Then @xmath , where @xmath given by Eq.\u2009( 17 ). From this\nequation one can calculate the dependence on the temperature of pairing\npotential @xmath . Then, taking the zero temperature limit one can show\nthat in the weak-coupling limit @xmath , where @xmath is the Debye\nenergy that characterises the cutoff of the phonon spectrum, and @xmath\nis the density of states at the Fermi level for electrons of one spin\nprojection. Now, considering that at the critical temperature, @xmath ,\nthe pairing potential vanishes @xmath , one can show that @xmath holds\nfor conventional low- @xmath superconductors. . In previous definition,\nwe have assumed zero temperature and a superconductor without\nimpurities. In alloys with a mean-free path @xmath , the coherence\nlength follows @xmath [ 57 ] .\n\nAnother special result of the BCS theory was on the density of states in\nthe superconductor: @xmath , where @xmath is the density of states at\nthe Fermi energy in the normal state assumed constant within @xmath .\nThen, according to Eq.\u2009( 17 ), @xmath for @xmath exhibits divergences at\nthe gap edges @xmath giving rise to the van Hove singularities of the\nsuperconducting spectrum \u2076 \u2076 6 These peaks are also known as coherence\npeaks. , and zero within the gap of width @xmath , as shown in Fig. 1 [\n59 , 57 , 58 ] . The fact that there are no states within @xmath is\nbased on the nature of our @xmath -wave superconductor and supported by\nthe Anderson\u2019s theorem \u2077 \u2077 7 states that an @xmath -wave superconductor\ndoes not host states within the gap at zero magnetic field [ 60 ] . [ 60\n]\n\nAs we have already discussed, the eigenvalues of the Bogoliubov-de\nGennes Hamiltonian come in pairs due to electron-hole symmetry, and it\nis schematically shown in Fig. 3 . Thus, in a superconductor, the\ncreation of a quasiparticle with energy @xmath is identical to the\nannihilation of a quasiparticle with energy @xmath . This idea can be\nseen in the quasiparticle operators given by Eqs.\u2009( 19 ), where @xmath .\n\nWe have pointed out in Sec. 2 that superconducting systems are natural\nplatforms for investigating the emergence of Majorana physics in\ncondensed matter systems. The main condition we described was based on a\nparticle being its own anti-particle. This property is represented in\nterms of Majorana operators by the relation @xmath . As already\ndiscussed, electron-hole symmetry in @xmath -wave superconductors\nintroduces somehow a similar condition, @xmath . The condition for\nhaving a particle which is its own antiparticle must therefore occur at\nzero energy. However, the problem with @xmath -wave superconductors is\nevidently the spin due to spin degeneracy, and therefore the zero energy\nstate is not robust. Thus, it is not always obvious how to impose this\ncondition in trivial superconductors, such as @xmath -wave, due to spin\ndegeneracy. This is the reason why spinless or spin-polarised\nsuperconductors are required, and in the next section we discuss the\nsimplest proposal in one dimension.\n\n### 4 One-dimensional topological superconductivity\n\nIn this part we introduce the Kitaev\u2019s proposal [ 27 ] , a model to\nengineer Majorana bound states in one-dimensional quantum wires based on\n@xmath -wave superconductivity. It describes a 1D system of fermions\nwith the same spin that can be viewed as spin-polarized or spinless. The\nmodel consists of a chain with N sites, where each site can be empty or\noccupied by a fermion\n\n  -- -- -- ------\n           (22)\n  -- -- -- ------\n\nwhere @xmath represents the onsite energy, @xmath is the\nnearest-neighbor hopping amplitude and @xmath is the superconducting\npairing potential between nearest neighbors sites (assumed real for now)\nand with lattice spacing @xmath , see Fig. 4 (a).\n\nThe operator @xmath creates (destroys) a spinless fermion at site @xmath\n. Fermions obey the following anti-commutation relations\n\n  -- -------- -- ------\n     @xmath      (23)\n  -- -------- -- ------\n\nFor a better understanding of how Majorana zero modes emerge, let us\nfirst consider the situation of a chain with open boundary conditions,\nand then write the Eq.\u2009( 22 ) in the Majorana basis.\n\nAs we have introduced in Sec. 2 , any fermion operator can be defined in\nterms of two new operators, Eqs.\u2009( 2 ) and their inverse Eqs.\u2009( 3 ),\nknown as Majorana operators, see Fig. 4 (b). Although sometimes it does\nnot lead to any novelty but rather it complicates the problem, we will\nshow that in this situation such decomposition leads to interesting\nphysics. Therefore, the Hamiltonian given by Eq.\u2009( 22 ) in terms of\nthese new operators reads (see Appendix Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states for more details on the derivation)\n\n  -- -------- -- ------\n     @xmath      (24)\n  -- -------- -- ------\n\nwhere @xmath , @xmath and @xmath represent hopping amplitudes between\nMajorana fermions of the same fermionic site @xmath , between the first\nMajorana of site @xmath with the second Majorana of site @xmath , and\nbetween the second Majorana of site @xmath with the first Majorana of\nsite @xmath , respectively. Fig. 5 shows the situation we have described\nhere.\n\nThe Hamiltonian given by Eq\u2009( 24 ) exhibit different interesting\nproperties depending on the values of the system parameters, @xmath ,\n@xmath and @xmath . Such properties belong to the emergence of different\nquantum phases. Now, we illustrate the difference between the\ntopological and trivial phases by looking at two special limits.\n\nThe trivial phase: For @xmath , the Hamiltonian given by Eq.\u2009( 24 )\nreads\n\n  -- -------- -- ------\n     @xmath      (25)\n  -- -------- -- ------\n\nPrevious sum tells us that Majorana operators from the same physical\nsite are paired together to form a fermion and the ground state is given\nby all fermion states empty ( @xmath ) or occupied ( @xmath ). See Fig.\n5 (b). At this point nothing special happens and the system is\ntopologically trivial.\n\nThe topological phase: On the other hand, an interesting situation\nhappens when @xmath and @xmath . Indeed, for the former, Eq.\u2009( 24 )\nacquires the following form,\n\n  -- -------- -- ------\n     @xmath      (26)\n  -- -------- -- ------\n\nRemarkably, @xmath does not contain operators @xmath and @xmath and only\nMajorana operators on adjacent lattice sites are coupled, as sketched in\nFig. 5 (c). These operators that do not appear in the Hamiltonian\nrepresent zero-energy Majorana modes localized at the ends of the chain.\nSince such operators are not coupled to any Majorana operator, they\ncommute with the Hamiltonian @xmath .\n\nNow, we can define a new set of fermionic operators that involve only\nMajorana operators included in the Hamiltonian given by Eq.\u2009( 24 ),\n\n  -- -------- -- ------\n     @xmath      (27)\n  -- -------- -- ------\n\nHence, in terms of these new operators, Eq.\u2009( 24 ) reads\n\n  -- -------- -- ------\n     @xmath      (28)\n  -- -------- -- ------\n\nwhich can be further written as\n\n  -- -------- -- ------\n     @xmath      (29)\n  -- -------- -- ------\n\nwith ground state energy @xmath for @xmath .\n\nOne realises that the two unpaired Majorana operators residing at the\nends of the chain, @xmath and @xmath , can be fused into an ordinary\nfermion operator, hence\n\n  -- -------- -- ------\n     @xmath      (30)\n  -- -------- -- ------\n\nThis fermion is delocalised with contributions from both ends of the\nchain, and since it is absent in Eq.\u2009( 28 ) to occupy its quasiparticle\nstate requires zero energy. One can check that the space formed by all\nthe ground states @xmath of @xmath can be written using the operators\n@xmath and @xmath defined above. The occupation number operator is\n@xmath and can be used to label the ground state, which exhibits a\ntwo-fold degeneracy arising from the two possible occupancies @xmath of\nthe ordinary fermion state @xmath . The two ground states indeed are\n@xmath , which satisfies @xmath and the other ground state can be\ndefined as @xmath . One notices that @xmath , implying that @xmath and\n@xmath are two different ground states and that indeed the ground state\ndegeneracy of the Kitaev\u2019s model in the topological regime is two-fold.\n\nThe parity state defines a degenerate two-level system, a qubit, so that\nit can be used to encode quantum information [ 27 ] . Since the\ndefinition of such number operator state takes into account the zero\nenergy fermion operator made of two Majorana operators at the end of the\nchain, the fermion state cannot be measured with any local measurement\non one of the bound states at the end of the chain: such parity state\ncan be accessed by a joint measurement of the two Majoranas. This is the\nreason why it is considered that the information in such a quit is\nstored non-locally [ 27 ] .\n\nUp to this part, we have discussed the two distinct phases that exhibits\nthe Kitaev\u2019s model: a trivial phase and the topological phase with\nunpaired Majorana zero modes located at the end of the chain. Now, in\norder to investigate the properties of the superconducting bulk without\nperturbations from the ends of the chain and to fully describe the two\nphases we have studied previously, we assume that the chain forms a\nclosed loop with periodic boundary conditions. This requires to add an\nextra term in the Hamiltonian given by Eq.\u2009( 22 )\n\n  -- -------- -- ------\n     @xmath      (31)\n  -- -------- -- ------\n\nHence, the Hamiltonian given by Eq.\u2009( 22 ), reads\n\n  -- -- -- ------\n           (32)\n  -- -- -- ------\n\nNotice that the addition of the extra term implies that the second sum\nruns till site @xmath and allows interactions between sites @xmath and\n@xmath . The consideration of periodic boundary conditions is achieved\nby requiring that sites @xmath and @xmath correspond to the same site,\nso that @xmath and @xmath . Indeed, this is the closed loop assumption\nwe have made. It is thus appropriate to consider the Hamiltonian given\nby Eq.\u2009( 32 ) in momentum space @xmath ; and since electrons and holes\nare involved in the problem, it is useful to rewrite the momentum\nHamiltonian in Nambu space, see App. Hybrid superconductor-semiconductor\nnanowire junctions as useful platforms to study Majorana bound states\nfor more details,\n\n  -- -------- -- ------\n     @xmath      (33)\n  -- -------- -- ------\n\nwhere @xmath defines a Nambu operator and @xmath is the so-called\nBogoliubov-de Gennes Hamiltonian,\n\n  -- -------- -- ------\n     @xmath      (34)\n  -- -------- -- ------\n\nwhere @xmath , @xmath , @xmath , and @xmath . The energy spectrum of\n@xmath is then given by\n\n  -- -------- -- ------\n     @xmath      (35)\n  -- -------- -- ------\n\nFor @xmath , the energy gap closes when both elements inside the square\nroot vanish simultaneously: @xmath and @xmath . The former vanishes at\nisolated points @xmath and @xmath . Hence, for @xmath , @xmath , while\nfor @xmath , @xmath . Previous can be understood by considering that the\nsuperconducting pairing @xmath has @xmath -wave nature, being an odd\nfunction in @xmath , thereby Cooper pairs are prohibited to form at\n@xmath or @xmath . This closing of the energy gap represent a special\nkind of phase transition and it is called topological phase transition\nfor reasons that will be understood below. The two lines @xmath separate\ntwo gapped superconducting phases, @xmath and @xmath , that are\nconnected only by making zero the gap of the energy spectrum.\n\nWhen @xmath is much smaller than the relevant energy scales in the\nproblem, these two phases can be distinguished by means of topological\ninvariants as briefly discussed in the introduction. In the case of\none-dimensional superconductors such topological invariant is the\nMajorana number [ 27 ] @xmath , where @xmath represents the number of\npairs of Fermi points in the Brillouin zone of the normal system (\n@xmath ). Remarkably, when restoring superconductivity ( @xmath ) the\nsystem becomes a topological superconductor with Majorana zero modes\nlocated at the ends of the system: odd number of pairs of Fermi points\nindicates the emergence of the topological phase, while even of the\ntrivial one. Notice that this topological invariant cannot be changed in\na continuous way without closing the gap of the spectrum as discussed\nabove. For @xmath , the number of pairs of Fermi points is odd and\ntherefore the Majorana number is @xmath . See Fig. 6 . It represents the\nexistence of Majorana zero modes and confirms the discussion we have\nmade in the geometry with open boundary conditions. On the other hand\n@xmath is a trivial phase. We conclude this part by pointing out that\nalong this thesis we will refer to these Majorana zero modes bounded at\nthe ends of the chain as to Majorana bound states (MBSs).\n\nIn general, for a small but non-zero @xmath , the Majorana bound states\nare not really localise at the ends of the wire, but their\nwave-functions exhibit an exponential decay into the bulk of the wire,\n@xmath , see Eq.\u2009( 6 ). The non-zero spatial overlap of the two Majorana\nwave-functions results in a non-zero energy splitting between the two\nMajorana states. For long enough wires the splitting is very small that\nthe two Majorana states can be considered to be degenerate. Moreover,\nthe Majoranas can also split when the higher-energy states in the bulk\ncome very close to zero energy, hence the Majorana modes are protected\nas long as the bulk energy gap is finite. This follows from the\nparticle-hole symmetry involved in the problem, where the spectrum has\nto be symmetric around zero energy. Therefore, trying to move the\nMajorana zero modes from zero energy individually is impossible, as it\nwould violate particle-hole symmetry.\n\nTherefore, we conclude that Majorana bound states at the end of the\nKitaev\u2019s chain are protected by electron-hole symmetry, and by the\nabsence of zero-energy excitations in the bulk of the wire, and not by\nfine tuning of the model\u2019s parameters.\n\n### 5 Physical realization based on nanowires with Rashba spin-orbit\ncoupling\n\nA promising physical realisation for engineering topological\nsuperconductivity in one dimension based on the Kitaev\u2019s model is\nschematically shown in Fig. 7 . It involves one-dimensional\nsemiconducting nanowires with strong spin-orbit coupling (SOC) (such as\nInSb, InAs), where conventional @xmath -wave superconductivity is\ninduced by proximity effect and an external Zeeman field, perpendicular\nto the spin-orbit axis, drives the system into the topological\nsuperconducting phase with Majorana bound states at the end of the wire\n[ 41 , 61 ] . Along this thesis, we will refer to a nanowire with Rashba\nSOC as to Rashba nanowire. The idea is such that the normal system, with\nzero superconductivity, can support an odd number of pairs of Fermi\npoints for a given chemical potential, similar to the normal system in\nthe Kitaev\u2019s proposal, and therefore when switching on superconductivity\na topological superconducting phase emerges hosting Majorana bound\nstates at each end of the wire. To understand how the topological phase\narises in this system, it is worth to firstly describe the normal state\nof the nanowire.\n\nBefore going further we point out that for investigating topological\nsuperconductivity one really needs a spin texture an @xmath -wave\nsuperconductivity. For the proposal we discuss along this thesis, the\ninterplay of Rashba spin-orbit coupling and Zeeman interaction gives\nrise to the spin-texture, however, other systems as chains of magnetic\natoms [ 62 , 43 , 63 , 64 , 65 ] or topological insulators [ 37 , 66 , 6\n, 7 ] can also lead to similar conclusions. The calculations we present\nalong this chapter and in the rest of this thesis correspond to typical\nparameters for InSb. For reviews see for instance [ 51 , 29 , 52 , 53 ,\n54 ] .\n\n#### Nanowire with Rashba spin-orbit coupling and Zeeman interaction\n\nWe consider a single channel nanowire in one-dimension \u2078 \u2078 8 The radius\nof the wire is small compared to the Fermi wavelength and there is a\nsingle 1D occupied mode. with SOC and Zeeman interaction, whose\nHamiltonian is given by\n\n  -- -------- -- ------\n     @xmath      (36)\n  -- -------- -- ------\n\nwhere the first, second and third terms are the kinetic, spin-orbit\ncoupling and Zeeman Hamiltonians, respectively. We refer to @xmath as to\nthe for the normal system Hamiltonian to distinguish it from the\nsuperconducting one to be described next. The kinetic term reads\n\n  -- -------- -- ------\n     @xmath      (37)\n  -- -------- -- ------\n\nwhere @xmath is the effective electron\u2019s mass in the nanowire and @xmath\nthe chemical potential, which determines the filling of the nanowire.\nThe spin-orbit coupling Hamiltonian is described by\n\n  -- -------- -- ------\n     @xmath      (38)\n  -- -------- -- ------\n\nwhere the spin direction is such that @xmath , @xmath is the vector of\nPauli matrices, @xmath denotes the spin direction along the @xmath\n-axis, and @xmath represents the strength of Rashba spin-orbit coupling.\nThe Zeeman Hamiltonian associated to the magnetic field @xmath along the\nthe nanowire @xmath -axis, perpendicular to the spin-orbit axis,\n\n  -- -------- -- ------\n     @xmath      (39)\n  -- -------- -- ------\n\nwhere @xmath is the Zeeman energy, @xmath is the applied magnetic field,\n@xmath is the wire\u2019s @xmath -factor and @xmath the Bohr magneton. In the\nprevious Hamiltonians, @xmath represents the annihilation operator of an\nelectron at position @xmath with spin @xmath . The fact that we require\nthe Zeeman and the spin-orbit axes to be perpendicular will become clear\nlater. For a discussion on the effects of a parallel field see Appendix\nC . It is appropriate to introduce the Hamiltonian density @xmath\n\n  -- -------- -- ------\n     @xmath      (40)\n  -- -------- -- ------\n\nwhere the Hamiltonian density reads\n\n  -- -------- -- ------\n     @xmath      (41)\n  -- -------- -- ------\n\nand @xmath is the momentum operator. Typical values for InSb nanowires [\n67 ] include the electron\u2019s effective mass @xmath and the spin-orbit\nstrength @xmath meVnm. Mostly along this thesis we will refer to\nHamiltonian densities denoted by @xmath simply as to Hamiltonians\nwithout loss of generality.\n\nThe eigenvalues and eigenvectors of previous Hamiltonian, @xmath , are\nfound by solving the Schrodinger equation @xmath . In terms of plane\nwaves @xmath , see Appendix C for details on the derivation, we get\n\n  -- -------- -- ------\n     @xmath      (42)\n  -- -------- -- ------\n\nwhere @xmath , and @xmath .\n\nIn Fig. 8 , we present the energy dispersion for the nanowire with\nRashba SOC and Zeeman interaction, which is given by Eq.\u2009( 42 ). The top\nleft panel of Fig. 8 shows the energy dispersion of the free electron\nHamiltonian that consists of two superimposed parabolas, one for each\nspin. The value of the chemical potential @xmath is measured from the\nbottom of the band and determines the filling of the nanowire. The\nspin-orbit coupling shift the two parabolas, which cross at zero\nmomentum @xmath , by momenta @xmath and by energy @xmath , see top right\npanel in Fig. 8 . The spin of the two electronic bands is aligned along\n@xmath . Up to this part, one can clearly notices that there is no\npossibility to mimic the topological phase when superconductivity is\napplied in a similar way as it was done in the Kitaev\u2019s approach, since\nfor any @xmath there are two pairs of Fermi points which corresponds to\nan even number and thus to a trivial phase. An external magnetic field,\nif perpendicular to the spin-orbit field, solves this issue (bottom\npanels). Indeed, a Zeeman magnetic field @xmath lifts the spin\ndegeneracy at @xmath by removing the level crossing and opens a gap in\nthe spectrum of @xmath at zero momentum @xmath . When the chemical\npotential @xmath is tuned to be inside the gap opened by the Zeeman\nfield @xmath , the system hosts an odd number of pairs of Fermi points\n(two Fermi points, red filled circles), thus only the lowest band is\npartially occupied and the nanowire behaves as spinless. Therefore, the\nsystem can reach the topological superconducting phase by placing the\nnanowire on a @xmath -wave superconductor. When the chemical potential\nlies within this anti-crossing gap, the system has two Fermi points, as\nopposed to four Fermi points for above or below this gap. This window is\na helical gap , since the two fermi points correspond to counter\npropagating states with different spins (the spin projection is locked\nto momentum) and hence the name helical. Therefore, a nanowire with\n@xmath is helical and along this thesis we will refer to it as to\nhelical nanowire . As mentioned, when the chemical potential lies within\nthis helical gap, the wire is spin polarised and it appears spinless.\nTurning on a @xmath -wave pairing weakly compared to @xmath , then\neffectively @xmath -wave pairs states and therefore drives the system\ninto the topological phase. We will see that the helical regime plays an\nimportant role in normal transport in hybrid junctions (see Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states ) and it is crucial towards the emergence of\nthe topological superconducting phase as we will see later in this\nthesis.\n\nElectrons in the semiconducting nanowire feel an effective\nsuperconducting pairing potential as a result of the so-called proximity\neffect [ 68 , 69 ] . To occur such effect, a good interface between the\nwire and superconductor should be made, so that electrons can tunnel\nbetween these two systems. Within the BCS theory, @xmath -wave\nsuperconducting pairing couples states with opposite momenta @xmath and\nspin and can be described by a phenomenological or reduced Hamiltonian\n\n  -- -------- -- ------\n     @xmath      (43)\n  -- -------- -- ------\n\nwhere @xmath is the pairing potential, which is complex in general but\nfor now we will consider it to be real, and @xmath is the\nsuperconducting phase. The full system is now described by the sum of\nEqs.\u2009( 40 ) and \u2009( 43 ),\n\n  -- -------- -- ------\n     @xmath      (44)\n  -- -------- -- ------\n\nAgain, when dealing with superconducting systems, it is appropriate to\nmake use of the Bogoliubov formalism described in Sec. 3 . Therefore,\nthe full Hamiltonian, @xmath , can be then written in Nambu space by\ndefining new spinors @xmath , so that\n\n  -- -------- -- ------\n     @xmath      (45)\n  -- -------- -- ------\n\nwhere,\n\n  -- -------- -- ------\n     @xmath      (46)\n  -- -------- -- ------\n\nis the Bogoliubov-de Gennes Hamiltonian. The Pauli matrices @xmath and\n@xmath act in spin and electron-hole subspaces, respectively. The energy\nspectrum of Hamiltonian ( 46 ) is then given by\n\n  -- -------- -- ------\n     @xmath      (47)\n  -- -------- -- ------\n\nwhere @xmath is the free electron energy dispersion.\n\nFirst, we analyse the role of superconductivity in the energy spectrum\ngiven by previous equation without analysing the emergence of the\ntopological phase, see Fig. 9 . The band spectrum, additionally to the\nnormal regime, contains an inverted parabola (left-top panel) that\ncorresponds to the kinetic Hamiltonian of a hole due to the Nambu\ndescription. Introducing spin-orbit, (right-top panel), such parabolas\nsplit and cross at @xmath , while the Zeeman field opens a gap of @xmath\nat @xmath , as shown in Fig. 8 . (bottom panels) The superconducting\npairing @xmath modifies the energy spectrum and it opens a gap at each\nFermi point encircled with dashed green circles (bottom row). Moreover,\nnotice that the superconducting pairing opens gaps mixing different\nbands at finite energy (Magenta dashed circles). In the following we\ndiscuss in more detail the dependence of the gaps at @xmath on the\nZeeman field.\n\nEq.\u2009( 47 ) allows us to investigate the evolution of the energy spectrum\nwith the Zeeman field and the emergence of MBSs. It is, however,\ninstructive to write down the Hamiltonians given by Eqs.\u2009( 40 ) and ( 43\n) in the basis constructed from Eqs.\u2009( 42 ) as follows [ 39 , 51 ] ,\n\n  -- -------- -- ------\n     @xmath      (48)\n  -- -------- -- ------\n\nwhere @xmath are operators that annihilates states in the upper\/lower\nbands at momentum @xmath with energy @xmath and @xmath the respective\nnormalized wave-functions calculated previously and given by Eq.\u2009( 42 ).\nFrom here on we will refer to this basis as to helical . We can\ndecompose previous equations into the two spinor components, for details\nsee Appendix C , thus\n\n  -- -------- -- ------\n     @xmath      (49)\n  -- -------- -- ------\n\nIn this basis, the Hamiltonian @xmath is diagonal, see Appendix C . By\nintroducing Eqs.\u2009( 49 ) into Eqs.\u2009( 40 ) and ( 43 ), we get for the full\nHamiltonian in this new basis, see Appendix C ,\n\n  -- -------- -- ------\n     @xmath      (50)\n  -- -------- -- ------\n\nwhere\n\n  -- -------- -- ------\n     @xmath      (51)\n  -- -------- -- ------\n\nrepresent the different pairing functions that arise in our nanowire due\nto the interplay of Rashba SOC and Zeeman interaction when placed on a\n@xmath -wave superconductor. The first line of Eq.\u2009( 50 ) is just the\nnormal Rashba nanowire Hamiltonian, while in the second line, the first\nand second terms associated to @xmath , describe pairing between states\nof the same @xmath band, while the third term associated to @xmath ,\nrepresents pairing between states of different band. Moreover, it is\nimportant to notice that @xmath are odd functions of momentum @xmath ,\nwhile @xmath is even. This implies that @xmath is an interband @xmath\n-wave pairing, while @xmath is an intraband @xmath -wave pairing. Eq.\u2009(\n50 ) can be written in Nambu space, see Appendix C.3 ,\n\n  -- -------- -- ------\n     @xmath      (52)\n  -- -------- -- ------\n\nwhere the Bogoliubov-de Gennes Hamiltonian reads\n\n  -- -- -- ------\n           (53)\n  -- -- -- ------\n\nThe eigenvalues of @xmath are given by\n\n  -- -------- -- ------\n     @xmath      (54)\n  -- -------- -- ------\n\nwhere @xmath are given by Eq.\u2009( 42 ) and @xmath by Eqs.\u2009( 51 ).\n\nAs we have already discussed, the @xmath -wave pairing opens gaps in the\nenergy spectrum given by Eq.\u2009( 54 ), as shown in Fig.\u2009( 9 ). Now, we\nconcentrate on the gaps opened at the Fermi momenta @xmath . The energy\nband that experiments such gap opening is the lower band @xmath .\nTherefore, we define the two gaps opened by @xmath as\n\n  -- -------- -- ------\n     @xmath      (55)\n  -- -------- -- ------\n\nwhere @xmath is the lower band given by Eq.\u2009( 54 ) and @xmath the Fermi\nmomenta given by Eq.\u2009( 274 ). Notice that @xmath corresponds to a low\nmomentum gap @xmath , while @xmath to higher momentum @xmath . Since the\nFermi momenta depend on the spin-orbit, Zeeman interaction and chemical\npotential, the gaps will behave differently for increasing such\nparameters. Experimentally, however, it is more reliable to vary the\nZeeman field @xmath or chemical potential @xmath than the spin-orbit\ncoupling strength @xmath . Thus, it is then natural to assume fixed SOC\nand vary @xmath or @xmath . It is important to notice that the energy\nspectrum given by Eq.\u2009( 54 ) at @xmath reads\n\n  -- -------- -- ------\n     @xmath      (56)\n  -- -------- -- ------\n\nRemarkably, from Eq.\u2009( 56 ), we observe that this lower band is zero,\n@xmath , when Zeeman field reaches @xmath , otherwise it is finite, then\n\n  -- -------- -- ------\n     @xmath      (57)\n  -- -------- -- ------\n\nwhere\n\n  -- -------- -- ------\n     @xmath      (58)\n  -- -------- -- ------\n\nis the critical field at which @xmath . This point signals a phase\ntransition between two gapped phases. It was shown that these two phases\nare topologically different and @xmath defines the topological phase\ntransition into a topological superconducting phase with MBSs [ 41 , 61\n] . As in the Kitaev\u2019s model [ 27 ] , the topological invariant that\ndistinguish these phases is the Majorana number @xmath , where @xmath is\nthe number of pairs of Fermi points in the normal dispersion (see Fig. 8\n). The system host an odd number of pairs of Fermi points when @xmath is\nwithin the helical gap, @xmath . Fig. 10 shows the behaviour of the two\ngaps as function of @xmath for different values of the spin-orbit\ncoupling strength. Observe that the low momentum gap, @xmath , firstly\ndecreases as the Zeeman field increases, reaching zero at @xmath . By\nfurther increasing the Zeeman field, it increases linearly with @xmath .\n\nOn the other hand, the higher momentum gap, @xmath , is strongly\ndependent on the spin-orbit coupling. Indeed, it decreases for a small\nvalues of @xmath but it is finite for all relevant fields. However,\nnotice that for strong spin-orbit coupling the gap @xmath remains\nconstant for all fields.\n\nIn Fig. 11 , we show the energy bands evolution given by Eq.\u2009( 54 ) as\none increases the Zeeman field @xmath . At @xmath , a non-zero\nsuperconducting pairing @xmath opens a gap of @xmath at the Fermi points\n@xmath given by Eqs.\u2009( 274 ) and marked with green circles in Fig. 9 .\nMoreover, it modifies the gap at @xmath as seen in Eq.\u2009( 56 ). We have\nseen that the spin-orbit coupling splits NW states into two subbands of\nopposite helicity at @xmath , see Figs. 8 and 9 . At finite @xmath ,\nthese two subbands, which we label @xmath and @xmath , have spins canted\naway from the SO axis. The s-wave pairing @xmath , expressed in the\n@xmath basis, takes the form of an intraband @xmath -wave @xmath , plus\nan interband @xmath -wave pairing @xmath [ 51 ] , given by Eqs.\u2009( 51 ).\nWithout the latter, the problem decouples into two independent @xmath\n-wave superconductors, while @xmath can be understood as a weak coupling\nbetween them. Now, we identify two sectors, associated to the two\nsubband denoted by @xmath . The energy gaps @xmath and @xmath , defined\nby Eqs.\u2009( 51 ), for each sector @xmath arise as soon as the Zeeman field\nis switched on and have a different dependence on the Zeeman field\n@xmath : the former represents the energy gap at small momentum @xmath ,\nwhile the latter at high momentum @xmath . As one increases the Zeeman\nfield, @xmath remains roughly constant for strong spin-orbit coupling [\n70 , 71 ] , while @xmath gets reduced as can be seen in Fig. 11 (top\nmiddle and top right panels). Remarkably, as the Zeeman field approaches\nthe critical field @xmath , @xmath vanishes (roughly) linearly, see Fig.\n10 . For @xmath , @xmath is zero and becomes centered at @xmath , Fig.\n11 (bottom left panel). By further increasing the Zeeman field @xmath ,\n@xmath reopens and follows @xmath , the zero momentum energy of the\nlowest subband, see Fig. 11 (bottom middle and right panels). This\nclosing and reopening of the energy gap @xmath , also known as gap\ninversion, signals a topological transition, induced by the effective\nremoval of the @xmath sector away from the low-energy problem (see\ndiscussion in next paragraph). Below @xmath the NW is composed of two\nspinless p-wave superconductors, and is therefore topologically trivial.\nAbove @xmath , @xmath is no longer a p-wave gap, but rather a normal\n(Zeeman) spectral gap already present in the normal state, transforming\nthe wire into a single-species @xmath -wave superconductor with\nnon-trivial topology. This phase contains MBSs, protected by the\neffective gap @xmath , at the wire ends. Above a certain field @xmath ,\nthe gap @xmath saturates at @xmath and the physics of superconducting\nhelical edge states in spin-Hall insulators is recovered [ 66 , 72 ] ,\nsee Fig. 10 . Indeed, in the following we show that for high Zeeman\nfields @xmath , the Hamiltonian @xmath given by Eq.\u2009( 50 ) can be\nconnected onto the Kitaev\u2019s model hosting Majorana bound states.\n\nTo have a further insight of the previous discussion, the system has to\nexhibit @xmath -wave pairing symmetry according to the Kitaev\u2019s model.\nThus, it is convenient to project the system Hamiltonian onto the lower\nband @xmath . This is allowed because for reaching the topological phase\none needs strong Zeeman field, then the upper band @xmath , see Fig. 11\n, can be removed from the low-energy problem. Therefore, we can write,\n\n  -- -- -- ------\n           (59)\n  -- -- -- ------\n\nwhere the superconducting pairing potential, or order parameter,\n\n  -- -------- -- ------\n     @xmath      (60)\n  -- -------- -- ------\n\nhas @xmath -wave symmetry. Now, we write previous Hamiltonian in the BdG\nform,\n\n  -- -------- -- ------\n     @xmath      (61)\n  -- -------- -- ------\n\nwhere\n\n  -- -------- -- ------\n     @xmath      (62)\n  -- -------- -- ------\n\nwhose energy spectrum is given by\n\n  -- -------- -- ------\n     @xmath      (63)\n  -- -------- -- ------\n\nPrevious equation is in essence the energy spectrum of a @xmath -wave\nsuperconductor, thus being in concordance with the Kitaev\u2019s model\ndescribed in previous section. Therefore, it is not a coincidence that\nthe model given by the Hamiltonian Eq.\u2009( 44 ) indeed describes\nMajorana-like physics when @xmath .\n\nFrom the point of view of topology, the infinite, Zeeman polarised,\nsingle-channel semiconducting nanowire in proximity to a conventional\n@xmath -wave superconductor, described in this section, belongs to the\nso called one-dimensional D class [ 73 ] , which has an invariant @xmath\nthat may be @xmath (topologically trivial) or @xmath (non-trivial). This\nsystem undergoes a band topological transition from @xmath to @xmath\nwhen the Zeeman splitting @xmath , perpendicular to the spin-orbit axis,\nexceeds a critical value @xmath , where @xmath and @xmath are the wire\u2019s\nFermi energy and induced gap respectively.\n\nAn interface between a @xmath semi-infinite wire (with @xmath ) and\nvacuum ( @xmath ) binds a single subgap state [ 20 , 74 ] . The state is\npinned to zero energy by the particle-hole symmetry of the Bogoliubov-de\nGennes description, locked strictly midway between electrons and holes;\nit satisfies the Majorana condition @xmath , and is hence known as a\nMBS. This robust pinning is broken when two MBSs are brought within a\nfinite distance of each other, i.e. in a topological superconducting\nnanowire of finite length @xmath , see left panel in Fig. 12 . Both MBSs\nthen overlap and hybridize into a single conventional fermion of finite\nenergy, or Andreev bound state. Right panel in Fig. 12 presents the\nevolution of the wire spectrum with @xmath , showing the energy\nsplitting of MBSs for @xmath . The energy splitting can be small for\nlong enough wires, though strictly speaking it is non-zero for any\nlength [ 75 , 70 , 71 , 76 ] . The MBSs become merely quasi-stationary\nstates, with their energy splitting representing a Rabi frequency at\nwhich one oscillates into the other. See Chap. 10 for details on the\ncalculation of the spectrum presented in Fig. 12 .\n\nThe wave-functions of the MBSs exponentially decay into the bulk of the\nsuperconducting wire [ 76 , 77 ] and can be approximately write down for\n@xmath as @xmath , where @xmath is the effective coherence length and\n@xmath the effective Fermi wave vector associated with the zero-mode\nsolution [ 76 ] . The relevant decay length characterising this overlap\nis the effective coherence length @xmath and we refer to it as to the\nMajorana localisation length denoted later by @xmath , which tells us\nhow well are MBSs localised at the ends of the wire. For a finite\nspatial overlap between their wave-functions, the MBSs acquire a finite\nenergy and they are not longer true zero modes, thus for @xmath [ 76 ]\n\n  -- -------- -- ------\n     @xmath      (64)\n  -- -------- -- ------\n\nwhere @xmath is the effective electron\u2019s mass in the nanowire, and\n@xmath is the wire\u2019s length. Notice that such energy splitting exhibits\nan oscillating behaviour in the system parameters @xmath and @xmath\nthrough @xmath . We also notice that for sufficiently long wires, @xmath\n, the energy splitting can be very small so that it can be assumed to be\nzero @xmath .\n\nTo conclude this section, we remark that we have described in detail the\nplatform for engineering Majorana bound states in nanowires with strong\nRashba spin-orbit coupling (SOC) in proximity to an @xmath -wave\nsuperconductor, where an external Zeeman field, perpendicular to the\nspin-orbit axis, drives the system into the topological superconducting\nphase [ 41 , 61 ] . The topological phase transition is controlled by\nincreasing the Zeeman field and the topological phase is determined by\nthe presence of two Majorana bound states, one at each end of the wire,\nwhich can be splitted in energy or not depending on the relation between\nthe length of the wire and the Majorana localisation length.\n\n### 6 Experimental signatures\n\nAlthough recent experiments have focused on diverse theoretical\nproposals, in this section we aim at giving a brief description of the\nones based on Rashba nanowires in proximity to @xmath -wave\nsuperconductors [ 41 , 61 ] . This platform has attracted serious\nattention mainly because all the ingredients are well-known phenomena in\ncondensed matter. As we have explained in the two previous sections,\naccording to theory, signatures Majorana physics in quantum wires\nimplies to find Majorana bound states at each end of the wire. For the\nsystem to host such zero modes, there has to be a topological phase\ntransition as the applied external Zeeman field increases, which is\ndistinguishable by observing the closing and reopening of the gap.\n\nFollowing these ideas, a nanowire with Rashba SOC can be partially\nplaced on a @xmath -wave superconductor, where the portion in contact\nwith the superconductor acquires superconducting correlations by the\ninduced proximity effect and we refer to it as to the superconducting\npart S, while the other portion of the wire does not contain\nsuperconductivity and therefore is refereed to as to the normal part N.\nWhen the applied Zeeman field exceeds the critical field, @xmath , the S\npart becomes topological superconducting and therefore host Majorana\nbound states emerge at its two ends, one at each end. This configuration\ngives rise to the hybrid geometry known as NS junction, and offers a\nnumber of advantages over superconducting nanowires in that it allows\nfor contacting the junction with gates and thus tune its chemical\npotential. Indeed, superconductor-semiconductor hybrid devices can be\nassembled from semiconductor nanowires individually contacted by\nsuperconductor electrodes. Below the superconductor critical\ntemperature, the high transparency of the contacts gives rise to\nproximity-induced superconductivity. The nanowires form superconducting\nweak links operating as mesoscopic Josephson junctions with electrically\ntunable coupling [ 78 ] . This allows to study a wealth of fundamental\nphysical phenomena in a tunable and well controlled manner. Now, the\nmatter is how one should proceed in order to measure the presence of\nthese MBSs or at least one of them in NS junctions.\n\nIn a NS junction, the S part possesses a superconducting order\nparameter, which make the energy spectrum in S gapped, while N remains\nmetallic. An electron traveling towards the NS interface is not\ntransmitted since there are no states within the gap of S, but it is\nrather reflected as a hole. This process is known as Andreev reflection\nand will be discussed in more detail in Sec. 9 . The general relation\nbetween the conductance of a single mode NS junction and the Andreev\nreflection probability is given by @xmath , where the factor of @xmath\narises because the Andreev reflection of an electron into a hole doubles\nthe current and @xmath is the Andreev reflection probability which\ndepends on the nature of the interface [ 79 ] . Since @xmath , there is\nno time-reversal symmetry and therefore Kramers degeneracy does not\napply. The system still possesses particle-hole symmetry, which requires\nthat any @xmath is two-fold degenerate (Beri degeneracy [ 80 ] ) with\nexceptions for @xmath and @xmath , which may be non-degenerate. It was\nshown that a right-moving electron from N experiments an Andreev\nreflection probability from a MBS (a zero energy state within the gap)\nwhich is non-degenerate and pinned to unity, @xmath , thus producing a\nquantised conductance of @xmath at zero energy (the energy of the MBS),\nwhereas without the MBS the conductance vanishes [ 81 , 82 , 83 , 84 ,\n29 ] . On the other hand, all other Andreev reflected modes are two-fold\ndegenerate and the conductance become @xmath . Therefore, measuring the\nconductance at zero energy constitutes a powerful tool for detecting the\npresence or absence of MBSs in a NS hybrid junction when MBSs emerge at\nthe ends of the S region.\n\nBy applying electrostatic gates at the NS contact, one makes a tunnel\njunction between the N and S parts of the NS junction. Then, under an\napplied voltage bias @xmath across the junction, we can measure the\ntunneling current @xmath through this weak link. In the tunneling regime\nthe differential conductance @xmath is proportional to the density of\nstates at the end of the superconducting region, which is adjacent to\nthe tunneling contact. The density of states, to a very good\napproximation, measures the conductance of a NS junction. Therefore, one\nexpects that as the Zeeman field increases the differential conductance\n@xmath should trace the gap closing and reopening, which leads to the\ntopological superconducting phase with a peak at @xmath of high @xmath .\nThis peak is referred to as zero-bias peak (ZBP) or zero-bias anomaly\n(ZBA). During the last years, this approach was extensively pursued\nexperimentally in hybrid NS junctions made of nanowires, looking for the\nzero-bias peak in the conductance across such junction when the S part\nbecomes topological.\n\nWe point out that the observation of a zero-bias peak in the conductance\nis not the unique condition for testing MBSs in nanowires. Stronger\nevidence could be provided by the observation of non-Abelian\ninterference (braiding) [ 85 ] , or by transport in phase-sensitive\nsuperconductor-normal-superconductor (SNS) junctions. The latter\napproach, which typically involves the measurement of an anomalous\n\u201cfractional\u201d @xmath -periodic ac Josephson effect [ 86 , 66 , 87 ] , is\nmuch less demanding than performing braiding. Realistically, however,\nthe fractional effect, detected through, e.g., the absence of odd steps\nin Shapiro experiments [ 87 , 88 , 89 , 90 ] , may be difficult to\nmeasure (dissipation is expected to destroy it in the steady state), or\nmay even develop without relation to topology [ 91 ] . Although it has\nbeen shown that the @xmath periodicity survives in the dynamics, such as\nnoise and transients [ 72 , 92 , 93 ] , simpler experimental probes of\nMBSs are extremely desirable. On the other hand, it has been proposed to\nemploy T-junctions in order to test braiding statistics in one-dimension\n[ 94 ] , however, on the experimental side it still represents a major\nchallenge than measuring the zero-bias peak in conductance.\n\nRegarding the materials, InAs [ 46 ] and InSb nanowires [ 95 ] are known\nto have strong spin-orbit interaction, @xmath meVnm and @xmath meVnm,\nand large @xmath -factor [ 46 , 96 ] . Indeed, the @xmath -factor in\nbulk InAs and InSb is very large, @xmath and @xmath , respectively,\nwhich makes such nanowires to accept high Zeeman fields as a result of\nthe applied magnetic field. Indeed, when a good proximity effect between\nthe nanowire with an s-wave superconductor is generated, the large\n@xmath -factors allow for exceptionally weak fields to drive the wire\ninto a topological superconductor with MBSs. The strong spin-orbit\ncoupling further allows this topological state to possess a relatively\nlarge gap that remains robust against disorder [ 97 ] . A relatively\ngood proximity effect was measured in both systems [ 69 , 98 , 99 ] ,\nmaking them promising for the search of MBSs.\n\nFollowing these ideas, the first evidence was reported by the Delft\ngroup [ 67 ] . In this experiment the geometry was similar to the NS\njunctions described above. They employed an InSb semiconductor\nquasi-one-dimensional wire with strong spin-orbit coupling partially\ndeposited on a substrate equipped with gates and contacted with\nsuperconducting (niobium titanium nitride) and normal metal electrodes\nas shown in Fig. 13 (b). The presence of the MBS at the end of the\nsuperconducting section adjacent to the NS interface of the wire was\ntested by measuring the tunnelling current @xmath through the weak link,\ncreated between the superconducting and normal electrodes, under an\napplied bias @xmath . In this setup, the differential conductance @xmath\nis proportional to the density of states in the superconducting end\nadjacent to the tunnelling contact. By increasing the magnetic field, a\nclear zero-bias peak was observed for a range of magnetic fields of\n@xmath T @xmath mT, and disappearing for higher fields, see Fig. 13 (a).\nThese results support the existence of MBSs in NS junctions, however, a\nnumber of features related to the emergence of MBSs are missing. Indeed,\nthe value of the zero-bias quantized conductance was smaller than the\npredicted, @xmath ), and the experiment does not show the gap closing\nand reopening for entering into the topological phase, when such\nzero-bias peak emerge, as predicted by theory. Theoretical studies\nattribute this softness of the induced superconducting gap to disorder\nat the semiconductor-superconductor interface [ 100 ] and to multiple\nsubbands [ 101 , 102 ] .\n\nAdditional experimental observations of the existence of Majorana\nquasiparticles were subsequently reported by several independent groups,\nshowing the celebrated zero-bias peak at non-zero magnetic field [ 45 ,\n46 , 47 , 48 , 49 ] . All these experiments point towards the clear\nevidence of MBSs in NWs, although it was shown that detection of sub-gap\nzero modes through zero-bias peaks in transport can be obscured, or even\nmimicked by other effects, such as owing to Kondo physics [ 103 , 47 ,\n48 , 104 ] , disorder [ 101 , 105 , 83 , 106 ] , smooth confinement [ 70\n, 107 ] , parity crossings of Andreev levels [ 49 , 104 ] .\n\nIn all previous experiments a characteristic zero-bias tunnelling peak\nappearing at finite magnetic field have been reported, where in all\ncases a soft gap is also seen, indicated by sizable subgap conductance [\n45 , 46 , 47 , 48 , 49 ] . As mentioned before, preliminary studies\nattribute it to disorder at the semiconductor-superconductor interface [\n100 ] , but also the emergence of quasiparticle states in the gap tends\nto destroy topological protection, since quasiparticles occupying such\nsub-gap states will inevitably participate affecting the quantum state\nwhen braiding the MBSs and thus inducing decoherence effects [ 108 , 109\n] . Their findings were partially in agreement with the existence of\nsuch zero energy Majorana bound states [ 110 , 111 , 81 ] , and\nsubsequent theoretical explanations showed that these features, as the\nnon-closing of the gap, can be understood with realistic NS calculations\n[ 70 , 112 , 71 , 52 ] .\n\nNew experiments have been also reported within the last year, where in\nnanowires the soft-gap problem was recently resolved by growing Al\nsuperconductor epitaxially on InAs nanowires (see Fig. 14 ), yielding\ngreatly reduced sub-gap conductance [ 113 , 114 , 115 ] and later it was\nrealised in a two dimensional semiconductor-superconductor\nheterostructure [ 116 ] . Further studies on these materials showed\nimproved Majorana signatures [ 117 ] . The InAs nanowire still contain\nresidual disorder, which shows up as unintentional quantum dots in\ntransport measurements [ 103 , 49 , 113 ] .\n\nThen, as an alternative material, the Delft group has recently reported\nnew experiments showing significant improvements in reducing disorder in\na high-quality interface between an InSb nanowire and NbTiN\nsuperconductor [ 118 ] (see Fig. 15 ). They demonstrate ballistic\ntransport and induced hard-gap with strongly reduced subgap density of\nstates by gate tuning the device to a tunnel probe. In their experiment,\nthe induced zero-bias peak is consistent with theory and exclude other\nexplanations based on disorder effects. The choice for InSb nanowires is\nfully justified. Indeed, in general, InSb nanowires are cleaner (showing\nhigher electron mobility [ 119 , 120 ] ) than InAs. Additionally InSb\nhas a larger @xmath -factor (about @xmath times larger), thus reducing\nthe required external magnetic field needed to induce the topological\nphase transition.\n\nAccording to previous discussion, recently there has been a remarkably\nprogress in fabrication of junctions with hard gaps and good\ntransparency in the single-channel limit. Therefore, it is natural to\nask what can we learn from these good junctions beyond the zero-bias\nparadigm and investigate new geometries such as SNS junctions, which\noffer a number of advantages over NS junctions. These issues are\ninvestigated along this thesis.\n\nThe spin-texture needed for entering into the topological\nsuperconducting phase and generated by the SOC and Zeeman fields in\nprevious description can be also mimicked by a chain of magnetic atoms\nwith an spatially modulated spin arrangement [ 63 , 65 , 43 , 64 , 121 ,\n122 ] . Similar ideas allowed Nadj-Perge et al. [ 123 ] to investigate\nan alternative scenario, where Fe atoms were placed on a conventional\n@xmath -wave superconductor (Pb) with strong SOC. Here, the topological\nsuperconducting phase arises from the ferromagnetic interaction between\nFe atoms and the strong SOC in the superconductor. Nadj-Perge et al. [\n123 ] reported preliminary evidence of zero bias peaks in the density of\nstates, by Scanning tunnelling microscopy (STM), associated with the\nends of the magnetic chains as possible Majorana signatures. Still, it\nhas triggered interesting discussions on the physical origin of these\npeaks due to the short values for the Majorana localization lengths.\nAlthough there are some possible theoretical explanations [ 124 ] ,\nadditional investigations are needed for supporting their findings. More\nrecently, Pawlak et al. [ 125 ] investigated the spatial and electronic\ncharacteristics of topological superconducting chains of iron atoms on\nthe surface of Pb(110) by combining STM and atomic force microscopy\n(AFM). They demonstrated that the Fe chains are mono-atomic and exhibit\nzero-bias conductance peaks at their ends, which are interpreted as\nsignature for the Majorana bound state. It is also shown another strong\nfingerprint associated with the localization of the Majorana\nwavefunction, which exhibits an exponential decay. In this experiment\nthe proximity gap is driven into the topological phase by a spin texture\nwhich gives rise to a helical field in a similar fashion as in [ 123 ] .\n\n### 7 This thesis\n\nAs discussed in previous sections, there has been an increasing\ntheoretical and experimental interest towards real signatures for\nengineering one-dimensional topological superconductivity and therefore\nMajorana bound states. In spite of the efforts, conclusive experiments\nare urgently needed, and further theoretical analysis has to be done in\nmore complex geometries such as Superconductor-Normal\nmetal-Superconductor (SNS) junctions [ 126 , 127 ] . This geometry has a\nnumber of advantages including the possibility of studying supercurrents\n[ 128 , 78 , 98 , 99 , 129 ] , or direct spectroscopy of Andreev bound\nstates (ABS) [ 130 , 131 , 132 , 133 , 134 , 135 , 136 , 49 , 137 ] . As\nwe shall discuss along this thesis, this latter technique can be used,\nin principle, to directly monitor the detailed evolution from the\ntrivial to the topological phase. Moreover, it contains information\nabout the peculiar dependence of Majorana bound states hybridization\nwith superconductor phase difference, despite not requiring any external\ncontrol on it. In the following we describe our main findings.\n\n#### Chapter 2\n\nIn this chapter we provide an introduction to the technical part of this\nthesis. Indeed, an important part of this thesis was devoted to\ninvestigate an appropriate scheme for modelling hybrid junctions. For a\ncomplete description, we firstly introduce the classification of SNS\njunctions based on the comparison between the length of the normal N\nregion, @xmath , and the superconducting coherence length, @xmath :\nshort junctions for @xmath , and long for @xmath . Then, we show in a\nsimple example how the concepts of Andreev reflection, Andreev bound\nstates and Multiple Andreev reflections emerge. Later, we concentrate on\ngiving the necessary details for modelling superconducting nanowires and\nhybrid one-dimensional NS and SNS junctions made of nanowires with\nRashba SOC and Zeeman interaction. Afterwards, we make a detailed\ncalculation of Andreev bound states and Josephson currents in SNS\njunctions made of Rashba nanowires with Zeeman interactions and induced\n@xmath -wave superconductivity. Here, we show the detailed evolution of\nthe Andreev bound states from the trivial phase into the topological\nphase with Majorana bound states. Moreover, we show that the Josephson\nand the critical current exhibit non-trivial signatures when Majorana\nbound states are present, which should be experimentally accessible with\nthe outstanding advance in fabrication techniques.\n\n#### Chapter 3\n\nMotivated by the experiments based on nanowires hybrid junctions coupled\nto superconductors, we focused on the study of transport in voltage\nbiased short SNS Josephson junctions made of NWs with strong spin-orbit\ncoupling, as the system undergoes into the topological superconducting\nphase for increasing the Zeeman field [ 138 ] . In this work, by means\nof the Keldysh Green\u2019s function technique, we proposed the multiple\nAndreev reflection (MAR) and critical currents as an alternative and\npowerful tool to study the topological transition. This is possible by\nthe direct effect that gap inversion, MBS formation and fermion-parity\nconservation have on the MAR current at various junction transparencies.\nOn the other hand, we also showed that the critical current remains\nunexpectedly finite for all Zeeman fields due to a significant continuum\ncontribution, and exhibits an anomaly at the topological transition that\ncould be experimentally traced.\n\n#### Chapter 4\n\nTo support new experiments and provide further insights towards the\norigin of Majorana-like physics in hybrid\nsuperconductor-semiconductor-superconductor junctions, we made a\ndetailed study on the role that confinement and helicity have on normal\ntransport and on the sub-gap Andreev spectrum in short and long SNS\njunctions made of semiconducting nanowires (NWs) with strong Rashba\nspin-orbit coupling [ 139 ] . We identified different normal transport\nregimes that lead to very interesting physics when superconducting leads\nare attached. Indeed, we found that a long junction with a helical\nnormal section, but still in the topologically trivial regime, supports\na low-energy sub-gap spectrum consisting of multiple-loop structures and\nparity crossings that smoothly evolve towards Majorana bound states as\nthe Zeeman field exceeds its critical value. This suggests an\ninteresting connection between sub-gap parity crossings in helical\njunctions in the trivial phase and Majorana bound states in the\ntopological one.\n\n#### Chapter 5\n\nMotivated and ispired by our previous work, where we found a connection\nbetween sub-gap parity crossings in helical junctions, in the trivial\nphase, and Majorana bound states, in the topological phase, we have\ninvestigated a novel approach to engineer Majorana bound states in\nnon-topological superconducting wires [ 140 ] . The recipe of our scheme\nconsists that instead of inducing a topological transition in a\nproximized Rashba NW, we propose to create a sufficiently transparent\nnormal-superconductor junction on a Rashba wire, with a topologically\ntrivial superconducting side and a helical normal side. The strong\ncoupling to the half-metallic environment forces a single long-lived\nresonance to emerge at precisely zero energy above a threshold\ntransparency, which evolves as the transparency is increased further\ninto a stable state localised at the junction. The robust zero energy\npinning is protected by electron-hole symmetry, and it is not the result\nof any fine tuning, due to eigenstate bifurcation of the scattering\nmatrix poles at exceptional points. We show that relevant transport and\nspectral properties associated to these zero energy states, here dubbed\nexceptional point Majorana bound states, are indistinguishable from\nthose of conventional Majorana bound states.\n\n#### Chapter 6\n\nIn this Chapter we analyse screening properties in superconducting\none-dimensional nanowires with SOC and with Zeeman interaction. Our\nstudy is based on the linear response theory using the Bogoliubov De\nGennes formulation of excitations in a superconductor and on the Randon\nPhase Approximation (RPA) approach. Firstly, we calculate the\ndensity-density response function and then we apply it to obtain the RPA\ndielectric function and the screening properties of these wires. This\ncalculation is relevant for experiments trying to measure Majorana bound\nstates and their non-trivial overlap (which might change depending on\nthe screening potential inside the wire).\n\n## Chapter \\thechapter SNS junctions made of nanowires with spin-orbit\ncoupling999The results of this chapter are being prepared for\npublication.\n\nIn this chapter, we formally introduce hybrid Normal\nmetal-Superconductor (NS) and Superconductor-Normal metal-Superconductor\n(SNS) junctions. For a better understanding, we firstly describe a\nsituation where the spin-orbit coupling and the Zeeman interactions are\nneglected. Here, we discuss the basic phenomena in these systems such as\nAndreev reflection (AR), Andreev bound states (ABSs) and Multiple\nAndreev reflections (MARs) based mainly on scattering arguments, and\nthen we classify SNS junctions depending on the length of the normal\nregion with respect to the superconducting coherence length.\n\nLater, we provide a full tight-binding description for modelling\nsuperconducting nanowires, NS and SNS junctions made of one-dimensional\nsemiconducting nanowires with SOC in presence of Zeeman interaction,\nwhere superconducting correlations are induced via proximity effect.\nAfterwards, we investigate the ABSs formation and the emergence of\nMajorana bound states in short and long SNS junctions, as well as in\nsuperconducting nanowires and NS junctions. In this part, we present the\nAndreev bound states as function of the superconducting phase difference\nfor different values of the Zeeman field, spanning the trivial and\ntopological phases. Then, we concentrate on the Josephson current\ndependence on the superconducting phase difference, calculated from the\nAdreev spectrum in short and long SNS junctions. We show that the\npresence of MBSs in the topological phase is a distinguishable signature\nin both the Andreev spectrum and the Josephson current despite of being\n@xmath periodic. We also present the critical current as a function of\nthe Zeeman field, which allows to make a detailed study of the\ntopological transition and trace the behaviour of the topological gap,\nwhich after the band inversion gives rise to the topological phase with\nMBSs. We report that the topological transition point is a robust\nfeature, which we expect to be distinguishable from other mechanisms in\nreal experiments.\n\n### 8 Introduction\n\nAll physical proposals for investigating the emergence of Majorana bound\nstates (MBSs) include @xmath -wave superconductors. In the previous\nchapter, we have introduced the platform based on nanowires with strong\nspin-orbit coupling (SOC) placed on a trivial @xmath -wave\nsuperconductor. Assuming good contact between the superconductor and the\nnanowire, superconducting correlations are then induced into the\nnanowire via proximity effect, giving rise to a superconducting\nnanowire. Then, by applying an external Zeeman field, @xmath , the\nsystem reaches the topological phase for @xmath with Majorana bound\nstates (MBSs) at the end of the wire, one at each end. Here, @xmath is\nthe chemical potential of the wire and @xmath the induced\nsuperconducting @xmath -wave pairing.\n\nPerforming measurements on single superconducting nanowires is a\nchallenging task and instead it is usually required to fabricate\njunctions between normal and superconducting systems. This allows to\ntune different system parameters in the different regions of the system\nand therefore perform, for instance, transport measurements. These\nsystems are known as hybrid, since they combine the effects of regions\nin the superconducting state with others in the normal state. For\ninstance, a nanowire can be partially placed on a superconductor. Then,\ndue to the proximity effect, the region in contact with the\nsuperconductor acquires superconductivity (denoted by S) leaving the\nother region (the non-proximitized region) in the normal state (denoted\nby N). This results in a NS junction. Additionally, one can place\nanother superconductor bellow the left part of the nanowire. In this\ngeometry, superconducting correlations are induced onto the regions that\nare in contact with the superconductors and therefore leaving a central\nregion of the wire in the normal state. This system is refereed to as\nSNS junction.\n\nImportant effects take place in these hybrid systems which lead to very\nunusual physics and provide a powerful platform for investigating\ntopological superconductivity and therefore Majorana bound states. In\nthis chapter we first describe the basic phenomena in NS and SNS\nstructures and then we focus on the low-energy Adreev spectrum in NS and\nSNS junctions made of semiconducting nanowires with Rashba SOC and\nZeeman interaction. Additionally, we study phase-biased transport in SNS\njunctions and suggest it as a useful tool for the search of MBSs in\nnanowires.\n\n### 9 Basic phenomena in NS and SNS junctions\n\nIn this section, we introduce two important effects which take place in\nNS and SNS junctions: the Andreev reflection in NS junction and the\nformation of Andreev bound states (ABSs) and multiple Andreev\nreflections (MAR) in SNS junctions.\n\n#### 9.1 NS junctions: Andreev reflection\n\nSemiconducting nanowire junctions represent a very important platform\nfor investigating scattering processes. Consider, for instance, a\njunction formed out by two regions, where a right moving electron hits\nthe interface between them. At this point, the electron experiments\nreflection or transmission according to scattering theory and depend on\nvarious properties of the system under investigation. Within the\nreflection process, the electron is reflected as an electron, if the\nright part of the system is a non-superconducting region. The situation,\nhowever, changes when the right part is a superconductor.\n\nConsider a NS junction, where neither SOC nor Zeeman effects are\ninvolved and superconductivity is allowed only in the S part, as\nsketched in Fig. 16 . In this case, the Fermi energy of the N side tends\nto be aligned with the Fermi energy of the S region. Now, suppose an\nelectron is created in the normal region N with energy @xmath , and\ntravels towards the NS interface. When such incident electron meets the\nNS interface it can be reflected or transmitted according to the\nscattering point of view. The analysis of this scattering problem is\ncarried out by solving the BdG equations, given by Eq.\u2009( 16 ), in the\ntwo regions. For determining the wave-functions and the energy spectrum,\none follows the wave-matching technique taking into account the relation\nbetween the energy of the incident electron and the superconducting\nenergy gap @xmath . Indeed, when the energy of the incident electron is\nless than the superconducting gap, @xmath , there are no states in the S\npart available for transmission, and therefore the only possibility for\nthe incident electron is to be fully reflected as a hole when there is\nno potential barrier at the interface. See Fig. 16 . This reflection\nprocess is known as Andreev reflection (AR) [ 141 ] . Because the\ncharges of an electron and a hole are opposite, a charge of @xmath , a\nCooper pair, is transferred from the normal metal into the\nsuperconductor. Following wave-matching techniques, the Andreev\nreflection amplitude of an incoming electron and an outgoing hole can be\nwritten as\n\n  -- -------- -- ------\n     @xmath      (65)\n  -- -------- -- ------\n\nwhere @xmath is the superconducting phase. For the calculation of @xmath\nit is also assumed Andreev approximation, meaning that @xmath , where\n@xmath is the chemical potential. Following similar ideas and under\nsimilar physical conditions, an incident hole with energy @xmath from\nthe N region is reflected as an electron with amplitude @xmath . The\nAndreev reflection amplitude for a left going electron into a right\ngoing hole is @xmath , while for a left going hole and a right going\nelectron @xmath . Notice that during this special reflection process the\nreflected quasiparticle acquires a phase from the superconductor, which\nleads to very interesting physics when a left superconducting contact is\nadditionally attached to the NS junction (see next).\n\n#### 9.2 SNS junctions: Andreev bound states\n\nLet us now attach another superconductor on the left side of our\nprevious NS junction. This gives rise to the so-called SNS junction. Our\nsystem is now composed of a left superconductor (S) with pairing\npotential @xmath , a central normal system (N) of length @xmath with\nzero superconducting pairing and a right superconductor (S) with @xmath\n, as depicted in Fig. 17 . Notice that we focus on ballistic or\nperfectly transmitted SNS junctions. A brief discussion of finite\ntransmission junction will be given at the end of this section. Consider\nagain a right-moving electron at low energy @xmath . According to the\nAndreev reflection process described in the previous section, such\nelectron is reflected at the right NS interface into a left moving-hole,\nleaving a charge of @xmath in the right superconductor. Then, the\nleft-moving hole meets the left SN interface and is reflected back into\na right-moving electron, taking a charge of @xmath from the left\nsuperconductor. During one of these cycles a Cooper pair of charge\n@xmath is transferred from the left to the right superconductor, thus\ncreating a supercurrent flow across the junction, as it is schematically\nshown in Fig. 17 .\n\nBecause of the finite length of region N, @xmath , discrete energy\nlevels are formed. When the phase difference, @xmath , is non-zero, the\nSNS structure host standing bound waves with quantised energies. The\ncorresponding states are referred to as Andreev bound states (ABSs) [\n142 ] . In general, the condition for the formation of bound states in\none-dimension dictates that the total phase acquired during one cycle is\na multiple of @xmath [ 58 ] ,\n\n  -- -------- -- ------\n     @xmath      (66)\n  -- -------- -- ------\n\nwhere @xmath , @xmath , and the signs @xmath in front of @xmath\ncorresponds to a process starting with a right-moving electron (and its\nleft-moving Andreev reflected hole), and to a process starting with a\nleft-moving electron (and its right-moving Andreev reflected hole),\nrespectively. Eq.\u2009( 66 ) can be explicitly solved in two special limits:\n@xmath and @xmath . Within the Andreev approximation @xmath , one can\napproximate @xmath , where @xmath . Moreover, we consider states within\nthe superconducting energy gap, @xmath . Then, the two special limits\ngive rise to the classification of such SNS junctions, which is based\naccording to the relation between the length of the normal region @xmath\nand the superconducting coherence length @xmath [ 143 ] \u00b9\u00b9 \u00b9\u00b9 11 We\npoint out that the superconducting coherence length @xmath can be also\ndefined without the factor @xmath in the denominator: @xmath . ,\n\n  -- -------- -- ------\n     @xmath      (67)\n  -- -------- -- ------\n\nSuch classification can be also given in terms of natural energy scales\nof the problem, the Thouless energy, @xmath , and the induced\nsuperconducting pairing potential @xmath , being @xmath the Fermi\nvelocity, and @xmath the length of the normal region. The above\nconditions, in terms of these energy scales, are\n\n  -- -------- -- ------\n     @xmath      (68)\n  -- -------- -- ------\n\nTherefore, for a short junction the third term in Eq.\u2009( 66 ) is\nneglected and we get two degenerated Andreev bound states\n\n  -- -------- -- ------\n     @xmath      (69)\n  -- -------- -- ------\n\nwhere @xmath . The special case of @xmath , corresponds to the so-called\nweak link junctions , where the only need for having ABSs is finite\nsuperconducting phase difference. This limit corresponds to the\nso-called superconducting point contact . For the long-junction regime,\nconsidering @xmath and therefore setting @xmath , we have\n\n  -- -------- -- ------\n     @xmath      (70)\n  -- -------- -- ------\n\nNotice that here we have a set of equally spaced energy levels until the\nlevels approach @xmath , and the position of the levels is set by the\nsuperconducting phase difference @xmath .\n\nIn Fig. 18 we present the ABSs for short ( @xmath ) and long ( @xmath )\nSNS junctions given by Eqs.\u2009( 69 ) and \u2009( 70 ), respectively.\n\nNotice that in the previous analysis we have considered ballistic SNS\njunctions, where elastic scattering is negligible. When the normal\nregion N has a finite transmission @xmath , there exists a finite\nbackscattering probability in the normal region. Hence, in the case of a\nsingle channel short junction ( @xmath ), a right-moving electron (or\nhole) can be reflected back into a left-moving electron (or hole),\ntherefore giving rise to a coupling between the two ballistic ABSs,\nwhich have energies smaller than the superconducting gap @xmath and are\nlocalised at the short junction over a distance of the order of @xmath [\n142 , 144 ] ,\n\n  -- -------- -- ------\n     @xmath      (71)\n  -- -------- -- ------\n\nThe dependence of the energy levels on the superconducting phase\ndifference @xmath , from previous expression, is plotted in Fig. 19 for\ndifferent transmission values @xmath . In the ballistic regime ( @xmath\n), two levels, corresponding to left-moving ( @xmath ) and right-moving\n( @xmath ) electrons, cross at @xmath , while @xmath gives rise to an\nanticrossing at @xmath of size @xmath . Decreasing @xmath , the opened\ngap increases and for sufficiently small transmission the ABSs lie at\n@xmath . The transmission @xmath can be tuned electrostatically with\ngates for instance.\n\n#### 9.3 The Josephson current\n\nAs a result of the formation of Andreev bound states in SNS junctions a\npair of correlated electrons is transferred from the left to the right\nsuperconductor, creating a supercurrent flow across the junction. This\nphenomenon is known as the dc-Josephson effect and takes place as long\nas the superconducting phase difference is finite [ 145 ] . An important\ncharacteristic among the expressions given by Eqs.\u2009( 69 ), \u2009( 70 ) and\n\u2009( 71 ) is the energy levels dependence on the superconducting phase\ndifference between the two superconductors. This constitute the base of\nthe Josephson effect [ 145 ] , which states that a finite current flows\nbetween the two superconductors when the superconducting phase\ndifference is finite. In fact, the discovery of the Josephson effect was\ndone in Superconductor-Insulator-Superconductor (SIS) tunneling\njunctions, where Cooper pairs coherently tunnel through the insulating\nbarrier between the superconductors and lead to a supercurrent flow\nwhich exhibits a dependence on the superconducting phase difference\n@xmath , being the critical current @xmath the maximum supercurrent that\nthe junction can support [ 145 ] .\n\nThe Josephson current can be calculated from the thermodynamic\npotential, @xmath , as a function of the superconducting phase\ndifference between the two superconductors, @xmath ,\n\n  -- -------- -- ------\n     @xmath      (72)\n  -- -------- -- ------\n\nwhere @xmath thermodynamic potential (the grand canonical for instance)\nof the superconductor [ 58 , 144 ] . The factor of @xmath in previous\nequation accounts for the Cooper pair charge and all the degeneracies\nare included in @xmath . Important to notice here is that previous\nformula is a general expression and remains valid for any kind of\nJosephson junction [ 58 ] . In order to find the current, one should be\nable to calculate @xmath . It can be done following the Green\u2019s function\ntechnique [ 146 ] or directly from the BdG equations given by Eq.\u2009( 16 )\n[ 58 , 144 ] . The latter approach leads to [ 58 , 144 ]\n\n  -- -- -- ------\n           (73)\n  -- -- -- ------\n\nwhere the first term represents the contributions from the discrete\npositive Andreev levels within the gap and the second term contains the\ncontribution from the excited states in the continuum with energies\nabove @xmath , whose density of states is @xmath . Notice that in\nprevious expression we have considered that our system is not spin\ndegenerate, otherwise we would have obtained a factor of 2 multiplying\nthe two terms on the right side.\n\nIn the short-junction limit ( @xmath ), @xmath is the same as in a bulk\nsuperconductor and therefore is phase independent. Hence, in this\nregime, the energy levels from the continuous spectrum do not contribute\nto the Josephson current @xmath and Eq.\u2009( 73 ) at zero temperature,\n@xmath , reduces to\n\n  -- -------- -- ------\n     @xmath      (74)\n  -- -------- -- ------\n\nFor a short junction ( @xmath ) we have obtained in Eqs.\u2009( 71 ) two\ndegenerate ABSs which are spin degenerate. Applying the previous\napproach for finding the Josephson current carried by the two ABSs,\n@xmath (the factor of @xmath here counts for spin degeneracy). Then,\n\n  -- -------- -- ------\n     @xmath      (75)\n  -- -------- -- ------\n\nwhere each ABS carry supercurrent in opposite direction, which is\nplotted in Fig. 20 . Notice that the supercurrent or Josephson current\nis an odd periodic function of @xmath with period @xmath and is zero at\n@xmath for @xmath . The current-phase characteristics strongly depends\non the transmission @xmath . For @xmath , the junction is in the tunnel\nregime and the current follows @xmath , where @xmath is the critical\ncurrent, which is the maximum supercurrent at @xmath . On the other\nhand, for @xmath , one has @xmath , where @xmath is the critical\ncurrent, which is the maximum supercurrent at @xmath .\n\nNotice that, in general, in a short junction with @xmath channels the\nnumber of ABSs within the gap is @xmath , where due to electron-hole\nsymmetry of the Nambu description @xmath are positive and @xmath\nnegative.\n\nIn general, long junctions ( @xmath ) host many energy levels within the\ngap @xmath (see Fig. 18 ), unlike the short-junction case. We have shown\nthat for @xmath the energy levels are given by Eq.\u2009( 70 ). For\ncalculating the Josephson current, however, the levels above the gap may\nalso contribute to the current as it is given by Eq.\u2009( 73 ). Thus, we\ncannot just perform the derivative of the energy levels found in Eq.\u2009(\n70 ) with respect to @xmath , and then use Eq.\u2009( 74 ). We do not\ncalculate the supercurrent in long junctions but rather discuss some\ndifferences with short junctions. It was shown that the Josephson\ncurrent in a long junction at zero temperature is a @xmath periodic\nfunction in the phase difference @xmath and it has a linear relation\nwith the phase gradient @xmath within @xmath , being zero at @xmath and\nexhibiting a sawtooth profile at odd multiples of @xmath [ 147 , 148 ] .\n\nAlong this thesis, however, we will not only use the approach presented\nin this part for calculating the Josephson current, but we also employ\nthe Green\u2019s function formalism. The latter is described in Chapter\nHybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states .\n\n##### 9.3.1 Multiple Andreev reflections (MAR)\n\nWe have seen that in a SNS junction a right-moving electron is Andreev\nreflected as a hole at the right NS interface into a left-moving hole,\nwhich is also Andreev reflected into a right-moving hole at the left SN\ninterface. Thus, Andreev reflections favour the formation of Andreev\nbound states. When a constant voltage @xmath is applied across the\njunction, the situation changes drastically. First, the superconducting\nphase difference becomes time-dependent and increases linearly with time\n@xmath . The Josephson current becomes oscillatory with @xmath , giving\nrise to the ac Josephson effect [ 145 ] . We assume that the voltage\ndrops over an arbitrary point of the N region, denoted by the orange\ndashed line in Fig. 21 A right-moving electron (hole) increases\n(decreases) its energy each time it crosses the normal region N from\nleft to right, while the Andreev reflected hole (electron) increases its\nenergy passing through N from right to left.\n\nSince energies are changing in the process of transmission,\nquasiparticle energies of both signs are considered and in left and\nright superconducting electrodes only quasiparticle states with @xmath\nare available (Fig. 21 ). A right-moving electron from the left\nsuperconductor with energy below @xmath crosses the N region and arrives\nat the right superconductor only if @xmath (top panel Fig. 21 ). This\nrepresents a single quasiparticle process, where a charge of @xmath is\ntransferred from the left to the right superconductor. For @xmath\nslightly greater than @xmath , the right-moving electron arrives at the\nNS interface and performs an Andreev reflection, since it is the unique\npossibility as within @xmath there are no available quasiparticle\nstates. As a result, a left-moving hole emerges and when crossing the N\nregion, it increases its energy by @xmath arriving at the continuum of\nthe left superconductor. During this process a charge of @xmath is\ntransferred from the left to the right superconductor. For @xmath , the\nright-moving electron from the left superconductor performs multiple\nAndreev reflections (MAR) as needed to exit the superconducting gap. In\neach process, a charge of @xmath is transferred, at least. The @xmath\nprocesses involves @xmath Andreev reflections, and starts with threshold\nvoltages @xmath . Important to remark is that a new transport channel\narises whenever the full gap si an odd integer multiple of @xmath :\n@xmath , otherwise the right-moving electron ends up at the continuum of\nstates of the left superconductor (second panel in Fig. 21 ). These\nprocesses give rise to a number of singularities in the I-V curves at\nthe corresponding voltage.\n\n### 10 NS and SNS junctions made of Rashba nanowires: Details on\nmodelling\n\nIn Chap. Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states we have discussed the\nemergence of Majorana bound states (MBSs) in the Kitaev\u2019s toy model and\nthen in a physical system based on Rashba nanowires. We have pointed out\nthat MBSs emerge at interfaces of systems with different topology.\nWithin the Rashba nanowire proposal what one needs is a nanowire with\nRashba SOC placed on a @xmath -wave superconductor and then apply a\nZeeman field @xmath , perpendicular to the SO axis. The system exhibits\ntwo topologically different phases, which can be driven by varying\n@xmath . The topological transition is defined by the critical field\n@xmath , where @xmath is the chemical potential of the superconducting\nwire and @xmath the induced pairing potential. For high fields, @xmath ,\nthe superconducting nanowire is in the topological phase with Majorana\nbound states at its ends, one at each end. Here, the interfaces between\ntwo topologically different regions are between the topological\nsuperconducting nanowire and vacuum, which is in the trivial\nnon-topological phase. We have also discussed that the wave-functions of\nthe two Majorana bound states decay exponentially into the bulk of the\nsuperconducting wire [ 76 , 77 ] . The relevant decay length\ncharacterising this overlap is the Majorana localisation length @xmath ,\nwhich tells us how well are MBSs localised at the ends of the wire. For\nfinite @xmath , being @xmath the length of the superconducting wire, the\noverlap between MBSs is significant and therefore they are no longer\ntrue zero modes. If there is a finite overlap between the MBSs wave\nfunctions, then the energy of the MBSs splits leaving behind their zero\nenergy character. However, for long enough wires, they can still be\nconsidered as zero modes.\n\nJunctions made of nanowires also represent experimental feasible\nplatforms for the search of MBSs. Placing only the right region of a\nnanowire on a @xmath -wave superconductor gives rise to NS junctions,\nwhile placing a nanowire on top of two @xmath -wave superconductors, as\nmaking a bridge, lead to SNS junctions. In this section we describe how\nto model superconducting nanowires, NS and SNS junctions based on the\nsemiconducting nanowires with SOC. Then, we perform a full analysis of\nthe low-energy Andreev spectrum in such junctions and finally we focus\non supercurrents and critical currents.\n\nThe calculations presented in this part are carried out considering\nexperimental values for InSb nanowires: the electron\u2019s effective mass\n@xmath , the spin-orbit strength @xmath meVnm and typical induced\npairing gap of @xmath meV [ 67 ] . The other parameters such as the\nchemical potential is considered arbitrary since in principle it can be\ncontrolled by means of electric gates.\n\n#### 10.1 Tight-Binding discretization\n\nFor computation purposes, we consider a discretisation of the 1D\ncontinuum model given by Eq.\u2009( 41 ) for the Rashba nanowire into a\ntight-binding (TB) lattice with a small lattice spacing @xmath , see\nFig. 22 . The smaller is @xmath , the better is the description and by\nletting such lattice constant tend to zero one recovers the usual\ncontinuum limit. We choose a discrete lattice whose points are located\nat @xmath , where @xmath is an integer and @xmath the small lattice\nspacing. Notice that by doing so, we are trying to find a matrix\nrepresentation of the 1D continuum model in site space. Within the TB\napproach, Eq.\u2009( 41 ) reads\n\n  -- -------- -- ------\n     @xmath      (76)\n  -- -------- -- ------\n\nwhere the symbol @xmath means that @xmath couples nearest-neighbor\n@xmath sites and\n\n  -- -------- -- ------\n     @xmath      (77)\n  -- -------- -- ------\n\nare matrices in spin space, @xmath is the hopping parameter and @xmath\nthe SO hopping. The dimension of the matrix @xmath is set by the number\nof sites of the wire.\n\nIn the following subsections we describe how one can model\nsuperconducting wires, NS and SNS junctions based on the tight-binding\ndescription presented here.\n\n#### 10.2 The superconducting wire model\n\nConsider a semiconducting nanowire placed on top of a superconductor,\nsimilar to the original proposal discussed in Sec. 5 of Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states . Assuming good contact between the nanowire\nand the superconductor, superconducting correlations are induced into\nthe nanowire via proximity effect, resulting in a superconducting wire.\nThis is schematically shown in Fig. 23 .\n\nThe nanowire is single mode and modelled with the Hamiltonian given by\nEq.\u2009( 41 ), which is discretised into a tight-binding lattice resulting\nin the Hamiltonian given by Eq.\u2009( 76 ). The length of the\nsuperconducting wire is @xmath , where @xmath is the number of sites and\n@xmath the lattice spacing. Superconducting correlations are of @xmath\n-wave type as described in Sec. 5 of Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states and the pairing potential is given by\n\n  -- -------- -- ------\n     @xmath      (78)\n  -- -------- -- ------\n\nwhere @xmath is the superconducting phase and @xmath the @xmath Pauli\nmatrix. The full Hamiltonian describing the superconductivity nanowire\nis written in Nambu space\n\n  -- -------- -- ------\n     @xmath      (79)\n  -- -------- -- ------\n\nPrevious Hamiltonian is diagonalised numerically and exactly solved with\nthe dimensions given by the number of sites of the wire, which implies a\ndependence on the length of the wire. Previous description accounts for\nfinite length wires and therefore it is important upon investigating the\noverlap of MBSs discussed in in Sec. 5 of Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states . The superconducting phase in the order\nparameter is assumed to be zero in our calculations of this part as it\nis only relevant when investigating Andreev bound states (see next\nsections).\n\nBased on the Hamiltonian model given by Eq.\u2009( 79 ), we first analyse\nwhat happens to the low-energy spectrum as a function of the wire\u2019s\nlength @xmath . This is shown in Figs. 24 and 25 . Top row in Fig. 24\nshows the energy spectrum of a normal nanowire at zero Zeeman field for\nzero and finite superconducting pairing, respectively. While in the\nnormal state (top left panel) the energy spectrum is gapless, by\ninducing superconductivity with a finite @xmath (top right panel), a\nclear gap is opened in the energy spectrum, as expected, and remains\nfinite as the length of the wire is increased. This is in accordance\nwith the Anderson\u2019s theorem which prevents the existence of bound states\ninside the gap of an s-wave superconductor for non-magnetic impurities [\n60 ] . For a finite Zeeman field (bottom row), but still in the trivial\nphase (left bottom panel), the induced gap, opened by superconductivity,\ngets reduced as expected according to the description given in Sec. 5 .\nWhile in the trivial phase, @xmath , there are no levels within the\ninduced gap (bottom left panel), in the topological phase, @xmath , two\nenergy levels from energies around @xmath develop an oscillatory\ndecaying behaviour as the length of the wire, @xmath , is increased. As\nsuch length is made really long, the amplitude of the oscillations is\nreduced and even totally negligible, where the levels become zero energy\n(see green dashed line). These lowest energy levels represent the\noscillating MBSs, which for long wires become zero energy. This\ndiscussion is in accordance with description made in Sec. 5 . Indeed,\nthe low momentum gap gets reduced as @xmath increases and closes at\n@xmath marking the topological phase transition point and for @xmath the\nsystem is in the topological superconducting phase with MBSs.\n\nBefore going further, in Fig. 25 we demonstrate the importance of the\nSOC towards the emergence of MBSs in nanowires. We examine the energy\nspectrum of a Rashba nanowire for @xmath at zero and at finite SOC (left\nand right panels in Fig. 25 ). While at zero SOC, left panel, the\nspectrum consists of a dense quasi-continuum as the length @xmath\nincreases, a finite SOC removes all finite energy crossings while\npreserving the lowest two oscillatory decaying levels coming from\nenergies around @xmath . The oscillatory pattern is visible for @xmath ,\nwhile for long enough wires @xmath the oscillations are considerable\nreduced and assumed to be zero, as marked by magenta and green dashed\nlines. Notice that @xmath represents the Majorana localisation length.\nWe therefore conclude that, as expected for @xmath , a topological\nsuperconducting nanowire host two MBSs (one at each end of the wire)\nwhich exhibit an energy splitting when their overlap is finite, while\nfor long enough wires they become zero energy.\n\nIn order to clarify the previous discussion, we show in Fig. 26 the\nlow-energy spectrum as a function of the Zeeman field at fixed wire\u2019s\nlength (see caption for more details). Top left panel represents the\ncase of zero superconducting pairing, @xmath , and finite SOC, @xmath ,\nwhile top right panel a situation of finite pairing, @xmath , but with\nzero SOC, @xmath . Bottom panels show a calculation for finite both SOC\nand superconducting pairing for @xmath and @xmath , respectively. In\nFig. 24 (top left panel) we have seen that at @xmath and @xmath the\nenergy spectrum consists of a dense quasi-continuum. The same is\nobserved in Fig. 26 (top left panel). Notice that as the Zeeman field\ntakes finite values and increases, the energy levels split as shown in\ntop left panel for @xmath and @xmath . As the Zeeman field increases,\nwithin the weak Zeeman phase @xmath , the energy levels contain both\nspin components and for certain values of the Zeeman field they may\ncross zero energy, while in the strong Zeeman phase @xmath one spin\nsector is completely removed giving rise to a spin-polarised spectrum as\none can indeed observe in top left panel of Fig. 26 . The transition\npoint from weak to strong Zeeman phases is marked by the chemical\npotential @xmath (green dashed line), while the spin-orbit energy is\nmarked by the orange dashed line. We point out that none of the zero\nenergy crossings are protected in top left panel of Fig. 26 .\n\nTop right panel of Fig. 26 shows the energy levels at finite\nsuperconducting pairing, @xmath , and zero SOC, @xmath . The first thing\none notices, in comparison to the top left panel of Fig. 26 , is that at\nzero Zeeman field the superconducting pairing induces a gap with no\nlevels within it according to the Anderson theorem as discussed before [\n60 ] . The magnetic field applied to a finite length superconducting\nnanowire tends to destroy the pairing of the electrons, inducing the\nso-called Zeeman depairing. Here, the spins of the electrons couple with\nthe field, the up and down levels shift by @xmath , and roughly\nspeaking, when @xmath exceeds the induced superconducting gap @xmath the\nsuperconductivity ceases. This is indeed observed in top right panel of\nFig. 26 . As the Zeeman increases, the energy levels from energies\naround @xmath get coupled to the Zeeman field and reduce their energies,\nthus reducing the induced gap. Different spin components of the energy\nlevels cross zero energy at @xmath , signalling the closing of the\ninduced superconducting gap, marked by the magenta dashed line. Further\nincreasing of the Zeeman field @xmath gives rise to a region (between\nred and magenta dashed lines) where the energy levels contain both spin\ncomponents, which depend on the finite value of the chemical potential.\nIndeed, we have checked that for @xmath magenta and red dashed lines\ncoincide (not shown). On the other hand, for @xmath , one spin sector is\nremoved and the energy levels are spin polarised, showing a family of\nZeeman crossings, which are not protected.\n\nRemarkably, when the SOC is switched on we observe a number of changes\nin the low-energy spectrum (bottom panels). First, the gap closing\nchanges from @xmath , shown in top right panel for zero SOC, to @xmath\n(bottom panels). The critical field @xmath is the field which marks the\ntopological transition point into the topological superconducting phase\nwith MBSs. Second, a clear closing at @xmath and reopening for @xmath of\nthe induced gap is observed as the Zeeman field increases. Third, the\nspin polarised energy spectrum shown in top right panel at zero SOC for\n@xmath is washed out, keeping only the crossings around zero energy of\nthe two lowest levels. The two lowest energy levels for @xmath are the\ncelebrated MBSs, which in this case exhibit the expected oscillatory\nbehaviour due to their finite spatial overlap. For long enough wires,\nthe amplitude of the oscillations is considerable reduced (even\nnegligible) thus these levels acquire zero energy (see next discussion\nfor Fig. 27 ). Fourth, the SOC introduces a finite energy separation (\nminigap ) between the lowest levels, crossings around zero, and the rest\nof the levels. The value of this minigap is related to the outer gap we\nhave discussed in Sec. 5 , where we pointed out that such minigap is\nroughly constant for strong SOC.\n\nIn order to support the view on the lowest levels for @xmath and have a\ndeeper insight about the topological transition, in Fig. 27 we present\nthe energy levels of a superconducting nanowire as function of the\nZeeman field for @xmath and @xmath . In both panels, the low-energy\nlevels react to the increasing of the Zeeman field and trace the gap\nclosing at @xmath , as discussed previously. By further increasing of\nthe Zeeman field, @xmath , two energy levels remain around zero energy\nseparated from the rest of the spectrum by a minigap, which is strongly\ndependent on the SOC. The energy levels around zero oscillate when the\nZeeman field @xmath increases giving rise to an energy splitting between\nthem, as predicted by Eq.\u2009( 64 ), [ 76 ] . The energy splitting can be\nsmall for long enough wires, see right panel in Figs. 27 and 25 , though\nstrictly speaking it is non-zero for any length [ 75 , 70 , 71 , 76 ] .\nThe MBSs become merely quasi-stationary states, with their energy\nsplitting representing a Rabi frequency at which one oscillates into the\nother. It is also important to mention here that above @xmath there is a\nconsiderable amount of discrete levels which become visible when the\nlength of the wire is increased as observed in Fig. 27 . This is due to\nthe fact that since we are in a finite length nanowire the energy\nspectrum is discrete, where part of it is within the gap and the other\nabove the gap forming the quasi-continuum. The discrete quasi-continuum\nwill have important consequences in the calculation of the Josephson\ncurrent across SNS junctions (see Sec. 11 ).\n\nThus, to conclude, we strongly point out that this part proves that only\nthe combination of SOC, @xmath -wave superconductivity and Zeeman\ninteraction gives rise to MBSs at the end of the wire for @xmath in\naccordance with the original proposals [ 41 , 61 ] .\n\n#### 10.3 The NS junction model\n\nNow, we consider a nanowire with Rashba SOC partially placed on top of a\n@xmath -wave superconductor as schematically shown in Fig. 28 . The\nright part of the nanowire acquire superconducting correlations ( @xmath\n) and the left region remains in the normal state (N). This results in a\nNS junction.\n\nNotice that an external magnetic field @xmath is applied along the wire\nand perpendicular to the SO axis, which opens a gap of @xmath in the\nenergy spectrum, where @xmath is the associated Zeeman field in the\nwire, @xmath is the wire\u2019s @xmath -factor and @xmath the Bohr magneton.\n\nFor modelling the NS structure, we consider that the regions N and S are\ndescribed by the tight-binding Hamiltonian @xmath given by Eq.\u2009( 76 ),\nwith their respective chemical potential, Zeeman field, hopping\nparameters,\n\n  -- -------- -- ------\n     @xmath      (80)\n  -- -------- -- ------\n\nwhere N and S denotes the normal and superconducting regions of the\njunction. We will assume that only the chemical potentials are different\nin the N and S regions. Notice that the NS junction of length @xmath is\ndiscretized into a tight-binding lattice with spacing @xmath following\nSubsec. 10.1 . Here, @xmath and @xmath are the lengths of the N and S\nregions, being @xmath and @xmath the number of sites of S and N,\nrespectively.\n\nThe junction NS without superconducting correlations is therefore\nmodelled by the Hamiltonian\n\n  -- -------- -- ------\n     @xmath      (81)\n  -- -------- -- ------\n\nwhere @xmath and @xmath is the Hamiltonian for the normal and\nsuperconducting regions given by Eq.\u2009( 76 ) and the Hamiltonian @xmath\ncouples the normal region to the superconducting part and contains\nnon-zero elements for adjacent sites that lie at the interfaces of\n@xmath and @xmath . One can control the transmission in these NS\njunctions by a hopping matrix @xmath , @xmath , which parametrises the\ncoupling between the sites that define the interfaces of the NS\njunction. A tunnel junction can be modelled by considering @xmath ,\nwhile a fully transparent junction with @xmath . We consider fully\ntransparent junctions unless otherwise stablished. The @xmath -wave\npairing potential must have the same structure as previous Hamiltonian.\nTherefore,\n\n  -- -------- -- ------\n     @xmath      (82)\n  -- -------- -- ------\n\nwhere @xmath and @xmath are the pairing potentials in the normal and in\nthe superconducting regions, respectively. As for superconducting\nnanowires, the superconducting phase is assumed to be zero in our\ncalculations for NS junctions.\n\nTherefore, the full Hamiltonian describing the NS junction is given by\n\n  -- -------- -- ------\n     @xmath      (83)\n  -- -------- -- ------\n\nIn NS junctions described here (see Fig. 28 ) the S region becomes\ntopological for @xmath and therefore Majorana bound states emerge at its\nends in a similar fashion as in the topological superconducting wire\nwith the sole difference that now the left part of the superconducting\nwire is in its normal state. We will see that this N part plays an\nimportant role as it introduces additional energy levels into the energy\nspectrum and therefore reduces the minigap which separates the MBSs from\nthe rest of the levels in the topological phase.\n\nIn the discussion made for topological superconducting wires we have\nobserved that in the trivial phase there are no levels within the\ninduced gap when the length of the wire @xmath is increased (see bottom\npanels in Fig. 24 ). We have also seen that the low-energy spectrum of\nsuch superconducting wires in the topological phase develops decaying\nenergy levels with an oscillatory behaviour as the length of the wire is\nincreased. Here, the lowest two levels represent the Majorana bound\nstates of the wire which oscillate due to the finite spatial overlap\nbetween their wavefunctions and they acquire zero energy when the length\nof the wire is long enough @xmath , being @xmath is the Majorana\nlocalization length.\n\nNow, we focus on the role of the length of the normal region @xmath in\nthe low-energy spectrum of the NS junction. This is reported in Fig. 29\n, where we present the energy levels as function of the length of the\nsuperconducting region @xmath for a very short (left panel) and long\n(right panel) N regions. In the former, two levels emerge from the gap\n@xmath and exponentially decay developing an oscillatory behaviour that\nis suppressed as the length of the superconducting region @xmath\nincreases. This case is very similar to the one shown in right panel of\nFig. 25 for the topological superconducting wire. The latter, however,\nposses some differences. Indeed, when the length of the N region is\nincreased, the number of energy levels of the system increases and even\ninside the gap one finds levels which coexist with the MBSs (see right\npanel in Fig. 29 ). This has a very important consequence as such levels\naffect the mini-gap by reducing it almost to a half of the one in case\nof a very short N region. This apparent negative role of having long N\nregions is not completely true. In fact, the additional levels from N\nreduce the minigap but they also reduce the amplitude of the\noscillations developed by the MBSs around zero energy. Compare for\ninstance dashed magenta lines in both panels of Fig. 29 . Therefore, the\ncondition for having zero modes in NS junctions with long N region is\nreached before than in NS junctions with short N junctions. This is a\nvery important conclusion and represents an advantage over NS junctions\nwith short N regions towards practical implementation of MBSs for\ntesting their braiding statistics.\n\nIn Figs. 30 , 31 and 32 , we explore the dependence of the energy levels\nas function of the Zeeman field @xmath for very short, intermediate and\nlong N regions of the NS junctions, respectively. In each figure we\npresent two cases for (left panel) visible and (right panel) neglectible\noscillations of the MBSs around zero energy. One observes that, as\nexpected, the low energy spectrum traces the gap closing at @xmath and\nits respective reopening for @xmath . We strongly point out that, at\nleast in principle, spectroscopy of energy levels could experimentally\ntest the emergence of MBSs in NS junctions. For very short N regions,\nshown in Fig. 30 , the energy levels behave in a similar way as in the\nsuperconducting nanowire discussed in previous subsection (Fig. 27 ).\nThe increase of @xmath , presented in Figs. 31 and 32 , introduces\nadditional levels (coming from N) into the low-energy spectrum inside\n@xmath as can be indeed observed and tend to reduce the minigap for\n@xmath . Another important feature to notice in this part is that\nalthough the energy levels follow the closing of the gap, they also\ndevelop a number of crossings around zero energy before the topological\ntransition. Remarkably, this behaviour is not related to the topological\nphase but rather to a sign that the N region has reached its helical\nphase @xmath . More about this discussion will be given in Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states . Moreover, we point out here that the\noscillations around zero energy of the MBSs can be reduced by either\nincreasing @xmath or @xmath . The price to pay in the former is that by\ndoing so one introduces additional levels and therefore the minigap\nseparating the MBSs from the rest is also reduced, while the latter\nrepresents the standard picture for reducing such oscillations.\n\n#### 10.4 The SNS junction model\n\nWe consider a nanowire with Rashba SOC subjected to an external magnetic\nfield @xmath along the wire and perpendicular to the SO axis. The\napplied magnetic field opens a gap of @xmath in the energy spectrum,\nwhere @xmath is the associated Zeeman field in the wire, @xmath is the\nwire\u2019s @xmath -factor and @xmath the Bohr magneton. This nanowire is\nplaced on top of two @xmath -wave superconductors (S\u2019 with pairing\npotentials @xmath ) as it is schematically shown in Fig. 33 . We assume\nthat there is a good contact interface between the nanowire and the\nsuperconductors (S\u2019), so that superconducting correlations are induced\nby proximity effect into the regions of the nanowire that are in contact\nwith the superconductors. This results in a nanowire containing left (\n@xmath ) and right ( @xmath ) regions with superconducting properties\nleaving the central region in the normal state (N), as shown in Fig. 33\n. These nanowires with left and right superconducting regions (denoted\nby S) and a central normal one (N) represent the hybrid\nSuperconductor-Nanowire-Superconductor (SNS) junctions discussed here,\nas shown in Fig. 34 . It is common to consider that as a result of the\nproximity effect, the @xmath parts have acquired an induced pairing\n@xmath . Although rigorously speaking this assumption is incorrect, it\nprovides a good description of the proximity effect for large gaps\n@xmath .\n\nThe superconducting regions of the nanowire are considered to have\nchemical potential @xmath and superconducting pairing potential @xmath\nand @xmath , where @xmath . The central region of the nanowire is in the\nnormal state without superconductivity, @xmath , and with chemical\npotential @xmath .\n\nFor modelling SNS junctions made of Rashba nanowires, we proceed as in\nprevious subsections, where the system is discretised into a\ntight-binding lattice with lattice spacing @xmath . Here, the SNS\njunction is of length @xmath , where @xmath and @xmath , being @xmath\nand @xmath are the number of sites in @xmath and @xmath , respectively.\nThe regions N and @xmath are described by the tight-binding Hamiltonian\n@xmath given by Eq.\u2009( 76 ), see Fig. 34 , with their respective chemical\npotential, Zeeman field, hopping parameters,\n\n  -- -------- -- ------\n     @xmath      (84)\n  -- -------- -- ------\n\nwhere @xmath and @xmath denotes the normal and left(right)\nsuperconducting regions of the SNS junction.\n\nThe Hamiltonian describing the SNS junction without superconductivity is\nthen given by\n\n  -- -------- -- ------\n     @xmath      (85)\n  -- -------- -- ------\n\nwhere @xmath is the Hamiltonian of the superconducting region @xmath\nthat we consider to be the same, @xmath the Hamiltonian that couples the\nsuperconducting region @xmath to the normal region @xmath , while @xmath\nthe Hamiltonian that couples the normal region to @xmath . The elements\nof these coupling matrices are non-zero for adjacent sites that lie at\nthe interfaces of the superconducting regions and of the normal region,\nonly. This coupling is parametrized by a hopping matrix @xmath between\nthe sites that define the interfaces of the SNS junction, where @xmath .\nA tunnel junction can be modelled by considering @xmath , while a full\ntransparent junction with @xmath . All the elements in the diagonal of\nmatrix Eq.\u2009( 85 ) have the structure of @xmath given by Eq. ( 76 )\ntaking into account that the superconducting regions have a chemical\npotential @xmath , while this is @xmath for the normal region. This was\nstablished in Eq.\u2009( 84 ). It is important to point out here that the\nmatrix of Eq.\u2009( 85 ) is of finite size and the dimensions of the\nmatrices are set by the number of sites of the respective region. Now,\nwe are left with considering superconducting correlations. Again, @xmath\n-wave pairing is taken into account and the pairing potential for the\nfull system must have the same structure as the SNS Hamiltonian, @xmath\n. Therefore,\n\n  -- -------- -- ------\n     @xmath      (86)\n  -- -------- -- ------\n\nwhere @xmath since in the normal region the superconducting correlations\nare absent, and @xmath . In the introduction of this Chapter we have\nseen that a finite phase difference between @xmath and @xmath gives rise\nto the physics of Andreev bound states and therefore to the Josephson\ncurrent. Thus, it is crucial to consider, and we indeed do, a finite\nphase difference between @xmath and @xmath , @xmath : @xmath and @xmath\n.\n\nThe full system Hamiltonian is then written in Nambu space\n\n  -- -------- -- ------\n     @xmath      (87)\n  -- -------- -- ------\n\nPrevious Hamiltonian is diagonalised numerically and for our\ncalculations we consider realistic system parameters for InSb as\ndescribed in the introduction of this Chapter. In the next section we\nproperly investigate the low-energy spectrum and Josephson and critical\ncurrents in SNS junctions, whose model was described in this part. In\nparticular, we focus on the formation of Andreev bound states, their\nevolution into Majorana bound states and show that the presence of MBSs\ncan tested either by Andreev spectroscopy or by measuring the Josephson\nand the critical currents.\n\n### 11 Andreev levels and Josephson current in SNS junctions\n\nAs we have discussed in the introduction of this work, Sec. 4 , a\ntopological superconductor nanowire hosts two Majorana bound states\n(MBSs) at its ends, @xmath and @xmath , one at each end. These two MBSs\ndefine a non-local fermion and can be fused to form a Dirac fermion\n@xmath . The fermion parity operator is defined as @xmath and has\neigenvalues @xmath or @xmath for empty @xmath and occupied @xmath\nstates. A spatial overlap of the two MBSs, in the superconducting wire,\nhybridises them into eigenstates of opposite fermion parity. Indeed, in\na topological superconducting wire, the spatial overlap induces an\nenergy splitting given by Eq.\u2009( 64 ) and it is proportional to @xmath [\n76 ] .\n\nOn the other hand, in the case of a SNS junctions discussed here, the\nsuperconducting regions of the nanowire, @xmath and @xmath , are driven\ninto the topological superconducting phase when @xmath , where @xmath .\nTherefore, due to the finite length @xmath , we expect the formation of\nfour MBSs in the SNS junction: two at the interfaces with vacuum, @xmath\n, ( outer MBSs ), and two at the interfaces with the normal regions of\nthe nanowire N, @xmath , ( inner MBSs ), as schematically shown in Fig.\n35 . Notice that when @xmath , the outer MBSs are at infinity and the\nproblem involves only the two inner MBSs. The four MBSs hybridise both\nthrough the region N or the finite region S. The two MBSs, @xmath , at\neither side of the junction with phase difference @xmath and\ntransparency @xmath will hybridise into states of opposite fermion\nparity with energies @xmath [ 87 , 66 ] , where @xmath is the effective\ninduced superconducting pairing. It is important to point out here that\na finite phase difference matters and the emergence of MBSs is not\narbitrary but the system hosts four MBSs when the phase difference is\n@xmath , while for zero phase difference only the outer MBSs are\npresent, @xmath . The wave-functions of the MBSs decay exponentially\nfrom both ends of the topological superconducting regions in the SNS\njunction into the bulk of S. For finite @xmath , being @xmath the length\nof the superconducting regions of the SNS junction and @xmath the\nMajorana localisation length, the overlap between MBSs is significant\nand therefore they are no longer true zero modes. However, if @xmath the\noverlap is negligible and one can assume the MBSs to be true zero modes.\n\nThus, we conclude that in these SNS junctions of finite length four MBSs\nemerge naturally. It was theoretically shown that the minimal platform\nfor investigating the non-Abelian statistics of MBSs consists of a\nsystem with four MBSs [ 149 ] . Therefore, research along these lines\nrepresents an important advance towards realistic implementations of\nMBSs and potential application in topological quantum computation [ 24 ]\n.\n\nIn this part we present the low-energy Andreev spectrum, Josephson\n(supercurrent) and critical currents in ballistic short ( @xmath ) and\nlong ( @xmath ) SNS junctions based on the model described in previous\nsection, being @xmath the superconducting coherence length and @xmath\nthe length of the normal region. In particular, we discuss the formation\nof Andreev bound states and their connection with the emergence of MBSs.\nFinally, we propose the Josephson and critical currents as a powerful\ntool for detecting MBSs in such hybrid systems.\n\n#### 11.1 Andreev energy levels\n\nIn Figs. 36 and 37 , we show the Andreev levels as function of the\nsuperconducting phase difference and their evolution with the Zeeman\nfield in a short SNS junction for @xmath and @xmath , respectively. On\nthe other hand, the dependence of the Andreev levels on the phase\ndifference for long junctions is presented in Figs. 38 and 39 .\n\nLet us first concentrate on the short-junction regime, Figs. 36 and 34\nfor @xmath and @xmath , being @xmath the Majorana localisation length.\nAt zero magnetic field (top left panel in Figs. 36 and 34 ), two\ndegenerate ABSs appear within @xmath as solutions to the BdG equations.\nNote that even this non-topological case is anomalous as the ABS\nenergies do not reach zero at @xmath , unlike predicted by the standard\ntheory for a transparent channel within the Andreev approximation @xmath\n[ 144 ] . The dense amount of levels above @xmath represent the\nquasi-continuum of states, which consists on a discrete set of levels\ndue to the finite length of the SNS junction. Indeed, all the\ncalculations presented here correspond to systems of finite length and\ntherefore their energy spectrum is discrete, where the levels in the\nenergy spectrum corresponds to the full system, the N and S regions.\nWithin the gap @xmath the junction host levels which are clearly\ndiscrete, however, above @xmath one observes the formation of a discrete\nquasi-continuum being denser for junctions with longer @xmath as\ncomparing Figs. 36 and 34 . This will have important consequences for\nthe calculation of the Josephson current (see next subsection).\nMoreover, the detachment of the quasi-continuum at @xmath and @xmath is\nnot clear but what is clear is that it is not zero. In what follows we\nwill see that such detachment depends on the finite length of the S\nregions (see Fig. 37 ).\n\nFor a non-zero Zeeman field the ABSs split and the two different gaps\n@xmath and @xmath , discussed in Sec. 5 , emerge (top middle and right\npanels). The former was defined at low momentum, while the latter at\nhigher momentum. By increasing the Zeeman field the low momentum gap\n@xmath gets reduced as expected from the band structure for the\nsuperconducting nanowire discussed in Sec. 5 , while the gap @xmath\nremains roughly unchanged for strong SOC. At @xmath , the energy\nspectrum exhibits the closing of the low momentum gap @xmath (bottom\nleft panel). This signals the topological transition point, where\naccording to the adiabatic theorem two gapped topologically different\nphases are only connected through a gap closing. By further increasing\nof the Zeeman field (bottom middle and right panels), @xmath , the\nsystem enters into the topological phase and the superconducting regions\ndenoted by @xmath become topological, while the @xmath region remains in\nthe normal state (see Fig. 34 ). In the topological superconducting\nnanowire, MBSs emerge at the end of the wire because it defines an\ninterface between two topologically different regions: the vacuum, which\nis in the trivial phase and the topological superconducting wire.\n\nIn SNS junctions, on the other hand, MBSs are expected to appear for\n@xmath at the ends of the two topological superconducting sectors @xmath\n, since they define interfaces between topologically different regions:\nthe normal region @xmath and vacuum. This is what we indeed observe for\n@xmath in Fig. 36 , where the low energy spectrum has Majorana\nproperties. For @xmath , the topological phase is characterised by the\nemergence of two (almost) dispersionless levels with @xmath , which\nrepresent the outer MBSs @xmath formed at the ends of the junction and\nschematically shown in Fig. 35 . Additionally, two energy levels tend to\nreach zero at @xmath and represent the inner MBSs @xmath formed inside\nthe junction. For sufficiently strong fields, @xmath , the lowest gap is\n@xmath , which in principle bound the MBSs. Notice that the four MBSs\nexhibit a considerable splitting around @xmath . This is a result of the\nfinite spatial overlap between the MBSs wave-functions, @xmath , being\n@xmath the Majorana localisation length. The problem can be solved by\neither increasing the spin-orbit coupling strength and therefore\nreducing the Majorana localisation length, as discussed in Appendix K ,\nor by increasing the length of the superconducting regions @xmath ,\nwhich indeed demands longer computational times. Since realistic\nexperiments consider nanowires with an intrinsic spin-orbit coupling [\n67 ] , which is a material property, for reducing the energy splitting\nat @xmath we consider SNS junctions with longer superconducting regions,\n@xmath . As an example, we present in Fig. 37 the energy levels as\nfunction of the phase difference for @xmath . First, we notice that the\nenergy spectrum at @xmath for @xmath , exhibits a visible denser\nspectrum than in Fig. 36 signalling the quasi-continuum of states. The\nbehaviour of the two different gaps remains as one increases @xmath .\nNotice that in the topological phase, @xmath , the energy levels\nassociated to two outer MBSs are really dispersionless with @xmath and\ntherefore they can be considered as truly zero modes. Remarkably, the\nenergy splitting at @xmath is considerable reduced, however it will be\nalways non-zero, though not visible by naked eye, due to the finite\nlength and thus due to the presence of the outer MBSs. Observe also in\nFig. 37 that an increase in the length of the superconducting regions\nfavours the reduction of the detachment between the discrete spectrum\nand the quasi-continuum at @xmath and @xmath , as it should be for a\nballistic junction [ 87 , 66 ] . In the topological phase it can be\nassociated to the finite spatial overlap between the wavefunctions of\nthe MBSs at the end of the S regions.\n\nA true crossing is reached by considering semi-infinite superconducting\nleads, @xmath , as it is done in Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states . In such geometry the outer MBSs are not\npresent in the description of the system and the crossing at @xmath is\nprotected by conservation of the total fermion parity. Notice also that\nFig. 37 shows that the inner MBSs, the ones giving rise to ABSs due to\nhybridization, are truly bound within @xmath , unlike Fig. 36 .\n\nThe energy levels dependence on the superconducting phase difference in\nlong SNS junctions is shown in Figs. 38 and 39 for @xmath and @xmath ,\nrespectively. In the introduction of this Chapter, Sec. 9 , we have\ndiscussed the emergence of Andreev levels in short and long SNS\njunctions. At this levels, neither Zeeman nor spin-orbit coupling were\nconsidered. We have seen that a long SNS junction host more levels than\na short one. This is because in a longer junction more levels fit within\nthe region of length @xmath . We have obtained the behaviour of the\nenergy levels analytically taking into account a number of\napproximations that in general are not necessarily true.\n\nA long junction, at @xmath , contains more levels within the energy gap\n@xmath than a short junction (see top left panels in Figs. 38 and 39 ).\nThis is expected as it is a situation similar to the one discussed in\nSec. 9 . When a finite Zeeman field is switched on, the two different\ngaps, discussed in 5 , emerge (see top middle and right panels in Figs.\n38 and 39 ).\n\nAs for short junctions, in long junctions, the Andreev energy spectrum\ntraces the closing of the low momentum gap @xmath , which reaches zero\nat @xmath (see bottom left panels in Figs. 38 and 39 ). This signals the\ntopological phase transition point into the topological superconducting\nphase, where the @xmath regions of the SNS junction become topological.\nFor @xmath , the four lowest levels represent the MBSs formed at the\nends of the two topological superconducting regions @xmath . Notice that\nfor strong Zeeman fields in the topological phase, the lowest gap is\n@xmath and MBSs coexist with additional levels, which arise due to the\nlong length of the N region (see bottom left and right panels in Figs.\n38 and 39 ).\n\nWhen the length of the superconducting regions @xmath is increased,\n@xmath , the two lowest energy levels do not disperse with @xmath and\nthe anti-crossing at @xmath is negligible. Thus, this anti-crossing can\nbe reduced as much as needed taking into account @xmath . In a junction\nmade of two semi-infinity wires, only the inner MBSs are present and the\ncrossing at @xmath is also protected by conservation of the total\nfermion parity, as in the short junction regime.\n\nThe discussion made before can be clarified by considering the\ndependence of the low-energy spectrum on the Zeeman field. This is shown\nin Figs. 40 , 41 and 42 for short, intermediate and long SNS junctions\nat (top row) @xmath and (bottom row) @xmath , while left column for\n@xmath and right column for @xmath . As already discussed before for\nsuperconducting wires or NS junctions, the low-energy levels as function\nof the Zeeman field trace the gap inversion. Here, either at @xmath or\n@xmath one clearly observes such prediction, with the sole difference\nthat at @xmath there are four lowest levels instead of two at @xmath ,\nas can be indeed seen in the phase-dependence energy spectrum ( see for\ninstance Fig. 36 ). In the topological phase @xmath at @xmath , the four\nlowest levels oscillate around zero energy for @xmath , while such\noscillations are remarkably suppressed by making the superconducting\nsection longer @xmath (see bottom panels of Figs. 40 , 41 and 42 ). On\nthe other hand, in the topological phase @xmath at @xmath , only the\nouter MBSs are present developing an oscillatory patter for @xmath ,\nwhich are suppressed for @xmath (see top panels of Figs. 40 , 41 and 42\n).\n\nAn increase in the length of the normal section is reflected by\nincreasing the amount of levels in the energy spectrum. Indeed, observe\nin Figs. 41 and 42 , for intermediate and long junctions, respectively,\nthat additional levels fit in the junction and they appear inside the\nsuperconducting induced gap. As discussed before, in the topological\nphase, @xmath , these levels tend to reduce the minigap (separation\nbetween the energy levels oscillating around zero and the rest of the\nspectrum). However, they also slightly reduce the amplitude of the\noscillations of the energy levels around zero in the topological phase\nand therefore allowing such levels to reach their Majorana character in\nreasonable long superconducting regions (see Figs. 41 and 42 ).\n\nNotice that by comparing the low-energy spectrum of NS junctions, Figs.\n30 , 31 and 32 with those of SNS junctions at @xmath , in the latter\nadditional levels are introduced and those arise from the finite left S\nregion which is considered to model the SNS junction. In the topological\nphase these levels also slightly reduce the amplitude of the\noscillations of the lowest levels around zero, introducing also a\nreduction of the mini-gap, which is bad for potential applications in\ntopological quantum computation as it determines the degree of\nprotection for the qubit. Although there are some limitations, these\nhybrid systems offer a direct way for monitoring the dependence if the\nMBSs on the superconducting phase difference, thus we believe that such\nhybrid structures constitute a powerful platform for the search of MBSs\nin one-dimensional systems.\n\nTo close this part, we emphasise that the energy spectrum of SNS\nnanowire junctions offers the possibility to directly monitor the\nAndreev bound states which trace the gap inversion and allows us to\ninvestigate their evolution into Majorana bound states in a powerful\nway.\n\n#### 11.2 Josephson and critical currents\n\nIn Sec. 9 we have introduced how to calculate the Josephson current\nbased on the discrete Andreev spectrum of SNS junctions\n\n  -- -------- -- ------\n     @xmath      (88)\n  -- -------- -- ------\n\nBefore going further we firstly discuss the validity of previous\nequation in short and long junctions. Notice that we are considering SNS\njunctions of finite length and therefore due to this fact their energy\nspectrum is discrete. Indeed, it consists of a discrete spectrum wihin\nthe gap and of a quasi-continuum, which is also discrete due to the\nfinite length of the system, above the gap. Therefore, Eq.\u2009( 88 ) allows\nus to include the discrete quasi-continuum contribution in the\ncalculation of the Josephson current (supercurrent) @xmath . Having\nestablished this we are in a position to use Eq.\u2009( 88 ) for calculating\nthe Josephson current in both short and long SNS junctions.\n\nMoreover, we define the critical current, @xmath , which is the maximum\nsupercurrent that flows across the junction. It is in general calculated\nby maximizing the Josephson current @xmath with respect to the\nsuperconducting phase difference @xmath ,\n\n  -- -------- -- ------\n     @xmath      (89)\n  -- -------- -- ------\n\nAs before, here we present calculations for InSb nanowires, where the\nspin-orbit strength is @xmath meVnm and the typical induced\nsuperconducting gap @xmath meV [ 67 ] . We expect that the Josepshon and\nthe critical currents capture the presence of Majorana bound states for\nrealistic parameters.\n\nNext, we present the Josephson current based on Eq.\u2009( 88 ). In Figs. 43\nand 44 we present the evolution with the Zeeman field of the Josephson\ncurrent as a function of the superconducting phase difference for finite\nlength short and long SNS junctions, respectively. Left row shows the\nsupercurrent for @xmath , while right row for @xmath . In short SNS\njunctions (Fig. 43 ) at @xmath the Josephson current has the usual\nsine-like behaviour, which is reduced as the Zeeman field increases due\nto the reduction of the induced superconducting gap (see blue curves in\ntop row). Notice that the supercurrent develops two kinks just before\nand after @xmath for finite Zeeman field @xmath (see top panels). These\ncorrespond to the energy level crossings shown in Fig. 36 , which arise\ndue to SOC. Besides these features, the supercurrent curves for @xmath ,\nfor both @xmath and @xmath , exhibit a similar behaviour (see top row).\n\nInterestingly, at the topological transition, @xmath , the system is\ngapless but the current is not zero (see red curve in bottom row). For\n@xmath , the S regions of the SNS junction become topological and\nMajorana bound states emerge at the ends of S. We have shown in Sec. 5\nthat the combination of SOC, Zeeman interaction and @xmath -wave\nsuperconductivity generates two intraband @xmath -wave pairings @xmath\nand one interband @xmath -wave @xmath , where @xmath and @xmath denotes\nthe energy bands. These two @xmath sectors have different gaps @xmath at\nlow and high momemtum, respectively, that depend on the Zeeman field.\nThe gap @xmath is the topological gap which closes at @xmath and gives\nrise to the topological phase for @xmath , while the high momentum gap\nremains finite and roughly constat for strong SOC. We have also seen\nthat the topological phase is effectively reached due to the generation\nof an effective @xmath -wave superconductor, which is the result of\nprojecting the system Hamiltonian onto the lower band keeping only the\nintraband @xmath -wave pairing @xmath . Deep in the topological phase\nthe lowest gap is @xmath . We have shown in Fig. 36 that the Andreev\nlevels are associated with the gaps @xmath and they trace the closing of\nthe reopening of the gap. Remarkably, in the topological phase the\nlowest gap is @xmath and therefore the number of levels within such gap\nis less than in the trivial phase. This causes a reduction in the\nsupercurrent as it is the direct result of the Andreev levels (see\nbottom row in Fig. 43 ). Interestingly, despite the presence of MBSs the\ncurrent is @xmath periodic. For @xmath , there is a finite spatial\nMajorana wave function overlap and therefore the Josephson current in\nthe topological phase tends to decrease (black curves in bottom left\npanel), while for @xmath such overlap is negligible and the current do\nnot decreases but it rather develops a clear sawtooth profile at @xmath\n(see black curves in bottom right panel). Notice that the supercurrent\n@xmath for @xmath shown in left ( @xmath ) and right ( @xmath ) top\npanels of Fig. 43 exhibit a similar behaviour even despite the length of\nthe superconducting regions @xmath is different in both cases. Quite\nremarkably the supercurrent for @xmath , shown in left and right bottom\npanels of Fig. 43 , exhibits a different dependence on @xmath due to the\nemergence of MBSs. While for @xmath (left bottom panel) the finite\nspatial overlap of Majorana wave-functions obscures the direct detection\nof MBSs, for @xmath (right bottom panel) the sawtooth profile at @xmath\ndetermines the presence of MBSs and this happens only for @xmath .\n\nAs the length of the normal region is increased, one expects the\nJosephson current to be reduced. This is shown in Fig. 44 for a long\njunction considering @xmath and @xmath and spanning the trivial and\ntopological phase. Notice that although the amplitude of the current is\nreduced in this case, the behaviour is similar to the short junction\nregime. Indeed, in the trivial phase (blue curves in top row), as one\nincreases the Zeeman field, the current gets reduced. As the system\nenters into the topological phase, we distinguish two situations. For a\nfinite Majorana wave function overlap @xmath , in the topological phase,\nthe current decreases signalling the non-zero splitting at @xmath in the\nenergy spectrum. However, for @xmath , as the Zeeman field increases in\nthe topological phase, the Josephson current acquires a constant value\nand it develops a clear sawtooth signature at @xmath due fact that the\nsplitting in the energy spectrum at @xmath is zero.\n\nNow, we present results for the critical current in short SNS junctions.\n\nIn Fig. 45 we present calculations of the critical current @xmath in\nshort SNS junctions as the Zeeman field @xmath increases from the\ntrivial ( @xmath ) to the topological phase ( @xmath ). Different curves\nin top left panel correspond to different values of the superconducting\nregion length @xmath . Observe that the current is maximum at zero field\nand as the Zeeman field @xmath increases the current decreases almost\nlinearly tracing the reduction of the low-momentum gap @xmath discussed\nin Sec. 5 . We have shown that such gap closes at @xmath and marks the\ntopological transition point into the topological superconducting phase\nwith MBSs.\n\nRemarkably, at the topological transition, @xmath , the critical current\nremains finite and develops a robust non-trivial feature, which is the\nresult of the closing of the gap in the energy spectrum. Roughly\nspeaking half of its value at @xmath because the system is losing one\nchannel after the topological transition. As the the Zeeman field is\nfurther increased for @xmath , the critical current develop\noscillations, which arise from the finite spatial overlap of the\nMajorana wave functions when @xmath . Notice that one way to reduce such\noverlap consists of increasing @xmath , as it can be seen in top left\npanel. On the other hand, one can also reduce it by increasing the SOC\nand therefore decreasing the Majorana localisation length, as shown in\ntop right panel. Although both ways are efficient, the former is more\nrealistic including the variation of the length of the proximitized\nregion, while the latter requires to increase a material property (the\nSOC) or to increase it by electrostatic gates, which is not an easy task\nat all. Notice that while in the former case, the effect of increasing\n@xmath only reduces the oscillations of the critical current in the\ntopological phase without affecting its value in general, in the latter\nsituation, by increasing the SOC, the critical current is increased.\nExperimentally, however, is not very easy to fabricate SNS junctions\nwith a perfect coupling between N and S regions, although recently there\nhas been a considerable increase in fabrication techniques of such\nsystems. In subsection 10.4 , we have shown that the coupling between\nthe N and S regions can be parametrised by the parameter @xmath . In\nprinciple, by varying such coupling, one can control the transparency,\nwhere @xmath determines a full transparent junction. In bottom panel of\nFig. 45 we show the critical current as a function of the Zeeman field\nfor different values of @xmath in a finite length SNS short junction.\n\nNotice that as the control parameter @xmath decreases, the critical\ncurrent also decreases. In the trivial phase, @xmath , for small values\nof @xmath , the critical current is considerable reduced and even zero.\nRemarkable, however, the critical current develops a robust feature at\nthe closing of the topological gap and it exhibits a finite value for\nall @xmath . In the topological phase, @xmath , the critical current\nshows a non-monotonic behaviour for increasing @xmath with oscillations\ndue to Majorana overlap.\n\nThus, from changes in @xmath these features could be used to detect the\ntopological transition and therefore the topological phase with Majorana\nbound states.\n\n### 12 Conclusions\n\nIn this Chapter we have introduced the basic phenomena that takes place\nin hybrid NS and SNS junctions. Then, we have shown how to model such\nsystems based on nanowires with spin-orbit coupling assuming good\ncontact between nanowire and superconductor.\n\nA detailed study of the Andreev bound states have been presented and the\nemergence of Majorana bound states have been investigated for short and\nlong SNS junctions. In this part, we showed the Andreev bound states as\nfunction of the superconducting phase difference for different values of\nthe Zeeman field, spanning the trivial and topological phases. At this\nlevel, we point out that, in principle, Andreev levels spectroscopy\nshould be able to test the emergence of MBSs.\n\nAfterwards we have focused on the Josephson current dependence on the\nsuperconducting phase difference, calculated from the Adreev spectrum in\nshort and long SNS junctions. We have found that the presence of MBSs in\nthe topological phase is a distinguishable signature in the Josephson\ncurrent despite of being @xmath periodic. Indeed, in the topological\nregime, the Josephson current is reduced since the number of ABSs is\nreduced. Additionally, when the spatial overlap is negligible between\nthe MBSs, the Andreev spectrum is translated into the Josephson current\nin a clear sawtooth profile at @xmath , representing a clear\nmanifestation of the MBSs.\n\nWe also present the critical current as a function of the Zeeman field.\nThis quantity allows us to make a detailed study of the topological\ntransition and trace the behaviour of the topological gap, which after\nthe band inversion gives rise to the topological phase with MBSs. We\nreport that the topological transition point is a robust feature, which\nwe expect to be distinguishable from other mechanisms in real\nexperiments.\n\n## Chapter \\thechapter Voltage-biased transport in SNS\njunctions121212The results presented in this chapter have been published\nin [138].\n\nWe study transport in a voltage biased\nsuperconductor-normal-superconductor (SNS) junction made of\nsemiconducting nanowires with strong spin-orbit coupling, as it\ntransitions into a topological superconducting phase for increasing\nZeeman field. Despite the absence of a fractional steady-state ac\nJosephson current in the topological phase, the dissipative multiple\nAndreev reflection (MAR) current @xmath at different junction\ntransparencies is particularly revealing. It exhibits unique features\nrelated to topology, such as the gap inversion, the formation of\nMajorana bound states, and fermion-parity conservation. Moreover, the\ncritical current @xmath , which remarkably does not vanish at the\ncritical point where the system becomes gapless, provides direct\nevidence of the topological transition. These results demonstrate the\nfeasibility to probe the formation of Majorana states without the need\nof phase sensitive or noise-related measurements. Therefore, for\njunctions with tuneable transparency, this collection of signatures\nconstitutes an unmistakable fingerprint of Majorana bound states.\n\n### 13 Introduction\n\nIn Chapter Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states we have shown that\nsemiconducting nanowires (NWs) with a strong spin-orbit (SO) coupling in\nthe proximity of s-wave superconductors and in the presence of an\nexternal Zeeman magnetic field @xmath are a promising platform to study\nMajorana physics. Theory predicts that above a critical field @xmath ,\ndefined in terms of the Fermi energy @xmath and the induced s-wave\npairing @xmath , the wire undergoes a topological transition into a\nphase hosting zero energy Majorana bound states (MBSs) at the ends of\nthe wire [ 61 , 150 ] . We have discussed in Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states that the emergence of a zero-bias peak in\nthe differential conductance @xmath supports the existence of MBSs at\nnormal-superconductor (NS) junctions. Stronger evidence could be\nprovided by the observation of non-Abelian interference (braiding) [ 85\n] , or by transport in phase-sensitive\nsuperconductor-normal-superconductor (SNS) junctions. The latter\napproach, which typically involves the measurement of an anomalous\n\u201cfractional\" @xmath -periodic ac Josephson effect [ 86 , 66 , 87 ] , is\nmuch less demanding than performing braiding. Realistically, however,\nthe fractional effect, detected through, e.g., the absence of odd steps\nin Shapiro experiments [ 87 , 88 , 89 , 90 ] , may be difficult to\nmeasure (dissipation is expected to destroy it in the steady state), or\nmay even develop without relation to topology [ 91 ] . Although it has\nbeen shown that the @xmath periodicity survives in the dynamics, such as\nnoise and transients [ 72 , 92 , 93 ] , simpler experimental probes of\nMBSs are extremely desirable.\n\nHere we propose the multiple Andreev reflection (MAR) current in\nvoltage-biased SNS junctions made of NWs [ 78 , 99 ] as an alternative,\nremarkably powerful, yet simple tool to study the topological\ntransition. This is made possible by the direct effect that gap\ninversion, MBS formation and fermion-parity conservation have on the MAR\ncurrent @xmath at various junction transparencies @xmath . For tunnel\njunctions, @xmath traces the closing and reopening of the\nsuperconducting gap at @xmath , @xmath . This gap inversion can be shown\nto be a true topological transition by tuning the junction to perfect\ntransparency @xmath . In this regime, the limiting current @xmath shows\nsignatures of the parity conservation effects that are responsible for\nthe fractional Josephson current in the presence of MBSs, but which, in\ncontrast to the latter, survive in the steady state limit. Moreover, the\ndetailed dependence of MAR as a function of @xmath has the fundamental\nadvantage over NS junctions in that it contains information about the\npeculiar dependence of MBS hybridization with superconductor phase\ndifference @xmath , despite not requiring any external control on it.\nSimilarly, we show that another important phase-insensitive quantity,\nthe critical current @xmath , remains unexpectedly finite for all @xmath\ndue to a significant continuum contribution, and exhibits an anomaly at\nthe topological transition.\n\nThis chapter is organized as follows. In section 14 , we review the\nmodel for Rashba nanowires in the presence of both s-wave\nsuperconducting pairing and an external Zeeman field and describe how a\nspinless p-wave superconductor regime can be achieved. In particular, we\ndiscuss how the problem can be understood in terms of two independent\np-wave superconductors, originated from the Rashba helical bands, and\nweakly coupled by an interband pairing term. This two-band description\nis very useful in order to understand the main results of this paper.\nSuch results are discussed in section 15 which is divided in two parts.\nThe first part (subsection 15.1 ) is devoted to the ABSs which are\nconfined in the junction. The detailed evolution of these ABSs as the\nsystem undergoes a topological transition has not been discussed in the\nliterature, to the best of our knowledge, and becomes essential in order\nto gain a deep understanding of transport across the junction, which is\ndiscussed in subsection 15.2 . In this part we study the ac Josephson\neffect in nanowire SNS junctions, with focus on how the MAR currents\nreflect the topological transition in the nanowires as the Zeeman field\nincreases. In particular, we present a thorough analysis of MAR\ntransport in topological SNS junctions for arbitrary transparency of the\nnormal part. Finally, we discuss in section 16 how the critical current\n@xmath does not vanish at the critical point where the system becomes\ngapless and, importantly, how @xmath provides direct evidence of the\ntopological transition.\n\n### 14 Rashba nanowire model and effective p-wave pairing\n\nBefore going further we firstly review the possibility for engineering\none-dimensional topological superconductivity based based on nanowires\nwith SOC in proximity to a @xmath -wave superconductor (see Chapter\nHybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states for more details). A single\none-dimensional NW in the normal state is described by the Hamiltonian\n\n  -- -------- -- ------\n     @xmath      (90)\n  -- -------- -- ------\n\nwhere @xmath is the effective mass, @xmath the SO strength, @xmath the\nchemical potential and @xmath the spin Pauli matrices. An external\nmagnetic field @xmath along the wire produces a Zeeman splitting @xmath\n, where @xmath is the Bohr magneton and @xmath is the wire g-factor. The\nNambu Hamiltonian\n\n  -- -------- -- ------\n     @xmath      (91)\n  -- -------- -- ------\n\nmodels the NW in the presence of an induced s-wave superconducting\npairing @xmath (here assumed real without loss of generality). The\nessential ingredient for a topological superconductor is an effective\np-wave pairing acting on a single (\u201cspinless\") fermionic species [ 86 ]\n. SO coupling splits NW states into two subbands of opposite helicity at\n@xmath . At finite @xmath , these two subbands, which we label @xmath\nand @xmath [black and orange lines in Fig. 46 (a)], have spins canted\naway from the SO axis. Notice that here we have a notation opposite to\nthe one given in Chap. Hybrid superconductor-semiconductor nanowire\njunctions as useful platforms to study Majorana bound states . The\ns-wave pairing @xmath , expressed in the @xmath basis, takes the form of\nan intraband p-wave @xmath , plus an interband s-wave pairing @xmath [\n51 ] .\n\nWithout the latter, the problem decouples into two independent p-wave\nsuperconductors, while @xmath acts as a weak coupling between them. Each\nquasi-independent @xmath sector has a different ( @xmath -dependent)\ngap, which we call @xmath (at small @xmath ) and @xmath (large @xmath ),\nsee Fig. 46 (a,b). While @xmath remains roughly constant with @xmath\n(for strong SO coupling [ 70 , 71 ] ), @xmath vanishes linearly as\n@xmath approaches the critical field, @xmath \u00b9\u2074 \u00b9\u2074 14 Note that, in\ngeneral, @xmath is at a small but finite momentum. However, as @xmath\napproaches @xmath , @xmath becomes centered at @xmath and is\napproximately equal to @xmath , where @xmath is the zero momentum energy\nof the lowest subband, @xmath , and is related to the topological charge\nof the lowest superconducting band. [ 151 ] . This closing and reopening\n(gap inversion) signals a topological transition, induced by the\neffective removal of the @xmath sector away from the low-energy problem.\nBelow @xmath the NW is composed of two spinless p-wave superconductors,\nand is therefore topologically trivial. Above @xmath , @xmath is no\nlonger a p-wave gap, but rather a normal (Zeeman) spectral gap already\npresent in the normal state, transforming the wire into a single-species\np-wave superconductor with non-trivial topology. This phase contains\nMBSs, protected by the effective gap @xmath , at the wire ends. Above a\ncertain field @xmath , the gap @xmath saturates at @xmath and the\nphysics of superconducting helical edge states in spin-Hall insulators\nis recovered [ 66 , 72 ] .\n\n### 15 Nanowire SNS junctions\n\nIn the previous section we described how a semiconducting nanowire with\na strong SO coupling in the proximity of an s-wave superconductor and in\nthe presence of an external Zeeman magnetic field @xmath behaves as a\ntopological superconductor above a critical field @xmath . See also\nChapter Hybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states for further details.\n\nHere we are concerned with the effects of this topological transition on\nthe MAR current @xmath across junctions formed with such nanowires. In\nparticular, we consider SNS junctions of different normal transparencies\n@xmath . Experimentally, such geometry can be fabricated by partially\ncovering a single NW with two superconducting leads and leaving an\nuncovered normal region in the middle. The coupling of the normal part\nof the NW to the superconducting leads can be tuned by local control of\nthe electron density with a gated constriction. This can be realized by\nusing, e.g., bottom-gates forming a quantum point contact, see Fig. 47 .\nSuch geometry has been successfully implemented experimentally in Ref. [\n48 ] for NS junctions, where control of the coupling between the\nsuperconducting and normal sections from near pinch-off (tunneling\nlimit) to the multichannel regime is demonstrated. We point out that the\nSNS junctions taken into account here differ from the ones discussed in\nChapter Hybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states in that the superconducting\nleads are semi-infinite unlike the finite length ones in Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states .\n\nFor simplicity, here we focus on short SNS junctions \u00b9\u2075 \u00b9\u2075 15 Results\nfor the long junction limit are discussed in Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states with single channel nanowires. For\ncomputation purposes, we consider a discretisation of the continuum\nmodel Eq. ( 90 ) for the Rashba nanowire into a tight-binding lattice\nwith a small lattice spacing @xmath , as describes in Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states . This transforms terms containing the\nmomentum operator @xmath into nearest-neighbour hopping matrices @xmath\n. Namely @xmath , with\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nare matrices in spin space, and @xmath . The pairing is incorporated\nlike in Eq. ( 91 ). A short SNS junction is modelled by suppressing the\nhopping matrix @xmath between two sites in the middle of the wire, which\nrepresent the junction. The dimensionless factor @xmath controls the\njunction\u2019s normal transparency at @xmath , which we denote @xmath . A\nphase difference @xmath across the junction is implemented by\nmultiplying @xmath to the left and right of the junction by @xmath ,\nrespectively. Despite the simplicity of this description, it contains\nthe relevant physics of a short SNS junction. As it has been shown for\nstandard junctions [ 152 ] , such physics essentially depend on the\ncontact normal transmission as well as the voltage drop across it \u00b9\u2076 \u00b9\u2076\n16 Note that, for the sake of simplicity, we do not include the\npossibility of junctions containing resonant levels or quantum dots. A\nstudy of such junctions, including Coulomb blockade effects, is beyond\nthe scope of this paper but might be useful in order to analyse the\npossibility of Majorana physics arising in experiments with short SNS\njunctions containing quantum dot nanowires, such as the ones reported in\nRef. [ 128 ] . Thus, we expect that a more detailed modeling, including\ne.g. a spatially-dependent voltage drop, would only modify the effective\ntransmission @xmath which defines the different regimes we shall explain\nin the following.\n\n#### 15.1 Andreev bound states\n\nIn Chapter Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states finite length SNS\njunctions and therefore we discussed the system with four MBSs, two\ninner at the junction and two outer at the ends of the superconducting\nregions. Here, however, take into account semi-infinite superconducting\nleads so that the outer MBSs are not involved in the description.\n\nIn such short SNS junction, an ABS should form for each of the two\np-wave sectors described in section 14 for @xmath , while only one,\nassociated to @xmath , should remain for @xmath . To support this\npicture, we present calculations of the local density of states (LDOS)\nat the junction in the transparent limit ( @xmath ). This LDOS is peaked\nat the energy @xmath of the ABS, which is a function of the phase\ndifference @xmath across the junction. For @xmath (Fig. 48 a) the two\nABSs are degenerate and confined within the gap @xmath \u00b9\u2077 \u00b9\u2077 17 Note\nthat even this non-topological case is anomalous as the ABS energies do\nnot reach zero at @xmath , unlike predicted by the standard theory for a\ntransparent channel @xmath within the Andreev approximation @xmath [ 144\n] . We have checked that the energy minimum @xmath does indeed vanish as\n@xmath grows, see Fig. 95 in H . As the Zeeman field increases, Fig. 48\nb, the two ABS split and the system develops the two distinct gaps\n@xmath and @xmath described in Section 14 . Note that both ABSs are\ntruly bound at energies below the lowest gap @xmath , but only\nquasibound in the energy window @xmath . This is clearly seen in the\nplots as broadening of the ABS resonances (see, e.g. Fig. 48 c). As\n@xmath approaches the critical field @xmath , @xmath gets reduced, and\nbecomes exactly zero at @xmath . Note that at this point the upper ABS\nhas reached zero energy at @xmath and is quasibound for all energies,\nFig. 48 d. Upon entering the topological phase ( @xmath ), @xmath\nreopens but one of the ABSs of the problem has disappeared (Fig. 48 e).\nThe surviving ABS associated to @xmath arises as the hybridisation of\nthe two emerging MBSs across the junction. Global fermion-parity\nconservation protects the @xmath level crossing. Due to the residual\n@xmath coupling between the two sectors, the @xmath Andreev state is\nonce more quasibound in the energy window @xmath . At high enough\nmagnetic fields, @xmath is the smallest gap of the problem and hence the\nMajorana ABS is truly bound, Fig. 48 f. In long junctions, more ABSs can\nbe confined in the junction as discussed in Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states [ 139 , 153 ] . These extra ABSs coexist\nwith the ones described here and may, for example, anti-cross with the\nMajorana-like @xmath Andreev level, affecting its character near zero\nenergy [ 70 , 139 ] .\n\n#### 15.2 ac Josephson effect and MAR currents\n\nUnder a constant voltage bias @xmath , the pairings @xmath to the left\nand right of the junction acquire an opposite and time-dependent phase\ndifference,\n\n  -- -------- -- ------\n     @xmath      (92)\n  -- -------- -- ------\n\nThis induces Landau-Zener transitions between the ABSs and into the\ncontinuum, thereby developing a time dependent Josephson current with\nboth @xmath and @xmath components. Such is the point of view in e.g.\nRefs. [ 154 , 92 ] . Alternatively, @xmath can be gauged away into the\nhopping across the junction, @xmath , where @xmath is the @xmath -Pauli\nmatrix in Nambu space. By employing Keldysh-Floquet theory [ 152 , 155 ]\n, we obtain the stationary-state time-dependent ac Josephson current\n\n  -- -------- -- ------\n     @xmath      (93)\n  -- -------- -- ------\n\n(note that only even harmonics survive, see F for full details). Here,\nwe concentrate on the dc-current @xmath . The results for @xmath at\nsmall, intermediate and full transparency are summarised in Fig. 49\n(a-c) for increasing values of @xmath spanning the topological\ntransition.\n\n##### 15.2.1 Tunneling regime.\n\nFor non-topological tunnel junctions, dc-transport vanishes below an\nabrupt threshold voltage (Fig. 49 (a), blue curves)\n\n  -- -------- -- ------\n     @xmath      (94)\n  -- -------- -- ------\n\nThis well known result follows from the fact that there are no\nquasiparticle excitations in the decoupled wires for energy @xmath if\n@xmath . Indeed, to second order in perturbation theory in @xmath , the\nMAR current takes the form of a convolution between @xmath and @xmath ,\nwhere @xmath is the decoupled ( @xmath ) spectral density at each side\nof the junction ( G ). [The trace of @xmath , proportional to the LDOS,\nis shown in Fig. 50 (a)]. Hence, as @xmath increases, the tunnelling\ncurrent threshold follows the closing of the gap in the LDOS, until\n@xmath vanishes and @xmath becomes linear in small @xmath at @xmath\n(black curve). As @xmath , the gap reopens, but the threshold is now\nhalved to (Fig. 49 (a), red curves)\n\n  -- -------- -- ------\n     @xmath      (95)\n  -- -------- -- ------\n\nNote that the small step visible at @xmath is the second-order MAR,\nwhose relative height vanishes as @xmath . The change, easily detectable\nas a halving of the slope of the threshold @xmath across @xmath , is due\nto the emergence of an intra-gap zero-energy MBS in the topological\nphase [see zero energy peak in Fig. 50 (a)], which opens a tunnelling\ntransport channel from or into the new zero energy state. Moreover, when\n@xmath , @xmath surpasses @xmath , and @xmath saturates at @xmath . This\nis directly visible in @xmath as a kink at @xmath [see dashed and dotted\nlines in Fig. 49 (a)] \u00b9\u2078 \u00b9\u2078 18 Similar considerations may apply to\nrecent experiments with lead nanoconstrictions formed in an STM tip, see\nRef. [ 156 ] . .\n\n##### 15.2.2 Intermediate transparency regime.\n\nAs transparency increases, subharmonic MAR steps develop at voltages\n\n  -- -------- -- ------\n     @xmath      (96)\n  -- -------- -- ------\n\nas shown Fig. 49 (b) The specific profile of each step with @xmath still\ncontains information on the LDOS of the junction at energies around\n@xmath . At @xmath , the power-law LDOS for @xmath results in a\nstaircase-like curve @xmath [blue line in Fig. 49 (d)]. This shape is\nroughly preserved up to @xmath . For @xmath the MAR profile changes\nqualitatively, however. The subharmonic threshold voltages\n\n  -- -------- -- ------\n     @xmath      (97)\n  -- -------- -- ------\n\nare halved (since @xmath is halved), and the MAR current profile becomes\noscillatory instead of step-like. A blowup of the oscillations is\npresented in Fig. 49 (d) (red curve), together with guidelines for the\ncorresponding @xmath in gray.\n\nThe emergence of oscillatory MAR steps, which here is connected to the\nformation of zero energy peaks in the LDOS owing to the localized MBSs,\nis well known in Josephson junctions containing a resonant level [ 157 ,\n158 , 159 ] . Note, however, that the oscillations in a topologically\ntrivial system, such as for instance a quantum dot between two\nsuperconductors, arise at odd fractions of @xmath , i.e. at voltages\n@xmath , instead of the @xmath of the Majorana case. Interestingly, this\ndifference is ultimately due to the fact that a resonant level spatially\nlocalised within the junction cannot carry current directly into the\nreservoirs, while a zero energy MBS (essentially half a non local\nfermion) can. This same situation arises in @xmath -wave Josephson\njunctions, which also exhibit oscillatory @xmath MAR subharmonics owing\nto the presence of mid gap states [ 160 ] .\n\n##### 15.2.3 Transparent limit.\n\nIn the limit @xmath , ABS energies @xmath [Fig. 48 (c)] touch the\ncontinuum at @xmath . This has an important consequence. From the\nLandau-Zener point of view of the ac Josephson effect [ 154 ] , the time\ndependence of @xmath for an arbitrarily small @xmath will induce the\nescape of any quasiparticle occupying an ABS into the continuum after a\nsingle @xmath cycle. A given ABS becomes occupied with high probability\nin each cycle around @xmath if the rate @xmath exceeds its energy\nminimum @xmath . (Recall this energy is finite, since the Andreev\napproximation does not apply, see H .) One quasiparticle is then\ninjected into the continuum per cycle, and a finite @xmath arises. Below\nsuch voltage, however, the ABS remains empty, so that if @xmath is\nfinite, as is the case of a realistic non-topological junction [see Fig.\n48 (a-c)], one obtains @xmath (valid for any transparency at @xmath ).\nThis is in contrast to the conventional @xmath , @xmath result @xmath ,\npredicted within the Andreev approximation ( @xmath ).\n\nAfter the topological transition, this picture changes dramatically. The\ntwo MBSs at each side of the junction hybridise for a given @xmath into\na single ABS. This seemingly innocent change has a notable consequence.\nSince fermion parity in the superconducting wires is globally preserved,\nan anticrossing at @xmath , which would represent a mixing of a state\nwith one and zero fermions in the lone ABS, is forbidden. Parity\nconservation therefore imposes @xmath in the presence of MBSs,\nirrespective of @xmath or @xmath \u00b9\u2079 \u00b9\u2079 19 Note that residual splitting\nmay survive in the topological phase for finite length nanowires, for\nwhich a finite (albeit exponentially small) coupling between four MBSs\nexist. . This is a true topologically protected property of the\njunction, and gives rise to a finite @xmath , i.e. half the value\nexpected for the non-topological junction in the Andreev approximation.\nThis abrupt change is shown in Fig. 49 (c,e). The @xmath MAR current in\ntransparent junctions, therefore, directly probes the emergence of\nparity protection.\n\n### 16 Critical current\n\nIn the transparent limit, a supercurrent peak [ 78 , 99 , 161 ] may\nhinder the experimental identification of the @xmath limit, but itself\nholds valuable information about the transition. The critical current\n@xmath may be computed in general by maximizing the @xmath\n(time-independent) current @xmath respect to @xmath (including the\ncontribution from the continuum) as shown in the last part of Chapter\nHybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states . For a short transparent\njunction at @xmath , @xmath is maximum, and equal to @xmath in the\nAndreev approximation. Fig. 50 (b) shows @xmath for increasing values of\n@xmath . Naively, one may expect that a junction without a\nsuperconducting gap should not carry a finite supercurrent, but this is\nnot the case here. At @xmath , @xmath is finite \u00b2\u2070 \u00b2\u2070 20 Note also that\nin junctions with trivial superconductors, @xmath as the nanowire\nbecomes helical at @xmath [ 162 ] . Our result is therefore another\nnontrivial consequence of topology in the junction. , while @xmath [the\njunction LDOS at criticality is also gapless, see Fig. 50 (a)]. This\ngapless supercurrent comes from the @xmath quasi-bound Andreev state in\nthe continuum, which contributes almost as if it were a subgap ABS. It\nis thus a reasonable approximation to write @xmath as the sum of the\ncritical current from each ABS. For @xmath , @xmath . The @xmath\ncontribution, however, should not be included for @xmath , leading to a\ndiscontinuity in @xmath . This simple model gives a qualitative fit\n[dotted line in Fig. 50 (b)] to the exact numerics (solid line), with\ndeviations coming from corrections to the Andreev approximation, and\ncontributions above @xmath . Additional deviations in experiments,\ncoming e.g. from the finite impedance of the electromagnetic\nenvironment, are not expected to alter the discontinuity in @xmath ,\nwhich remains a signature of the topological transition.\n\nNote that we also present results for the critical current in short SNS\njunctions in Chap. Hybrid superconductor-semiconductor nanowire\njunctions as useful platforms to study Majorana bound states .\n\n### 17 Conclusions\n\nIn conclusion, we have shown that the dc-current in voltage biased\nJosephson junctions is a flexible experimental probe into the various\naspects of the topological superconducting transition in semiconducting\nnanowires. Tuning the junction transparency one may obtain evidence of\nMBS formation as conclusive as a fractional Josephson effect, without\nrequiring control of the junction phase. Moreover, we have found that\nthe critical current in the wire does not vanish at the transition due\nto above-gap contributions, although its derivative with @xmath exhibits\na discontinuity as a result of the disappearance of one ABS. This\nbehavior of @xmath provides a direct evidence of the topological\ntransition. MAR spectroscopy and critical current measurements in\nnanowires similar to the ones studied here have already been reported [\n78 , 99 ] .\n\nAlthough we have focused here on the simplest case (single-band, short\njunction limit) we expect the main features of the topological\ntransition to remain robust under more general conditions. Preliminary\nresults in the quasi-one dimensional multiband case show that @xmath is\na non-monotonic function for increasing magnetic fields. For weak\ninterband SO mixing [ 75 ] , the behavior discussed in Fig. 50 (b) can\nbe generalized and @xmath presents a series of minima at different\nfields corresponding to the topological transition of each subband.\n\nImportantly, the alternative physical scenarios, such as, e. g.,\ndisorder [ 101 , 105 , 83 , 106 ] or Andreev bound states [ 49 ] , that\nproduce ZBAs in NS junctions (and thus mimic Majorana physics), cannot\ngive the distinct features associated to global parity that were\ndiscussed here for SNS junctions. We therefore believe that experiments\nalong the lines discussed in this paper could provide the first\nunambiguous report of a topological transition in nanowires, and the\nemergence of Majorana bound states.\n\n## Chapter \\thechapter SNS junctions in nanowires with spin-orbit\ncoupling: role of confinement and helicity on the sub-gap\nspectrum212121The results presented in this chapter have been published\nin [139].\n\nWe study normal transport and the sub-gap spectrum of\nsuperconductor-normal-superconductor (SNS) junctions made of\nsemiconducting nanowires with strong Rashba spin-orbit coupling. We\nfocus, in particular, on the role of confinement effects in long\nballistic junctions. In the normal regime, scattering at the two\ncontacts gives rise to two distinct features in conductance, Fabry-Perot\nresonances and Fano dips. The latter arise in the presence of a strong\nZeeman field @xmath that removes a spin sector in the leads ( helical\nleads), but not in the central region. Conversely, a helical central\nregion between non-helical leads exhibits helical gaps of half-quantum\nconductance, with superimposed helical Fabry-Perot oscillations. These\nnormal features translate into distinct subgap states when the leads\nbecome superconducting. In particular, Fabry-Perot resonances within the\nhelical gap become parity-protected zero-energy states (parity\ncrossings), well below the critical field @xmath at which the\nsuperconducting leads become topological. As a function of Zeeman field\nor Fermi energy, these zero-modes oscillate around zero energy, forming\ncharacteristic loops, which evolve continuously into Majorana bound\nstates as @xmath exceeds @xmath . The relation with the physics of\nparity crossings of Yu-Shiba-Rusinov bound states is discussed.\n\n### 18 Introduction\n\nMajorana fermions, particles that are their own antiparticles, have been\nthe subject of intense research over the past decades in the context of\nparticle physics and cosmology [ 30 , 163 ] . In Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states we have discussed that during last few years\nthis interest extended to the condensed matter arena where Majorana\nfermions are intensely studied nowadays [ 31 , 53 ] . This state of\naffairs has been driven by the key observation that emergent\nquasiparticles in superconductors can be described as Majorana fermions\n[ 51 , 164 , 29 , 52 , 53 ] . This, together with the recent advances in\nthe field of topological materials [ 6 , 7 ] , has spurred an intense\nsearch for condensed matter realizations of Majorana fermions. Most of\nthese realizations focus on zero-energy modes inside the gap of\ntopological superconductors. Thus, instead of Majorana fermions, they\nare now more precisely referred to as Majorana bound states (MBSs) or\nMajorana zero modes. \u00b2\u00b3 \u00b2\u00b3 23 It has been argued that Bogoliubov\nquasiparticles in conventional superconductors are true Majorana\nfermions [ 32 ] ). Their Majorana fermion nature can be revealed by\nannihilation processes, see [ 165 ] . .\n\nWe have seen in Chapter Hybrid superconductor-semiconductor nanowire\njunctions as useful platforms to study Majorana bound states that MBSs\ncan emerge in exotic superconductors, such as p-wave, since they realize\ntopological phases that support edge excitations with Majorana fermion\ncharacter [ 166 , 28 , 167 , 23 , 27 , 168 ] . and a physical promising\nplatform is based on the proximity effect between a conventional s-wave\nsuperconductor and a semiconductor nanowire (NW) with strong spin-orbit\n(SO) coupling [ 169 , 38 , 39 , 61 , 150 ] . It has been shown [ 61 ,\n150 ] that if an external Zeeman field @xmath , orthogonal to the SO\naxis, exceeds a critical value @xmath , where @xmath is the Fermi energy\nand @xmath the induced s-wave pairing, zero energy MBSs emerge at the\nnanowire ends signaling a topologically non-trivial phase.\n\nUnfortunately, the outcome of the simplest detection protocol for MBSs\nin NW devices [ 110 , 111 , 81 ] , detection of subgap zero modes\nthrough zero-bias anomalies in transport [ 67 , 128 , 46 , 47 , 48 , 49\n] , can be obscured, or even mimicked, by other effects as discussed in\nChapter Hybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states [ 103 , 101 , 105 , 83 , 106 ,\n70 , 107 , 104 ] . In this Chapter we go beyond zero-bias anomaly\nexperiments and study more complex geometries such as\nSuperconductor-Normal-Superconductor (SNS) junctions [ 126 , 127 , 170 ]\n. This geometry has a number of advantages including the possibility of\nstudying supercurrents [ 128 , 78 , 98 , 99 , 129 ] , or direct\nspectroscopy of Andreev bound states (ABS) [ 130 , 131 , 132 , 133 , 134\n, 135 , 136 , 49 , 137 ] as shown in Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states . As we shall discuss, this latter technique\ncan be used, in principle, to directly monitor the detailed evolution\nfrom the trivial to the nontrivial regime (see also Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states ). Previous papers have mostly focused on\nshort junctions [ 126 , 171 , 172 , 173 , 174 ] and detailed studies of\nABS in long and intermediate-length junctions has been carried out in\nChap. Hybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states , while the study of other\neffects (such as confinement and helicity) remain largely unaddressed.\nIn particular, the role of Fabry-Perot resonances occurring in normal\ntransport as the middle NW finite-lenght section of the junction is\ndepleted has never been studied to the best of our knowledge. In this\nwork we fill this void and present detailed calculations of the normal\nconductance and Andreev spectra in such geometries. We emphasize here\nthat all nanowire experiments should ideally belong to the category\nstudied here, as confinement effects should be present when a ballistic\nquasi-one dimensional conductor is contacted between leads, especially\nwhen the normal part of the NW (in our geometry, the region of length\n@xmath not directly in contact with leads) is gated. This electrical\ngating naturally creates quantum wells (or barriers) with their\nassociated confined quantum levels in the middle region of the NW.\n\nIn the first half of this work, we discuss normal transport across a\nfinite length ballistic NW. We show how bandstructure details in the\npresence of strong Rashba SO coupling and Zeeman fields may dominate\ntransport, and give rise to distinct features associated to helical\nphases (defined by singly-degenerate subbands at the Fermi level with\nspin locked to momentum) known as helical gaps (Fig. 51 ). Likewise,\nfinite contact resistance induces confinement resonances in conductance\nas quasibound states develop in the NW. In the simplest case of\nnon-interacting electrons \u00b2\u2074 \u00b2\u2074 24 Coulomb blockade effects will be\ndiscussed elsewhere. , we find that confinement generates two types of\nresonances: Fabry-Perot resonances and helical Fano dips. Fabry-Perot\nresonances for a spinful mode [ 175 ] will give conductance oscillations\nwith a ceiling of @xmath , unless the central NW is depleted into its\nhelical regime, in which case one may observe helical Fabry-Perot\nresonances with a half-quantum @xmath ceiling. For long enough\njunctions, many helical Fabry-Perot resonances may occur. We discuss\nthat, while confinement effects may mask the helical gap, the\ncharacteristic reentrance of helical Fabry-Perot resonances with Zeeman\nfield or gate voltage contains valuable information about non-trivial\nhelical transport through the NW. The second kind of resonances are\nsharp Fano dips when the central section of the NW is gated to form a\nquantum well (non-helical) and the NW sections below the contacts (the\nleads) are helical. Therefore, both types of resonant features in normal\ntransport may signal the helical regime in different sections (central\nor below the contacts) of the NW. In the presence of superconducting\nleads, the two lead to distinct effects.\n\nIn the second half of this work we consider the connection of this\nphenomenology to transport in the superconducting regime. Each helical\nFano dip in the normal phase translates, in an SNS geometry, into a\nsingle subgap state that crosses zero energy as a function of external\nparameters (Fermi energy or Zeeman field). Such a crossing is often\nknown as a parity crossing , since it is protected by conservation of\nnumber parity in the junction. As we discuss, these parity crossings are\nmade possible by the nontrivial topology in the underlying effective\np-wave superconductor for @xmath . Similar bound states originated from\nnonmagnetic impurities in topological superconductors and superfluids\nhave been recently discussed in Refs. [ 176 , 177 ] and can be\nconsidered the p-wave counterparts of Yu-Shiba-Rusinov bound states [\n178 , 179 , 180 , 181 , 182 ] in standard s-wave superconductors with\nmagnetic impurities. A more direct analogy with standard\nYu-Shiba-Rusinov magnetic bound states actually applies in the\nnon-topological phase @xmath . In this situation, helical Fabry-Perot\nresonances in normal conductance translate, in the superconducting\nregime, into loops around zero energy in the ABS spectrum as a function\nof external parameters. For long junctions, many of these loops are\nvisible, each separated by a parity crossing at zero energy. As a\nresult, the @xmath subgap spectrum contains near-zero energy subgap\nstates that oscillate as a function of Fermi energy or Zeeman field when\nthe N region of the junction is helical. Interestingly, we find that\nthese oscillating near-zero subgap states in the trivial regime are\nsmoothly connected to MBS when Zeeman is increased beyond @xmath .\n\nThis paper is organized as follows. In section 19 we describe the\nHamiltonian model employed in our work. Section 20 focuses on the normal\nconductance and how the two types of resonances, helical Fabry-Perot and\nhelical Fano dips, appear in the system. The rest of the paper is\ndevoted to analysing the consequences of these resonant levels in the\nsub-gap spectrum in the superconducting regime. After a brief discussion\non how the SNS junction is modeled, as well as a discussion about the\nrelevant length scales of the problem, section 21 presents a systematic\nstudy of the subgap spectrum of SNS junctions, including its dependence\non the superconducting phase difference across the junction, @xmath . We\ndiscuss in detail how the presence of confined levels within the central\nregion affect the ABS and lead to parity crossings in the topological\nphase. The dependence of the ABS on phase difference, Fermi energy of\nthe normal region and Zeeman field is discussed for both short and long\njunctions in subsections 21.2 and 21.3 , respectively. Our conclusions\nare presented in Section 22 . Here we employ the model described in\ndetail in Section 10.4 of Chapter Hybrid superconductor-semiconductor\nnanowire junctions as useful platforms to study Majorana bound states\nfor SNS junctions by using a tight-binding version of the continuum\nmodel Hamiltonian. Appendix J discusses an effective model that fully\nexplains the phenomenology behind helical Fano resonances.\n\n### 19 Nanowire model\n\nWe present the model for a nanowire with Rashba SOC and in the presence\nof an external Zeeman, whose description was fully studied in Chapter\nHybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states . We restrict ourselves to the\nstrictly one dimensional (single-mode) case for simplicity.\nGeneralisations to multimode nanowires are relatively straightforward.\nThe model Hamiltonian reads\n\n  -- -------- -- ------\n     @xmath      (98)\n  -- -------- -- ------\n\nwhere @xmath is the momentum operator, @xmath is the effective electron\nmass, @xmath the Rashba SOC strength, @xmath the Fermi energy and @xmath\nthe spin Pauli matrices. An external magnetic field @xmath along the\nwire produces a Zeeman splitting @xmath , where @xmath is the Bohr\nmagneton and @xmath the wire @xmath -factor. The Rashba coupling defines\na typical length, the spin-orbit length @xmath , with the spin-orbit\nenergy defined as @xmath . For typical InSb values @xmath , with @xmath\nthe electron mass and @xmath eV \u00c5, the spin-orbit energy is @xmath which\ngives SO lengths of the order of @xmath nm.\n\nNote that the Rashba and Zeeman fields in Eq.\u2009( 98 ) are perpendicular.\nAs a result, the two spinful bands (shifted by SO) become mixed by the\nZeeman term and the zero-field crossing point at zero momentum becomes\nan anticrossing of size @xmath . When the chemical potential lies within\nthis anti crossing gap, the system has two Fermi points, as opposed to\nfour Fermi points for @xmath above or below this gap. This window is a\nhelical gap, since the two fermi points correspond to counter\npropagating states with different spins (the spin projection is locked\nto momentum) [ 183 ] , see right panel in Fig. 51 .\n\n### 20 The normal conductance\n\nBefore discussing the sub-gap Andreev spectrum of a NW coupled to\nsuperconducting leads, we characterize the normal regime in the presence\nof a Zeeman field. We are interested in particular in the normal\nconductance @xmath as the Fermi energy ( @xmath ) in the middle section\nof the NW (length @xmath ) varies with respect to the one in the left\nand right leads @xmath . Such situation models a NW contacted between\nnormal electrodes and with a Fermi energy tuned by a central gate, see\ne. g. Ref. [ 48 ] . For simplicity in the discussion, we model the\ngate-induced electrostatic potential with an abrupt profile (the role of\nsmooth gate potentials has been recently discussed in Ref. [ 184 ] ).\n\nFor computations purposes we discretize Eq.\u2009( 98 ) into a tight-binding\nlattice. The momentum operator introduces hopping elements @xmath\nbetween nearest-neighbor sites. The transparency of the left and right\ncontacts is parameterised by a factor @xmath , introduced in the hopping\nmatrix @xmath across the two interfaces, see Section 10.4 . @xmath is\ncalculated by means of the Greens function technique [ 185 , 186 ] ,\n\n  -- -------- -- ------\n     @xmath      (99)\n  -- -------- -- ------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (100)\n  -- -------- -- -------\n\nis the full retarded Green\u2019s function. The bare Green\u2019s function of the\nnormal region without the presence of the leads is given by\n\n  -- -------- -- -------\n     @xmath      (101)\n  -- -------- -- -------\n\nThe hamiltonian @xmath corresponds to @xmath in Eq. 98 with @xmath . The\nleads are taken into account through the self-energies\n\n  -- -------- -- -------\n     @xmath      (102)\n  -- -------- -- -------\n\nwhere @xmath stands for the left\/right lead\u2019s propagator, when decoupled\nfrom the system. In this case, @xmath corresponds to @xmath in Eq.\u2009( 98\n) with @xmath . Finally,\n\n  -- -------- -- -------\n     @xmath      (103)\n  -- -------- -- -------\n\nIn practice, @xmath is computed recursively with the boundary conditions\nimposed by the leads.\n\nTo set the stage, we first consider an N-NW junction between a good\nmetal and a semi infinite nanowire, which will allow us to discuss\ndeviations when we consider confinement effects. Fig. 51 shows the\nexpected conductance profile as a function of the NW Fermi energy @xmath\n, for different values @xmath of the Fermi energy in the metal. At\nfinite magnetic fields, the normal conductance exhibits a gap (with\n@xmath ) of size @xmath . As we explained, this gap is a direct\nconsequence of the combined action of Zeeman effect and strong SO\ncoupling and reflects the presence of helical transport, namely\nspin-polarized counter propagating states [ 183 ] . As discussed in Ref.\n[ 184 ] , the visibility of this helical gap depends on various factors\nwhich, importantly, include the actual value of the SO energy. Indeed,\nas the ratio @xmath is made larger, the visibility of the gap in @xmath\nis rapidly degraded (see lower curves in Fig. 51 ).\n\nWe now consider the confined N-NW-N junction geometry. Due to the\nconfinement of the central NW section, Fabry-Perot resonances are\nexpected. Fig. 52 shows the extreme case of a very short central region\nwith only one resonant quasibound state in the junction. As expected,\nthe conductance without external Zeeman field (solid curve) has a\nLorentzian shape and reaches its maximum value @xmath when @xmath\n(vertical dashed guideline). Similar results are found for small Zeeman\nfields @xmath (dashed). When @xmath , however, the leads becomes\nspin-polarized (or helical, to be precise) and hence the maximum\nconductance is halved to @xmath (red curve).\n\nWe consider first the situation with @xmath . This regime is\ncharacterised by strong Fano dips that appear when @xmath is positive,\nnamely when the junction is gated to create a quantum dot instead of a\nbarrier, see Eq. ( 98 ). At these Fano dips destructive interference is\nmaximum and @xmath . Moreover, the position of these Fano resonances\nmoves to higher @xmath as @xmath increases (Fig. 52 , insets). The Fano\ndips can be understood by noticing that the system develops a truly\nbound state at an energy below @xmath as @xmath increases (Fig. 53 a).\n\nWhile for @xmath this level lies far below the chemical potential of the\nleads and cannot significantly affect @xmath , in the case @xmath at\nhand, the situation is markedly different. At such high fields, one spin\nsector in the leads is removed away from the chemical potential, and the\nleads become helical. Similarly, the bound state below @xmath is\nZeeman-split, such that the component corresponding to the removed spin\nsector may then cross the Fermi level at a given @xmath (Fig. 53 b-d).\nThis results in one spin projection strongly coupled to the continuum\n(the sector that is not removed), while the other spin projection\nremains weakly coupled to this helical continuum through the split bound\nstate (dashed circles), owing to the small spin canting induced by SO.\nThis configuration mimics the physics of a Fano resonance, as we\nexplicitly demonstrate in Appendix J with an effective model. Note that\nSO is essential to mimic the physics of the Fano effect (two channels\nwith very different coupling to the continuum). Indeed, we have checked\nthat for @xmath (namely a fully spin-polarized system without canting)\nthe effect disappears (not shown). The general behaviour is related to\nthe so-called Fano-Rashba effect in systems with inhomogeneous Rashba\ncouplings [ 187 , 188 ] although in our case the bound states originate\nfrom the Fermi energy inhomogeneity, which is probably more realistic\nfor NWs with gates. For intermediate lengths, the system can accommodate\nmany of the above resonances but the helical gap is not visible (not\nshown).\n\nConsider now the @xmath regime complementary to the preceding\ndiscussion. In this situation, there exist two propagating channels in\nthe leads, and conductance may reach @xmath at Fabry-Perot maxima, as\nlong as the central NW is likewise non-helical ( @xmath ). Otherwise,\nfor long enough junctions ( @xmath for the realistic NW parameters in\nour simulation) a helical gap develops in conductance, such that @xmath\n. As central @xmath is tuned into and out of the helical regime,\nconductance exhibits a reentrant behavior, switching from @xmath to\n@xmath and back to @xmath . This reentrance can be resolved across\nmultiple resonant helical Fabry-Perot oscillations. This is illustrated\nin Fig. 54 where we plot the conductance for a 4 @xmath -long nanowire\nas a function of the central Fermi energy @xmath . Note the reentrant\nconductance, and the helical Fabry-Perot resonances with an @xmath\nceiling, signalling helical transport in the junction. The visibility of\nthe conductance reentrance and the helical gap is lost for fields @xmath\n, see bandstructure, right panel in Fig. 51 . At such fields, the\nhelical gap becomes an extended @xmath half-plateau (potentially with\nsuperimposed Fano resonances if @xmath also exceeds @xmath ) that\nemerges directly from pinch-off @xmath . Note that the regime with\nhelical Fano dips in the normal conductance is quite relevant towards\nreaching topological superconductivity: the NW under the contacts can\nbecome a non-trivial topological superconductor in the presence of\npairing as long as it can be depleted and made helical in the normal\nphase. Hence our prediction of helical Fano dips superimposed on a\nhalf-plateau of @xmath constitutes a strong signature of helical\nbehaviour as precursor of non-trivial superconductivity.\n\nSimilar phenomenology is obtained for conductance at fixed magnetic\nfields and increasing @xmath (Fig. 55 ). As expected, the Fano dips\ndisappear as soon as @xmath while the gap coming from helicity in the\ncentral section in the NW is much more robust. Increasing @xmath results\nin well defined Fabry-Perot resonances in the helical gap region. The\nnormal conductance as a function of magnetic field is shown in Fig. 56 .\nHere, a change from irregular behavior to regular @xmath oscillations as\na function of magnetic field signals the helical regime when @xmath [\n184 ] .\n\nHaving in mind that there exists no conclusive experimental evidence of\nthe helical regime in nanowires in the literature [ 189 , 120 ] , the\nnontrivial resonant effects in finite-length junctions that we have\ndescribed, both helical Fabry-Perot resonances and helical Fano dips,\ncould be used as an interesting option for detecting such helical\ntransport regime in long junctions. Even more significant, these helical\nresonant features give rise to a non-trivial subgap spectrum when the\nleads become superconducting, as we discuss in what follows.\n\n### 21 Subgap levels in SNS junctions\n\nIn this section we investigate the role of the effects we have studied\nin previous section on the sub-gap spectrum. First, we discuss how we\nmodel a SNS junction and refer to Section 10.4 for more details. Then,\nwe make an important distinction of the different length scales of the\nproblem. At the end we present our results and point out the relevance\nof our calculations towards experimental detection of Majorana bound\nstates.\n\n#### 21.1 SNS junction model and relevant length scales\n\nA full description for modeling finite length SNS nanowire junctions is\nprovided in Chapter Hybrid superconductor-semiconductor nanowire\njunctions as useful platforms to study Majorana bound states . To model\na SNS junction we assume that the outer parts of the wire are coupled to\nan s-wave superconductor (with bulk values @xmath and pairing @xmath ),\nwhile the central is not (see Fig. 57 ). Superconducting correlations\nare induced by proximity effect into the nanowire. For good enough\ncontact between the NW and the superconductor, the Cooper pair amplitude\nis finite inside the NW regions below the superconductor. In most papers\nin the literature, this situation is modeled by including by hand a\npairing term, @xmath , in the hamiltonian of such NW regions. While,\nrigorously speaking, this is incorrect (the superconducting coupling\nconstant is zero inside the NW), it is well known that it provides a\ngood description of the proximity effect for large enough gaps (in such\ncases, the parameter @xmath is essentially the low frequency limit of a\ntunneling self-energy and is given by the tunnel coupling between the\nnormal and superconducting parts, see e.g. [ 173 ] ). Therefore, we\nadopt this approximation here for simplicity (we have checked that all\nour conclusions remain unaltered irrespective of whether we use this\nsimplified model or a full NW + SC coupling model, see appendix I ). In\ncases where the interface transparencies are small, extra Fabry-Perot\nresonances coming from insulating layers could complicate our analysis,\nsee Ref. [ 190 ] .\n\nIn particular, we model the regions of the nanowire below the\nsuperconducting contacts as regions with Fermi energy @xmath and pairing\npotential on the left (L) and right (R) contact given by @xmath and\n@xmath , with @xmath . The region in the middle of the nanowire without\nsuperconducting correlations is the normal region (N) with Fermi energy\ndenoted by @xmath as before. At high enough magnetic fields, the regions\nof the NW below the superconductors (S regions of the junction) can be\ndriven into a topological superconducting phase when @xmath . Owing to\nthe finite length @xmath , this results in a SNS junction with four\nMajorana bound states for a phase difference of @xmath between the\nsuperconductors: two inner Majorana bound states, labeled @xmath , that\nform inside the junction, and two outer Majorana bound states, @xmath ,\nsee Fig. 57 . On the other hand, for a zero phase difference, only the\nouter MBSs are present.\n\nSNS Josephson junctions are classified in two types, depending on the\nrelationship between the length of the normal region @xmath (i.e.\ndistance between the superconducting contacts) and the coherence length\n@xmath , where @xmath is the Fermi velocity. Short junctions are\ncharacterized by @xmath , whereas @xmath in long junctions. See Chapter\nHybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states for additional details. Such\nclassification can be also given in terms of natural energy scales of\nthe problem, the Thouless energy, @xmath , and the induced\nsuperconducting pairing potential @xmath , being @xmath the Fermi\nvelocity, and @xmath the length of the normal region. The above\nconditions, in terms of these energy scales, are @xmath for short\njunctions and @xmath for long ones. The significance of this\nclassification is related to the typical number @xmath of Andreev subgap\nstates of the junction, in addition to the MBSs at zero energy.\n\nThe MBSs wave functions decay from both ends of the topological\nsuperconducting leads. The inner and outer MBSs may feel their mutual\npresence if their wave functions exhibit a non zero spacial overlap. The\nrelevant decay distance characterizing this overlap is the Majorana\nlocalization length @xmath (appendix K ). For finite @xmath the overlap\nbetween MBSs is significant and therefore they are no longer true zero\nmodes.\n\nIn what follows, we discuss the subgap spectrum of short SNS junctions\nin the topological regime @xmath as well as the subgap spectrum of long\nSNS junctions as one goes from the helical junction regime to the\ntopological one. The helical junction regime is defined by a central\nregion depleted into the helical regime, while the S regions remain\nnon-topological, namely by @xmath , and @xmath .\n\n#### 21.2 Short junctions\n\nFor very short junctions, the ABS spectrum at @xmath and @xmath does not\ncontain sub-gap states (Figs. 58 a and b). This is expected for a short\njunction with @xmath . The @xmath spectrum (Figs. 58 c and d), on the\nother hand, is much more interesting. It contains the expected subgap\nstate near zero energy for all @xmath (coming from the weakly coupled\nouter Majoranas for @xmath , the inner MBS at @xmath are strongly\nhybridized and form standard ABS at energy @xmath ). Notably, this MBS\ncoexists with a bound state that crosses zero energy for a given @xmath\n(dashed line).\n\nThis bound state originates from the single resonance that the junction\naccommodates for increasing @xmath (see Fig. 53 ), which we discussed in\nconnection to Fano resonances. If we interpret this resonant state as an\nimpurity level, our results for @xmath are consistent with Anderson\u2019s\ntheorem which prevents the existence of bound states inside the gap of\nan s-wave superconductor for non-magnetic impurities [ 60 ] . The reason\nis that the zero-enery crossing appears for @xmath , such that the\nsuperconductor is effectively p-wave. Therefore, the emergence of these\nsubgap states crossing zero energy should be understood as a direct\nconsequence of nontrivial topology in the junction [ 176 , 177 ] . The\nprecise condition for the level crossing coincides with the condition\nfor having a Fano dip. As we discussed in section 20 , this is the\ncondition in the normal regime for having a single resonant state which\ninterferes destructively with a helical contact; the latter condition is\nhere fulfilled because @xmath . These subgap states and zero-energy\ncrossings should be understood as the p-wave counterparts of so-called\nYu-Shiba-Rusinov sub-gap states [ 178 , 179 , 180 , 181 ] and their\ncorresponding parity crossings [ 182 ] in s-wave superconductors with\nmagnetic impurities.\n\nFurther insight comes from the magnetic field dependence at fixed @xmath\n(Fig. 59 ), where we show three different situations: (top left) @xmath\n, @xmath (top right) and @xmath (bottom). After the closing of the gap\nacross the topological phase transition at @xmath , the spectrum of the\njunction exhibits a perfect zero-energy state (left and middle panels)\naccompanied by a zero-energy crossing (dashed line in top left and right\npanels) similar to the one discussed in Fig. 58 . On the other hand,\nwhen @xmath , the zero energy states (outer Majorana bound states) are\nnot present anymore and a truly crossing at zero energy is observed.\n\nNote here that despite the finite length of the central NW (in the top\nright panel) the zero energy state for @xmath does not oscillate as a\nfunction of Zeeman field, unlike what is typical of overlapping MBSs\n(top left panel) [ 75 , 70 , 71 , 76 ] . This can be easily understood\nas this state comes from the outer MBSs which at @xmath are effectively\ndecoupled across the junction, since we assume @xmath for the top right\npanel.\n\nWe now analyse in more detail the full phase dependence in the\ntopological phase for different values of @xmath . The low-energy sector\nis characteristic of a short junction: two almost @xmath -independent\nlevels near zero energy coming from outer MBSs and two dispersive levels\ncoming from hybridization of inner MBSs across the junction. The anti\ncrossings near @xmath are only visible for finite @xmath . For @xmath\n(Fig. 60 a), the zero-energy levels are flat and the anti crossing at\n@xmath becomes negligible \u00b2\u2075 \u00b2\u2075 25 In @xmath limit, the outer Majoranas\nare no longer involved in transport while the levels at @xmath exactly\ncross (not shown) giving rise to anomalous @xmath -periodic spectrum and\nJosephson currents if fermionic parity is conserved . In the following,\nwe refer to the dispersive ABS with almost perfect crossings at @xmath\nas Majorana ABSs. As @xmath increases, an extra bound state emerges from\nthe continuum as an almost dispersionless subgap state and interacts\nvery weakly with the Majorana ABSs (Fig. 60 b). Importantly, after\ncrossing zero energy (Fig. 60 c) and reemerging at finite energy (Fig.\n60 d), the anti crossing with the Majorana ABS is considerably larger,\nindicating that the bound state has changed its parity character.\n\n#### 21.3 Long junctions\n\nThe ABS spectrum of long junctions at small magnetic fields @xmath\ndiffers considerably from the one of short junctions. Even for @xmath\n(Fig. 61 a), the spectrum is very sensitive to the sharp increase of\nconductance at small negative @xmath , when the junction goes rapidly\nfrom pinch-off to fully transmitting (solid black line in Fig. 54 ).\nThis is reflected in a feature that resembles the closing and reopening\nof a gap (but, of course, is related to the central region becoming\nmetallic, rather than with a gap closing). The emergence of Fabry-Perot\nresonances in the normal phase is translated into the appearance of\nlevel pairs at finite energies, or loops, that oscillate with system\nparameters in the superconducting phase. A distinct change in the loop\nstructure takes place as @xmath is increased within a window @xmath .\nThis, recall, corresponds to the helical regime of the normal region,\ncharacterised in normal transport by a helical gap and helical\nFabry-Perot oscillations. The loops inside said window reconnect, and\ngive rise to new loops around zero-energy, separated by parity crossings\n(Fig. 61 b). Each of these crossings corresponds to a helical\nFabry-Perot resonance in the normal regime. For larger Zeeman energies,\nsupporting many helical Fabry-Perot resonances within the helical gap,\ncorrespondingly many consecutive zero-energy loops become visible in the\nsuperconducting regime. As soon as the normal side ceases to be helical\n( @xmath ), the spectrum does no longer show loops around zero energy.\nSince depleting the normal section of the NW junction should be much\neasier than gating the proximized region, we expect that said near-zero\nloops and parity crossings should be ubiquitous for finite size\njunctions near depletion \u00b2\u2076 \u00b2\u2076 26 Intermediate @xmath junctions also\nshow the same behaviour, not shown. and constitute yet another\nalternative scheme to detect the helical regime.\n\nEach loop in the helical regime (see e.g. Fig. 61 b) is similar to the\nones expected for magnetic impurities [ 178 , 179 , 180 , 181 ] , or\nquantum dots in the Coulomb blockade regime [ 49 , 130 ] coupled to\nsuperconductors (we emphasize here that our junction is noninteracting).\nThis result again suggests an interesting analogy with the physics of\nYu-Shiba-Rusinov states in superconductors with magnetic impurities.\nHere, the combined action of Zeeman-induced spin-polarization and\ndepletion is crucial. Consecutive loops around zero energy, resemble the\noscillatory behavior expected from overlapping MBSs in finite length\nNWs. However, since the helical gap condition @xmath does not involve\n@xmath , which may be large, the zero-energy loops may exist while the\nproximized S regions are still in the topologically trivial regime\n@xmath (Fig. 61 c and d). Remarkably, there exists a profound connection\nbetween zero-loops and MBSs. We find that the former actually evolve\ncontinuously into outer MBSs as @xmath is increased beyond @xmath .\n\nTo illustrate this key idea, we compare in Fig. 62 , a situation without\nnear-zero energy loops at low B fields ( @xmath , panel a) with another\nwith loops at very low B coming from a helical normal region ( @xmath ,\npanel b). While the MBSs in the first configuration emerge from a\nsituation without zero energy states\/crossings at low fields, the ones\ncorresponding to the second configuration are clearly evolving from the\nlow B-field loops around zero energy. We emphasize here that both\nconfigurations correspond to the same physical nanowire junction with\nthe sole difference of a depletion in the normal part of the junction in\nthe second case. Fig. 62 nicely illustrates two of our main results: 1)\nlong loops with parity crossings in the ABS spectrum can be used to\nidentify the helical regime in a Rashba NW and 2) such helical loops,\ncoming from depletion in the normal side of the junction, continuously\nevolve into MBS for large enough magnetic fields.\n\nTo obtain more precise information about the nature of this interesting\nconnection between @xmath near-zero loops and MBS states, we study their\nevolution for increasing SO coupling (Fig. 63 ). For @xmath (Fig. 63 a),\nZeeman-induced depairing closes the superconducting gap and the spectrum\nbecomes a dense quasi-continuum (the full junction is in the normal\nregime), as expected. Any @xmath removes all finite energy crossings\nwhile preserving the parity-protected crossings at zero energy. As a\nresult, the spectrum is still gapped after the first parity crossing\n(the Zeeman field is no longer fully depairing) and many parity\ncrossings are possible. This important observation is illustrated in\nFig. 63 (b,c,d) (see also Fig. 62 b). For finite @xmath , the low-energy\nspectrum remains gapped after the first crossing and also after\nsubsequent crossings.\n\nAnother interesting conclusion that we can draw from our results is that\na clear distinction between the near-zero states in the @xmath and\n@xmath regions can no longer be made. The only difference is\nquantitative, in that the amplitude of MBS oscillations in the\ntopological regime become smaller for increasing @xmath , unlike for\n@xmath . (The SO length becomes much shorter and, hence @xmath ).\nHowever, other spectral properties, such as the mini gap separating the\nnear-zero modes from the first excited states, is roughly the same in\nboth the trivial @xmath and non-trivial @xmath phases.\n\nTo finish, we consider the phase dependence of the subgap spectrum in\nFig. 64 . While topological SNS junctions with @xmath are @xmath\n-periodic as a function of phase difference @xmath due to the\ncharacteristic parity-protected crossing at @xmath (see e.g. Fig. 60 a),\nin finite @xmath junctions (Fig. 64 a), said crossing is avoided, and\nsplits by a small energy due to the hybridization of MBSs at the\njunction (inner) and MBSs at the far ends of each S region (outer),\nwhich leads to a more conventional @xmath -periodicity [ 92 ] .\nInterestingly, the subgap spectrum at @xmath (Fig. 64 b) shows\nessentially the same phase-dependence, shown in bottom panels of Fig. 64\n, which further confirms the deep connection between the @xmath and\n@xmath parity crossings. Note that the resulting Josephson current [ 162\n] , which only depends on the Andreev spectrum, would be effectively the\nsame (not shown).\n\n### 22 Conclusions\n\nWe have studied the normal transport and the sub-gap spectrum of SNS\njunctions based on semiconducting nanowires with strong Rashba\nspin-orbit coupling. In particular, we have focused on the role of\nconfinement effects in ballistic finite-length junctions and analyzed\nthe distinct properties of the ABS for short and long junctions as\ndifferent sections of the underlying NW (N or S or both) become helical.\nFor @xmath , confined levels in the normal section give rise to bound\nsubgap states, as expected from the effective p-wave nature of the\ntopological superconductor. In normal transport, such bound states give\nrise to helical Fano dips. Perhaps more strikingly, we have found that a\nlong junction with a helical normal section, but still in the\ntopologically trivial regime with @xmath , supports a low-energy subgap\nspectrum consisting of multiple-loop structures and parity crossings.\nSuch states are derived from helical Fabry-Perot resonances in the\nnormal regime. We have argued that such multiple loop structure in the\nABS spectrum could be used to unambiguously identify the helical regime\nin NWs. Interestingly, these multiple loops smoothly evolve towards\nMajorana bound states as the Zeeman field exceeds the critical value.\nThis suggests an interesting connection between subgap parity crossings\nin helical junctions with @xmath and Majorana bound states in\ntopological ones with @xmath . A recent study of fully open\nhelical-N\/trivial-S contacts [ 140 ] further confirms the profound\nconnection between subgap states in the helical regime and Majorana\nphysics.\n\n## Chapter \\thechapter Majorana bound states from exceptional points in\nnon-topological superconductors272727This Chapter is part of a work\npublished in [140]\n\nRecent experimental efforts towards the detection of Majorana bound\nstates have focused on creating the conditions for topological\nsuperconductivity. Here we demonstrate an alternative route, which\nachieves fully localised zero-energy Majorana bound states when a\ntopologically trivial superconductor is strongly coupled to a helical\nnormal region. Such a junction can be experimentally realised by e.g.\nproximitizing a finite section of a nanowire with spin-orbit coupling,\nand combining electrostatic depletion and a Zeeman field to drive the\nnon-proximitized (normal) portion into a helical phase. Majorana zero\nmodes emerge in such an open system without fine-tuning as a result of\ncharge-conjugation symmetry, and can be ultimately linked to the\nexistence of \u2018exceptional points\u2019 (EPs) in parameter space, where two\nquasibound Andreev levels bifurcate into two quasibound Majorana zero\nmodes. After the EP, one of the latter becomes non-decaying as the\njunction approaches perfect Andreev reflection, thus resulting in a\nMajorana dark state (MDS) localised at the NS junction. We show that\nMDSs exhibit the properties associated to conventional closed-system\nMajorana bound states, while not requiring topological\nsuperconductivity.\n\n### 23 Introduction\n\nThe emergence of topologically protected Majorana zero modes in\ntopological superconductors has recently entered the spotlight of\ncondensed matter research [ 51 , 164 , 29 , 52 , 53 ] One of the main\nreasons is the remarkable prediction that such Majorana bound states\n(MBSs), also known as Majorana zero modes, should obey non-Abelian\nbraiding statistics [ 86 , 149 ] , much like the 5\/2 states in the\nfractional Hall effect, without requiring many-body correlations. It has\nbeen argued that the successful generation, detection and manipulation\nof MBSs would open the possibility of practical topologically protected\nquantum computation [ 85 , 191 ] . Despite impressive experimental\nprogress [ 67 , 128 , 46 , 90 , 47 , 48 , 49 , 192 , 193 , 123 ] , such\nambitious goals have still not been conclusively achieved.\n\nA number of practical proposals have been put forward aiming to generate\nthe conditions for the spontaneous emergence of robust MBSs in real\ndevices. Some of the most studied ones are based on proximitising\ntopological insulators [ 37 ] or semiconductor nanowires [ 61 , 150 ] .\nThe core challenge in all these proposals has been to artificially\nsynthesise a topologically non-trivial superconductor with a\nwell-defined and robust topological gap [ 100 ] . The bulk-boundary\ncorrespondence principle dictates that the superconductor surface is\nthen host to topologically protected MBSs. Creating a topological gap is\narguably the main practical difficulty of such proposals, particularly\nsince topological superconductors are rather sensitive to disorder.\n\nIn this Chapter we present an alternative scheme for the creation of\nMBSs that does not require topological superconductivity at all. The\npossibility of engineering Majoranas in topologically trivial setups has\nbeen studied in other contexts before. It has been shown, for example,\nthat topological excitations, and MBSs in particular, may arise in\ntrivial superconductors under adequate external driving [ 88 , 194 ] ,\nsimilarly to the mechanism behind Floquet topological insulators [ 195 ]\n. Also, cold-atom systems with specifically engineered dissipation [ 196\n, 197 ] may relax into a topologically non-trivial steady state that are\nhost to dark states at zero energy with Majorana properties. Our\napproach is implemented in a solid state setup and is based on\nproximitized semiconductor nanowires. In its topologically trivial\nregime, such a wire will not generate MBSs when terminated with vacuum\n(i.e. at a closed boundary). Its spectrum is instead a set of Bogoliubov\nquasiparticles that can be seen as pairs of Majoranas hybridized to\nfinite energy. By creating a sufficiently transparent\nnormal-superconductor (NS) junction at one end of the wire, we create a\ndifferent kind of open boundary, to which the bulk-boundary\ncorrespondence principle does not apply. Such a high-transparency\njunction can be fabricated by proximitizing only one half of a pristine\nsemiconducting nanowire (Fig. 67 ). We demonstrate that, as one tunes\nthe normal side into a helical (half-metallic) regime via a parallel\nZeeman field, one Majorana pair becomes decoupled into two zero energy\nresonances. One of which is subsequently removed into the reservoir,\nleaving behind a stable Majorana \u2018dark state\u2019 (MDS) at the NS junction\nwithout requiring a non-trivial superconductivity. A dark state here is\ndefined as a bound state that despite having an energy embedded in a\ncontinuum of delocalized excitations is orthogonal to them and,\ntherefore, non-decaying.\n\n#### 23.1 General considerations on NS junctions\n\nThe emergence of these MDSs cannot be described using the conventional\nband topology language, but rather needs to be understood in the context\nof open quantum systems. Unlike in closed systems, eigenstates in open\nsystems decay with time, as the state leaks into the reservoir. Hence,\ntheir energies are no longer real but have a negative imaginary part\n@xmath , @xmath . Such a complex spectrum is sometimes modelled by a\nnon-Hermitian Hamiltonian. A more precise and general description is\nobtained by considering the analytic continuation of the scattering\nmatrix @xmath , where the energy @xmath of incoming states from the\nreservoir is allowed to extend into the lower complex half-plane. The\nanalogous to the real eigenvalues of the closed system then becomes the\npoles of @xmath for the open system.\n\nScattering processes at the NS interface in the stationary regime are\ndetermined by the scattering matrix ( @xmath -matrix), whose general\nform is given by\n\n  -- -------- -- -------\n     @xmath      (104)\n  -- -------- -- -------\n\nwhere @xmath is the effective non-Hermitian Hamiltonian that describes\nthis open system , @xmath is the coupling matrix to the normal reservoir\nN and @xmath the isolated system\u2019s time-independent Hermitian\nHamiltonian.\n\nAs an example we consider a minimal description that consists of a\nlow-energy energy BdG parity crossing, a pair of Andreev levels near\nzero-energy crossing as the ones discussed in Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states (see for instance Fig. 65 ) and then we\nanalyse its properties in an open NS system, when coupled to a single\npair of electron-hole modes in the normal reservoir N. Here, we follow\nthe discussion made in [ 198 ] . The low-energy problem restricts the\ndimension of matrices @xmath and @xmath to be @xmath . Therefore, they\ncan be in general written as\n\n  -- -------- -- -------\n     @xmath      (105)\n  -- -------- -- -------\n\nwhere the entries are in general complex numbers. Since we are dealing\nwith a superconducting system, electron-hole symmetry requires @xmath\nand @xmath [ 54 ] . Thus, taking into account Hermicity of @xmath , and\nelectron-hole symmetry, we arrive at\n\n  -- -------- -- -------\n     @xmath      (106)\n  -- -------- -- -------\n\nwhere @xmath are defined from the eigenvalues of the coupling matrix\n@xmath ,\n\n  -- -------- -- -------\n     @xmath      (107)\n  -- -------- -- -------\n\nand @xmath being real coefficients. Therefore, the effective Hamiltonian\ncan be written as\n\n  -- -------- -- -------\n     @xmath      (108)\n  -- -------- -- -------\n\nIn order to understand the meaning of @xmath , we write down the\neffective Hamiltonian in the Majorana representation, which is defined\nby the following rotation matrix @xmath [ 54 ] ,\n\n  -- -------- -- -------\n     @xmath      (109)\n  -- -------- -- -------\n\nIn this basis, the rotation of the effective Hamiltonian, @xmath , is\nwritten as\n\n  -- -------- -- -------\n     @xmath      (110)\n  -- -------- -- -------\n\nand exhibits a clear physical meaning. Indeed, note that in Eq.\u2009( 110 )\neach Majorana contributing to a BdG excitation may have a different\nlifetime @xmath , where @xmath represents the Majorana overlap.\n\nFurther information is acquired from analysing the poles of the @xmath\n-matrix given by Eq.\u2009( 104 ). Such poles are the eigenvalues of the\neffective Hamiltonian @xmath . Then, from Eq.\u2009( 108 ), we get the\neigenvalues and eigenfunctions\n\n  -- -- -- -------\n           (111)\n  -- -- -- -------\n\nThe NS junction is now an open system with quasi bound Andreev states\nthat acquire a finite imaginary part, which gives rise to a finite\nlifetime.\n\nThe discussion made before can be generalised to a multichannel case [\n198 ] , and therefore we can conclude that in NS junctions, all such\npoles come in pairs @xmath for all poles with non-zero real part @xmath\n, due to the charge-conjugation symmetry of the Nambu representation [\n199 , 200 ] . Here, we denote the real part as @xmath , while @xmath as\nthe imaginary part of eigenvalues given in Eq.\u2009( 111 ). In this sense,\npoles with zero real part @xmath are special, as they do not come in\npairs. We denote their total number by @xmath , which excludes any pole\nwith zero real and imaginary part.\n\nFrom Eq.\u2009( 111 ), one notices that for @xmath , there are two kind of\npoles in the low complex plane with standard BdG degeneracy @xmath (see\nFig. 66 a). As a given parameter of the system is varied, a pair of\npoles @xmath first approach each other (see Fig. 66 a) and then become\ndegenerate at the imaginary axis when @xmath (see Fig. 66 b), being the\nreal part of the eigenvalues is zero, @xmath . The S-matrix has a single\ndegenerate pole and the eigenvalues and eigenvectors of the effective\nHamiltonian, which are poles of the S-matrix, have the special form\n\n  -- -------- -- -------\n     @xmath      (112)\n  -- -------- -- -------\n\nThe fusion of the two poles of the @xmath -matrix is known as a pole\ntransition , which is a particular instance of a more general phenomenon\nin open quantum systems and known as exceptional point (EP) [ 201 , 202\n, 203 , 204 , 205 ] . It differs from a closed-system degeneracy in that\nthe corresponding eigenstates do not remain orthogonal, but rather\ncoalesce into one as they pass through a branch point singularity, as\none can indeed check from Eq.\u2009( 112 ),\n\n  -- -------- -- -------\n     @xmath      (113)\n  -- -------- -- -------\n\nIt turns out that this phenomenon is very well known in the open quantum\nsystems, where complex eigenvalues and eigenfunctions coalesce at an\nexceptional point in the spectrum owing to branch point singularities.\nIndeed, exceptional points have been extensively studied in photonics\nwhere they have been shown to give rise to novel phenomena unique to\nopen systems [ 206 , 207 , 208 , 209 , 210 , 211 , 212 , 213 ] . Their\nimplications in electronic systems, however, have been seldom discussed\n[ 214 , 215 ] .\n\nAfter the exceptional point, in our example for @xmath (see Fig. 66 c),\nthe @xmath -matrix has two purely imaginary poles\n\n  -- -------- -- -------\n     @xmath      (114)\n  -- -------- -- -------\n\nrepresenting two modes with zero real energy but with different\nlifetime, which arises from the imaginary part. The two degenerate poles\nbranch along the imaginary axis and their decay rates bifurcate into\ndifferent values as one can indeed observe in previous equation. A\nmaximum width bifurcation is reached when @xmath (see Fig. 66 d), that\nis at the parity crossing (see red circle in Fig. 65 ), then the\neigenvalues read\n\n  -- -------- -- -------\n     @xmath      (115)\n  -- -------- -- -------\n\nObserve that they acquire different lifetime which depends on the\ncouplings to the reservoir N, @xmath , as they are eigenvalues of the\ncoupling matrix @xmath .\n\nThe total number @xmath (which excludes any pole with zero real and\nimaginary part) has a very important meaning in open NS junctions, and\ndefines the analogue of band topology of a closed quantum system.\nIndeed, it has been shown that the topology of the scattering matrix in\nquasi-1D NS junctions is classified by the invariant @xmath , i.e. the\nparity of the number of poles with zero real energy, with @xmath\nsignalling an open system with non-trivial topology from the point of\nview of scattering [ 199 , 200 ] . In terms of its S-matrix poles, the\ntopological transitions of an open NS junction follow a characteristic\npattern. At the beginning, @xmath , since there are no poles with zero\nreal energy, and the S-matrix is trivial, @xmath . The EP transition\ndiscussed above is the open-system counterpart of a band inversion in a\nclosed system [ 199 , 200 ] . We have seen that after the exceptional\npoint, the @xmath -matrix has two purely imaginary poles and their decay\nrates bifurcates into different values denoted now by @xmath . The\nexceptional point thus involves a change of @xmath by 2, but the\ntopology of the @xmath -matrix remains trivial, @xmath . If @xmath\nevolves towards zero (or close enough to zero for all practical\npurposes), it is said that the corresponding pole is buried , and it is\nexcluded from the @xmath count, effectively signalling a change of\ntopology @xmath . Crucially, the existence of a buried pole implies the\nexistence of a zero-energy non-decaying (dark) state somewhere in the\nsystem with Majorana properties. In this sense, S-matrix topology is a\ntrue generalization of the band-structure topology of closed systems,\nand has the same implications in terms of topologically protected\nexcitations, albeit in the context of open systems. It is also closely\nlinked to the existence of an exceptional point in the system that\noccurs before the pole burying, in the trivial @xmath phase.\n\nIn this Chapter we show that, while at weak couplings between the normal\nenvironment and the superconductor a non-trivial S-matrix implies that\nthe superconductor is also non-trivial in isolation, this is not the\ncase at strong couplings. In specific but experimentally relevant\nconditions, a sufficiently transparent junction between a normal metal\nand a trivial superconductor has a non-trivial S-matrix with @xmath ,\nand is thus host to a Majorana dark state. The required conditions are:\n(1) the system should have a finite spin-orbit coupling at the contact,\n(2) the normal part of the junction should be sufficiently depleted\n(small Fermi energy @xmath ) and polarised by a Zeeman field @xmath into\na helical half-metallic phase @xmath , (3) the normal transmission of\nthe junction should be close to one, and (4) the trivial superconductor\nshould be in the Andreev limit @xmath , where @xmath is the\nsuperconducting gap and @xmath is its Fermi energy. The rationale of\nthese conditions is to achieve good Andreev reflection of helical\ncarriers from the normal side, which generates a MDS strongly localized\nat the junction.\n\nThe intuitive mechanism behind the process is as follows. When isolated,\nthe trivial superconducting wire is host to a Majorana pair at each end,\nwhich is strongly hybridized into a fermionic Bogoliubov state, with\nreal energies @xmath . As the contact is opened onto a helical wire\n(which has a single decay channel), one (and only one) of the two\nMajoranas escapes into the reservoir (blue state in Fig. 67 ), leaving\nbehind the orthogonal Majorana as a dark state (red), pinned at zero\nenergy since it no longer overlaps with the escaped Majorana. This\nprocess takes place formally by crossing an exceptional point\nbifurcation of the @xmath poles into poles @xmath on the imaginary axis.\nAs the conditions above are fulfilled, the zero energy dark state\nbecomes truly non-decaying @xmath . Deviations from these conditions\nresult in a residual decay rate @xmath . The dark state is then a sharp\nMajorana resonance centered at zero, but with Majorana properties\nsurviving at times shorter than @xmath . We consider a realistic model\nof an NS contact in a proximitized semiconducting wire. We show that the\nresidual decay rate of the MDS in non-ideal conditions depend\nexponentially with junction lengthscales, just like the Majorana\nsplitting in closed topological superconductors.\n\n### 24 Majorana dark states in a proximitized Rashba wire\n\nIn Chapter Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states we have discussed that\nin recent years experimental progress has been reported towards the\ndetection of MBS in Rashba nanowires [ 67 , 128 , 46 , 90 , 47 , 48 ,\n216 ] . These efforts were in large part stimulated by the prediction by\nLutchyn et al. [ 61 ] and Oreg et al. [ 150 ] that these type of systems\nwould undergo a topological transition into an effective p-wave\nsuperconducting phase when a Zeeman field @xmath parallel to the wire\nexceeds a critical value @xmath . See Chap. Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states for a full description about engineering 1D\ntopological superconductors based on nanowires with Rashba spin-orbit\ncoupling. We now consider models relevant to single-mode Rashba wires,\nand demonstrate the formation of MDSs for @xmath .\n\nFollowing Refs. [ 61 , 150 ] , we model a thin proximitized Rashba\nnanowire under a Zeeman field by a spinful 1D tight-binding chain,\n\n  -- -------- -- -------\n     @xmath      (116)\n  -- -------- -- -------\n\nNotice that previous Hamiltonian is the same given by Eq.\u2009( 79 ) in\nChap. Hybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states . The parameters of the model\nare the chemical potential measured from depletion @xmath , the hopping\n@xmath , where @xmath is the effective mass and @xmath is the lattice\nspacing, the induced pairing @xmath , the SO hopping @xmath , where\n@xmath is the SO coupling and @xmath is the SO length, and the Zeeman\nfield @xmath , where @xmath is the g-factor, and @xmath is the magnetic\nfield along the wire. In what follows we present simulations with\nparameters corresponding to an InSb proximitized wire [ 67 ] ( @xmath\nmeV, @xmath meV nm, @xmath , @xmath ). We will consider both an isolated\nproximitized wire of finite length, and an open NS contact between\nproximitized and non-proximitized sections of a nanowire, Fig. 67 . The\nlatter is assumed infinite (see the supplemental information for finite\nlength effects), and is modelled by the same Hamiltonian, albeit with\n@xmath and a @xmath in place of @xmath . The normal-state average\ntransparency per mode @xmath of the contact is physically controlled by\na electrostatic gating in an actual device, and is modelled here either\nby a hopping @xmath across the contact, or by a spatial interpolation\nbetween @xmath and @xmath across a certain contact length @xmath\ndetermined by the distance of the wire to the depletion gate ( @xmath is\nalways abrupt, see Supplementary Material). Note that if the density of\ndefects in the wire is small, @xmath , with @xmath a lengthscale of the\norder of the average Fermi wavelength.\n\nTopologically, the isolated nanowire belongs, for finite @xmath , to the\nsame one-dimensional D-class as the multimode Kitaev wire. For @xmath\nsmaller than a critical @xmath , the nanowire is trivial ( @xmath ). As\n@xmath exceeds @xmath , the topological invariant becomes non-trivial (\n@xmath ) through a band inversion, see Fig. 68 a, with the peculiarity\nthat the two hybridized Majoranas in the trivial @xmath phase are not\ndeep inside the gap, but at the band edge. As @xmath grows, @xmath\nquickly becomes unrealistically large, and the nanowire remains trivial\nfor all reasonable fields, Fig. 68 b. (A large @xmath , incidentally, is\nthe natural experimental regime, since the superconductor will typically\ntransfer charge to the proximitized section of the wire that is\ndifficult to deplete due to screening.)\n\nThe nanowire contains a non-proximitized normal section, Fig. 67 , and\nwe define the effective Hamiltonian as @xmath , with the exact self\nenergy from the normal portion of the wire evaluated at zero frequency\n@xmath (see Appendix Hybrid superconductor-semiconductor nanowire\njunctions as useful platforms to study Majorana bound states ). As the\ncoupling to the reservoirs increases (the junction transparency @xmath\ngrows), two eigenvalues drop out from the band edge into the lower\ncomplex plane, and merge at the imaginary axis at an exceptional point.\nThis exceptional point is only reached if the Zeeman field exceeds a\ncertain value @xmath , see dashed lines in 68 (c,d). This @xmath is the\nfield required for the normal nanowire to become helical . For @xmath ,\nthe normal nanowire hosts a single propagating mode, with the other spin\nsector completely depleted by the Zeeman field, and behaves as a\nsingle-mode reservoir like the one discussed for the Kitaev wire in [\n140 ] . Note that this helical regime should be achievable using\nelectrostatic gating, since it only requires a sufficient depletion of\nthe non-proximitized section of the semiconductor nanowire, unscreened\nby the superconductor.\n\nAfter crossing the exceptional point (region above thick black curves in\n68 [c,d]), the scattering matrix @xmath at the trivial NS contact\nacquires @xmath purely imaginary poles. One of the two moves towards the\norigin. The asymptotic decay rate @xmath in the limit @xmath is not\nvanishing in general, so that the corresponding states should be denoted\nas Majorana resonances [ 217 ] . However, in the experimentally relevant\nAndreev limit @xmath , Fig. 68 d, the asymptotic @xmath vanishes\nexponentially with @xmath (see inset). When the wire is tuned into the\nregime @xmath and the contact is made sufficiently transparent, the\nMajorana resonances are stabilised into proper non-decaying MDSs. For\nexample, for the realistic parameters of the simulations in Fig. 68 d\nthe lifetime for the minimum widths (see inset) corresponds to @xmath\n0.2 microseconds. While this is already a rather long time, this is not\nan upper bound since even longer lifetimes can in principle be obtained\nby increasing @xmath .\n\nThe interpretation of this mechanism is as follows. While two MBSs at\nopposite ends of an isolated topological nanowire can be considered\nexact zero modes up to exponentially small corrections (in the wire\nlength) coming from their mutual overlap, an MDSs (red in Fig. 67 ) also\nbecomes an exact Majorana zero mode without any fine tuning by a\nsuppression of its overlap with its sibling Majorana (blue in Fig. 67 ),\nwhich escapes into the helical reservoir. It is important to note that,\nin contrast to isolated topological wires, any residual overlap that\nremains after the exceptional point does not translate into a finite\nenergy splitting, but rather into a residual decay rate @xmath .\n\n### 25 Physical properties of Majorana dark states\n\nHaving established the emergence of zero energy dark states at a\ntransparent helical metal-trivial superconductor junction in the Andreev\nlimit, we now turn to the analysis of the physical properties of said\nstates, and compare them to conventional MBSs. We will study their\nsignatures in transport, their wavefunction locality, particle-hole\nconjugation, their charge neutrality, uniform charge oscillations and\nfinally and the low energy spectrum properties in SNS geometries.\n\n#### Signatures in dI\/dV\n\nWe start by analysing the differential conductance @xmath through a\nnormal tunnelling probe weakly coupled to the neighbourhood of the\njunction, brown in Fig. 67 . In the tunneling limit, this is\nproportional to the local density of states at the junction at energy\n@xmath , where @xmath is the bias voltage. (Note that this is different\nfrom the differential conductance across the NS contact, which is not\nnecessarily in the tunnelling regime, see below). We computed the\ntunnelling @xmath versus @xmath and @xmath using standard quantum\ntransport techniques [ 218 ] (see Appendix Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states ), and we present the results in Fig. 69\n(a-f) for several transparencies @xmath , both far from the Andreev\nlimit (top row), and deep into the Andreev limit (bottom row). Atop each\npanel, the evolution of the lowest complex eigenvalues with @xmath is\nshown, with an exceptional point bifurcation at @xmath . Panel (a)\ncorresponds to the tunnelling limit @xmath , which exhibits a sharp peak\nat zero-energy due to conventional MBSs for @xmath , and slightly split\nin two due to their hybridization across @xmath . As @xmath is\nincreased, panels (b,c), the @xmath zero-energy peak in the LDOS is\nwashed away, since the Majorana at the contact becomes a finite-lifetime\nMajorana resonance, increasingly delocalized into the reservoir.\nInterestingly, however, as @xmath is increased the onset of the Majorana\nresonance is shifted to fields @xmath , for which the band topology of\nthe superconducting nanowire is trivial. The Majorana resonance emerges\nupon crossing an exceptional point at a certain @xmath (see bifurcation\nin Fig. 69 (b,c) [top plots]. As @xmath is increased from 0 to 1, @xmath\ndecreases from @xmath (solid guidelines) to @xmath (dashed). @xmath is\nthe field for which the N side of the junction becomes helical (spin\nbecomes locked to the value of momentum), as is characterised by the\nloss of one propagating channel.\n\nTwo important conclusions can be drawn from these results. On the one\nhand, we see that in the particular @xmath regime, @xmath limit, the\ntopological transition and the exceptional point coincide @xmath . [ 200\n] For wires sufficiently open to reservoirs, however, the exceptional\npoint and its associated Majorana resonance will occur at lower fields\n(around @xmath ) than the topological crossover, or pole burying (at\n@xmath ), and might therefore be easier to reach experimentally.\nSecondly, the difference between a Majorana resonance at @xmath and a\nconventional @xmath MBSs in finite wires seems to be merely qualitative,\ni.e. differing simply in their lifetime, since both correspond to the\nsame pole of the scattering matrix at different positions in the complex\nplane. Conventional MBSs above @xmath have a finite (real) energy\nsplitting due to the finite length, while Majorana resonances below\n@xmath have a finite width @xmath . However, while the former can be\ndecreased by increasing the length of the proximitised wire (making the\nMBSs effectively eigenstates), the inverse lifetime @xmath of Majorana\nresonances is always sizeable in the present regime ( @xmath ); it\ndecreases with Zeeman field, and exhibits a kink for high @xmath at the\nhelical transition @xmath of the normal side (see top panel of Fig. 69\nc, where the imaginary part of the poles develops a kink at @xmath ),\nbut it remains relatively large all the way till @xmath . Next, we will\nshow that in the experimentally relevant regime @xmath this is no longer\nthe case. The kink at @xmath evolves, at high @xmath , into an S-matrix\ntopological crossover far below @xmath , which gives rise to the\nformation of a new type of exceptional MBSs localised at the junction,\nwith @xmath .\n\nSo far, we have shown that Majorana resonances for @xmath evolve\ncontinuously into conventional MBSs as @xmath crosses @xmath . A natural\nquestion arises as to why a zero-energy Majorana resonance may appear in\na topologically trivial wire in the first place. This may be intuitively\nunderstood by considering that a topologically trivial @xmath isolated\nnanowire actually hosts a pair of MBSs pairs at each end (one for each\nof two opposite p-wave sectors in the trivial wire [ 51 ] ), that are\nstrongly hybridized away from zero energy to an energy close to @xmath ,\ndue to their large overlap. However, when one end is fully opened into a\nhelical wire with a single propagating mode ( @xmath ), one (and only\none) of the two MBSs escapes into the reservoir, and decouples from the\nother MBS, which remains well localized at the contact and returns to\nzero energy. This mechanism does not apply for @xmath since in this case\nboth MBSs may immediately escape into the reservoir. The origin of the\nfinite lifetime of a Majorana resonance is connected to the probability\nfor one of the two hybridized Majoranas to completely escape into the\nhelical wire and out into the reservoir. The higher this probability,\nthe longer-lived the remaining Majorana will be, since its overlap with\nits delocalised sibling will be suppressed. For perfect escape\nprobability, the Majorana becomes a zero-energy, non-decaying dark state\nat the junction. One might guess that this escape probability should be\n@xmath itself, but we showed in Fig. 69 (a,b,c) that a @xmath contact\nwith @xmath has a Majorana resonance of finite lifetime. The reason is\nthat a perfect normal transparency @xmath only implies escape\nprobability one across the NS junction in the limit in which the induced\npairing @xmath is a small perturbation respect to the normal phase, i.e.\nin the Andreev limit @xmath . This is, incidentally, the realistic\nregime of experimental samples, since electrostatically depleting a\nproximitised wire to have @xmath is much more difficult than depleting\nan exposed section, whose @xmath can typically be tuned all the way to\nzero by a gate.\n\nTo demonstrate this scenario, we show in Fig. 69 (d,e,f) the LDOS and\npole evolution of the NS junction in the Andreev limit, @xmath . This\nmoves the topological crossover @xmath to higher fields ( @xmath T, up\nfrom @xmath T), while the helical field @xmath (dashed guideline)\nremains the same. The range of physical @xmath fields is the same as in\nthe top row of Fig. 69 , but now @xmath falls outside of this range. As\n@xmath is increased (by making the spatial transition between @xmath and\n@xmath at the contact smooth [ 184 ] ), the width of the Majorana\nresonance becomes greatly reduced, i.e. the resonance becomes gradually\ndecoupled from the reservoir. Note the similarity between the sharp zero\nenergy peak in the LDOS emerging in Fig. 69 f for @xmath and the one in\nFig. 69 a for @xmath . The width of the latter, a conventional MBSs\nassociated to a topologically non-trivial superconducting bulk, vanishes\nas @xmath . The width of the former, in contrast, vanishes as @xmath and\n@xmath is increased. This is demonstrated in the inset of Fig. 68 d,\nwhich shows @xmath at the helical transition @xmath for @xmath as a\nfunction of @xmath . We see that @xmath is quickly suppressed as soon as\nwe approach the Andreev limit @xmath , and becomes arbitrarily small as\n@xmath grows. This supports the intuitive picture of the preceding\nparagraphs.\n\nPanel (f), with @xmath , corresponds to a cut along the top of Fig. 68\n(d), for which MDSs are fully developed. Their presence gives rise to\nsharp zero bias anomaly (ZBA) in transport at fields @xmath , with a\nsharpness that increases exponentially with @xmath . This type of ZBA\nwas the first signature of MBSs explored experimentally [ 67 ] , though\nin the present context they arise far from the topological regime @xmath\n. The ZBA is not preceded by signatures of a gap closing. Note also that\naway from the ideal conditions @xmath , @xmath , wide Majorana\nresonances are also visible in the topologically trivial regime, panels\n(b,c,e), albeit of finite lifetime. Exceptional MBSs are therefore\nzero-energy dark state that arise at a sufficiently transparent junction\nbetween a conventional superconductor and a metal with a single\npropagating helical channel. By the S-matrix definition, such junction\nbecomes effectively non-trivial topologically, while by the band\ntopology definition, both normal and superconducting bulks remain\ntrivial. In spite of the system being arbitrarily far from a band\ntopological transition, the more general S-matrix point of view shows\nthat the zero energy state associated to the buried pole is a genuine\nMBS. In contrast to a @xmath MBS, the exceptional MBS is located at the\njunction (red sphere in Fig. 67 ), and its residual energy scale can be\ntuned all the way to zero by increasing @xmath instead of @xmath . In\nthe following we will demonstrate its Majorana character, and analyse\nits associated phenomenology.\n\n#### Spatial localization and Majorana character\n\nThe spatial locality and Majorana self-conjugation @xmath are assessed\nnext, by analysing the wavefunction of the MDSs. Figure 70 shows, in\nred, the quasiparticle density @xmath (solid lines) and charge density\n@xmath (dashed lines) of the MDS marked by the white arrow in Fig 69 f (\n@xmath and @xmath are particle and hole components of its wavefunction,\nrespectively). As discussed above, the MDS represents a non-decaying\nstate at zero energy. The figure shows that it is furthermore well\nlocalised at the junction, decaying exponentially as @xmath with a\nMajorana localization length @xmath [ 219 ] into the superconductor (see\nenvelopes and inset in 70 ). For comparison we also show in black the\nspatial probability @xmath of a conventional @xmath MBS for a\ntopological bulk at zero transparency (isolated topological wire). For\nboth states, the charge density @xmath is zero, as implied by the\nMajorana relation @xmath .\n\nWe now examine the charge density patterns that arise from the weak\noverlap of two MDSs. It was shown [ 220 , 221 ] that the charge density\n@xmath , which is zero everywhere for an isolated MBS (see Fig. 70 ),\ndevelops a spatial oscillatory pattern that is uniform throughout space\nwhen two MBSs approach each other in a 1D superconductor, irrespective\nof their particular positions. This is a very specific and non-trivial\nsignature of MBSs that probes the state wavefunction itself, and was\nproposed as a way to detect MBSs through charge sensing. A transparent\nNSN junction (with N portions coupled to reservoirs) provides a\nconvenient geometry to study this effect in the topologically trivial\nregime. Two localized MDSs appear for @xmath at the two ends of the S\nsection. They weakly overlap, and should thus be expected to exhibit\nuniform spatial charge oscillation throughout the superconductor in\nanalogy to conventional MBSs. Figs. 71 compare the charge density @xmath\nfor @xmath MBSs in the tunnelling limit and @xmath in the transparent\nlimit. Once more, we see the strong similarity between the two cases,\nwhich points to an essential equivalence between the two types of\nstates.\n\n#### 25.1 Low-energy phase dependence\n\nIn Fig. 72 we present the low-energy phase dependence in a topological\n(left) and non-topological (right) four-Majorana Josephson junction.\nMBSs at the outer (non-contacted) ends of the wire will form a zero\nenergy fermion for long enough wires (in red), while the inner MBSs (the\nancilla pair, in blue) will form a fermion with @xmath -dependent\nenergy. The ancilla Majoranas in this situation correspond to the two\nMajoranas delocalised over the helical region (blue in Fig. 72 , while\nthe outer Majoranas are the MDSs localised at each contact (red).\nRegardless of their different positions in space, the low energy Andreev\nspectrum in this system is essentially the same as for a four-MBS\ntopological Josephson junction [ 139 ] (compare left and right panels in\nFig. 72 ).\n\n### 26 Conclusions\n\nWe have presented a novel approach to engineer Majorana bound states in\nnon-topological superconducting wires. Instead of inducing a topological\ntransition in a proximitized Rashba wire, we consider a sufficiently\ntransparent normal-superconductor junction created on a Rashba wire,\nwith a topologically trivial superconducting side and a helical normal\nside. The strong coupling to the helical environment forces a single\nlong-lived resonance to emerge from an exceptional point at precisely\nzero energy above a threshold transparency. This resonance evolves as\nthe transparency is increased further into a stable dark state localised\nat the junction. We have demonstrated this phenomenon in a realistic\nmodel for a proximitized semiconducting nanowire.\n\nThe zero-energy state emerges as the junction traverses an exceptional\npoint at the threshold transparency, and becomes robustly pinned to zero\nenergy without fine tuning by virtue of charge-conjugation symmetry.\nMoreover, its residual decay rate at perfect transparency is\nexponentially suppressed in the experimentally relevant Andreev limit.\nFinally, we have shown that relevant transport and spectral properties\nassociated to these zero energy states, here dubbed Majorana dark\nstates, are indistinguishable from those of conventional Majorana bound\nstates.\n\nThus, our proposal offers a new promising strategy towards generating\nand detecting Majorana bound states in the lab, with potential\nadvantages over more conventional approaches in situations where\nmanipulating the metallic environment and contact properties proves to\nbe simpler than engineering a topological superconducting transition.\nMost importantly, the condition for reaching a helical phase in the\nnormal side, while the proximitized region of the nanowire remains in\nthe large @xmath Andreev limit, is expected to be accessible\nexperimentally. All the necessary ingredients for our proposal are\nalready available in the lab: dramatic advances in fabrication of thin\nsemiconducting nanowires, proximitized with conventional s-wave\nsuperconductors, were recently reported [ 113 , 115 ] . Highly\ntransparent, single-channel, NS contacts and a high-quality proximity\neffect in quantitative agreement with theory were demonstrated. Reaching\nthe helical regime in such high-quality and fully tunable devices should\nbe within reach, so we expect that our proposal for MDSs will be soon\ntested.\n\nThe general connection demonstrated here between Majorana states and the\nbifurcation of zero energy complex eigenvalues at exceptional points in\nopen systems offers a new perspective on the mechanisms that may give\nrise to Majorana states in condensed matter systems. In this sense it\nextends conventional strategies based on topological superconductors. It\nmoreover expands on the extensive studies on exceptional point physics\nin optics, where it has been shown that state coalescence has\nfar-reaching physical consequences, such as e.g. non-Abelian geometric\nphases [ 222 , 223 , 224 ] . To date, most studies of this kind have\nbeen concerned with open photonic systems under parity-time (PT)\nsymmetry [ 206 , 207 , 208 ] and with its spontaneous breakdown through\nexceptional point bifurcations. This leads to intriguing physical\nphenomena, such as unidirectional transmission or reflection [ 208 ] ,\nloss-induced transparency [ 209 ] , lasers with reversed pump dependence\nand other exotic properties [ 210 , 211 , 212 ] . Such striking optical\nphenomena are seemingly unrelated to the physics described in this work,\nbut interesting connections are being made. These include open photonic\nsystems with charge-conjugation symmetry [ 215 ] (as opposed to PT\nsymmetry), and which show spectral transitions analogous to the zero\nmode bifurcation discussed here. Also, radiation-induced non-hermicity\nhas been demonstrated as a way to convert Dirac cones into exceptional\npoints [ 225 ] , a phenomenon completely analogous to the conversion of\nzero energy crossings of Bogoliubov-de Gennes excitations in Josephson\njunctions into double exceptional point structures. Further research\nshould extend the understanding of these interesting connections. More\nimportantly, our study and others [ 215 , 225 ] raise relevant\nquestions, such as whether there is a deeper connection between\ntopological transitions in closed systems and spectral bifurcations in\nnon-hermitian systems. Answering such questions would help in advancing\nour understanding of the meaning of non-trivial topology in open\nsystems.\n\n## Chapter \\thechapter Density response function in Rashba nanowires: a\nlinear response approach292929The results of this chapter are being\nprepared for publication.\n\nIn this Chapter we investigate the density-density response function in\nnanowires with Rashba spin-orbit coupling, where a Zeeman field is\napplied perpendicular to the spin-orbit axis. Then, we extend the\nanalysis and consider induced @xmath -superconductivity into the\nnanowire, which is solve by taking zero interband pairing and then the\nstrong Zeeman field limit. This analysis is carried out based on the\nlinear response theory. Then, we use these results in order to\ninvestigate electron-electron interactions in the longitudinal direction\nof the wire within the Random Phase Approximation approach (RPA). In\nthis part, we have calculated the dielectric function, and then the\ncharge density-density response as well as the screened potential which\nallows us to describe screening effects in such nanowires.\n\n### 27 Introduction\n\nNanowires with Rashba spin-orbit coupling (SOC) are a solid platform for\ninvestigating Majorana bound states (MBSs). In fact, it was shown that\nwhen a Zeeman field @xmath is applied, perpendicular to the spin-orbit\naxis, and @xmath -wave superconductivity is induced, the nanowire\nbecomes a topological superconducting nanowire for fields exceeding\n@xmath , which is defined in terms of the induced superconducting\npairing @xmath and the wire\u2019s chemical potential @xmath . See Chapter\nHybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states for details. A significative\nnumber of measurements on electronic systems can be investigated by\napplying a small external field, as a probe of a certain type, to the\nsystem at an initial time and then focus on how the system responds.\nWhen the field is small enough, the response is proportional (a linear\nfunction) to the external perturbation, and the coefficient of\nproportionality is the correlation function of the system in the\nequilibrium ensemble without the perturbation. Therefore, the\ndescription of the response is based on linear response theory [ 226 ] .\nWithin this approach, the correlations functions are also known as\nlinear response functions. The change in the density of a system due to\na local change in its density (the response of the expectation value of\nthe number density operator) is an example of such linear response\nfunctions and it is described by the density-density response function\n(also known as Lindhard function) [ 226 ] . The density-density response\nfunction provides crucial information upon understanding static\nscreening, and, to the best of our knowledge, in nanowires with SOC and\nZeeman interaction it was not explored so far. The chemical potential in\nthe nanowire model for MBSs plays an important role, and in real\nexperiments it is tuned by means of electrostatic gates.\nElectron-electron interactions can affect the real value of @xmath and\nand therefore changing the topological transition point. A first step\nfor investigating electron-electron interactions in such nanowires can\nbe described within the Random Phase Approximation (RPA) and follows\nfrom the knowledge of the density-density response function [ 226 ] .\nIndeed, in a non-interacting electron gas, the (linear response) RPA\napproach is the approximation in which the proper response function is\nreplaced by the density-density response function (also known as the\nLindhard function) [ 226 ] . We are interested in the electron-electron\ninteractions along the longitudinal direction of the wire as we believe\nit is the most realistic situation. The calculation of the Lindhard\nfunction is trivial for free electrons [ 226 ] , however, it becomes\ncomplex when the system involves SOC, Zeeman fields or\nsuperconductivity. In this Chapter we firstly provide a brief\nintroduction and then calculate the density-density response function in\none-dimensional nanowires with SOC and Zeeman interaction. Afterwards,\nwe consider induced @xmath -wave superconductivity into Rashba\nnanowires, where our main interest is to calculate the density-density\nresponse function in the regime of strong Zeeman field. The results of\nthe density-density response function allow us to investigate the\ndielectric function, the charge density and screened potential within\nthe RPA approximation.\n\n#### 27.1 Model\n\nWe consider a one-dimensional one mode wire with Rashba SOC and Zeeman\nfield, perpendicular to the spin-orbit axis, modelled by the following\nHamiltonian\n\n  -- -------- -- -------\n     @xmath      (117)\n  -- -------- -- -------\n\nwhere the first, second and third terms are the kinetic, Rashba and\nZeeman Hamiltonians\n\n  -- -------- -- -------\n     @xmath      (118)\n  -- -------- -- -------\n\nThe spin direction is such that @xmath . @xmath denotes the spin\ndirection along the @xmath -axis. The Hamiltonian @xmath in the basis\n@xmath , @xmath being the transpose operation, can be written as\n\n  -- -------- -- -------\n     @xmath      (119)\n  -- -------- -- -------\n\nwhere the Hamiltonian density, @xmath , reads\n\n  -- -------- -- -------\n     @xmath      (120)\n  -- -------- -- -------\n\nwhere @xmath is the momentum operator, @xmath the electron\u2019s effective\nmass in the nanowire, @xmath the spin-orbit coupling strength, and\n@xmath the Zeeman splitting due to the magnetic field @xmath .\n\nThe eigenvalues and eigenvectors of the previous Hamiltonian are given\nby,\n\n  -- -------- -- -------\n     @xmath      (121)\n  -- -------- -- -------\n\nwhere @xmath and @xmath , @xmath is the dispersion relation for free\nelectrons, @xmath labels the two bands, @xmath the chemical potential\nmeasured from the bottom of the band, @xmath , with @xmath , and @xmath\nis the length of the wire. Notice that we have renamed the functions\n@xmath in Eq.\u2009( 42 ) by @xmath in Eq.\u2009( 121 ).\n\n#### 27.2 General concepts\n\nWhen a system is perturbed by a external potential @xmath , its density\ndeviates from the equilibrium value, and the change induces an\nadditional potential @xmath . The total potential in the system is the\nsum of the external and the induced potentials\n\n  -- -------- -- -------\n     @xmath      (122)\n  -- -------- -- -------\n\nand it is also known as the screened potential. If the perturbation is\nweak, there is a linear relationship between the induced density and the\nexternal potential\n\n  -- -------- -- -------\n     @xmath      (123)\n  -- -------- -- -------\n\nwhere @xmath is the density-density response function. By using Poisson\nand Eq.\u2009( 122 ) and @xmath , the dielectric function is given by\n\n  -- -------- -- -------\n     @xmath      (124)\n  -- -------- -- -------\n\nIn general, previous equation is the exact structure of the dielectric\nresponse where we need to know @xmath .\n\nThe screened effective potential is different from the bare external\npotential, and therefore it is useful to define a proper density-density\nresponse function, which gives the response of the induced density to\nthe screened potential @xmath . Therefore, the dielectric function and\nthe density response become,\n\n  -- -------- -- -------\n     @xmath      (125)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (126)\n  -- -------- -- -------\n\nThe Randon Phase Approximation replaces the induced charge without\ninteractions with the screened charge. Thus, in a non-interaction\nelectron gas, the (linear response) RPA approach is the approximation in\nwhich the proper response function is replaced by the Lindhard function\n[ 226 ] . The Lindhard function is the density-density response function\ndefined in Eq.\u2009( 146 ).\n\n  -- -------- -- -------\n     @xmath      (127)\n  -- -------- -- -------\n\nSo that the RPA dielectric function is given by\n\n  -- -------- -- -------\n     @xmath      (128)\n  -- -------- -- -------\n\nand the RPA charge density by,\n\n  -- -------- -- -------\n     @xmath      (129)\n  -- -------- -- -------\n\nNotice that @xmath represents the Coulomb interaction which depends on\nthe dimensionality of the problem. In our case, it corresponds to a\none-dimensional wire. To derive such potential, one examine the\nrepresentation of the Yukawa interaction in an infinite cylindrical wire\nof radius @xmath , where the transverse wave-function is assumed to be\ngaussian. Thus, arriving at [ 226 ] ,\n\n  -- -------- -- -------\n     @xmath      (130)\n  -- -------- -- -------\n\nwhere @xmath is the exponential-integral function\n\n  -- -------- -- -------\n     @xmath      (131)\n  -- -------- -- -------\n\nbeing @xmath the radius of the wire and @xmath the vacuum permittivity.\nNotice that @xmath diverges logarithmically for @xmath , imposing that\nthe use of finite @xmath in one-dimensional wires is both a physically\nrealistic characteristic and a mathematical requirement [ 226 ] . See\nfor instance right panel in Fig. 74 . The Fourier transform of the\nCoulomb potential is given by, see left panel in Fig. 74 ,\n\n  -- -------- -- -------\n     @xmath      (132)\n  -- -------- -- -------\n\nThe dielectric function is a property of the material being\ninvestigated, and usually assumed constant. We will see that, in\ngeneral, it depends on various parameters of the system and considering\nit as a constant implies somehow a naive approximation.\n\nThe screened potential for a point charge with @xmath , given by Eq.\u2009(\n130 ), can be calculated as follows [ 226 ]\n\n  -- -------- -- -------\n     @xmath      (133)\n  -- -------- -- -------\n\nor its Fourier transform as, in the static limit @xmath ,\n\n  -- -------- -- -------\n     @xmath      (134)\n  -- -------- -- -------\n\nwhere the integral includes the whole @xmath -space, @xmath . Previous\nequation represents the screened potential of the point charge potential\n@xmath within the RPA approximation, since the dielectric function\n@xmath is calculated in such approximation. Likewise, the induced\ndensity from Eq.\u2009( 123 ) can be written in the RPA limit as\n\n  -- -------- -- -------\n     @xmath      (135)\n  -- -------- -- -------\n\nor its Fourier transform\n\n  -- -------- -- -------\n     @xmath      (136)\n  -- -------- -- -------\n\nWe have seen in this subsection that, within the Random Phase\nApproximation (RPA), the Lindhard function (density response function)\n@xmath provides a simple but powerful tool in order to investigate the\ndielectric function, charge density and screened potential. This, of\ncourse, represents a first step in order to understand electron-electron\ninteractions in Rashba nanowires.\n\n##### 27.2.1 Finite length considerations\n\nIn order to take into account the length of the wire, one can define a\nnew potential @xmath ,\n\n  -- -------- -- -------\n     @xmath      (137)\n  -- -------- -- -------\n\nwhere we have introduced @xmath to count for the one dimensional\nelectron density which in general depends on @xmath and on the\nparameters of the system under investigation. In principle, the electron\ndensity should be calculated self-consistently using the Poisson and\nBdGs equations, however, for simplicity we assume that the electron\ndensity remains roughly constant within @xmath , @xmath , where @xmath\nrepresents the wire\u2019s length. Thus, the integral over @xmath in previous\nequation is finite for @xmath , then for the screened potential, in the\nwire of length @xmath , we get\n\n  -- -------- -- -------\n     @xmath      (138)\n  -- -------- -- -------\n\nwhere we have assumed constant density in the wire. Similarly, for the\nRPA induced density in the finite length wire we get from Eq.\u2009( 136 )\n\n  -- -------- -- -------\n     @xmath      (139)\n  -- -------- -- -------\n\nInstead of using a self-consistent solution of the Poisson-BdGs\nequations in @xmath , for simplicity we just consider @xmath . Notice\nthat @xmath is the perturbation to the electron density of the infinite\nwire @xmath , which can be calculated as follows. Indeed, from Eq.\u2009( 121\n) we can solve for @xmath and get @xmath , where\n\n  -- -------- -- -------\n     @xmath      (140)\n  -- -------- -- -------\n\nwhere @xmath , @xmath and @xmath . The density of states can be\ncalculated from previous equation as @xmath . Thus, the electron density\n@xmath is calculated by integrating the density of states up to the\nFermi level, which is defined by the chemical potential @xmath . Then,\nfor @xmath , both Rashba bands are occupied and therefore\n\n  -- -------- -- -------\n     @xmath      (141)\n  -- -------- -- -------\n\nWhen the chemical potential is within the Zeeman gap, @xmath , only the\nlower band is occupied and therefore\n\n  -- -------- -- -------\n     @xmath      (142)\n  -- -------- -- -------\n\nAnd for @xmath\n\n  -- -------- -- -------\n     @xmath      (143)\n  -- -------- -- -------\n\nPrevious formulae provide analytics for the electron density for a\nRashba nanowire.\n\n#### 27.3 Screening of the Coulomb potential with constant dielectric\nfunction\n\nIn our previous discussion, we have shown that the dielectric function\ncan be calculated from the density-density response function following\nRPA and linear response theory. On the other hand, it is usually\nconsidered that the static dielectric function is a parameter of the\nsystem and assumed to be a known quantity, being approximately @xmath\nfor InSb. However, later in this Chapter we will see that it strongly\ndepends on the wave-vector @xmath , but before going further, we first\ndiscuss the situation with constant dielectric function, @xmath . Then,\nwe can write Eq.\u2009( 134 ) as\n\n  -- -------- -- -------\n     @xmath      (144)\n  -- -------- -- -------\n\nwhere we have suppressed the notation @xmath in @xmath for obvious\nreasons and @xmath is the 1D Coulomb potential [ 226 ] given by Eq.\u2009(\n130 ).\n\nAs before, a finite length wire @xmath is taken into account by\nintegrating over @xmath , with @xmath the electron density,\n\n  -- -------- -- -------\n     @xmath      (145)\n  -- -------- -- -------\n\nIn Fig. 75 we plot the screened Coulomb potential as a function of\n@xmath , given by Eq.\u2009( 144 ), for different values of the dielectric\nconstant @xmath and wire\u2019s radius @xmath . For small @xmath (top left\npanel), the behaviour of the screened potential @xmath follows the\ntypical @xmath decay, however, as @xmath is increased, @xmath\nexperiments a considerable reduction for all @xmath and roughly\npreserving the @xmath shape for small @xmath . This implies that the\nscreened lengths are reduced by increasing @xmath . Notice also that by\nincreasing the wire\u2019s radius @xmath (top right and bottom panels), the\nvalues of the screened potential at small @xmath considerable decrease.\nFor huge values of @xmath (bottom right panel), the @xmath decay is\npractically lost and the potential tends to decrease linearly.\n\nIn Figs. 76 and 77 we plot the screened potential in a wire of finite\nlength @xmath as a function of @xmath , @xmath , given by Eq.\u2009( 145 ),\nfor different values of the dielectric constant and the wire\u2019s radius.\nIn both cases, the screened potential tends to be reduced by approaching\nthe edges of the wire, while acquiring a flat shape in the bulk. Notice\nthat by increasing the dielectric constant, @xmath is considerable\nreduced (see for instance different curves in left top panel of Fig. 76\n), and an increase in the wire\u2019s radius also introduces a reduction in\nthe screened potential (compare top panels), as also observed in Fig. 75\n. On the other hand, as one increases the length of the wire @xmath ,\nthe values of the screened potential are enhanced and the flatness\nbehaviour in the bulk is more robust. The lowest curves (red curves) in\nprevious figures correspond to @xmath , typical value of the dielectric\nconstant for InSb wires. Observe that for long finite wires with large\nradius @xmath the values of the screened potential @xmath tend to be\naround @xmath .\n\nIn this part we have learned that depending on the values of the\ndielectric constant @xmath , the screened potential may acquire\ndifferent values. Small (big) values of @xmath lead to big (small)\nvalues of the screened potential. Additionally, we have seen that\nincreasing the wire\u2019s radius also tend to reduce the screened potential.\nThese effects remain in both infinite and finite wires. The introduction\nof the finite wire\u2019s length also affect the screened potential at the\nwire edges.\n\nNext we will see how previous results change when the dielectric\nfunction is calculated from the density response function within the RPA\nand linear response approaches.\n\n### 28 Density response function in Rashba nanowires\n\nIn this part we calculate the density response function @xmath in\nnanowires with spin-orbit coupling and subjected to an external Zeeman\nfield, perpendicular to the spin-orbit axis, following the linear\nresponse approach [ 226 ] . From previous section we know that @xmath\nallows us for studying screening effects in these one-dimensional\nsystems. Although a full exact analysis should be done by solving the\nPoisson-BdGs equations, we believe that the treatment we do here\nrepresents a first step towards the understanding of electron-electron\ninteractions in such nanowires.\n\n#### 28.1 Density response function with SOC and Zeeman interaction\n\nWe calculate the density-density response function for a homogeneous\nnon-interacting 1D nanowire in the presence of Rashba spin-orbit and\nZeeman interactions following the linear response theory [ 226 ] .\n\nThe response function in momentum and frequency space is given by [ 226\n]\n\n  -- -------- -- -------\n     @xmath      (146)\n  -- -------- -- -------\n\nwhere we have denoted @xmath and\n\n  -- -- -- -------\n           (147)\n  -- -- -- -------\n\nHere, @xmath represents the electron density operator. In second\nquantisation, @xmath can be written in terms of electron field\noperators. The relation between the annihilation field operator @xmath ,\nat position @xmath and time @xmath , and any other set of annihilation\noperators @xmath is given by @xmath , where @xmath represent the\none-electron wave functions and @xmath labels spin, momentum, etc.\nTherefore, it is natural to use the eigenstates @xmath , given by Eq.\u2009(\n121 ), to construct such field operators. The electron density operator\nis then written as [ 226 ]\n\n  -- -------- -- -------\n     @xmath      (148)\n  -- -------- -- -------\n\nThen, we can write\n\n  -- -------- -- -------\n     @xmath      (149)\n  -- -------- -- -------\n\nwhere @xmath . Now, we plug the wave functions given in Eq.\u2009( 121 ) into\nprevious equations, and get\n\n  -- -------- -- -------\n     @xmath      (150)\n  -- -------- -- -------\n\nwhere @xmath , and @xmath Then, we introduce the equations for the\nelectron density operator, given by Eqs.\u2009( 150 ), into the average of\nthe commutator given by Eq.\u2009( 147 ). After some algebra we can get the\nstatic limit of the density-density response function, see Eq.\u2009( 416 )\nin Appendix Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states for more details on the\nderivation,\n\n  -- -------- -- -------\n     @xmath      (151)\n  -- -------- -- -------\n\nAt zero temperature @xmath , the Fermi distribution function @xmath\nbecomes a step function @xmath , which is @xmath for @xmath or @xmath ,\notherwise. The function @xmath restricts the @xmath integration to\ninterval @xmath , with @xmath defined from Eq.\u2009( 121 ), @xmath , where\n\n  -- -------- -- -------\n     @xmath      (152)\n  -- -------- -- -------\n\nwith @xmath , @xmath and @xmath .\n\nIn Fig. 78 we present the static density-density response function,\ngiven by Eq.\u2009( 151 ), as a function of the momentum @xmath for different\nvalues of the Zeeman field. The @xmath limit of the static density\nresponse function is a measure of the number of excited states available\nto the system for vanishing excitation energy. Therefore, unlike the\nfree electron case [ 226 ] , the density response function, given by\nEq.\u2009( 151 ), is zero at @xmath , and that is because the external\nmagnetic field introduces a gap into the system [ 226 ] . Another\nimportant feature of the density response function given by Eq.\u2009( 151 )\nis that it develops three clear resonance peaks at @xmath , @xmath and\n@xmath , and also an almost invisible kink for @xmath close to @xmath\ncorresponds to @xmath . This is different from to the free electron\ncase, where only one peak at @xmath [ 226 ] . The positions of these\npeaks are shown in left panel of Fig. 78 , while in the right panel one\nobserves its evolution as the Zeeman field increases. The peaks are\nvisible as long as they are real. Indeed, in Fig. 78 , for\nexperimentally reasonable values of @xmath , @xmath and @xmath , one\nobserves that for @xmath , the density response @xmath exhibits the\nthree clear resonant peaks at the corresponding @xmath and an almost\ninvisible kink as explained above. On the other hand, when @xmath ,\n@xmath , defined by Eq.\u2009( 152 ), becomes completely imaginary and\ntherefore the system involves only one Fermi momentum leaving only the\nresonance at @xmath . Notice that the almost invisible kink close to\n@xmath happens at @xmath as long as such wave vectors are real, which\nmeans for @xmath , otherwise such resonance peak is the same as the one\nat @xmath . Important, such peaks can be interpreted as evidence of\nstatic charge density waves.\n\nIn Subsec. 27.2 we have introduced the RPA approach in order to\ncalculate the dielectric function. We have pointed out that in this\napproach the proper response function is the density-density response\nfunction ( or Lindhard function), see Eq.\u2009( 128 ). Thus, in order to\ncalculate the dielectric function for Rashba nanowires, we use the\ndensity-density response given by Eq.\u2009( 151 ), and then plug into Eq.\u2009(\n128 ). The results are shown in Fig. 79 , where we present the\ndielectric function as a function of momentum @xmath in the RPA\napproach. In this part we have also the Coulomb potential in 1D derived\nin [ 226 ] , see Eq.\u2009( 130 ). In Fig. 79 the nanowire\u2019s radius @xmath is\nfixed.\n\nSince the dielectric function is calculated from the density response\nfunction, one expects that such function still contains information\nabout the resonance peaks, as one can indeed observe in Fig. 79 . We\nalso notice that the resonance peaks in the dielectric function @xmath\nare not of the same high as in the density response function @xmath ,\nsee Fig.\u2009( 78 ).\n\nThe visibility of the resonance peaks also depends on the new length\nscale introduced with the wire\u2019s radius. Indeed, observe the evolution\nof the dielectric function @xmath at fixed Zeeman field for @xmath and\n@xmath in left and right panels of Fig.\u2009( 80 ). In the former case, the\ntwo Fermi wave vectors @xmath are real and therefore the dielectric\nfunction develops the three resonance peaks at @xmath , @xmath , @xmath\n, and a small kink at @xmath . While in the latter, @xmath is imaginary\nand only one resonance peak at @xmath is observed. In both cases, as the\nwire\u2019s radius increases, the resonance peaks are reduced and even\ncompletely washed out when @xmath is long enough. It seems that the\nresonance peaks are visible as long as @xmath , where @xmath .\n\nIn Fig. 81 , we present the charge density response function in the RPA\napproach as a function of the momentum, @xmath , for different values of\nthe wire\u2019s radius, calculated from Eq.\u2009( 129 ). Top panels correspond\nfor @xmath , while bottom for @xmath . Notice that, in the former case,\nthe expected resonance peaks, which appeared in the density response\nfunction in Fig. 78 at @xmath , @xmath , @xmath and a small kink at\n@xmath , are only visible when the radius of the wire is made very large\n(see dashed lines in top panels). On the other hand, in the latter, for\n@xmath , @xmath is imaginary and only one resonance peak is the one\nassociated to @xmath , as one indeed observes (see dashed line at high\nmomentum). Interestingly, at small momentum, the charge density, @xmath\n, develops a resonance, which is visible for @xmath nm (for parameters\ngiven in caption of Fig. 81 ) and follows the rule @xmath , where @xmath\nis the Fermi length @xmath .\n\n### 29 Density response function in superconducting nanowires\n\nThe aim of this part is to calculate the response function in strong\nZeeman fields, as it is the one that corresponds to the topological\nsuperconducting phase with MBSs.\n\nIn this part we consider the same Rashba nanowire as in the previous\nsection, and place it in proximity to a @xmath -wave superconductor with\nHamiltonian\n\n  -- -------- -- -------\n     @xmath      (153)\n  -- -------- -- -------\n\nFor introducing superconductivity, we first write down the full system\nHamiltonian, @xmath , in the so-called helical basis given by Eqs.\u2009( 49\n), whose description was given in Sections 5 and C . In such basis, the\nfull Hamiltonian is written as\n\n  -- -------- -- -------\n     @xmath      (154)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (155)\n  -- -------- -- -------\n\nrepresent the different pairing functions that arise in our nanowire due\nto the interplay of Rashba SOC and Zeeman interaction when placed on a\n@xmath -wave superconductor. The first line of Eq.\u2009( 154 ) is just the\nnormal Rashba nanowire Hamiltonian, while in the second line, the first\nand second terms associated to @xmath , describe pairing between states\nof the same @xmath band, while the third term associated to @xmath ,\nrepresent pairing between states of different band.\n\nEq.\u2009( 154 ) can be written in Nambu space,\n\n  -- -------- -- -------\n     @xmath      (156)\n  -- -------- -- -------\n\nwhere the Bogoliubov-de Gennes Hamiltonian reads\n\n  -- -- -- -------\n           (157)\n  -- -- -- -------\n\nwhose eigenvalues read, see Eq.\u2009( 54 ),\n\n  -- -------- -- -------\n     @xmath      (158)\n  -- -------- -- -------\n\nwhere @xmath , @xmath , and @xmath by Eqs.\u2009( 155 ). At @xmath the lower\nband, @xmath , develops a gap, as shown in Sec. 5 , and follows\n\n  -- -------- -- -------\n     @xmath      (159)\n  -- -------- -- -------\n\nwhich closes at @xmath , determining the topological phase transition\npoint into a topological superconducting phase with Majorana bound\nstates at the end of the wire.\n\nOn the other hand, for zero interband pairing, @xmath , we are left with\npairing potentials between states of the same band, only. This could\nmimic the physics of two p-wave superconductors with pairing potentials\n@xmath and @xmath . In this regime, the BdG Hamiltonian reads,\n\n  -- -------- -- -------\n     @xmath      (160)\n  -- -------- -- -------\n\nwhere the energy spectrum reads,\n\n  -- -------- -- -------\n     @xmath      (161)\n  -- -------- -- -------\n\nwith @xmath and the superconducting pairing potentials are of @xmath\n-wave nature\n\n  -- -------- -- -------\n     @xmath      (162)\n  -- -------- -- -------\n\nAt @xmath ,\n\n  -- -------- -- -------\n     @xmath      (163)\n  -- -------- -- -------\n\nso that there is a closing of the gap at low momentum when @xmath . This\nresembles to the closing of the gap at @xmath when the interband\npairing, @xmath , is not zero.\n\n#### 29.1 Density response function: zero interband pairing, two band\nmodel\n\nFor simplicity, we calculate the density response function when the\npairing of states of different band is zero. Effectively, it is similar\nto a situation with two p-wave superconductors. We follow [ 226 ] . We\nstart but calculating the density response with SO and Zeeman field, and\nthen use the bogoliubov transformation found in previous chapter in\norder to write the helical basis in the quasiparticle one.\n\nThe density-density response function is given by\n\n  -- -------- -- -------\n     @xmath      (164)\n  -- -------- -- -------\n\nwhere\n\n  -- -- -- -------\n           (165)\n  -- -- -- -------\n\nHere, @xmath is the electron density operator. We have seen in previous\nsection that, in second quantisation, the electron density operator can\nbe written in terms of field operators\n\n  -- -------- -- -------\n     @xmath      (166)\n  -- -------- -- -------\n\nwhere @xmath are wave functions of the Rashba-Zeeman problem\n\n  -- -- -- -------\n           (167)\n  -- -- -- -------\n\nWe then write\n\n  -- -------- -- -------\n     @xmath      (168)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (169)\n  -- -------- -- -------\n\nTherefore,\n\n  -- -------- -- -------\n     @xmath      (170)\n  -- -------- -- -------\n\nNow, we insert previous equations into Eq.\u2009( 165 ), and then sum over\n@xmath . Moreover, since we are dealing with a superconducting system,\noperators @xmath are transformed into new ones according to the\nBogoliubov transformation described in detail in Appendix N.1 . We are\ninterested on the zero temperature and zero frequency limit, and after\nsome algebra, see Appendix N for details, we get\n\n  -- -------- -- -------\n     @xmath      (171)\n  -- -------- -- -------\n\nwith the superconducting coherence factors given by\n\n  -- -------- -- -------\n     @xmath      (172)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (173)\n  -- -------- -- -------\n\nrepresent the @xmath -wave nature of the superconducting pairing\npotential, and\n\n  -- -------- -- -------\n     @xmath      (174)\n  -- -------- -- -------\n\nis the coefficient arising from the interplay of the Rashba SOC and\nZeeman interaction. Notice that the summation in @xmath in Eq.\u2009( 171 )\nis replaced by an integration over @xmath : @xmath , and the limits of\nintegration includes all @xmath , i.e. @xmath . We do not discuss the\nresults obtained in this part because what interests us is the strong\nZeeman regime, which is discussed next.\n\n#### 29.2 Density response function in strong Zeeman field: one band\nmodel\n\nIn this part we address the situation of high Zeeman field @xmath . In\nthis case, only the lowest band, @xmath , is occupied. In a situation of\nhigh magnetic field, the system is in the topological phase and one can\nproject the full Hamiltonian onto the lower band @xmath , then\n\n  -- -------- -- -------\n     @xmath      (175)\n  -- -------- -- -------\n\nPrevious Hamiltonian can be written in the BdG form in the @xmath basis,\nthus\n\n  -- -------- -- -------\n     @xmath      (176)\n  -- -------- -- -------\n\nwith energy dispersion given by\n\n  -- -------- -- -------\n     @xmath      (177)\n  -- -------- -- -------\n\nand @xmath -wave superconducting pairing potential\n\n  -- -------- -- -------\n     @xmath      (178)\n  -- -------- -- -------\n\nNow, we calculate the density-density response function following the\nlinear response theory described in [ 226 ] , as we have done in\nprevious subsection. The response function in momentum and frequency\nspace is given by\n\n  -- -------- -- -------\n     @xmath      (179)\n  -- -------- -- -------\n\nwhere, @xmath ,\n\n  -- -- -- -------\n           (180)\n  -- -- -- -------\n\nwhere @xmath is the electron density operator. In second quantisation ,\n@xmath can be written in terms of the helical field operators described\nin the previous section\n\n  -- -------- -- -------\n     @xmath      (181)\n  -- -------- -- -------\n\nwhere\n\n  -- -- -- -------\n           (182)\n  -- -- -- -------\n\nare the wave functions of the Rashba-Zeeman problem, and @xmath . Hence,\nEq.\u2009( 181 ) can be written as\n\n  -- -------- -- -------\n     @xmath      (183)\n  -- -------- -- -------\n\nBy inserting previous relations into the equation for the density\nresponse we get\n\n  -- -------- -- -------\n     @xmath      (184)\n  -- -------- -- -------\n\nNow, we assume the situation of high Zeeman field, where only the lowest\nband, @xmath , is occupied. Therefore, in Eq.\u2009( 489 ) the unique\ncombination that we need is\n\n  -- -------- -- -------\n     @xmath      (185)\n  -- -------- -- -------\n\nIn order to describe the system with superconducting effects, we need to\ntransform our @xmath operators in Eq.\u2009( 490 ) into the new ones @xmath\naccording to the Bogoliubov transformation we have found in Eq.\u2009( 468 )\nor \u2009( 469 ). In momentum space, the static response function at zero\ntemperature, see Appendix N.2 , then we get\n\n  -- -------- -- -------\n     @xmath      (186)\n  -- -------- -- -------\n\nwhich is valid only for high Zeeman fields @xmath . Previous equation is\nthe density-density response function also known as the Lidnhard\nfunction. Previous equation represents the density-density response\nfunction in a 1D superconducting wire with Rashba and Zeeman interaction\nwith only the lowest band occupied, also known as the Lindhard function.\nThe coherence factors coming from the spin-orbit and Zeeman effects is\ngiven by\n\n  -- -------- -- -------\n     @xmath      (187)\n  -- -------- -- -------\n\nwhile the one from the superconductor\n\n  -- -------- -- -------\n     @xmath      (188)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (189)\n  -- -------- -- -------\n\nIn Fig. 82 the density response function, given by Eq.\u2009( 186 ), is\nplotted. The expected resonance at @xmath is observed, which\nconsequently is suppressed by increasing the superconducting pairing.\nNotice that the small momentum limit is really sensible to any change in\n@xmath , while higher momentum is roughly constant. This resonance at\n@xmath gives rise to the so-called Friedel oscillations, which can be\nobserved by Fourier transformed Eq.\u2009( 499 ) into @xmath -space. The\nFermi momentum is @xmath , where @xmath , @xmath and @xmath .\n\nIn Fig. 83 the dielectric function in the RPA limit, given by Eq.\u2009( 128\n), is plotted. The resonance at @xmath is still visible for a certain\nrange of the wire\u2019s radius @xmath , but it is completely lost when\n@xmath (see top right panel). A feature that is really sensible to any\nchange in @xmath is the small @xmath region with a complex dependence on\n@xmath , while the high momentum one exhibit a decay behaviour\nconverging to @xmath . The dependence of the dielectric function on the\nspin-orbit coupling, superconductivity, Zeeman and superconductivity, is\ngiven in top right, bottom left and right panels, respectively. An\nincrease in the SOC, the resonance peak is slightly moved towards higher\nmomenta, as indeed expected indeed, and the high of @xmath at small\n@xmath is decreased, but its width is constant. The effect of the\nsuperconducting pairing is observed in the bottom left panel. While it\nwashes out the resonance when increased but maintaining fixed its the\nposition, the hight of the dielectric function is considerably reduced.\nIn the bottom right panel, the Zeeman field is increased. The position\nof the resonance is then also moved towards higher momenta as in the\ncase when the SOC is increased. An important feature of the small\nmomentum window is that the width of resonance-like behaviour is varied,\nunlike the situation with different SOC and superconductivity.\n\nNow, we are in a position to investigate the screened potential within\nthe RPA approach @xmath [ 226 ] . In Subsection 27.2 we described the\nscreened potential @xmath for a point charge with electron-electron\ninteraction in one dimension @xmath given by Eq.\u2009( 130 ). Such screened\npotential is described by Eq.\u2009( 133 ) in momentum space or by Eq.\u2009( 134\n) in real space, for @xmath ,\n\n  -- -------- -- -------\n     @xmath      (190)\n  -- -------- -- -------\n\nNow, we discuss the screened potential @xmath for an infinite nanowire\nwith Rashba SOC, Zeeman interaction and superconductivity calculated\nfrom Eq.\u2009( 190 ) as a function of the distance @xmath . Fig. 84 show\nsuch situation for different values of the Zeeman field @xmath and\ndifferent values of the wire\u2019s radius @xmath . The potential exhibits a\nclear decay for small @xmath with the so-called Friedel oscillations\nwhose amplitude is reduced as @xmath increases. Note that the\noscillations are reduced by increasing the wire\u2019s radius and completely\nwashed out for realistic experimental values (see brown curve). Notice\nthat for small values of @xmath and @xmath the screened potential takes\nhuge values and diverges for @xmath due to the logarithmic divergence of\nthe 1D Coulomb potential @xmath . The oscillatory behaviour depends on\nthe Fermi wave vector @xmath defined in Eq.\u2009( 152 ) and therefore on the\nsystem parameters ( @xmath ). For increasing such parameters the\noscillations become more extended so that they are not observed (not\nshown). The decay of the screened potential is slow and the finite value\nof the potential for long distances @xmath strongly depends on the\nsuperconducting pairing @xmath as shown in Fig. 85 , where we present\nthe screened potential as a function of @xmath for different values of\nthe superconducting pairing @xmath with oscillations (small @xmath , top\nrow) and without them (large @xmath , bottom panel). From such plots one\ncan conclude that the long @xmath limit do not decay, however, we have\nchecked that @xmath in fact exhibits a really slow decay. First, the\nsuperconducting pairing does not influence on the shape of the\noscillations for small @xmath . As increasing @xmath the potential for\ndifferent @xmath acquire different values but still preserving the\noscillatory behaviour. For long @xmath and small @xmath the values of\nthe screened potential are reduced. This effect is observed for\ndifferent values of the wire\u2019s radius @xmath , as shown in Fig. 85 .\n\nOn the other hand the induced density was defined in momentum and real\nspace by Eqs.\u2009( 135 ),\n\n  -- -------- -- -------\n     @xmath      (191)\n  -- -------- -- -------\n\nand in real space by\n\n  -- -------- -- -------\n     @xmath      (192)\n  -- -------- -- -------\n\nwhere @xmath is the density-density response function.\n\nThe induced density @xmath has to be understood as a correction for the\nelectron density @xmath of the infinite wire given by Eq.\u2009( 142 for high\nZeeman fields), resulting in @xmath . In Fig. 86 we plot the electron\ndensity given by Eq.\u2009( 142 ) for an infinite Rashba wire. Notice the\ndependence on the system\u2019s parameters and it increased as one increases\nthe Zeeman field.\n\nIn Fig. 87 is plotted the induced density @xmath given by Eq.\u2009( 192 ) as\na function of the distance @xmath (top row) for two values of the Zeeman\nfield and different radius of the wire @xmath and (bottom row) for two\nvalues of the wire\u2019s radius and different Zeeman fields.\n\nThe induced density @xmath at small @xmath tends to be negative which\narises from the logarithmic divergence (small @xmath ) of the 1D Coulomb\npotential @xmath and it is suppressed when the wire\u2019s radius @xmath\ntakes realistic values @xmath nm. As we have explained before, the\nnegative value the induced density @xmath means that the total electron\ndensity @xmath is reduced at small @xmath due to the electron-electron\ninteraction, since @xmath corresponds to deviations from the electron\ndensity in equilibrium without perturbation ( @xmath for an infinity\nwire given by Eq.\u2009( 142 )). As @xmath increases the induced density\ncaptures the oscillatory pattern of the density-density response\nfunction @xmath , which are suppressed at long distances @xmath .\n\nIn order to take into account the finite length of the wire, @xmath , we\nhave defined a new potential @xmath , where @xmath represents the wire\u2019s\nlength,\n\n  -- -- -- -------\n           (193)\n  -- -- -- -------\n\nand for the induced density from Eq.\u2009( 139 ), we get\n\n  -- -------- -- -------\n     @xmath      (194)\n  -- -------- -- -------\n\nNotice that for simplicity we have defined the electron density in the\nwire as @xmath , being @xmath the length of the wire, and do not follow\nmore complicated schemes as the Poisson approach. By doing such\nassumption for @xmath we do not have any dependence on the system\nparameters such as @xmath that in principle @xmath has. A full\nPoisson-BdGs solution should take into account these details.\n\nIn Fig. 89 we present the screened potential as a function of the\nposition calculated from Eq.\u2009( 193 ) for a short and long wire,\nrespectively, for different values of the wire\u2019s radius. The\ndenomination short and long is made by comparing the wire\u2019s length with\n@xmath . The screened potential develops the expected oscillatory\nbehaviour in the wire, which represent the well-known Friedel\noscillations. In a long wire it acquires a higher amplitude, although\nsuch oscillations are more visible in a short wire than in a long one as\none can indeed see. Moreover, one notices that by increasing the wire\u2019s\nradius the oscillatory behaviour of the screened potential is reduced,\nand even washed out. For a reasonable long wire with a realistic radius,\nthe potential is constant in the bulk, while it is reduced at the edges.\n\nThe screened potential @xmath introduces a change in the chemical\npotential @xmath so that the new chemical potential is @xmath . First,\none notices that due to this dependence, the topological transition\npoint determined by @xmath is affected and becomes @xmath . A full\nanalysis requires to include the full band calculation in the density\nresponse function and therefore be able to map the topological\ntransition by increasing the Zeeman field, which is planned for a future\nstudy. Based on the results obtained in the strong Zeeman regime, this\nnew chemical @xmath allows us to investigate the Majorana wave function\namplitude as a function of the position in the wire and compare it to\nthe situation with @xmath . Additionally, we can also calculate the\nlow-energy Andreev spectrum and focus on its evolution of @xmath , being\nvalid only for strong @xmath . All these calculations form part of a\nfuture study in order to provide a full RPA analysis of the Majorana\nproblem in nanowires.\n\n### 30 Conclusions\n\nIn this Chapter we have calculated the density-density response function\nin one-dimensional superconducting nanowires with spin-orbit coupling\nand Zeeman fields. Firstly, we have investigated the density-density\nresponse function in isolated wires. Then, we have considered a\nproximitized nanowire, where the density-density response was calculated\ntaking into account zero-interband pairing and later in a strong Zeeman\nregime, being the latter of great relevance as such limit corresponds to\na situation with MBSs. The analysis was done within the linear response\ntheory framework. Then, we used these results in order to investigate\nelectron-electron interactions in the longitudinal direction of the wire\nwithin the Random Phase Approximation approach. In this part, we have\ncalculated the dielectric function, and then the charge density-density\nresponse as well as the screened potential for the infinite wire as well\nas for a finite length wire.\n\n## Chapter \\thechapter Conclusions\n\nIn this thesis we have investigated hybrid superconductor-semiconductor\njunctions made of semiconducting nanowires with Rashba spin-orbit\ncoupling. Along this thesis, we emphasise the importance of employing\nhybrids superconductor-semiconductor nanowire junctions towards the\nunambiguously detection of Majorana bound states (MBSs) beyond zero-bias\nanomalies. We have analysed the low energy Andreev spectrum, phase and\nvoltage-biased transport, have proposed a new scheme for engineering\nMBSs in trivial NS junctions and at the end have performed an analysis\nof screening properties in Rashba nanowires based on linear response\ntheory and Random Phase Approximation.\n\nThe main results of the thesis can be summarised as follows:\n\n-    In chapter Hybrid superconductor-semiconductor nanowire junctions\n    as useful platforms to study Majorana bound states we have presented\n    in detail how hybrid NS and SNS junctions are modelled based on\n    semiconductor nanowires with Rashba spin-orbit coupling. In this\n    part, we have showed that emergence of Majorana bound states is\n    distinguishable in the Andreev spectrum (see for instance Fig. 36 ).\n    Despite of being @xmath periodic, the Josephson current exhibits a\n    clear reduction in the topological phase and when, additionally, the\n    Majorana overlap is negligible (see for instance Fig. 43 ) it\n    develops a distinguishable sawtooth profile at @xmath . Remarkably,\n    the critical current traces the closing and reopening of the\n    topological gap, exhibiting a robust and non-trivial feature at the\n    gap closing, remaining finite in the topological phase and revealing\n    the Majorana oscillations (see Fig. 45 ).\n\n-    In chapter Hybrid superconductor-semiconductor nanowire junctions\n    as useful platforms to study Majorana bound states we have studied\n    transport in a voltage-biased short\n    superconductor-normal-superconductor (SNS) junction made of\n    semiconducting nanowires with Rashba spin-orbit coupling, as the\n    applied Zeeman field drives the system into the topological\n    superconducting phase. We have shown that the dissipative multiple\n    Andreev reflection (MAR) current at different junction\n    transparencies exhibits unique features related to topology such as\n    gap inversion, the formation of MBSs and fermion-parity\n    conservation. We predict the halving of MAR steps owing to the\n    presence of Majorana bound states in the junction (see Fig. 49\n    (a,d)) as well as the possibility of observing the transition into\n    the topological superconducting phase directly in the critical\n    current of the junction (see Fig. 50 ).\n\n-    In chapter Hybrid superconductor-semiconductor nanowire junctions\n    as useful platforms to study Majorana bound states we have extended\n    traditional conceptions and made a detailed study on the role that\n    confinement and helicity have on normal transport and on the sub-gap\n    Andreev spectrum in short and long SNS junctions made of\n    semiconducting nanowires (NWs) with strong Rashba spin-orbit\n    coupling. We found that a long junction with a helical normal\n    section but still in the topologically trivial regime, supports a\n    low-energy sub-gap spectrum consisting of multiple zero-energy\n    crossings that smoothly evolve towards MBSs as the junction becomes\n    topological (see for instance Fig. 62 ). This indeed suggests an\n    interesting connection between subgap parity crossings in helical\n    junctions with @xmath and Majorana bound states in topological ones\n    with @xmath .\n\n-    In chapter Hybrid superconductor-semiconductor nanowire junctions\n    as useful platforms to study Majorana bound states we have proposed\n    an alternative route for engineering MBSs with non-topological\n    superconducting wires, which consists of creating a sufficiently\n    transparent normal-superconductor (NS) junction on a Rashba wire,\n    with a topologically trivial superconducting side and a helical\n    normal side. The zero-energy state emerges as the junction traverses\n    an exceptional point at the threshold transparency and becomes\n    robustly pinned to zero energy without fine tuning by virtue of\n    charge-conjugation symmetry. Finally, we have shown that relevant\n    transport and spectral properties associated to these zero energy\n    states, here dubbed are indistinguishable from those of conventional\n    MBSs (see for instance Fig. 72 ).\n\n-    In chapter Hybrid superconductor-semiconductor nanowire junctions\n    as useful platforms to study Majorana bound states we have\n    investigated screening properties of proximitized nanowires with SOC\n    and Zeeman fields within RPA and linear response theory. This,\n    indeed, represents a relevant step for experiments trying to measure\n    Majorana bound states and their non-trivial overlap.\n\nWith the recent advance in fabrication techniques and induced hard-gaps\ntechnology [ 113 , 115 ] , we expect that our research reported here\nwill support new experiments towards the unambiguously detection of\nMBSs.\n\n## Chapter \\thechapter Resumen y conclusiones\n\nEn 1937, Ettore Majorana postul\u00f3 que la equation de Dirac se puede\nescribir en una base donde sus soluciones son campos reales [ 30 ] .\nEsto permite dividir la ecuaci\u00f3n de Dirac en dos sistemas de ecuaciones\nindependientes, cada una con dos ecuaciones acopladas. La solucion a uno\nde estos representa un campo real, @xmath , y por ende la part\u00edcula\nasociada a dicho campo es su propia antipart\u00edcula, @xmath . Esta\npart\u00edcula es fermi\u00f3nica, esp\u00edn @xmath , neutral, y se denomina fermi\u00f3n\nde Majorana. El origen de los fermiones de Majorana est\u00e1 en f\u00edsica de\npart\u00edculas, donde aun no se ha determinado completamente si los\nneutrinos obedecen dicha fenomenolog\u00eda.\n\nPor otro lado, en materia condensada ha despertado mucho inter\u00e9s la idea\nde tener part\u00edculas que sean sus propias antipart\u00edculas. El origen de\neste inter\u00e9s est\u00e1 en varias predicciones te\u00f3ricas en torno al a\u00f1o 2010\nque demostraron que los superconductores topol\u00f3gicos, la variante\nsuperconductora de los aislantes topol\u00f3gicos, poseen excitaciones de\ncuasipart\u00edcula de tipo Majorana [ 27 , 37 ] . La conexi\u00f3n formal con la\nf\u00edsica de altas energ\u00edas se encuentra en la simetr\u00eda de conjugaci\u00f3n de\ncarga: la simetr\u00eda electr\u00f3n-hueco, en lenguaje de f\u00edsica de la materia\ncondensada, que todo superconductor posee. Efectivamente, las\nexcitaciones sobre el estado fundamental BCS en un superconductor son\nsuperposiciones cu\u00e1nticas de electrones y huecos que se denominan\ncuasipart\u00edculas de Bogoliubov. Una cuasipart\u00edcula de Bogoliubov a\nenerg\u00eda cero es perfectamente neutra (mitad electr\u00f3n-mitad hueco) y por\ntanto, igual a su propia antipart\u00edcula. El \u00faltimo ingrediente para que\nuna excitaci\u00f3n de Bogoliubov sea de tipo Majorana es que no tenga\ndegeneraci\u00f3n de esp\u00edn y, por tanto, todas las propuestas para generar\nsuperconductividad topol\u00f3gica se basan en superconductores de onda\n@xmath , debido a que estos poseen fases topol\u00f3gicas. T\u00e9ngase en cuenta\nque, en materia condensada, lo que ha llamado mucho la atenci\u00f3n son\nestas cuasipart\u00edculas con car\u00b7cter Major\u00e1nico pero a energ\u00eda cero. Estas\nno tienen analog\u00eda en f\u00edsica de part\u00edculas, pero a\u00fan obedecen @xmath\n(donde @xmath viene a ser un operador Major\u00e1nico). Las fases con estados\nde Majorana se pueden distinguir de otras por medio de invariantes\ntopol\u00f3gicos, que en este caso es el n\u00famero Major\u00e1nico. Los estados de\nMajorana a energ\u00eda cero aparecen como estados ligados a interfaces con\ndiferente topolog\u00eda y es por eso que tambi\u00e9n se les denomina estados\nligados de Majorana (MBSs). Aparte de su inter\u00e9s fundamental, estas\nexcitaciones en un superconductor topol\u00f3gico poseen estad\u00edstica cu\u00e1ntica\nno-Abeliana, sin an\u00e1logos en el modelo est\u00e1ndar de la f\u00edsica de\npart\u00edculas, que da lugar a una forma de computaci\u00f3n cu\u00b7ntica muy robusta\n[ 24 ] .\n\nHasta hace poco, la necesidad de trabajar con superconductores de onda\n@xmath se consideraba una limitaci\u00f3n poco menos que insalvable, dada su\nescasez en la naturaleza y su sensibilidad al desorden. Esta situaci\u00f3n\nha cambiado en los \u00faltimos a\u00f1os con varias propuestas te\u00f3ricas que\ndemuestran que es posible generar de manera efectiva superconductividad\nde onda @xmath combinando materiales con fuerte acoplo esp\u00edn-\u00f3rbita\n(aislantes topol\u00f3gicos o semiconductores con acoplo Rashba) a\nsuperconductores usuales con simetr\u00eda de onda s [ 39 , 41 , 61 ] . Una\nde las plataformas mas prometedoras consiste en nanohilos\nsemiconductores con fuerte acoplamiento de esp\u00edn \u00f3rbita [ 41 , 61 ] .\nCuando en el nanohilo se induce superconductividad de onda @xmath , el\nnanohilo entra en la fase topol\u00f3gica cuando @xmath , donde @xmath es el\ncampo cr\u00edtico y se\u00f1ala la transition topol\u00f3gica dando origen a la\ninversi\u00f3n del gap, @xmath es el potencial qu\u00edmico del nanohilo y @xmath\nel pairing superconductor inducido en el nanohilo.\n\nLa posibilidad de obtener superconductividad topol\u00f3gica combinando estos\nmateriales m\u00e1s comunes gener\u00f3 altas expectativas y muchos laboratorios\ndel mundo se lanzaron a la carrera para detectar por primera vez una\npart\u00edcula de Majorana. El experimento pionero corresponde al grupo de\nDelft [ 67 ] , donde miden la emergencia de un pico a voltaje cero en la\nconductancia diferencial de una uni\u00f3n h\u00edbrida\nsemiconductor-superconductor como caracter\u00edstica de la emergencia de un\nestado ligado de Majorana. Experimentos posteriores [ 45 , 46 , 47 , 48\n, 49 ] tambi\u00e9n muestran datos consistentes con cuasipart\u00edculas de\nMajorana sin embargo no es posible descartar otras explicaciones\nalternativas del origen de los picos a voltaje cero, tales como\ndesorden, efecto Kondo, etc.\n\nMuchas de las preguntas han sido parcialmente resultas \u00faltimamente, sin\nembargo, a\u00fan se requiere estudios adicionales con nuevas propuestas.\nAdicionalmente, recientemente ha habido un gran avance en la fabricaci\u00f3n\nde uniones h\u00edbridas, donde se ha logrado sintetizar sistemas con\nhard-gaps inducidos [ 113 , 115 , 118 ] .\n\nEl objetivo de esta tesis es proponer y analizar posibles protocolos de\ndetecci\u00f3n m\u00e1s all\u00e1 de esta primera generaci\u00f3n experimental. Por lo antes\nexpuesto, esta tesis est\u00e1 dedicada a investigar propiedades de\ntransporte en sistemas h\u00edbridos NS y SNS basaos en nanohilos\nsemiconductores, as\u00ed como tambi\u00e9n estudiar la emergencia de los estados\nde Majorana en dichas estructuras. Una de las ventajas de las uniones\nSNS es, por ejemplo, que permite estudiar el monitoreo detallado de\nalgunos observables con respecto a la diferencia de fase\nsuperconductora.\n\nEn el cap\u00edtulo Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states se da una introducci\u00f3n\ngeneral a la superconductividad topol\u00f3gica en una dimension basados en\nel modelo de Kitaev para superconductividad de onda @xmath , y adem\u00e1s\nmostramos la emergencia de los estados de Majorana a energ\u00eda cero al\nfinal del nanohilo. Luego se describe el modelo f\u00edsico basado en\nnanohilos semiconductores con esp\u00edn \u00f3rbita tipo Rashba, donde un campo\nmagn\u00e9tico Zeeman @xmath es aplicado y superconductividad de onda @xmath\nes inducida en el nanohilo. Se asume que existe buen contacto entre el\nnanohilo y el superconductor de tal manera que correlaciones\nsuperconductoras sean inducidas al nanohilo por medio del efecto\nproximidad. Esto da origen a un nanohilo superconductor que cuando el el\ncampo magn\u00e9tico aplicado es mayor que @xmath se convierte en un nanohilo\nsuperconductor topol\u00f3gico con estados de Majorana al final del nanohilo,\nuno en cada lado. Aqu\u00ed, resaltamos que los estados de Majorana a energ\u00eda\ncero aparecen en la fase topol\u00f3gica ligados a interfaces de diferente\ntopolog\u00eda, con su funci\u00f3n de onda decayendo hacia el bulk.\n\nEn el cap\u00edtulo Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states , en primer lugar, se\nintroducen los conceptos b\u00e1sicos en uniones h\u00edbridas\nNormal-Superconductor (NS) y Superconductor-Normal-Superconductor (SNS):\nreflexi\u00f3n de Andreev (AR) y estado ligado de Andreev (ABS). Aqu\u00ed tambi\u00e9n\nclasificamos las uniones SNS en cortas ( @xmath ) o largas ( @xmath ),\ndonde @xmath es la longitud de la regi\u00f3n normal y @xmath es la longitud\nde coherencia superconductora. Luego nos centramos en describir\ndetalladamente como modelamos estas uniones h\u00edbridas a partir de\nnanohilos semiconductores con esp\u00ed-\u00f3rbita tipo Rashba, sujetos a un\ncampo magn\u00e9tico y donde superconductividad de onda @xmath es inducidad\nen el nanohilo. Para esto, discretizamos el Hamiltoniano para el\nnanohilo en una red tight-binding, para luego escribir el Hamiltoniano\ndel sistema en espacio Nambu. A partir de esto calculamos los niveles de\nenerg\u00eda ya sea para un nanohilo superconductor, uni\u00f3n NS o uni\u00f3n SNS. En\nel caso de uniones SNS, mostramos la evoluci\u00f3n detallada de los niveles\ncomo funci\u00f3n de la diferencia de fase desde la fase trivial hacia la\nfase topol\u00f3gica con estados de Majorana. Debido a la longitud finita de\nS, en este caso el sistema posee cuatro estados de Majorana cuando la\ndiferencia de fase es @xmath . Resaltamos en esta parte que, debido a\nque \u00faltimamente se viene investigando experimentalmente espectroscop\u00eda\nde niveles, es posible realizar un estudio experimental, similar al que\nhacemos, para detectar la presencia de los estados de Majorana. Adem\u00e1s\nmostramos que tanto la corriente Josephson como la corriente cr\u00edtica,\ncalculadas a partir de los niveles, poseen informaci\u00f3n relevante sobre\nlos estados de Majorana. Sorprendentemente, la corriente cr\u00edtica como\nfunci\u00f3n del campo Zeeman traza perfectamente la evolucion hacia la fase\ntopol\u00f3gica. Esta adquiere un valor no nulo en la transici\u00f3n topol\u00f3gica,\naqu\u00ed el sistema no tiene gap, y se mantiene finito a medida que el campo\naumenta. Sin lugar a dudas, esto da origen a caracter\u00edsticas no usuales\ny solamente relacionadas con la emergencia de los estados de Majorana.\nPor eso creemos que estas caracter\u00edsticas pueden ser distinguibles\nexperimentalmente en uniones con nanohilos.\n\nEn el cap\u00edtulo Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states se propone una forma\npotente y sencilla para detectar estados ligados de Majorana (MBSs) en\nuna uni\u00f3n h\u00edbrida SNS, donde un voltage constante es aplicado. Aqu\u00ed, se\nestudia transporte Josephson bajo voltage constante en una uni\u00f3n SNS\nhecha de nanohilos con esp\u00edn-\u00f3rbita fuerte, a medida que el sistema\nexperimenta una transici\u00f3n hacia la fase topol\u00f3gica cuando aumentamos el\ncampo Zeeman. La uni\u00f3n SNS es formada por dos leads superconductores\nsemi-infinitos, y por lo tanto solo dos estados de Majorana emergen en\nla uni\u00f3n. Usando la t\u00e9cnica de las funciones de Green de Keldysh,\nproponemos que las corrientes debido a las m\u00faltiples reflecciones de\nAndreev (MAR) as\u00edcomo tambi\u00e9n la corriente cr\u00edtica sirven como una forma\nalternativa y potente para estudiar la transici\u00f3n topol\u00f3gica. Esto se\nhace posible debido al efecto directo que la inversi\u00f3n del gap, la\nformaci\u00f3n de MBSs y la conservaci\u00f3n de la paridad fermi\u00f3nica tienen en\nla corriente MAR para diferentes transparencias de la uni\u00f3n. Por otro\nlado, tambi\u00e9n demostramos que la corriente cr\u00edtica es inesperadamente\nfinita para todo campo Zeeman debido a la contribuci\u00f3n del continuo, y\nexhibe una anomal\u00eda en la transici\u00f3n topol\u00f3gica que podr\u00eda ser\nexperimentalmente localizada y distinguida, como tambi\u00e9n se predice en\nel cap\u00edtulo Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states .\n\nEn el cap\u00edtulo Hybrid superconductor-semiconductor nanowire junctions as\nuseful platforms to study Majorana bound states estudiamos transporte\nnormal y el espectro subgap en uniones superconductoras SNS hechas de\nnanohilos semiconductores con un fuerte acoplamiento esp\u00edn-\u00f3rbita tipo\nRashba. Nos centramos, en particular, en el papel que los efectos de\nconfinamiento tienen en uniones bal\u00edsticas largas. En el r\u00e9gimen normal,\nscattering en los dos contactos da lugar a dos caracter\u00edsticas distintas\nde la conductancia: resonancias Fabry-Perot y dips Fano. Estas \u00faltimas\nse producen en presencia de un fuerte campo Zeeman @xmath que elimina un\nsector de esp\u00edn en los leads (leads helicales), pero no en la regi\u00f3n\ncentral. Inversamente, una regi\u00f3n central helical entre los conductores\nno helicales presenta gaps helicales de la mitad de la cu\u00e1ntica\nconductancia, con oscilaciones helicales Fabry-Perot superpuestas. Estas\ncaracter\u00edsticas normales se traducen en distintos estados subgap cuando\nlos leads se convierten en superconductores. En particular, resonancias\nFabry-Perot dentro del gap helical se convierten en cruces de estados a\nenerg\u00eda cero protegidos por la paridad (cruces de paridad), muy por\ndebajo del campo cr\u00edtico @xmath en el que los leads superconductores se\nconvierten en topol\u00f3gicos. Como funci\u00f3n del campo Zeeman o energ\u00eda de\nFermi, estos modos oscilan alrededor de energ\u00eda cero, formando loops\ncaracter\u00edsticos, que evolucionan continuamente hacia estados ligados de\nMajorana cuando @xmath excede @xmath . En esta parte tambi\u00e9n se discute\nla relaci\u00f3n con la f\u00edsica de los cruces de paridad de estados ligados de\nYu-Shiba-Rusinov.\n\nSintetizar superconductores en su fase topol\u00f3gica con un gap robusto y\nbien definido es la mayor dificultad pr\u00e1ctica que presenta la propuesta\noriginal. En el cap\u00edtulo Hybrid superconductor-semiconductor nanowire\njunctions as useful platforms to study Majorana bound states hemos\ninvestigado una plataforma alternativa para crear estados ligados de\nMajorana en nanohilos superconductors no topol\u00f3gicos. Nuestra propuesta\nconsiste en que en lugar de inducir la transici\u00f3n topol\u00f3gica en un\nnanohilo en proximidad a un superconductor de onda @xmath , se debe\nconectar el nanohilo superconductor trivial a un metal normal helical\npor medio de un contacto transparente. Esta nueva propuesta representa\nun gran avance y tiene muchas ventajas sobre los esquemas\nconvencionales, ya que los superconductores topol\u00f3gicos son sensitivos\nal desorden y llegar a la fase topol\u00f3gica implica un gran desaf\u00edo\nexperimental en muchos de ellos. Dicha uni\u00f3n puede ser realizad\nexperimentalmente, por ejemplo, poniendo en proximidad una secci\u00f3n\nfinita del nanohilo con acoplamiento esp\u00edn-\u00f3rbita, y combinando gates\nelectrost\u00e1ticos y un campo Zeeman para llevar la secci\u00f3n que no est\u00e1 en\nproximidad al superconductor hacia su fase helical. En nuestra\npropuesta, los estados de Majorana a energ\u00eda cero emergen en dicho\nsistema abierto sin la necesidad de fine-tuning como resultado de la\nsimetr\u00eda de conjugaci\u00f3n de carga, y puede ser ligado a la existencia de\npuntos excepcionales (EPs) en el espacio de par\u00e1metros, donde dos\nestados cuasi ligados de Andreev se bifurcan en dos estados ligados de\nMajorana a energ\u00eda cero. Despu\u00e9s del EP, uno de los estados cuasi\nligados de Andreev se vuelve no-decaying a medida que la uni\u00f3n se\naproxima a reflexi\u00f3n Andreev perfecta, resultando asi en un estado de\nMajorana dark (MDS) localizado en la uni\u00f3n NS. Aqu\u00ed se muestra que los\nMDSs poseen propiedades asociadas a los estados ligados de Majorana\nconvencionales en sistemas cerrados, sin la necesidad de requerir\nsuperconductividad topol\u00f3gica.\n\nPor otro lado, en el cap\u00edtulo Hybrid superconductor-semiconductor\nnanowire junctions as useful platforms to study Majorana bound states\nusamos teor\u00eda de respuesta lineal para calcular la funci\u00f3n de respuesta\nde densidad en nanohilos con acoplamiento esp\u00edn-\u00f3rbita y campo Zeeman\naplicado. Mostramos tambi\u00e9n que en esto puede generalizarse cuando el\nsistema se vuelve superconductor. Para ello nos centramos en dos\nl\u00edmites: el primero, donde el sistema posee dos bands pero el pairing\nentre bandas es cero y por ende posee una transici\u00f3n topol\u00f3gica;\nmientras que en el segundo nos centramos en el regimen de campos altos\ncuando el sistema est\u00e1 en la fase topol\u00f3gica. Luego, dentro de la Random\nPhase Approximation (RPA), calculamos la funci\u00f3n diel\u00e9ctrica, luego la\ndensidad de carga y el potencial de apantallamiento. Debido a la\nsimpleza del enfoque, esperamos que los resultados sean cualitativamente\nconsistentes con m\u00e9todos auto-consistentes.\n\nEsperamos que el trabajo presentado en esta tesis abra nuevos horizontes\nhacia la detecci\u00f3n de estados ligados de Majorana en materia condensada.\n\n## Chapter \\thechapter Appendix for Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states\n\nIn this chapter we provide additional details for a complete description\nof the introduction, thus making this thesis self-contained.\n\n## Appendix A Details of the Bogoliubov-de Gennes Hamiltonian\n\nThe reduced pairing Hamiltonian, given in the main text by Eq.\u2009( 121 ),\nemerges as a result of the electron-electron interaction Hamiltonian [\n58 ] ,\n\n  -- -------- -- -------\n     @xmath      (195)\n  -- -------- -- -------\n\nwhere the first term describes free electrons, while the second one the\ninteractions with strength @xmath . Regarded to Eq.\u2009( 121 ), we write\ndown the two parts of such Hamiltonian, @xmath ,\n\n  -- -------- -- -------\n     @xmath      (196)\n  -- -------- -- -------\n\nBecause fluctuations are small with respect to non-zero expectation\nvalues of operators @xmath , it is appropriate to write down [ 57 ]\n\n  -- -- -- -------\n           (197)\n  -- -- -- -------\n\nwhere the second terms in the right hand side, in previous two\nequations, represents the fluctuation around which the averages of the\noperators, the first terms, fluctuate. Then, the interaction part of the\npairing Hamiltonian can be written as,\n\n  -- -- --\n        \n  -- -- --\n\nIn the mean-field approach, the terms @xmath in previous expression are\nneglected, since fluctuations are assumed to be small. Therefore, the\nmean-field interaction Hamiltonian can be written as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNow, we are in position to define fundamental the averages of two\ncreation or annihilation operators as the superconducting pairing\npotential @xmath , leading to macroscopic quantum coherence of the\nsystem. This represents the fundamental characteristic of the\nsuperconducting state. A superconducting system is in a ordered state,\nand the pairing potential is also known as the order parameter [ 59 , 57\n, 58 ] . Thus, the mean-field pairing Hamiltonian reads,\n\n  -- -- -- -------\n           (198)\n  -- -- -- -------\n\nwhich is the one given in Eq.\u2009( 12 ).\n\nSuperconducting systems require to treat electrons and holes on the same\nfooting. This is why one follows the Bogoliubov-de Gennes formalism [ 58\n] , where one introduces a redundant description that will be clear in\nthe following. Let us first write the kinetic term of Eq.\u2009( 198 ),\n\n  -- -------- -- -------\n     @xmath      (199)\n  -- -------- -- -------\n\nwhere in the second equality in the first line, we have used usual\nanti-commutation relations for fermionic operators @xmath , and in the\nsecond line we have just relabelled @xmath to @xmath . Now, we assume\n@xmath to be independent of @xmath , and proceed with the second term in\nEq.\u2009( 198 ) similarly as for the kinetic term,\n\n  -- -------- -- -------\n     @xmath      (200)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (201)\n  -- -------- -- -------\n\nIn previous two equations we have used @xmath , and @xmath . Then, Eq.\u2009(\n198 ) reads\n\n  -- -------- -- -------\n     @xmath      (202)\n  -- -------- -- -------\n\nPrevious equation can be rewritten in a matrix form, then\n\n  -- -- -- -------\n           (203)\n  -- -- -- -------\n\nWe notice that in this elegant form, we have introduced a new spinor\nbasis containing creation and annihilation operators. These operators\ndefine the so-called Nambu representation [ 58 ] , which emerges\nnaturally in superconducting systems and we define them as,\n\n  -- -------- -- -------\n     @xmath      (204)\n  -- -------- -- -------\n\nWe point out that such representation is not unique but the physics\nremains the same. The matrix in Eq.\u2009( 203 ) is the so-called\nBogoliubov-de Gennes Hamiltonian [ 59 , 57 , 58 ]\n\n  -- -------- -- -------\n     @xmath      (205)\n  -- -------- -- -------\n\nThe last two terms in Eq.\u2009( 203 ) are constant and usually dropped off\nin the literature. Thus, the spectrum of Eq.\u2009( 203 ) is found after\nsolving the eigenvalue problem @xmath , and given by Eq.\u2009( 17 ), where\nthe eigenvalues form the diagonal elements of @xmath in the new basis\nand represent the quasiparticle excitations in a superconductor.\n\n#### Bogoliubov transformation\n\nThe ground state of a superconductor is formed by Cooper pairs, while\nthe quasiparticle excitations in a superconductor are separated from\nsuch ground state by an energy gap, as seen in Eq.\u2009( 17 ), and can\nemerge by breaking a Cooper pairs. Therefore, it is natural to look for\na relation between operators @xmath and the new ones denoted with @xmath\nnext, where the @xmath is diagonal, with the energies given by Eq.\u2009( 17\n). The new basis is found by projecting the spinor @xmath , given in\nEq.\u2009( 204 ), onto the eigenvectors of @xmath\n\n  -- -- -- -------\n           (206)\n  -- -- -- -------\n\nwhere @xmath is the spinor representing the new basis, @xmath is an\nunitary operator formed by the eigenvectors of @xmath , which connects\nthese two basis,\n\n  -- -------- -- -------\n     @xmath      (207)\n  -- -------- -- -------\n\nbeing a @xmath matrix due to spin and electron-hole symmetries. Notice\nthat the columns of @xmath are the eigenvectors of @xmath . We will see\nthat the unitary matrix @xmath can be also constructed by placing the\neigenvectors as rows, instead of columns, in @xmath , giving rise to\n@xmath , which is also unitary matrix and also diagonalizes @xmath .\nTaking the Hermitian conjugate of Eq.\u2009( 206 ) one has @xmath . Then,\nbecause @xmath , one has the inverse transformation\n\n  -- -------- -- -------\n     @xmath      (208)\n  -- -------- -- -------\n\nThe transformation given by Eq.\u2009( 206 ), or the inverse given by Eq.\u2009(\n208 ), are known in the literature as the Bogoliubov-Valatin\ntransformation, but we will refer to it as Bogoliubov transformation,\nonly. We have pointed out that the unitary matrix, which connects the\ntwo basis is formed out by the eigenvectors of @xmath , becoming our\nfirst task in the following part.\n\n##### The eigenvectors\n\nWe start by solving the eigenvalue problem for @xmath ,\n\n  -- -------- -- -------\n     @xmath      (209)\n  -- -------- -- -------\n\nwhere @xmath is the @xmath identity matrix. The eigenvalues then read\n@xmath . Now, we go back to the first equation of Eqs.\u2009( 209 ) and using\nthe known eigenvalues and the form of the eigenvectors, we write\n\n  -- -------- -- -------\n     @xmath      (210)\n  -- -------- -- -------\n\nFrom previous system of equations, one observes that they can be written\nin two groups,\n\n  -- -------- -- -------\n     @xmath      (211)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (212)\n  -- -------- -- -------\n\nwhich can be solved separately because spin up and down electrons are\nnot coupled, but rather electrons and holes through the pairing\npotential @xmath . Additionally, one indeed notices that in these two\ngroups only one equation matters, since the two equations are coupled\nand therefore contain redundant information. The fact that there are two\ngroups corresponding to up and down spins, which can be solved\nseparately, allows us to define eigenvectors associated to the first and\nsecond group, respectively,\n\n  -- -------- -- -------\n     @xmath      (213)\n  -- -------- -- -------\n\nwhere the zeroes in @xmath and @xmath correspond to elements that are\nnot present in Eqs.\u2009( 211 ) and Eqs.\u2009( 212 ), respectively. The first\ncomponent in the second equality of @xmath corresponds electron part\nwith spin up (down), while the second to the respective hole part with\nspin down (up) (because a hole is a time-reversed electron). The other\nequation that helps us to solve such systems is the normalisation\ncondition associated to @xmath : @xmath and @xmath\n\nFrom Eqs.\u2009( 211 ), for @xmath , one has\n\n  -- -------- -- -------\n     @xmath      (214)\n  -- -------- -- -------\n\nand normalization condition dictates\n\n  -- -------- -- -------\n     @xmath      (215)\n  -- -------- -- -------\n\nFor finding @xmath , one takes the positive value of @xmath in previous\nequation and then plug it into first equation of Eqs.\u2009( 214 ), then\n\n  -- -------- -- -------\n     @xmath      (216)\n  -- -------- -- -------\n\nThen,\n\n  -- -------- -- -------\n     @xmath      (217)\n  -- -------- -- -------\n\nwhere we have rewritten it as a four component vector according to\nEqs.\u2009( 213 ), and we have defined, up to a phase,\n\n  -- -------- -- -------\n     @xmath      (218)\n  -- -------- -- -------\n\nIn the same way, for @xmath , we have\n\n  -- -------- -- -------\n     @xmath      (219)\n  -- -------- -- -------\n\nand normalization condition dictates\n\n  -- -- -- -------\n           (220)\n  -- -- -- -------\n\nthen, by taking the positive value of @xmath , up to a phase, and\nplugging it back into the first equation of Eqs.\u2009( 219 ) one finds\n\n  -- -------- -- -------\n     @xmath      (221)\n  -- -------- -- -------\n\nWe notice that, according to definitions given by Eqs.\u2009( 218 ), for\n@xmath , we have obtained @xmath and @xmath . Then,\n\n  -- -------- -- -------\n     @xmath      (222)\n  -- -------- -- -------\n\nwhere according to Eqs.\u2009( 213 ) we have written as a four component\nvector. Therefore, the results we have obtained are, as four component\nvectors,\n\n  -- -- -- -------\n           (223)\n  -- -- -- -------\n\nIn a similar fashion one can proceed for Eqs.\u2009( 212 ), and after some\nalgebra obtains\n\n  -- -------- -- -------\n     @xmath      (224)\n  -- -------- -- -------\n\n##### The transformation\n\nNow, going back to the unitary transformation, it is important to\nremember that the problem was defined in two parts and therefore the\nfour equations were divided in two groups of two equations each and\nsolved separately. The unitary matrix, given by Eq.\u2009( 207 ), is then\ncarefully rewritten as\n\n  -- -- -- -------\n           (225)\n  -- -- -- -------\n\nTherefore, the unitary operators are given by\n\n  -- -------- -- -------\n     @xmath      (226)\n  -- -------- -- -------\n\nThen, according Eq.\u2009( 206 ), @xmath ,\n\n  -- -------- -- -------\n     @xmath      (227)\n  -- -------- -- -------\n\none arrives at\n\n  -- -------- -- -------\n     @xmath      (228)\n  -- -------- -- -------\n\nor the inverse, @xmath , by Eq.\u2009( 208 ),\n\n  -- -------- -- -------\n     @xmath      (229)\n  -- -------- -- -------\n\nleading to\n\n  -- -------- -- -------\n     @xmath      (230)\n  -- -------- -- -------\n\nTo finish this part, we point out that the other unitary matrix that\ndiagonalises @xmath is @xmath , being @xmath the transpose operation.\nThen, according Eq.\u2009( 206 ), @xmath , one has\n\n  -- -------- -- -------\n     @xmath      (231)\n  -- -------- -- -------\n\nor the inverse, @xmath , following Eq.\u2009( 208 ),\n\n  -- -------- -- -------\n     @xmath      (232)\n  -- -------- -- -------\n\nEquations 228 and 230 or 231 and 232 constitute the so-called\nBogoliubov-Valatin transformations.\n\nNotice that, for instance, from Eqs.\u2009( 228 ) one can write\n\n  -- -- -- -------\n           (233)\n  -- -- -- -------\n\nand therefore conclude that @xmath is connected to @xmath through the\nso-called electron-hole symmetry of @xmath discussed in the main text.\n\n#### Comment on singlet and triplet superconductors\n\nPauli inclusion principle imposes that the pairing function must be\nantisymmetric, then\n\n  -- -------- -- -------\n     @xmath      (234)\n  -- -------- -- -------\n\nwhere the @xmath denotes the spin indices. We can separate the spin part\nfrom the orbital part, then\n\n  -- -------- -- -------\n     @xmath      (235)\n  -- -------- -- -------\n\nTherefore, in the case of singlet pairing, the spin part is odd, while\nthe orbital part is even, the orbital part fulfils\n\n  -- -------- -- -------\n     @xmath      (236)\n  -- -------- -- -------\n\nand thus we have the pairing symmetry of the so-called @xmath -wave\nsuperconductor.\n\nOn the other hand, in the case of triplet pairing, the spin part is\neven, while the orbital part is odd, then for the orbital part\n\n  -- -------- -- -------\n     @xmath      (237)\n  -- -------- -- -------\n\nand we therefore have the pairing symmetry of the so-called @xmath -wave\nsuperconductor.\n\nOf course that our discussion is oversimplified and does not consider\nother pairing symmetries such as @xmath etc. The aim of this part is\njust to point out the difference between @xmath and @xmath -wave\nsuperconductors, since these two types are discussed in this thesis.\n\n## Appendix B Kitaev\u2019s model: open and closed periodic boundary\nconditions\n\nIn this section we provide additional details, which complete the\ndescription of the Kitaev\u2019s model.\n\n#### Open chain\n\nHere, we concentrate on the chain with @xmath fermionic sites, where the\nfirst and the last are not connected. We refer to this approach as to\nthe open chain case. The Kitaev model, @xmath , given by the Hamiltonian\nin Eq.\u2009( 22 ) with elements\n\n  -- -------- -- -------\n     @xmath      (238)\n  -- -------- -- -------\n\nwas written as Eq.\u2009( 24 ) by transforming fermionic operators @xmath\ninto Majorana ones according to Eqs.\u2009( 3 ). Here, we complete the\nderivation by expressing each Hamiltonian term into the new basis,\nassuming real pairing potential @xmath . Therefore, in terms of the\nMajorana operators, we have\n\n  -- -- -- -------\n           (239)\n  -- -- -- -------\n\nPrevious equations can be rewritten as\n\n  -- -- -- -------\n           (240)\n  -- -- -- -------\n\nIn the following, we make use of the algebra for Majorana operators\ngiven by Eqs.\u2009( 4 ), where\n\n  -- -------- -- -------\n     @xmath      (241)\n  -- -------- -- -------\n\nThus, according to Eqs.\u2009( 238 ), the necessary expressions are given by\n\n  -- -------- -- -------\n     @xmath      (242)\n  -- -------- -- -------\n\nTherefore, the Hamiltonian elements given by Eqs.\u2009( 238 ) in the\nMajorana basis read\n\n  -- -- -- -------\n           (243)\n  -- -- -- -------\n\nThe full Hamiltonian, @xmath , is then written as\n\n  -- -------- -- -------\n     @xmath      (244)\n  -- -------- -- -------\n\nwhich is the one given in the main text by Eq.\u2009( 24 ), with @xmath and\n@xmath .\n\nWe have discussed in the main text the emergence of zero energy Majorana\nmodes at the end of the chain, one at each end, in the topological\nphase. At this point, Majorana operators @xmath and @xmath , at the end\nof the chain, do not enter in the Hamiltonian given by Eq.\u2009( 26 ), and\ntherefore the following relations hold\n\n  -- -------- -- -------\n     @xmath      (245)\n  -- -------- -- -------\n\nThus, if @xmath is the energy of the ground state @xmath , then @xmath .\nNow, by employing Eqs.\u2009( 245 ), we write\n\n  -- -------- -- -------\n     @xmath      (246)\n  -- -------- -- -------\n\nThen, previous discussions imply the following relations\n\n  -- -------- -- -------\n     @xmath      (247)\n  -- -------- -- -------\n\nPrevious two equations manifest the fact that we can create a pair of\nMajorana states at the end of the chain, represented by operators @xmath\nand @xmath , with one Majorana at each end. Remarkably, after we create\nthis pair, the new state is still the ground state with the same energy\n@xmath as @xmath , indicating that there is no cost of energy to create\na pair of Majorana states at the ends of a superconducting chain.\n\nBy fusing the two unpaired Majorana operators @xmath and @xmath , we\nhave defined a zero energy fermion represented by new operators @xmath\nand @xmath , see Eq.\u2009( 30 ). Hence, from Eq.\u2009( 247 ), one can show that\n\n  -- -------- -- -------\n     @xmath      (248)\n  -- -------- -- -------\n\nThen, the ground states of @xmath can be spanned by operators @xmath and\n@xmath . The occupation number operator is defined as @xmath , while the\nfermion parity operator as @xmath . Let us now calculate\n\n  -- -------- -- -------\n     @xmath      (249)\n  -- -------- -- -------\n\nTherefore, previous equations indicate that we can use the occupation\nnumber @xmath in order to label the ground states. The two ground states\nare then the empty state @xmath and the occupied one @xmath satisfying\n@xmath and @xmath .\n\n#### Closed periodic boundaries\n\nThe assumption of a chain forming a closed loop with periodic boundary\nconditions, requires to add an extra term given by Eq.\u2009( 22 ) to the\nHamiltonian, arriving at the Hamiltonian given by Eq.\u2009( 32 ). The goal\nis to write down the Hamiltonian given by Eq.\u2009( 32 ), which is in site\nspace, in momentum space. Thus, we perform Fourier transformations of\nthe fermion operators @xmath as follows\n\n  -- -------- -- -------\n     @xmath      (250)\n  -- -------- -- -------\n\nAn implication of the periodicity of the lattice is that wave-vectors\n@xmath that differ by a reciprocal lattice vector are the same, so that\nthe sum over @xmath is limited to the first Brillouin zone:\n\n  -- -------- -- -------\n     @xmath      (251)\n  -- -------- -- -------\n\nIn the following we will make use of the discrete representation of the\nKronecker delta function\n\n  -- -------- -- -------\n     @xmath      (252)\n  -- -------- -- -------\n\nAccording to Eq.\u2009( 32 ), the fermion operators we need are the\nfollowings,\n\n  -- -------- -- -------\n     @xmath      (253)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (254)\n  -- -------- -- -------\n\nwhere we have used that @xmath . This is also used next,\n\n  -- -------- -- -------\n     @xmath      (255)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (256)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (257)\n  -- -------- -- -------\n\nTherefore, the Hamiltonian given by Eq.\u2009( 32 ) in momentum space reads\n\n  -- -------- -- -------\n     @xmath      (258)\n  -- -------- -- -------\n\nwhere @xmath is the normal energy dispersion. In what follows, we make\nuse of the redundant behaviour to treat electrons and hole at the same\nfooting, introduced when we discussed the Bogoliubov formalism in Sec. 3\n. Thus, formally, we can rewrite the fermion operators involved in\nprevious Hamiltonian as\n\n  -- -------- -- -------\n     @xmath      (259)\n  -- -------- -- -------\n\nTherefore, Eq.\u2009( 258 ) reads,\n\n  -- -------- -- -------\n     @xmath      (260)\n  -- -------- -- -------\n\nwhere the first term represents the kinetic part for electrons and\nholes, respectively, the second term is a constant usually neglected.\nThe third term in previous equation is the pairing part of the\nHamiltonian, where fermions with momentum @xmath and @xmath are paired\ntogether. Notice that there are two special points in @xmath -space with\nzero contribution to the pairing Hamiltonian because @xmath . Eq.\u2009( 258\n) can be written as\n\n  -- -------- -- -------\n     @xmath      (261)\n  -- -------- -- -------\n\nWe have seen in Sec. 3 that when dealing with electrons and holes, in\nsuperconducting systems for instance, it is natural to define Nambu\nspinors\n\n  -- -------- -- -------\n     @xmath      (262)\n  -- -------- -- -------\n\nThen, Eq.\u2009( 261 ) can be written as\n\n  -- -------- -- -------\n     @xmath      (263)\n  -- -------- -- -------\n\nwhere we have used that @xmath , since @xmath is an even function of\n@xmath , @xmath , and @xmath being the Bogoliubov-de Gennes Hamiltonian.\nNotice that @xmath is odd in @xmath , thus exhibiting its @xmath -wave\nnature.\n\n## Appendix C Rashba nanowire model\n\nIn this section we provide additional details that we find useful in\norder to have a complete view of what we present in Sec. 5 of the main\ntext.\n\n#### c.1 Eigenvalues and eigenfunctions for the Rashba normal system\n\nIn this part we calculate the eigen vectors for the Rashba system\nsubjected to a perpendicular Zeeman magnetic field. The Hamiltonian for\nthe normal system @xmath is given by Eq.\u2009( 41 ). The eigenvalues and\neigenvectors are found by solving the eigenvalue equation @xmath , where\n@xmath are the eigen-values and @xmath the eigenvectors that due to spin\nare two dimensional spinors. The problem can be solved by supposing that\nsolutions are given in terms of plane waves of the form @xmath , where\n@xmath stands for the transpose operation, and then one introduces them\nback into Eq.\u2009( 41 ). For the eigevalues, @xmath ,\n\n  -- -------- -- -------\n     @xmath      (264)\n  -- -------- -- -------\n\nwhere @xmath . Now, by using the calculated eigenvalues and the form of\nthe wavefunctions, one is able to find the values of @xmath and @xmath .\nOf course, we should not forget the normalization condition @xmath .\nThen, by writing down the eigenvalue equation,\n\n  -- -------- -- -------\n     @xmath      (265)\n  -- -------- -- -------\n\nwe can write\n\n  -- -------- -- -------\n     @xmath      (266)\n  -- -------- -- -------\n\nwhich are two coupled equations. Only one gives us relevant information:\none can express @xmath in terms of @xmath or the inverse, the result\nwon\u2019t change. Now, we use the first equation and express @xmath in terms\nof @xmath\n\n  -- -------- -- -------\n     @xmath      (267)\n  -- -------- -- -------\n\nand the wavefunctions hence reads,\n\n  -- -------- -- -------\n     @xmath      (268)\n  -- -------- -- -------\n\nwhere @xmath . Hence,\n\n  -- -------- -- -------\n     @xmath      (269)\n  -- -------- -- -------\n\nwhere @xmath can be calculated from the normalization condition\n\n  -- -------- -- -------\n     @xmath      (270)\n  -- -------- -- -------\n\ntherefore @xmath up to a phase that we do not consider for making the\ndiscussion easier. Then\n\n  -- -------- -- -------\n     @xmath      (271)\n  -- -------- -- -------\n\nOn the other hand, we could also consider the second equation in 266 ,\nthen\n\n  -- -------- -- -------\n     @xmath      (272)\n  -- -------- -- -------\n\nand proceeding in the same way as before we find\n\n  -- -------- -- -------\n     @xmath      (273)\n  -- -------- -- -------\n\nBoth solutions, Eq.\u2009( 271 ) and Eq.\u2009( 273 ) are equivalent. In the main\ntext, we consider the wavefunctions in the form given by Eq.\u2009( 271 ). We\ncomment here that the eigenvectors shown in Eq.\u2009( 42 ) are normalised to\na finite region of length @xmath , that is why in such equation we find\nthe factor @xmath .\n\nThe momenta where the energy intersects the @xmath -axis are determined\nfrom @xmath , then,\n\n  -- -------- -- -------\n     @xmath      (274)\n  -- -------- -- -------\n\nwhere @xmath and @xmath and\n\n  -- -------- -- -------\n     @xmath      (275)\n  -- -------- -- -------\n\nWe identify that @xmath and @xmath , the wavevectors associate to the\neigenvalues @xmath , as shown in Fig. 90 The spectrum in this case has\nextremes at @xmath and at @xmath , and the corresponding energies are\n@xmath and @xmath , respectively.\n\n#### c.2 Role of the Zeeman field parallel to the spin-orbit axis\n\nIn this subsection we discuss the role of a Zeeman magnetic field\nparallel to the spin-orbit axis, which is considered to be\n\n  -- -- -- -------\n           (276)\n  -- -- -- -------\n\nwhere @xmath is the magnitude of such field. The full Hamiltonian is\nthen given by @xmath , and the Zeeman field contains two components\n@xmath . The perpendicular component is given by Eq.\u2009( 39 ) and denoted\nsimple by @xmath in the main text. This term is the usual term\nconsidered in the literature and it plays a fundamental part towards the\nphysical implementation for the search of MBSs in Rashba nanowires. On\nthe other hand, we point out that experimentally is not so easy to\ncontrol the magnetic field along a certain direction, giving rise to a\nnon-zero components in both perpendicular and parallel directions. This\nmotivates us in order to discuss the role of the component parallel to\nthe spin orbit axis. Notice that now the Zeeman field is a vector with\ntwo components and can be parametrized as\n\n  -- -------- -- -------\n     @xmath      (277)\n  -- -------- -- -------\n\nThe full Hamiltonian, @xmath , can be then written in Nambu basis,\n@xmath , so that\n\n  -- -------- -- -------\n     @xmath      (278)\n  -- -------- -- -------\n\nwhere,\n\n  -- -------- -- -------\n     @xmath      (279)\n  -- -------- -- -------\n\nis the Bogoliubov de Gennes Hamiltonian. The Pauli matrices @xmath and\n@xmath act in spin and electron-hole subspaces, respectively. The\nspectrum is then given after solving the eigenvalue problem @xmath ,\nfrom where one gets the polynomial\n\n  -- -------- -- -------\n     @xmath      (280)\n  -- -------- -- -------\n\nFor @xmath , the spectrum reads\n\n  -- -------- -- -------\n     @xmath      (281)\n  -- -------- -- -------\n\nand its evolution with the Zeeman field is depicted in Fig. 11 . Notice\nthat in the main text we denoted @xmath . We have seen that proximity\ninduced superconductivity modifies the gap at @xmath , originally opened\nby the perpendicular Zeeman field, and opens a gap of @xmath , at finite\nmomentum. The topological transition is marked by vanishing the gap at\nsmall momenta @xmath . It happens at the critical field defined as\n@xmath , where for @xmath the system host two Majorana bound states at\nthe end of the wire. While the gap at small momenta gets reduces as one\nincreases @xmath and it closes at the critical field @xmath , the outer\ngap @xmath remains roughly constant in strong SOC at @xmath for any\n@xmath . See App. LABEL:appendixgapsapp .\n\nHence, it is natural to ask whether the condition, @xmath at @xmath ,\nholds or not for a non-zero paralell component @xmath . Further insight\ncan be extracted from the energy spectrum, but first let us check some\nsituations. We solve @xmath and get\n\n  -- -------- -- -------\n     @xmath      (282)\n  -- -------- -- -------\n\nwhere\n\n  -- -- --\n        \n  -- -- --\n\nwhere @xmath and @xmath are defined in Eq.\u2009( 280 ).\n\nThe inner gap at zero momentum, @xmath , is calculated from Eqs\u2009( 282 ),\nand reads\n\n  -- -------- -- -------\n     @xmath      (283)\n  -- -------- -- -------\n\nIf one now introduces Eqs.\u2009( 277 ) into previous equation, we get @xmath\n. Therefore, we conclude that at this point the condition of the closing\nof the gap for entering into the topological phase does not change.\n\nOn the other hand, the outer gap at high momentum, @xmath , is not\nconstant anymore and exhibits a different behavior as it was for zero\nparallel field, shown in App. LABEL:appendixgapsapp . To have an\nintuition of what is happening, in Fig. 91 we plot the solutions given\nby Eqs.\u2009( 282 ) for different values of @xmath . One observes that the\nouter gap, for @xmath at @xmath and @xmath at @xmath , decreases as one\nincreases @xmath . This behavior is important as it is the constantness\nof such gap the one that offers topological protection towards physical\nimplementation of quantum computation free of decoherence. Thus, we are\ninterested in knowning when such gap reaches zero. We solve @xmath at\n@xmath for @xmath and get the condition when such bands reach zero\nenergy,\n\n  -- -------- -- -------\n     @xmath      (284)\n  -- -------- -- -------\n\nThis can be understood in the following oversimplified view. Indeed,\ndespite of being in the topological phase or not, the perpendicular\ncomponent does not play a transcendental role at the outer branch in\ncase of strong SOC and the momentum is almost constant @xmath .\nTherefore, the problem can be analyzed in a situation of zero\nperpendicular @xmath . Thus from @xmath one gets\n\n  -- -------- -- -------\n     @xmath      (285)\n  -- -------- -- -------\n\nIn right panel of Fig. 91 we plot the band spectrum in zero and finite\nperpendicular field, corresponding to Eqs.\u2009( 285 ) and ( 282 ),\nrespectively. One indeed notices that for @xmath the agreement is very\ngood, as we expected. Without loss of generality, one can tune the\nchemical potential to zero @xmath . Then from Eqs.\u2009( 285 ) @xmath at\n@xmath one has the condition for the closing of the outer gap: @xmath [\n227 ] . Inverse iteration: To support our finding about the condition of\nthe closing of the outer gap, inverse iteration method can be employed [\n228 ] . Here, the wave-function corresponding to @xmath can be used to\nfind @xmath around @xmath and therefore calculate the outer gap by means\nof inverse iteration [ 228 ] . First, we solve @xmath at @xmath , from\nwhere we get @xmath at @xmath . A general solution thus reads @xmath ,\nwhere @xmath is the normalization condition.\n\nFor strong SOC, the wave-function reads @xmath , where @xmath . The\nimproved eigenvector @xmath for any @xmath around @xmath is then\ncalculated from @xmath . Since we already know the wave function at\n@xmath for @xmath , we can improve such eigenvalue by inverse iteration\nusing @xmath for any @xmath around @xmath . Indeed, the improved\neigenvalue correction reads, @xmath , where the first term is zero at\n@xmath and we only have a contribution from the second term. Here @xmath\nand @xmath are already known from previous discussion, therefore the\nimproved eigenvalue then reads,\n\n  -- -------- -- -------\n     @xmath      (286)\n  -- -------- -- -------\n\nwhere @xmath . Eq.\u2009( 286 ) can be then expanded around @xmath , @xmath\nfor small @xmath , where we find\n\n  -- -------- -- -------\n     @xmath      (287)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand @xmath . At @xmath , the outer gap @xmath ,\n\n  -- -- -- -------\n           (288)\n  -- -- -- -------\n\nIn Fig. 92 we plot previous equation as function @xmath and the exact\nvalue calculated from Eqs.\u2009( 282 ). Our result by inverse iteration is\nin a good agreement only when the parallel field @xmath is close to\n@xmath , as we have indeed expected.\n\n#### c.3 Full Rashba Hamiltonian in the helical basis\n\nIn this part we show how the Hamiltonian for the Rashba nanowire in\nproximity to a @xmath -wave superconductor, @xmath given by Eq.\u2009( 44 ),\nis written in the so-called helical basis [ 39 , 51 ] ,\n\n  -- -------- -- -------\n     @xmath      (289)\n  -- -------- -- -------\n\nwhere @xmath are operators that annihilates states in the upper\/lower\nbands and @xmath the respective normalized wavefunctions given by Eq.\u2009(\n42 ) that we decompose into the two spinor components\n\n  -- -------- -- -------\n     @xmath      (290)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (291)\n  -- -------- -- -------\n\nwhere @xmath . According to previous discussion, it is more appropriate\nto write down Eq.\u2009( 289 ) as follows\n\n  -- -------- -- -------\n     @xmath      (292)\n  -- -------- -- -------\n\nwhich using Eqs.\u2009( 290 ) and ( 290 ) become\n\n  -- -------- -- -------\n     @xmath      (293)\n  -- -------- -- -------\n\nIn what follows, we proceed to express the terms of the full Hamiltonian\ngiven by Eq.\u2009( 44 ) in the basis given by Eqs.\u2009( 292 ), resp. by Eqs.\u2009(\n293 ).\n\n##### Kinetic term\n\nThe kinetic Hamiltonian is given by,\n\n  -- -------- -- -------\n     @xmath      (294)\n  -- -------- -- -------\n\nwhere @xmath . Now, we use Eqs.\u2009( 293 ), and then write the elements of\nprevious Hamiltonian in the so called helical basis,\n\n  -- -------- -- -------\n     @xmath      (295)\n  -- -------- -- -------\n\nwhere we have used that @xmath . Now, we add up previous two expressions\nfor @xmath and @xmath , and plug them into the kinetic Hamiltonian given\nby Eq.\u2009( 294 ),\n\n  -- -------- -- -------\n     @xmath      (296)\n  -- -------- -- -------\n\n##### Spin-orbit and Zeeman terms\n\nThe spin-orbit Hamiltonian from Eq.\u2009( 38 ) reads\n\n  -- -------- -- -------\n     @xmath      (297)\n  -- -------- -- -------\n\nThen we express the terms of previous Hamiltonian using Eqs.\u2009( 293 ),\n\n  -- -------- -- -------\n     @xmath      (298)\n  -- -------- -- -------\n\nTherefore, subtracting previous two equations just to get the spin-orbit\nHamiltonian we have\n\n  -- -------- -- -------\n     @xmath      (299)\n  -- -------- -- -------\n\nThe Zeeman Hamiltonian from Eq.\u2009( 39 ) reads,\n\n  -- -------- -- -------\n     @xmath      (300)\n  -- -------- -- -------\n\nTherefore, using the same terms that helped us to express the spin-orbit\nHamiltonian, we arrive at\n\n  -- -------- -- -------\n     @xmath      (301)\n  -- -------- -- -------\n\nNow, we add up the spin-orbit and Zeeman terms derived above\n\n  -- -------- -- -------\n     @xmath      (302)\n  -- -------- -- -------\n\nNext, we write down some useful relations, to be used later, derived\nfrom the definition of @xmath ,\n\n  -- -------- -- -------\n     @xmath      (303)\n  -- -------- -- -------\n\nThen, we work out the elements of Eq.\u2009( 302 , and get\n\n  -- -------- -- -------\n     @xmath      (304)\n  -- -------- -- -------\n\n##### Kinetic, spin-orbit and Zeeman terms\n\nNow we add up the three terms we have calculated in previous\nsubsections, Therefore, we can write\n\n  -- -------- -- -------\n     @xmath      (305)\n  -- -------- -- -------\n\nwhere @xmath are the eigenvalues of the Rashba problem with Zeeman field\ngiven by Eq.\u2009( 42 ).\n\n##### The superconducting term\n\nThe superconducting Hamiltonian given by Eq.\u2009( 43 ) is written as\n\n  -- -------- -- -------\n     @xmath      (306)\n  -- -------- -- -------\n\nwhere we have used fermion anti-commutations relations\n\n  -- -------- -- -------\n     @xmath      (307)\n  -- -------- -- -------\n\nNow, we express the elements of @xmath in terms of the helical basis,\ngiven by Eqs.\u2009( 293 ),\n\n  -- -- -- -------\n           (308)\n  -- -- -- -------\n\nThen, we further subtract previous two expressions in order to obtain\n@xmath ,\n\n  -- -------- -- -------\n     @xmath      (309)\n  -- -------- -- -------\n\nIn the previous equation we identify four combinations of the operators\n@xmath . In the following we write them separately as @xmath , where the\nsubscript @xmath stands for the combination @xmath . The @xmath term\nthen reads,\n\n  -- -------- -- -------\n     @xmath      (310)\n  -- -------- -- -------\n\nwhere in the second equality we have made the substitution @xmath in the\nsecond term. The @xmath term reads\n\n  -- -------- -- -------\n     @xmath      (311)\n  -- -------- -- -------\n\nwhere in the second equality we have made the substitution @xmath in the\nsecond term. The terms @xmath can be grouped in one\n\n  -- -- -- -------\n           (312)\n  -- -- -- -------\n\nwhere in the second equality we have reordered the operator pairs just\nto make visible the use of the fermionic commutation relation, @xmath ,\nand the third equality we have used such relation, and in fourth\nequality we have made the substitution @xmath in the second term.\n\nWe still need to evaluate some expressions with combinations of @xmath\n\n  -- -------- -- -------\n     @xmath      (313)\n  -- -------- -- -------\n\nthen\n\n  -- -------- -- -------\n     @xmath      (314)\n  -- -------- -- -------\n\nTherefore, the superconducting Hamiltonian reads,\n\n  -- -- -- -------\n           (315)\n  -- -- -- -------\n\nNotice in previous equation, the coefficients of the operators @xmath .\nSuch terms represent the pairing between bands @xmath and @xmath . We\ntherefore write\n\n  -- -------- -- -------\n     @xmath      (316)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (317)\n  -- -------- -- -------\n\n##### Full Hamiltonian\n\nThe Hamiltonian describing a Rashba nanowire subjected to a Zeeman\ninteraction and superconducting correlations is given by\n\n  -- -------- -- -------\n     @xmath      (318)\n  -- -------- -- -------\n\nwhere\n\n  -- -- -- -------\n           (319)\n  -- -- -- -------\n\nwhere @xmath is the Nambu spinor.\n\nFor the superconducting part we proceed in a similar way\n\n  -- -------- -- -------\n     @xmath      (320)\n  -- -------- -- -------\n\nthen we can write previous Hamiltonian as\n\n  -- -- -- -------\n           (321)\n  -- -- -- -------\n\nwhere @xmath is the Nambu spinor. Therefore, the full Hamiltonian reads,\n\n  -- -- -- -------\n           (322)\n  -- -- -- -------\n\nwhere the pairing potentials are given in the previous subsection by\nEqs.\u2009( 317 ). The matrix under the integral is the so-called BdG\nHamiltonian.\n\n## Chapter \\thechapter Appendix for Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states\n\nIn this Appendix we provide further details on NS and SNS junctions.\n\n## Appendix D Tight-binding discretisation of the Rashba nanowire\n\nFor computation purposes, we consider a discretisation of the 1D\ncontinuum model given by Eq.\u2009( 98 ) for the Rashba nanowire into a\ntight-binding (TB) lattice with a small lattice spacing @xmath . The\nsmaller is @xmath , the better is the description, and by letting such\nlattice constant tend to zero one recovers the usual continuum limit. We\nchoose a discrete lattice whose points are located at @xmath , where\n@xmath is an integer and @xmath the small lattice spacing. Notice that\nby do so, we are trying to find a matrix representation of our 1D\ncontinuum model in site space.\n\n#### The kinetic term\n\nThe first term in our Hamiltonian is the kinetic energy operator @xmath\n,\n\n  -- -------- -- -------\n     @xmath      (323)\n  -- -------- -- -------\n\nwhere @xmath is the momentum operator, and @xmath is the chemical\npotential. In principle, @xmath depends on the spatial coordinate @xmath\n, however, in most of our calculations we consider it as independent.\nTherefore, in the TB representation, one is allow to write\n\n  -- -- -- -------\n           (324)\n  -- -- -- -------\n\nNow, the derivatives are expressed by using the method of finite\ndifferences and in terms of creations and annihilation operators. Thus\nthe first derivative can be approximated by\n\n  -- -------- -- -------\n     @xmath      (325)\n  -- -------- -- -------\n\nTherefore, taking into account previous equation, the second derivative\ncan be approximated by\n\n  -- -------- -- -------\n     @xmath      (326)\n  -- -------- -- -------\n\nOn the other hand, the chemical potential @xmath is on-site dependent,\nunlike the momentum operator that gives rise to hopping elements between\nsites. Thus, we can write\n\n  -- -------- -- -------\n     @xmath      (327)\n  -- -------- -- -------\n\nHence, the Kinetic energy operator in the tight-binding approach can be\nexpressed as\n\n  -- -------- -- -------\n     @xmath      (328)\n  -- -------- -- -------\n\nwhere @xmath is the hopping energy parameter between nearest-neighbor\nsites. Since we also consider spin, Eq.\u2009( 328 ) has to be written as\n\n  -- -------- -- -------\n     @xmath      (329)\n  -- -------- -- -------\n\nwhere @xmath is the @xmath identity matrix.\n\n#### The spin-orbit term\n\nThe spin-orbit term from Eq.\u2009( 41 ) is\n\n  -- -------- -- -------\n     @xmath      (330)\n  -- -------- -- -------\n\nwhere @xmath is the momentum operator. Again, as before\n\n  -- -------- -- -------\n     @xmath      (331)\n  -- -------- -- -------\n\nFor the first derivative we use\n\n  -- -------- -- -------\n     @xmath      (332)\n  -- -------- -- -------\n\nwhich can be understood as a symmetrized case of Eq.\u2009( 325 ), since\n\n  -- -------- -- -------\n     @xmath      (333)\n  -- -------- -- -------\n\nThen, the SO term reads\n\n  -- -------- -- -------\n     @xmath      (334)\n  -- -------- -- -------\n\nwhere @xmath is the SO hopping.\n\n#### The Zeeman term\n\nThe Zeeman term from Eq.\u2009( 41 ) is\n\n  -- -------- -- -------\n     @xmath      (335)\n  -- -------- -- -------\n\nwhich is independent of the site index. Thus, it leads to an on-site\nterm in the tight-binding Hamiltonian in a similar way as the chemical\npotential in the kinetic term.\n\n  -- -------- -- -------\n     @xmath      (336)\n  -- -------- -- -------\n\n#### The full Hamiltonian\n\nTherefore @xmath reads,\n\n  -- -------- -- -------\n     @xmath      (337)\n  -- -------- -- -------\n\nwhere the symbol @xmath means that @xmath couples nearest-neighbor\n@xmath sites and\n\n  -- -------- -- -------\n     @xmath      (338)\n  -- -------- -- -------\n\nare matrices in spin space, @xmath and @xmath .\n\n## Chapter \\thechapter Appendix for Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states\n\n## Appendix E General form of the current\n\nThe current from contact @xmath flowing through lead @xmath to the\ncentral region can be calculated from the evolution of the total number\noperator of fermions in such lead, and it is defined as [ 186 ]\n\n  -- -------- -- -------\n     @xmath      (339)\n  -- -------- -- -------\n\nwhere @xmath is the number operator for lead @xmath , and @xmath is the\nelectron charge, @xmath denotes the average over the ground state and\n@xmath represents the derivative of @xmath over time. The time evolution\nof the occupation number operator @xmath is described by the Heisenberg\npicture, where the equation of motion for operators reads,\n\n  -- -- -- -------\n           (340)\n  -- -- -- -------\n\nand @xmath is the Hamiltonian of the entire system, which in principle\nis time-dependent. The commutator of two operators reads @xmath , then\n@xmath . Thus, Eq.\u2009( 339 ) can be rewritten as\n\n  -- -------- -- -------\n     @xmath      (341)\n  -- -------- -- -------\n\nThe Hamiltonian @xmath usually has three terms: the first that\ncorresponds to the leads, the second to the central region and the third\none that take into account electron transitions between the leads and\nthe central region.\n\nIn our case the SNS system is described by the Hamiltonian\n\n  -- -------- -- -------\n     @xmath      (342)\n  -- -------- -- -------\n\nwhere @xmath , @xmath , corresponds to Hamiltonians for leads left L and\nright R, respectively, while @xmath is the central system Hamiltonian,\nwhich is not superconducting, and the last term represents the\ntunnelling Hamiltonian, which counts for electron transitions between\nthe leads and the central region . The matrices @xmath and @xmath have\nNambu structure\n\n  -- -------- -- -------\n     @xmath      (343)\n  -- -------- -- -------\n\nwith known sub-matrices @xmath , which are in spin space. The particle\nnumber operator @xmath commutes both with the corresponding Hamiltonian\nof the isolated central system and with the Hamiltonian of the isolated\nleads. The unique term changing particle numbers in each separate lead\nis the tunnelling term, last term in Eq.\u2009( 342 ), whose Hamiltonian is\n\n  -- -------- -- -------\n     @xmath      (344)\n  -- -------- -- -------\n\nNotice that for a correct derivation, one needs to consider also the\nhermitian conjugate of @xmath . Now we define the mixed lesser Green\u2019s\nfunctions\n\n  -- -------- -- -------\n     @xmath      (345)\n  -- -------- -- -------\n\nThen, the current can be written as\n\n  -- -------- -- -------\n     @xmath      (346)\n  -- -------- -- -------\n\nwhere @xmath counts for electrons and holes. The current is given by the\ntime diagonal components of the Green\u2019s functions defined in Eq.\u2009( 345\n), @xmath . The problem is to find the mixed lesser Green\u2019s function.\nOne can proceed with the Keldysh technique, where one employs the\nmixed-contour-ordered Green\u2019s function, @xmath , and then perform\nanalytic continuation to the real time to obtain the mixed lesser\nfunction @xmath [ 186 ]\n\n  -- -- -- -------\n           (347)\n  -- -- -- -------\n\nwhere @xmath and @xmath are the retarded and lesser full system Green\u2019s\nfunction, respectively. @xmath and @xmath are the isolated leads Green\u2019s\nfunctions defined as\n\n  -- -------- -- -------\n     @xmath      (348)\n  -- -------- -- -------\n\nwhere @xmath is the step function being @xmath for @xmath , and @xmath\notherwise. Then, the current acquires the form\n\n  -- -- -- -------\n           (349)\n  -- -- -- -------\n\nNow, we can introduce the lead\u2019s self energies defined as\n\n  -- -------- -- -------\n     @xmath      (350)\n  -- -------- -- -------\n\ntherefore the current reads\n\n  -- -------- -- -------\n     @xmath      (351)\n  -- -------- -- -------\n\n## Appendix F Floquet-Keldysh formalism\n\nConsider a mesoscopic system composed of two semi-infinite leads\n(labeled @xmath and @xmath ), each in thermal equilibrium at the same\ntemperature @xmath and with the same chemical potential @xmath . Each\nlead has a finite s-wave superconducting pairing @xmath , where @xmath .\nA central system ( @xmath ), which may or may not be superconducting, is\ncoupled to both leads through operator @xmath . In its Nambu form, the\nHamiltonian of the system reads\n\n  -- -- --\n        \n  -- -- --\n\nwhere the Nambu Hamiltonian matrix takes the general form\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHere @xmath is the normal Hamiltonian for each section of the system.\nThe blocks delimited by lines denote the Nambu particle, hole and\npairing sectors.\n\nIf we apply a left-right voltage bias @xmath through the junction, the\nBardeen-Cooper-Schrieffer (BCS) pairing of the leads will become time\ndependent, @xmath , while @xmath (we take @xmath ). Both these changes\ncan be gauged away from the leads and into the system by properly\nredefining @xmath . This transformation is done also inside the system\n@xmath , thereby effectively dividing it into two, the portion with an\n@xmath phase (denoted @xmath ), and the portion with the opposite phase\n(denoted @xmath ). This restores @xmath to its unbiased form, save for a\nnew time dependence in @xmath , which is constrained to the coupling\nbetween the @xmath and @xmath ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIt is important to note that @xmath is periodic, with angular frequency\n@xmath . In the steady state limit (at long times @xmath after switching\non the potential @xmath ) all response functions and observables will\nexhibit the same time periodicity (all transient effects are assumed to\nbe completely damped away). In particular, the steady state current\n@xmath , so that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor some harmonic amplitudes @xmath , in general complex, that satisfy\n@xmath since @xmath is real. This current can be computed using the\nKeldysh Green\u2019s function formalism [ 186 ] . The standard expression for\n@xmath is computed starting from the definition of @xmath , where @xmath\nis the total number of fermions in the left lead. By using Heisenberg\nequation and the Keldysh-Dyson equation, one arrives at, see previous\nsection for details on the derivation,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe z-Pauli matrix @xmath above acts on the Nambu particle-hole sector,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe self energy from the left lead is defined as @xmath , where @xmath\nstands for the left lead\u2019s propagator, when decoupled from the system\n(this propagator depends only on the time difference since the decoupled\nlead is time independent in this gauge). We define the Fourier transform\nof @xmath as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe retarded propagator in Fourier space is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhile the advanced @xmath . One can compute @xmath , where @xmath is the\nFermi distribution in the leads, and @xmath is the Nambu spectral\nfunction. The @xmath [and in particular @xmath ] is assumed known, or at\nleast easily obtainable from @xmath and @xmath . Finally, the Green\nfunctions @xmath and @xmath correspond to the propagator for the full\nsystem, including the coupling to the leads. (Note that, in practice,\nsince @xmath is inside a trace in @xmath , only matrix elements of\n@xmath inside the @xmath portion of the full system are needed). The\nretarded @xmath satisfies the equation of motion\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhile @xmath (when projected onto the finite-dimensional system @xmath )\nsatisfies the Keldysh relation\n\n  -- -------- -------- -------- --\n     @xmath   @xmath   @xmath   \n                       @xmath   \n  -- -------- -------- -------- --\n\nSince @xmath in @xmath is time dependent, @xmath propagators depend on\ntwo times; unlike @xmath or @xmath they are not Fourier diagonal.\nInstead, we can exploit the steady-state condition, which reads\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nto expand the system\u2019s @xmath as a Fourier transform in @xmath and a\nFourier series in @xmath . We define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe natural question is how the equation of motion is expressed in terms\nof the harmonics @xmath . It takes the most convenient form if we\nredefine @xmath (where @xmath is unbounded) in terms of the quasienergy\n@xmath , i.e. @xmath\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis has the advantage that the equation of motion translates to a\nmatrix equation analogous to that of a static system in Fourier space\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis is known as the Floquet description of the steady state dynamics in\nterms of sidebands, which appear formally as a new quantum number @xmath\n. Time dependent portions of @xmath act as a coupling between different\nsidebands. The effective Hamiltonian for the @xmath -th sideband is the\nstatic portion of @xmath , shifted by @xmath . One therefore sometimes\ndefines the Floquet \u201cHamiltonian\u201d of the system as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere, as before, @xmath . Likewise, one may define the Floquet\nself-energies as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n(since the leads are static, @xmath is sideband-diagonal).\n\nThe Floquet equation of motion for @xmath can be solved like in the case\nof a static system. Within the @xmath portion of the system, we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBoldface denotes the sideband structure implicit in all the above\nmatrices. Similarly, the Keldysh relation takes the simple form\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFinally, the time averaged current @xmath takes the form\n\n  -- -------- -- -------\n     @xmath      (352)\n  -- -------- -- -------\n\nwhere the trace includes the sideband index. In a practical computation,\nthe number of sidebands that must be employed is finite, and depends on\nthe applied voltage bias @xmath (the typical number scales as @xmath ).\nWe employ an adaptive scheme that increases the number of sidebands\nrecursively until convergence for each value of @xmath .\n\n## Appendix G Derivation of the current in the tunneling limit\n\nIn this part we aim at calculating the current in the tunneling limit.\nThe Hamiltonian for our system is given by Eq.\u2009( 342 ).\n\nAccording to Floquet\u2019s theory, a periodic time-dependent system is\ndescribed in terms of sidebands, whose Hamiltonian is shifted by @xmath\n. In this part we consider a subspace of one sideband, @xmath , where\nthe central system is composed of two sites, left and right. The role of\nthe leads are considered through their self energies. The full system\nHamiltonian is written as\n\n  -- -------- -- -------\n     @xmath      (353)\n  -- -------- -- -------\n\nwhere @xmath is given by Eq.\u2009( 342 ) and\n\n  -- -------- -- -------\n     @xmath      (354)\n  -- -------- -- -------\n\nwhere @xmath represents that hopping between the two central sites\n@xmath and @xmath , and it is given by\n\n  -- -------- -- -------\n     @xmath      (355)\n  -- -------- -- -------\n\nwhere @xmath is an small parameter that describes the nature of the\njunction that links the left and right superconductors, @xmath and\n@xmath . As described in Floquet\u2019s theory, the Hamiltonians for the\nisolated central system sidebands are\n\n  -- -------- -- -------\n     @xmath      (356)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (357)\n  -- -------- -- -------\n\nand @xmath and @xmath are matrices in spin space. Notice that the\nHamiltonian for the left lead, considering a tight-binding model and\nNambu in each site, is infinite. We assume that the left and right leads\nare attached at the left and right edges of the central system, so that\ntheir self-energy terms ( @xmath ) only influence sites of the first and\nlast column of the central system. That means that since we deal with a\ncentral system with sites @xmath and @xmath , the self-energy terms\n@xmath will influence sites @xmath and @xmath , respectively. Since a\nnearest-neighbor tight-binding model is used, the hopping matrices\nbetween leads and central system have nonzero elements only between\nsites on the surface of the lead and their neighboring sites in the\ncentral system. This means that only the surface Green\u2019s function @xmath\n(big letters L and R label hte left and right leads, respectively) is\nneeded when one calculates the lead\u2019s self-energies. In the Floquet\ndecomposition, one describes the central system in terms of sidebands.\nThese sidebands are coupled by the matrices @xmath and @xmath , and they\nare identical copies of the original system with the difference that\ntheir energies are shifted (due to the voltage bias): for a @xmath\nsideband subspace we have @xmath , @xmath and @xmath , where the\noriginal system is @xmath . @xmath . As we mentioned, in this part, we\nconsider one-sideband subspace, with three sites, @xmath , @xmath and\n@xmath .\n\nThe general expression for the current is given by Eq.\u2009( 352 ), for\n@xmath ,\n\n  -- -------- -- -------\n     @xmath      (358)\n  -- -------- -- -------\n\nwhere all the elements in previous equation are matrices in Floquet,\nNambu, sideband and central system subspaces. @xmath is the full system\nGreen\u2019s function, while @xmath the self energy of both leads. In this\npart we are interested in the tunnelling regime, meaning small\ntransparency across the junction. As we have discussed, our system\nconsists of two semiinfinite leads which are coupled through a central\nregion with two sites @xmath and @xmath . The hopping between these two\nsites is reduced and parametrised by @xmath , where @xmath see Eq.\u2009( 355\n). For @xmath one models a tunnel junction. Then, we consider second\norder terms in @xmath in Eq.\u2009( 358 ). Notice that the self-energies are\nproportional to @xmath , while the coupling matrix @xmath is given by\nEq.\u2009( 354 ) and it is proportional to @xmath . Hence, the self energies\nare of second order in @xmath and therefore in @xmath . Thus, a zeroth\norder expansion of the Dyson\u2019s equation is enough @xmath .\n\nTherefore, in one sideband subspace ( @xmath ) reads,\n\n  -- -------- -- -------\n     @xmath      (359)\n  -- -------- -- -------\n\nIn the space of sidebands, the self-energy matrices are diagonal. Thus,\nthe lesser and advanced self-energies @xmath corresponding to lead\n@xmath are,\n\n  -- -------- -- -------\n     @xmath      (360)\n  -- -------- -- -------\n\nwhere each matrix element of previous two matrices is a @xmath matrix in\nthe central system subspace,\n\n  -- -------- -- -------\n     @xmath      (361)\n  -- -------- -- -------\n\nThe roll of the self-energies labelled with prime symbol will be\nunderstood in the following.\n\nThe Nambu Pauli matrix @xmath in Eq.\u2009( 358 ) is in the space of\nsidebands ( @xmath ), in the space of left and right sites of the\ncentral system, in spin space and electron hole, thus one can write\n\n  -- -------- -- -------\n     @xmath      (362)\n  -- -------- -- -------\n\nwhere each element is in the space of left and right sites of the\ncentral system, in spin space and electron hole @xmath .\n\nMultiplying the matrices in Eq.\u2009( 358 ) in the sideband subspace, we get\n\n  -- -------- -- -------\n     @xmath      (363)\n  -- -------- -- -------\n\nwhere all the elements are matrices in spin and the central system (left\nand right) subspace. Tracing previous matrix over sidebands, we get\n\n  -- -------- -- -------\n     @xmath      (364)\n  -- -------- -- -------\n\nAs discussed previously, we consider up to second order in @xmath , and\ntherefore a zeroth order expansion of the Dyson\u2019s equation is enough (\n@xmath ). Therefore, previous equation reads\n\n  -- -------- -- -------\n     @xmath      (365)\n  -- -------- -- -------\n\nwhere @xmath is the Green\u2019s function for the disconnected sideband\n@xmath , whose matrix structure contains the influence of the left and\nright leads propagators on the central system. Thus, in the space of\nleft and right leads, one has\n\n  -- -------- -- -------\n     @xmath      (366)\n  -- -------- -- -------\n\nwhere we approximate @xmath to be the leads Green\u2019s function, @xmath ,\nand then use\n\n  -- -------- -- -------\n     @xmath      (367)\n  -- -------- -- -------\n\nwith @xmath the spectral function, being Hermitian as well as @xmath .\nWe assume that @xmath is known and in our case calculated numerically.\nThen, putting together both the self-energies and disconnected Green\u2019s\nfunctions, one gets the necessary elements for calculating the current\ngiven by Eq.\u2009( 358 )\n\n  -- -------- -- -------\n     @xmath      (368)\n  -- -------- -- -------\n\nNow, we are left with the self-energies. Projecting the self-energies on\nthe sideband subspace one gets,\n\n  -- -------- -- -------\n     @xmath      (369)\n  -- -------- -- -------\n\nwhere the Green\u2019s functions are given in Eq.\u2009( 368 ), @xmath is given by\nEq.\u2009( 354 ), and we rewrite it as\n\n  -- -------- -- -------\n     @xmath      (370)\n  -- -------- -- -------\n\nwhere @xmath describes the nature of the tunnel junction, and\n\nThen, introducing Eq.\u2009( 370 ) and ( 366 ) into Eq.\u2009( 369 ), we get the\nself-energies in their left\/right structure\n\n  -- -- -- -------\n           (371)\n  -- -- -- -------\n\nMatrix elements in previous equations give the prime left self-energies\ndefined in Eq.\u2009( 368 ), then\n\n  -- -------- -- -------\n     @xmath      (372)\n  -- -------- -- -------\n\nIn what follows, we use the definitions given by Eq.\u2009( 367 ). Then, we\nadd up the three terms given by Eq.\u2009( 368 ), trace out over the central\nsystem subspace, and then take the real part of Eq.\u2009( 368 ),\n\n  -- -------- -- -------\n     @xmath      (373)\n  -- -------- -- -------\n\nThe first term corresponds to sideband @xmath , the second and third to\n@xmath and the last one to @xmath . Notice that previous equations do\nnot contain first order terms in @xmath . Previous equation can be\nwritten as\n\n  -- -------- -- -------\n     @xmath      (374)\n  -- -------- -- -------\n\nwhere all elements are matrices in Nambu space (label by @xmath from\nhereon: @xmath ). So that the spectral function, @xmath and the Fermi\ndistribution function read\n\n  -- -- -- -------\n           (375)\n  -- -- -- -------\n\nThe relevant information information of the system is hidden in the\ndiagonal elements of the spectral function @xmath . Now, we use the\ndefinitions for @xmath given by Eqs.\u2009( 370 ) and then trace over Nambu\nspace,\n\n  -- -------- -- -------\n     @xmath      (376)\n  -- -------- -- -------\n\nor\n\n  -- -------- -- -------\n     @xmath      (377)\n  -- -------- -- -------\n\nPrevious equation can be rewritten in a more elegant way, since the\nFermi distribution functions can be factored out,\n\n  -- -------- -- -------\n     @xmath      (378)\n  -- -------- -- -------\n\nand by taking into account that the hopping matrix @xmath is real, one\nhas\n\n  -- -------- -- -------\n     @xmath      (379)\n  -- -------- -- -------\n\nOne can also seek for a relation between @xmath and @xmath . Since the\nspectral function is computed numerically by using the retarded and\nadvanced Green\u2019s functions of the leads, the structure of such Green\u2019s\nfunctions allows us to relate the @xmath and @xmath . Thus one has,\n\n  -- -------- -- -------\n     @xmath      (380)\n  -- -------- -- -------\n\nThen, Eq.\u2009( 379 ), introducing the limits of integration, reads\n\n  -- -------- -- -------\n     @xmath      (381)\n  -- -------- -- -------\n\nNotice that previous integral contains a term whose argument is @xmath .\nThen, we make the substitution @xmath . The distribution functions reads\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nPrevious considerations lead to\n\n  -- -------- -- -------\n     @xmath      (382)\n  -- -------- -- -------\n\nAssuming that @xmath , one gets\n\n  -- -- -- -------\n           (383)\n  -- -- -- -------\n\nOne can make a change of variable in the third integral in previous\nequation, @xmath , then one has that the third term is the conjugated of\nthe first one,\n\n  -- -- -- -------\n           (384)\n  -- -- -- -------\n\nNotice that the last two integrals of previous equation should vanish\ndue to symmetry considerations. Let us check it in for the terms @xmath\n, since this corresponds to the electron spectral function. The\nconclusion holds also for previous equation. One has,\n\n  -- -------- -- -------\n     @xmath      (385)\n  -- -------- -- -------\n\nIn the first integral the term @xmath is on the interval @xmath , then\nthe fourth integral vanish on the interval @xmath . The same analysis\ncan be done between the second and third terms. See Fig. 93 for more\ndetails.\n\nTherefore, the terms that survive are only the first and the third.\nSimilar considerations led to the conclusion of vanishing the last two\nterms in Eq.\u2009( 384 ). Therefore, one has\n\n  -- -- -- -------\n           (386)\n  -- -- -- -------\n\nwhere in the first integral we made a change of variable, @xmath . The\nfrequency can now take any arbitrary value, so that the integral limits\nchange. Then the current in the tunnel limit reads,\n\n  -- -------- -- -------\n     @xmath      (387)\n  -- -------- -- -------\n\nwhere the trace in previous expression is taken over the spin space. The\ncoupling across the junction is modelled by the hopping matrix @xmath\nbetween the end sites of each wire, where @xmath is the dimensionless\ntunneling parameter that controls the junction\u2019s normal transparency.\n\nThus, it was possible to calculate the @xmath current explicitly in the\ntunnelling limit, where to leading (second) order in the left-right\ncoupling @xmath , Eq. ( 352 ) reduces, after some algebra, to\n\n  -- -------- -------- -------- -- -------\n     @xmath   @xmath   @xmath      (388)\n  -- -------- -------- -------- -- -------\n\nwhere @xmath is the particle-particle Nambu @xmath matrix block of the\nspectral function of the @xmath decoupled wire,\n\n  -- -- --\n        \n  -- -- --\n\nand the trace is taken over spin space. The trace of @xmath is\nproportional to the local density of states. Fig. 94 shows results for\nthe tunnel current using Eq. 388 for increasing Zeeman fields. Overall,\nthe agreement with the full numerics in Fig. 49 (a) is very good and,\nimportantly, all the relevant features such as, e. g., the closing of\nthe gap, are captured by this tunneling approximation.\n\n## Appendix H Andreev approximation\n\nIt is conventional, in the study of hybrid superconducting-normal\njunctions, to assume the limit in which the Fermi energy @xmath of the\nmetal under consideration is much greater than the superconducting gap,\nand any other energy @xmath involved in the problem, @xmath . This is\nknown as the Andreev approximation. In essence, it allows one to regard\nthe normal system as featureless, with constant Fermi velocity and\ndensity of states. In this case, a number of simplifications can be\ncarried out in the computation of equilibrium transport properties. One\nimportant consequence of the approximation in the context of our work is\nthat, in a short SNS junction with phase difference @xmath , and\nsymmetric under time-reversal symmetry ( @xmath in our case), two\ndegenerate Andreev states will appear of energy @xmath [ 144 ] . This\nimmediately implies that at perfect normal transparency @xmath , the\nABSs will reach zero energy at @xmath . In other words, in the Andreev\napproximation the ABS energy minimum in the non-topological phase will\nbe @xmath .\n\nWhile in the topological phase, a zero @xmath is a robust property,\nprotected by parity conservation, a @xmath in the non-topological phase\nis accidental, a direct consequence of the Andreev approximation, and is\nnot protected by any symmetry. In fact, any deviation from the Andreev\napproximation will induce a finite splitting @xmath . In semiconducting\nnanowires such as the ones considered in this work, this correction is\nvery relevant. Indeed, for the nanowire to undergo a superconducting\ntopological transition at a reasonable Zeeman field @xmath , @xmath must\nremain relatively small (the wire must be close to depletion, and far\nfrom the Andreev approximation), otherwise the critical field @xmath\nwould be physically unreachable. The splitting @xmath , therefore,\nremains a relevant quantity in the formation and detection of Majorana\nbound states.\n\nThe value of @xmath in our system may be computed numerically. The most\nefficient way is to consider a short SNS junction with finite length\nsuperconductors, @xmath , @xmath and a phase difference @xmath . Since\nthis system is closed, an exact diagonalization of the tight-binding\nNambu Hamiltonian yields a minimum eigenvalue that is exactly @xmath if\nthe S leads are long enough (longer than the coherence length). We find\nthat this quantity is finite in the case of wires close to depletion,\n@xmath , and that it vanishes as one approaches the Andreev\napproximation regime @xmath , see Fig. 95 . More specifically, we have\nfound that @xmath scales as @xmath for some @xmath , within very good\nprecision.\n\n## Chapter \\thechapter Appendix for Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states\n\nIn this part we provide some additional technical aspects used in\nChapter Hybrid superconductor-semiconductor nanowire junctions as useful\nplatforms to study Majorana bound states . We make a full proximity\nmodel in order to justify our calculations within the simplified model\ndescription. Moreover, we perform an effective model for the normal\nconductance, where we aim at describing the physics of Fano resonances\nin the first part of Chapter Hybrid superconductor-semiconductor\nnanowire junctions as useful platforms to study Majorana bound states .\nAt the end, the Majorana localization length is calculated.\n\n## Appendix I Induced superconducting pairing\n\nA more realistic model when considering the proximity effect consists on\nthe following description. The full NW is divided in three sections: a\ncentral normal region (N) and two normal regions (M). See Fig. 96 . Each\nof the M sections describe NW regions coupled to a superconductor which,\nto distinguish from the previous notation, we denote as S\u2019. As opposed\nto the previous subsection, the full NW is now a normal system and the\nproximity effect comes now from the tunneling coupling between the\nsuperconductors and the M normal parts of the NW.\n\nIn this case, the full (normal) system is described by the following\nHamiltonian\n\n  -- -------- -- -------\n     @xmath      (389)\n  -- -------- -- -------\n\nwhere @xmath is a normal region of the same dimension as the\nsuperconducting one @xmath \u2019 and @xmath is a diagonal matrix in site\nspace that couples the superconductor @xmath with the normal lead @xmath\n. This coupling can be parametrized by the parameter @xmath . Then, we\nintroduce the he superconducting pairing, which is written in the same\nbasis as @xmath ,\n\n  -- -------- -- -------\n     @xmath      (390)\n  -- -------- -- -------\n\nwhere @xmath with @xmath describe the bulk s-wave superconducting leads.\nIn a similar way as the one described in Section 10.4 , we write the\nfull system Hamiltonian in Nambu space as\n\n  -- -------- -- -------\n     @xmath      (391)\n  -- -------- -- -------\n\nAs described in the main text, the approximate description of the\nproximity effect given in Section 10.4 is a good approximation provided\nthat we are in a large gap limit and that the contact transparency is\ngood. We have benchmarked the approximate solution given in Section 10.4\nagainst the full proximity model, given here, in various relevant cases\nand always found good agreement in the correct parameter range. Now, we\nillustrate this point by showing a calculation using the full proximity\neffect model of Eq. 389 instead of the approximate model given by Eq.\u2009(\n389 ) and fully described in Section 10.4 .\n\nIn Fig. 97 we show results corresponding to the same physical situation\nwe presented in Fig. 61 c in the main text, the only difference being\nthat the bulk gap in @xmath is much larger than the induced gap used in\nthe calculations of Fig. 61 c ( @xmath ). The overall behaviour of the\nsubgap states in Fig. 97 is the same as in Fig. 61 c (including the\nloops in the helical region described in the main text), demonstrating\nthat the simplified model is indeed justified when the bulk gap is the\nlargest energy scale. Importantly, note the rescaled @xmath axis which\nexplicitly shows that the relevant energy scale is not the original bulk\ngap included in the calculation but the smaller value @xmath , in\nagreement with our previous claim.\n\n## Appendix J Effective model for the conductance\n\nIn this part we make use of an effective model to describe the physics\nof Fano resonances. An effective spinless model based on Green\u2019s\nfunctions is constructed where two semi-infinite tight-binding chains\n(leads) are coupled through @xmath to a central region @xmath , formed\nby one site, that is additionally weakly coupled through @xmath to a\nresonant level @xmath , being @xmath a fixed parameter that represents\nthe separation between the quantum dot level and the resonant level (in\nprinciple this parameter mimics the role of the Zeeman splitting in our\nnumerics) (see Fig. 98 ). Consider that @xmath is the lattice constant\nand @xmath the hopping between sites in the leads. The normal\ntransmission, @xmath , through a central system formed by one site can\nbe calculated by using the Caroli\u2019s formula,\n\n  -- -------- -- -------\n     @xmath      (392)\n  -- -------- -- -------\n\nwhere @xmath is the retarded full system Green\u2019s function, and\n\n  -- -------- -- -------\n     @xmath      (393)\n  -- -------- -- -------\n\ntakes into account the influence of the leads on the central system\nthrough the left(right) L(R) self-energies @xmath .\n\nThe full system Green\u2019s function can be calculated by using the Dyson\u2019s\nrelation,\n\n  -- -------- -- -------\n     @xmath      (394)\n  -- -------- -- -------\n\nwhere @xmath is the retarded Green\u2019s function of the isolated central\nregion (this central region can for instance be a quantum dot) without\nthe influence of the leads and without the influence of the resonant\nlevel. It reads\n\n  -- -------- -- -------\n     @xmath      (395)\n  -- -------- -- -------\n\nwhere @xmath is the onsite energy of the central region.\n\nThe self-energy @xmath ,\n\n  -- -------- -- -------\n     @xmath      (396)\n  -- -------- -- -------\n\ncontain the effect of the left @xmath and right @xmath leads as well as\nthe influence of the resonant level @xmath , respectively. Such\nself-energies are defined as follows,\n\n  -- -------- -- -------\n     @xmath      (397)\n  -- -------- -- -------\n\nwhere @xmath is the retarded semi-infinite left (right) lead Green\u2019s\nfunctions. In principle such lead\u2019s Green\u2019s functions can be computed\nconsidering a recursive approach,\n\n  -- -------- -- -------\n     @xmath      (398)\n  -- -------- -- -------\n\n@xmath is the onsite energy in the leads. From previous equation one\nhas,\n\n  -- -------- -- -------\n     @xmath      (399)\n  -- -------- -- -------\n\ntherefore,\n\n  -- -------- -- -------\n     @xmath      (400)\n  -- -------- -- -------\n\nAdding a convergence factor to frequency, @xmath , one finds the\nretarded or advanced Green\u2019s function.We have the following properties\nof @xmath , {widetext}\n\n  -- -------- -- -------\n     @xmath      (401)\n  -- -------- -- -------\n\nwhere for the first case the density of states @xmath is zero, while in\nthe second case it exhibits a non zero value. These results allow us to\nobtain @xmath . The impurity self-energy @xmath reads,\n\n  -- -------- -- -------\n     @xmath      (402)\n  -- -------- -- -------\n\nwhere @xmath is the coupling of the resonant level to the system. With\nthese expressions for the different self-energies, we may compute @xmath\n,\n\n  -- -------- -- -------\n     @xmath      (403)\n  -- -------- -- -------\n\nThe normal conductance @xmath is calculated from the transmission as,\n\n  -- -------- -- -------\n     @xmath      (404)\n  -- -------- -- -------\n\nwhere by construction we have already in a spinless channel. Since we\nare interested in low temperature physics, @xmath , and @xmath .\nTherefore,\n\n  -- -------- -- -------\n     @xmath      (405)\n  -- -------- -- -------\n\nwhere @xmath is the Fermi energy which is the zero of energy in our\ncalculations.\n\nThe aim of this part was to construct an effective model that contains\nthe physics of our numerics, where the transmission (and conductance)\ndevelops a resonance in the trivial phase and a dip in the helical\nphase. Indeed, by plugging previous equations in the expression for the\ntransmission and conductance, one ends up with the desired result that\nis plotted in Fig. 99 .\n\nIn such plots, we consider a strong hopping @xmath between sites in the\nleads in comparison to the couplings @xmath and @xmath . For weak\ncoupling between leads and the central region a resonant tunnelling peak\nis obtained at the energy of the central region @xmath . Upon increasing\nthe coupling between the leads and the central region @xmath the\nresonant peak at @xmath becomes broader and a sharp Fano feature emerges\nat the resonant impurity @xmath . The new feature has the typical Fano\nstructure of a zero followed by a peak, and arises from the interference\nof the two possible paths for the carriers, through the very broadened\n(strongly coupled) site at @xmath , and through the weakly coupled\nresonant level at @xmath . For strong enough coupling @xmath , the\n@xmath contributes with a uniform @xmath background to conductance,\nwhile the Fano feature becomes a pure dip to zero.\n\nIn conclusion, we have developed an effective model that contains the\nphysics involved in our numerics where a resonance peak is present at\nthe energy of the quantum dot for weakly coupled system. By increasing\nthe coupling of the quantum dot to the leads a Fano feature (dip to zero\nfollowed by a peak) appears in conductance at the energy of the resonant\nlevel.\n\n## Appendix K Majorana localization length\n\nThe calculation of the Majorana localization length @xmath is carried\nout by solving the polynomial equation for the wave vector @xmath\n\n  -- -------- -- -------\n     @xmath      (406)\n  -- -------- -- -------\n\nwhere @xmath and @xmath . Previous equation was derived in Ref. [ 61 ] .\nWe numerically solve Eq.\u2009( 406 ), and then we look for real solutions\n@xmath . What we define as the Majorana localisation length is\n\n  -- -------- -- -------\n     @xmath      (407)\n  -- -------- -- -------\n\nIndeed, in Fig. 100 one observes that @xmath linearly increases as one\nincreases @xmath for realistic SOC (dashed line), while it acquires\nsmaller values and remains roughly constant for stronger SOC (solid\ncurve).\n\n## Chapter \\thechapter Appendix for Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states\n\nIn this supplemental material we discuss the robustness of the\nexceptional-point Majorana bound states presented in the main text\nagainst finite length and interaction effects.\n\n## Appendix L Methods\n\nTransport across the NS junction is computed using the nanowire model\nfor a Rashba wire,\n\n  -- -------- -------- -------- --\n     @xmath   @xmath   @xmath   \n                       @xmath   \n                       @xmath   \n  -- -------- -------- -------- --\n\nwith the non-proximized normal section (N) modelled by the same\nHamiltonian, albeit with @xmath and a @xmath in place of @xmath . The\nnormal contact transmission @xmath of each incoming mode is computed by\nalso setting @xmath on the proximised (S) side, and using the standard\nGreen\u2019s function scheme. One first splits the system into a left lead\n(with @xmath ), a right lead (with @xmath ), and a central section (the\ninterface with a non-uniform profile @xmath that transitions from @xmath\ninto @xmath ) coupled to the leads through operators @xmath . The total\nconductance @xmath of the @xmath incoming modes is then given by\nCaroli\u2019s formula [ 229 ]\n\n  -- -------- -- -------\n     @xmath      (409)\n  -- -------- -- -------\n\nwhere @xmath , @xmath is the dressed retarded Green\u2019s function of the\ncentral region, @xmath is the decay operator into the left\/right leads,\n@xmath is the corresponding self energies, and @xmath is the surface\nGreen\u2019s function of the decoupled leads.\n\nThe poles of the scattering matrix presented in the main text are given,\nclose to the origin of the complex plane, by the eigenvalues of\nnon-Hermitian Hamiltonian @xmath , where @xmath is the (Hermitian)\nHamiltonian of a sufficiently long segment of the wire containing the\njunction, and @xmath is the self-energy from the remaining wire (the\nreservoir), which is computed numerically.\n\nThe average normal transmission per mode is defined as @xmath . The\nvalues given in the main text were computed for Zeeman @xmath . @xmath\ndepends on the detailed spatial interpolation profile @xmath across the\ninterface. An abrupt interface has a smaller transmission than a smooth\none, due to the mismatch in Fermi velocity between the two sides. In a\nreal sample, the smoothness of such depletion profile is controlled by\ngeometric parameters of the gating used to deplete the normal side\n(typically the superconducting side will be difficult to deplete due to\nscreening by the parent superconductor). @xmath can also be controlled\nin a real device by adding a pinch-off gate close to the contact. This\npossibility is modelled by suppressing a single hopping term @xmath\nprecisely at the contact, where @xmath abruptly jumps from zero to\n@xmath . The combination of mismatch and pinch-off allows to sweep\n@xmath from zero to one.\n\n## Chapter \\thechapter Appendix for Chapter Hybrid\nsuperconductor-semiconductor nanowire junctions as useful platforms to\nstudy Majorana bound states\n\nIn this supplementary material we show how the density-density response\nfunction for Rashba nanowires was derived. Then, we describe how the\nBogoliubov transformation in a superconducting system was carried out in\norder to calculate the density-density response function, which is also\nshown here when the interband pairing is set to zero.\n\n## Appendix M Derivation of the density response in Rashba nanowires\n\nWe introduce the equations for the electron density operator, given by\nEqs.\u2009( 150 ), into the average of the commutator given by Eq.\u2009( 147 ),\nand get\n\n  -- -------- -- -------\n     @xmath      (410)\n  -- -------- -- -------\n\nPrevious equation is rewritten introducing the expressions for the wave\nfunctions @xmath from Eq.\u2009( 121 ),\n\n  -- -------- -- -------\n     @xmath      (411)\n  -- -------- -- -------\n\nNow, we work out the average of the commutator\n\n  -- -- -- -------\n           (412)\n  -- -- -- -------\n\nwhere @xmath is the Fermi distribution function, @xmath the Boltzman\nconstant and @xmath the system temperature. Then, we insert Eq.\u2009( 412 )\nexpression into Eq.\u2009( 411 ), and obtain\n\n  -- -------- -- -------\n     @xmath      (413)\n  -- -------- -- -------\n\nThe term at the end of previous expression arises from by combined\naction between the spin-orbit coupling and Zeeman interaction, which can\nbe written from the definition for @xmath given by Eq.\u2009( 121 ), as\n\n  -- -------- -- -------\n     @xmath      (414)\n  -- -------- -- -------\n\nThe next step is integration over time @xmath and over position @xmath ,\nof Eq.\u2009( 413 ) according to Eq.\u2009( 146 ) Hence, we obtain\n\n  -- -------- -- -------\n     @xmath      (415)\n  -- -------- -- -------\n\nwhere we have relabeled @xmath , @xmath , @xmath . The imaginary part of\nEq.\u2009( 415 ) gives the structure factor, and notice that we have obtained\nthe same as the one calculated in [ 230 ] , which provides a validity\ncheck for our calculations.\n\nIn the static limit, for @xmath , the Lindhard function (or\ndensity-density response function) @xmath calculate before is purely\nreal and is given by\n\n  -- -------- -- -------\n     @xmath      (416)\n  -- -------- -- -------\n\nNotice that the principal part prescription required by the\ninfinitesimal @xmath in the denominator of previous equation is not\nneeded here, since the denominator can only vanish simultaneously with\nthe numerator. In the limit @xmath , we have replaced the discrete sum\nover momentum by an integral\n\n  -- -------- -- -------\n     @xmath      (417)\n  -- -------- -- -------\n\nwhere @xmath is the dimension.\n\nFor higher dimensions one needs to calculate the electronic wave\nfunctions of the problem with Rashba SO and Zeeman in the desirable\ndimension and repite all what the steps we have done.\n\nAt zero temperature @xmath , the Fermi distribution function @xmath\nbecomes a step function\n\n  -- -------- -- -------\n     @xmath      (418)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (419)\n  -- -------- -- -------\n\nNotice that at zero temperature the chemical potential is equal to the\nFermi energy @xmath . The function @xmath restricts the @xmath\nintegration to interval @xmath , with @xmath defined by Eq.\u2009( 419 )\n@xmath\n\n  -- -------- -- -------\n     @xmath      (420)\n  -- -------- -- -------\n\nwhere @xmath , @xmath and @xmath . From Eq.\u2009( 416 ), the full\ndensity-density response can be expressed as a sum of four terms\n\n  -- -------- -- -------\n     @xmath      (421)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (422)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (423)\n  -- -------- -- -------\n\nFor a simplification upon integration let us divide each of the @xmath\ninto two integrals as follows\n\n  -- -------- -- -------\n     @xmath      (424)\n  -- -------- -- -------\n\nWe know that at zero temperature, the distribution functions become step\nfunctions and thus restrict the integration limits,\n\n  -- -------- -- -------\n     @xmath      (425)\n  -- -------- -- -------\n\nTo conclude, in this part we have shown how to derive the\ndensity-density response function in one-dimensional nanowires with SOC\nand Zeeman interaction.\n\n## Appendix N Derivation of the density response in superconducting\nRashba nanowires\n\nIn this part we derive the density-density response function in\nsuperconducting nanowires with SOC and Zeeman interaction. First, we\nshow how it is found the Bogoliubov transformation as it determines the\ninclusion of superconducting correlations into the nanowires. Then, we\nfind the density-density response function for a superconducting 1D\nnanowire when the interband pairing is set to zero, and then in a regime\nof strong Zeeman field, where only the lower band @xmath is taken into\naccount.\n\n#### n.1 Derivation of the Bogoliubov transformation at zero interband\npairing\n\nIn this part we show how to derive the Bogoliubov transformation when\nsuperconducting correlations are induced into the nanowire. This\ntransformation consists on finding an unitary operator that diagonalises\nthe system\u2019s Hamiltonian. The Hamiltonian for our problem in the helical\nbasis described in Secs. 5 and C , see Eq.\u2009( 49 ) for instance, is\n\n  -- -- -- -------\n           (426)\n  -- -- -- -------\n\nwhere the pairing potentials involved in the problem are\n\n  -- -------- -- -------\n     @xmath      (427)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (428)\n  -- -------- -- -------\n\ndenotes the @xmath -wave and @xmath -wave nature of the superconducting\npairing, respectively.\n\nNotice that the intraband pairing @xmath contains a phase, which is\nrepresented by the imaginary @xmath\n\n  -- -------- -- -------\n     @xmath      (429)\n  -- -------- -- -------\n\nThis phase can be gauge away by considering the eigenvalue problem\n@xmath , where, @xmath being the transpose operation,\n\n  -- -- -- -------\n           (430)\n  -- -- -- -------\n\nthen\n\n  -- -------- -- -------\n     @xmath      (431)\n  -- -------- -- -------\n\nTherefore, previous equations can be written as\n\n  -- -------- -- -------\n     @xmath      (432)\n  -- -------- -- -------\n\nThus, we have gauged away the phase in the intraband pairing potentials.\nNotice that the dispersion relation we have derived in previous section\nis not affected by this gauge transformation. We point out here that\n@xmath and @xmath represent the pairing potentials of two @xmath -wave\nsuperconductors, while @xmath acts as a weak coupling between them, see\nSec.\u2009( 5 ).\n\nThe situation when there is no pairing between states of different band\nis analysed here and described by setting @xmath . This case resemble a\nregime with two independent p-wave superconductors described by the two\n@xmath -wave pairing potentials @xmath and @xmath . The eigenvalues in\nthis case are calculated by diagonalising the Hamiltonian given by Eq.\u2009(\n426 )\n\n  -- -------- -- -------\n     @xmath      (433)\n  -- -------- -- -------\n\nThen, Eqs. 432 are written as\n\n  -- -------- -- -------\n     @xmath      (434)\n  -- -------- -- -------\n\nwhere the first and third equations form the Hamiltonian for sector\n@xmath , while second and fourth for sector @xmath . Previous four\nequations reduce to only two equations\n\n  -- -------- -- -------\n     @xmath      (435)\n  -- -------- -- -------\n\nwhich can be solved separately, since the two sectors are completely\ndecoupled. Remain that the coupling between the sectors @xmath and\n@xmath is described by @xmath , whose value is set to zero for\nsimplicity.\n\n##### Sector 1: @xmath\n\nFrom Eqs.\u2009( 435 ), we have\n\n  -- -------- -- -------\n     @xmath      (436)\n  -- -------- -- -------\n\nwhere the energy relation is given by\n\n  -- -------- -- -------\n     @xmath      (437)\n  -- -------- -- -------\n\nMoreover, we have the normalization condition\n\n  -- -------- -- -------\n     @xmath      (438)\n  -- -------- -- -------\n\nThen, we insert previous equation into Eq.\u2009( 436 )\n\n  -- -------- -- -------\n     @xmath      (439)\n  -- -------- -- -------\n\nthus\n\n  -- -------- -- -------\n     @xmath      (440)\n  -- -------- -- -------\n\nWe can completely neglect the @xmath function, but for completeness we\nkeep it for now. However, we will show that it won\u2019t alter our results.\nNow, we need to evaluate previous coherence factors for each energy\ngiven by Eq.\u2009( 437 ).\n(a): For @xmath\nFrom Eq.\u2009( 440 ), we have for @xmath and @xmath\n\n  -- -------- -- -------\n     @xmath      (441)\n  -- -------- -- -------\n\nNow, we denote previous results as follows\n\n  -- -------- -- -------\n     @xmath      (442)\n  -- -------- -- -------\n\nThe associated vector is therefore\n\n  -- -------- -- -------\n     @xmath      (443)\n  -- -------- -- -------\n\n(b): For @xmath\nFrom Eq.\u2009( 440 ) we have for @xmath and @xmath ,\n\n  -- -------- -- -------\n     @xmath      (444)\n  -- -------- -- -------\n\nNow, in terms of previous definitions @xmath and @xmath given by Eqs.\u2009(\n442 ) we can write\n\n  -- -------- -- -------\n     @xmath      (445)\n  -- -------- -- -------\n\nThen, the associated vector is\n\n  -- -------- -- -------\n     @xmath      (446)\n  -- -------- -- -------\n\nThe Bogoliubov transformation\nThis transformation consists on finding an unitary operator that\ndiagonalises the Hamiltonian for this sector and formed by the first and\nthird equations given by ( 434 ). Such unitary operator is a matrix and\nit is formed by the two vectors calculated previously. From Eqs.\u2009( 446 )\nand ( 443 ), we neglect the @xmath function, we have\n\n  -- -- -- -------\n           (447)\n  -- -- -- -------\n\nThis matrix relates the basis, represented by operators @xmath , in\nwhich the Hamiltonian is not diagonal with a new one, represented by\noperators @xmath , where it is diagonal. This new basis is the one of\nquasiparticles in a superconductor:\n\n  -- -------- -- -------\n     @xmath      (448)\n  -- -------- -- -------\n\ntherefore, the Bogolyubov transformation for operators that belong to\nthe sector @xmath are given by\n\n  -- -------- -- -------\n     @xmath      (449)\n  -- -------- -- -------\n\nMoreover, the matrix @xmath , @xmath denotes the transpose operation,\n\n  -- -------- -- -------\n     @xmath      (450)\n  -- -------- -- -------\n\nalso diagonalises the Hamiltonian for the sector @xmath , and therefore\nit can also apply for transforming the operators:\n\n  -- -------- -- -------\n     @xmath      (451)\n  -- -------- -- -------\n\n##### Sector 2:@xmath\n\nFrom Eqs.\u2009( 435 ), we have\n\n  -- -------- -- -------\n     @xmath      (452)\n  -- -------- -- -------\n\nwhere the energy relation is given by\n\n  -- -------- -- -------\n     @xmath      (453)\n  -- -------- -- -------\n\nand the normalization condition is given by\n\n  -- -------- -- -------\n     @xmath      (454)\n  -- -------- -- -------\n\nThen, we insert Eq.\u2009( 452 ) into previous equation and get\n\n  -- -------- -- -------\n     @xmath      (455)\n  -- -------- -- -------\n\nThus,\n\n  -- -------- -- -------\n     @xmath      (456)\n  -- -------- -- -------\n\n(a): For @xmath\nFrom Eq.\u2009( 452 ) for @xmath we have\n\n  -- -------- -- -------\n     @xmath      (457)\n  -- -------- -- -------\n\nAgain, here we make the following notation\n\n  -- -------- -- -------\n     @xmath      (458)\n  -- -------- -- -------\n\nThus, the associated vector is given by\n\n  -- -------- -- -------\n     @xmath      (459)\n  -- -------- -- -------\n\n(b): For @xmath\nFrom Eq.\u2009( 452 ) we have for @xmath\n\n  -- -------- -- -------\n     @xmath      (460)\n  -- -------- -- -------\n\nTherefore, these coherence factors in terms of previous definitions\n@xmath and @xmath , we get\n\n  -- -------- -- -------\n     @xmath      (461)\n  -- -------- -- -------\n\nThus, the associated vector is given by\n\n  -- -------- -- -------\n     @xmath      (462)\n  -- -------- -- -------\n\nThe Bogoliubov transformation\nHere we construct the unitary operator that diagonalizes the Hamiltonian\nof this sector @xmath . It is formed by the two vectors given by Eqs.\u2009(\n459 ) and ( 462 )calculated previously:\n\n  -- -- -- -------\n           (463)\n  -- -- -- -------\n\nAs before, this matrix relates the basis, represented by operators\n@xmath , in which the Hamiltonian is not diagonal to a new one,\nrepresented by operators @xmath , where it is diagonal. This new basis\nis the one of quasiparticles in a superconductor:\n\n  -- -------- -- -------\n     @xmath      (464)\n  -- -------- -- -------\n\ntherefore, the Bogoliubov transformation for operators that belong to\nthe sector @xmath are given by\n\n  -- -------- -- -------\n     @xmath      (465)\n  -- -------- -- -------\n\nAs explained before, the matrix @xmath , @xmath denotes the transpose\noperation,\n\n  -- -------- -- -------\n     @xmath      (466)\n  -- -------- -- -------\n\ndiagonalises our Hamiltonian, and therefore it can also apply for\ntransforming the operators @xmath into the new basis @xmath\n\n  -- -------- -- -------\n     @xmath      (467)\n  -- -------- -- -------\n\nNotice that upon writing the transformations we have omitted the term\n@xmath . It, however, won\u2019t alter our results.\n\n##### The Bogoliubov transformation from previous calculations\n\nTherefore, for transforming operators @xmath into the new basis @xmath\nwe can use\n\n  -- -------- -- -------\n     @xmath      (468)\n  -- -------- -- -------\n\nor the ones related to the transpose of @xmath , @xmath ,\n\n  -- -------- -- -------\n     @xmath      (469)\n  -- -------- -- -------\n\nComment 1: For calculating the density response, we can use either\nEqs.\u2009( 468 ) or Eqs.\u2009( 469 ), since both diagonalize the respective\nHamiltonian for each sector.\n\n#### Density density response at zero interband pairing\n\nThe density-density response function is defined in Eq.\u2009( 164 ), where\n\n  -- -------- -- -------\n     @xmath      (470)\n  -- -------- -- -------\n\nand we here define\n\n  -- -------- -- -------\n     @xmath      (471)\n  -- -------- -- -------\n\nAccording to the description given in the main text, one writes the\nelectron density operator in terms of field operators, see Eqs.\u2009( 166 ),\nwhich are constructed taking into account the one-electron wave\nfunctions given by Eq.\u2009( 168 ). Then, we insert Eqs.\u2009( 166 ) into Eq.\u2009(\n471 ), and get\n\n  -- -------- -- -------\n     @xmath      (472)\n  -- -------- -- -------\n\nand therefore\n\n  -- -------- -- -------\n     @xmath      (473)\n  -- -------- -- -------\n\nwhere we have summed over @xmath . There are @xmath terms to be\ncalculated. We need the Bogolyubov transformation to describe\nexcitations in a superconductor, which was derived in previous\nsubsection in Eqs.\u2009( 469 ),\n\n  -- -------- -- -------\n     @xmath      (474)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (475)\n  -- -------- -- -------\n\nand @xmath , @xmath , @xmath .\n\nBy working out all the elements, at zero temperature @xmath , @xmath ,\nwe get\n\n  -- -------- -- -------\n     @xmath      (476)\n  -- -------- -- -------\n\nThe frequency dependence is calculated by integrating previous\nexpression in time @xmath . Moreover, the coefficients coming from the\nRashba-SO problem in Eq.\u2009( 476 ), the terms with @xmath , give only two\ndifferent values that we denote as\n\n  -- -- -- -------\n           (477)\n  -- -- -- -------\n\nAfter the integration and considering previous definitions we arrive at\n\n  -- -------- -- -------\n     @xmath      (478)\n  -- -------- -- -------\n\nNow, we take the zero frequency limit and consider @xmath , @xmath ,\n@xmath and @xmath . Thus, previous equation can be written as\n\n  -- -- -- -------\n           (479)\n  -- -- -- -------\n\nLet us denote the term in brackets as @xmath . The momentum dependence\nis calculated as by integrating over space @xmath . Then,\n\n  -- -------- -- -------\n     @xmath      (480)\n  -- -------- -- -------\n\nTherefore we get\n\n  -- -------- -- -------\n     @xmath      (481)\n  -- -------- -- -------\n\nwhere coherence factors read\n\n  -- -------- -- -------\n     @xmath      (482)\n  -- -------- -- -------\n\n#### n.2 Regime of strong Zeeman field\n\nIn this part we address the situation of high Zeeman field @xmath . In\nthis case, only the lowest band, @xmath , is occupied. Therefore, the\nfull Hamiltonian can be projected to the lowest band yielding\n\n  -- -------- -- -------\n     @xmath      (483)\n  -- -------- -- -------\n\nThe Hamiltonian @xmath can be written in the BdG form in the @xmath\nbasis,\n\n  -- -------- -- -------\n     @xmath      (484)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (485)\n  -- -------- -- -------\n\nThe eigenvalues are given by\n\n  -- -------- -- -------\n     @xmath      (486)\n  -- -------- -- -------\n\nHere we proceed similarly to previous subsection in order to calculate\nthe density-density response function. The response function in momentum\nand frequency space is given by\n\n  -- -------- -- -------\n     @xmath      (487)\n  -- -------- -- -------\n\nwhere, @xmath ,\n\n  -- -- -- -------\n           (488)\n  -- -- -- -------\n\nand @xmath is the electron density operator. According to the\ndescription given in the main text, one writes the electron density\noperator in terms of field operators, see Eqs.\u2009( 166 ), which are\nconstructed taking into account the one-electron wave functions given by\nEq.\u2009( 168 ). Then, we insert Eqs.\u2009( 166 ) into Eq.\u2009( 488 ), and get\n\n  -- -------- -- -------\n     @xmath      (489)\n  -- -------- -- -------\n\nNow, we assume the situation of high Zeeman field, where only the lowest\nband, @xmath , is occupied. Therefore, in Eq.\u2009( 489 ) the unique\ncombination that we need is\n\n  -- -------- -- -------\n     @xmath      (490)\n  -- -------- -- -------\n\nIn order to describe the system with superconducting effects, we need to\ntransform our @xmath operators in Eq.\u2009( 490 ) into the new ones @xmath\naccording to the Bogoliubov transformation given by Eqs.\u2009( 468 ) or (\n469 ), where\n\n  -- -------- -- -------\n     @xmath      (491)\n  -- -------- -- -------\n\nLet us define the following quantity\n\n  -- -------- -- -------\n     @xmath      (492)\n  -- -------- -- -------\n\nTherefore, in terms of the new quasiparticle operators @xmath , we get\n\n  -- -- -- -------\n           (493)\n  -- -- -- -------\n\nThen, we can work out the average of the commutators in previous\nequation, consider the time evolution of the operators, @xmath , and\nobtain for Eq.\u2009( 490 ),\n\n  -- -------- -- -------\n     @xmath      (494)\n  -- -------- -- -------\n\nNow, we integrate over time and evaluate the zero temperature limit,\nwhere @xmath , and thus @xmath . Therefore, previous equation reads\n\n  -- -------- -- -------\n     @xmath      (495)\n  -- -------- -- -------\n\nWe can further simplify previous equation by considering the zero\nfrequency limit @xmath . The coefficients from the Rashba-Zeeman fields\nreads\n\n  -- -- -- -------\n           (496)\n  -- -- -- -------\n\nThen, from the relations for the coherence factors @xmath and @xmath and\nfor the dispersion relation @xmath , we have that @xmath , @xmath and\n@xmath . Additionally, t Therefore, taking into account previous\ncomments, the density density response reads,\n\n  -- -------- -- -------\n     @xmath      (497)\n  -- -------- -- -------\n\nMoreover, we can write the momentum dependence of the density-density\nresponse\n\n  -- -------- -- -------\n     @xmath      (498)\n  -- -------- -- -------\n\nThus, we get\n\n  -- -------- -- -------\n     @xmath      (499)\n  -- -------- -- -------\n\nPrevious equation represents the density-density response function in a\n1D superconducting wire with Rashba and Zeeman interaction with only the\nlowest band occupied, also known as the Lindhard function. Previous\nequation is valid for high Zeeman fields @xmath . Let us write down the\ncoherence coefficient in Eq.\u2009( 499 ),\n\n  -- -------- -- -------\n     @xmath      (500)\n  -- -------- -- -------\n\nwhere we have denoted\n\n  -- -------- -- -------\n     @xmath      (501)\n  -- -------- -- -------\n\nAs in previous subsection, sum over @xmath in Eq.\u2009( 499 ) is transformed\ninto an integral over @xmath ,\n\n  -- -------- -- -------\n     @xmath      (502)\n  -- -------- -- -------\n\nand the integral is performed numerically.\n\n\\addtotoc\n\nList of publications \\publications\n\n1.   Multiple Andreev reflection and critical current in topological\n    superconducting nanowire junctions\n    Pablo San-Jose, Jorge Cayao, Elsa Prada and Ram\u00f3n Aguado\n    New Journal of Physics 15, 075019 (2013)\n    Focus issue on Majorana Fermions in Condensed Matter\n\n2.   SNS junctions in nanowires with spin-orbit coupling: Role of\n    confinement and helicity on the subgap spectrum\n    Jorge Cayao, Pablo San-Jose, Elsa Prada and Ram\u00f3n Aguado\n    Physical Review B 91, 024514 (2015)\n\n3.   Majorana bound states from exceptional points in non-topological\n    superconductors\n    Pablo San-Jose, Jorge Cayao, Elsa Prada and Ram\u00f3n Aguado\n    Scientific reports 6, 21427 (2016).\n\n\\addtotoc\n\nCurriculum Vitae \\curriculum\n\n  ------------------------ -------------------------------------------------------------------------\n  Aug. 4th. 1986           Born in Lima, Peru\n  Apr. 2000 \u2013 Dec. 2002    Infantry reserve officer\n                           Colegio Militar Elias Aguirre, Chiclayo, Peru\n  Jan. 2003 \u2013 Sept. 2003   Academic preparation for the University admission exam\n                           Centro Pre-Universitario de la Universidad Nacional Mayor de San Marcos\n  Apr. 2004 \u2013 Aug. 2005    Three semesters of Bachelor in Physics\n                           Universidad Nacional Mayor de San Marcos, Lima, Peru\n  Sept. 2005 \u2013 June 2006   Slovak language and academic preparation\n                           Comenius University, Bratislava, Slovakia\n  Sept. 2006 \u2013 June 2009   Bachelor in Physics\n                           Comenius University, Bratislava, Slovakia.\n  Sept. 2009 \u2013 June 2011   Master in Physics with specialization in Astronomy and Astrophysics\n                           Comenius University, Bratislava, Slovakia\n  Aug. 2011 \u2013 Dec. 2011    SAP Engineer\n                           Hewlett-Packard (HP) Slovakia\n  Jan. 2012 \u2013 May 2016     PhD thesis\n                           Advisor: Dr. Ram\u00f3n Aguado\n                           Instituto de Ciencia de Materiales de Madrid (ICMM)\n                           Consejo Superior de Investigaciones Cient\u00edficas (CSIC), Spain\n  Aug. 2013 \u2013 Sept. 2013   Visiting Scholar\n                           Group of Prof. Vladimir Bu\u017eek, under the supervision of Dr. Peter Sta\u0148o\n                           Slovak Academy of Sciences. Bratislava, Slovakia\n  Sept. 2014 \u2013 Dec. 2014   Visiting Scholar\n                           Group of Prof. Daniel Loss, under the supervision of Dr. Peter Sta\u0148o\n                           Center for Emergent Matter Science, RIKEN. Tokyo, Japan\n  ------------------------ -------------------------------------------------------------------------\n","output":["One of the most promising platforms for one-dimensional topological\nsuperconductivity is based on semiconducting nanowires with strong spin-orbit\ncoupling (SOC), where s-wave superconductivity is induced by proximity effect\nand an external Zeeman field drives the system into the topological\nsuperconducting phase with Majorana bound states (MBSs) at the end of the wire.\nDuring last years this idea has led to a great number of important experiments\nin hybrid superconductor-semiconductor systems, where the main signature is an\nemergent zero-bias peak (ZBP) in the differential conductance as the Zeeman\nfield is increased.\n  This thesis focuses on the study of hybrid superconductor-semiconductor\njunctions made of semiconducting nanowires with Rashba SOC. We emphasise the\nimportance of employing hybrids superconductor-semiconductor nanowire junctions\ntowards the unambiguously detection of MBSs beyond zero-bias anomalies.","One of the most promising platforms for one-dimensional topological\nsuperconductivity is based on semiconducting nanowires with strong\nspin-orbit coupling (SOC), where @xmath -wave superconductivity is\ninduced by proximity effect and an external Zeeman field drives the\nsystem into the topological superconducting phase with Majorana bound\nstates (MBSs) at the end of the wire. During last years this idea has\nled to a great number of important experiments in hybrid\nsuperconductor-semiconductor systems, where the main signature is an\nemergent zero-bias peak (ZBP) in the differential conductance as the\nZeeman field is increased.\n\nThis thesis focuses on the study of hybrid superconductor-semiconductor\njunctions made of semiconducting nanowires with Rashba SOC. In the first\npart, we introduce the emergence of one-dimensional topological\nsuperconductivity, and then we show details on modeling one-dimensional\nhybrid junctions made of semiconducting nanowires with SOC. Afterwards,\nwe fully analyse the Andreev spectrum and study phase-biased transport,\nwhich exhibit non-trivial signatures in the topological phase with MBSs.\nIn the second part, we focus on transport in a voltage-biased short\nsuperconductor-normal-superconductor (SNS) junction made of\nsemiconducting nanowires with SOC as the applied Zeeman field drives the\nsystem into the topological superconducting phase. We show that the\ndissipative multiple Andreev reflection (MAR) current at different\njunction transparencies exhibits unique features related to topology\nsuch as gap inversion, the formation of MBSs and fermion-parity\nconservation. In the third part, we carried out a detailed study of\nhelicity and confinement in long SNS junctions based on semiconducting\nnanowires. The main conclusion in this part is that a long junction with\na helical normal section but still in the topologically trivial regime,\nsupports a low-energy sub-gap spectrum consisting of multiple\nzero-energy crossings that smoothly evolve towards MBSs as the junction\nbecomes topological. In the fourth part, we investigate a novel approach\nto engineer MBSs in non-topological superconducting wires, where we\npropose to create a sufficiently transparent normal-superconductor (NS)\njunction on a Rashba wire with a topologically trivial superconducting\nside and a helical normal side. We finish with an analysis of screening\nproperties of proximitized nanowires with SOC and Zeeman fields within\nlinear response theory, relevant for experiments trying to measure\nMajorana bound states and their non-trivial overlap. Along this thesis,\nwe emphasise the importance of employing hybrids\nsuperconductor-semiconductor nanowire junctions towards the\nunambiguously detection of MBSs beyond zero-bias anomalies. Keywords:\nTopological superconductivity, Majorana bound states, Andreev bound\nstates, hybrid NS and SNS junctions, spin-orbit coupling, Zeeman\ninteraction, @xmath -wave superconductivity\n"]}
{"input":"## Chapter 1 Introduction\n\n### 1.1 Problem formulation\n\nPredictive learning has traditionally been a standard inductive\nlearning, with two modes of inference: system identification (with the\ngoal of density estimation) and system imitation (for generalization).\nNonetheless, predictive learning does not end with inductive learning.\nWhile with inductive learning the main assumptions are a finite training\nset and a large (infinite), unknown test set, other problem settings may\nbe devised.\n\nThe transduction formulation [ 1 ] assumes a given set of labeled,\ntraining data and a finite , known set of unlabeled test points, with\nthe interest to estimate the class labels only at these points. The\nselection type of inference is, in some sense, even simpler than\ntransduction: given a set of labeled training data and unlabeled test\npoints, select a subset of test points with the highest probability of\nbelonging to one class. Selective inference needs only to select a\nsubset of @xmath test points, rather than assign class labels to all\ntest points. An hierarchy of types of inference can be, not\nexhaustively, listed [ 2 ] : identification, imitation, transduction,\nselection, etc.\n\nUnder the traditional inductive learning, different (sub-)problem\nformulations have been identified. Two of the most representative are\nregression and classification . While both consist on estimating a\nmapping from the feature space, the regression looks for a real-valued\nfunction defined in the feature space, whereas classification maps the\nfeature space into a finite class space. Depending on the cardinality of\nthe finite class space we are left with two-class or multiclass\nclassification problems. Finally, the presence or absence of a \u201cnatural\u201d\norder among classes will separate nominal from ordinal problems:\n\n### 1.2 Motivation\n\nAlthough two-class and nominal data classification problems have been\ndissected in the literature, the ordinal sibling has not yet received a\nlot of attention, even with many learning problems involving classifying\nexamples into classes which have a \u201cnatural\u201d order. Settings in which it\nis natural to rank instances arise in many fields, such as information\nretrieval [ 3 ] , collaborative filtering [ 4 ] , econometric modeling [\n5 ] and natural sciences [ 6 ] . ^(\u2020) ^(\u2020) \u2020 It is worth pointing out\nthat distinct tasks of relation learning, where an example is no longer\nassociated with a class or rank, which include preference learning and\nreranking [ 7 ] , are topics of research on their own.\n\nConventional methods for nominal classes or for regression problems\ncould be employed to solve ordinal data problems ( [ 8 , 9 , 10 ] );\nhowever, the use of techniques designed specifically for ordered classes\nresults in simpler classifiers, making it easier to interpret the\nfactors that are being used to discriminate among classes [ 5 ] .\nAlthough the ordinal formulation seems conceptually simpler than\nnominal, some technical difficulties to incorporate the piece of\nadditional information \u2013 the order \u2013 in the algorithms may explain the\nwidespread use of conventional methods to tackle the ordinal data\nproblem.\n\n### 1.3 Tools\n\nAs seen, there are relatively few predictive learning formulations;\nhowever, the number of learning algorithms, especially for the inductive\ncase, is overwhelming. Many frameworks, adaptations to real-life\nproblems, intertwining of base algorithms were, and continue to be,\nproposed in the literature; ranging from statistical approaches to state\nof the art machine learning algorithms, parametric to non parametric\nprocedures, a plethora of methods is available to users.\n\nOur study will not attempt to cover them all. Limited by time (and\ncompetence to add significant contributions), two major algorithms will\nbe the \u201chorsepower\u201d of our work: support vector machines and neural\nnetworks. Other base approaches, such as decision trees, for which\ninteresting algorithms for ordinal data have already been proposed ( [\n11 , 12 , 13 ] ), will have to wait for a next opportunity.\n\n#### 1.3.1 The ABC of support vector machines\n\nConsider briefly how the SVM binary classification problem is formulated\n[ 1 ] . ^(\u2021) ^(\u2021) \u2021 The following introduction to SVMs is based largely\non [ 14 ] .\n\nFor two training classes linearly separable in the selected feature\nspace, the distinctive idea of SVM is to define a linear discriminant\nfunction @xmath in the feature space bisecting the two training classes\nand characterized by @xmath . However, there may be infinitely many such\nsurfaces. To select the surface best suited to the task, the SVM\nmaximizes the distance between the decision surface and those training\npoints lying closest to it (the support vectors). Considering the\ntraining set @xmath , where @xmath denotes the class number, @xmath is\nthe index within each class, it is easy to show [ 1 ] that maximizing\nthis distance is equivalent to solving\n\n  -- -------- -- -------\n     @xmath      (1.1)\n  -- -------- -- -------\n\nIf the training classes are not linearly separable in feature space, the\ninequalities in ( 1.1 ) can be relaxed using slack variables and the\ncost function modified to penalise any failure to meet the original\n(strict) inequalities. The problem becomes\n\n  -- -------- -- -------\n     @xmath      (1.2)\n  -- -------- -- -------\n\nThe constraint parameter @xmath controls the tradeoff between the dual\nobjectives of maximizing the margin of separation and minimizing the\nmisclassification error. For an error to occur, the corresponding @xmath\nmust exceed unity so @xmath is an upper bound on the number of the\ntraining errors, that is @xmath , where @xmath is the classification\nrule induced by the hyperplane @xmath . Hence the added penalty\ncomponent is a natural way to assign an extra cost for errors.\n\nHowever, optimization of the above is difficult since it involves a\ndiscontinuous function @xmath . As it is common in such cases, we choose\nto optimize a closely related cost function, and the goal becomes to\n\n  -- -------- -- -------\n     @xmath      (1.3)\n  -- -------- -- -------\n\nunder the same set of constraints as ( 1.2 ).\n\nIn order to account for different misclassification costs or sampling\nbias, the model can be extended to penalise the slack variables\naccording to different weights in the objective function [ 15 ] :\n\n  -- -------- -- -------\n     @xmath      (1.4)\n  -- -------- -- -------\n\n#### 1.3.2 The ABC of neural networks\n\nNeural networks were originally developed from attempts to model the\ncommunication and processing information in the human brain. Analogous\nto the brain, a neural network consists of a number of inputs\n(variables), each of which is multiplied by a weight, which is analogous\nto a dendrite. The products are summed and transformed in a \u201cneuron\u201d\n(i.e. simple processing unit) and the result becomes an input value for\nanother neuron [ 16 ] .\n\nA multilayer feedforward neural network consists of an input layer of\nsignals, an output layer of output signals, and a number of layers of\nneurons in between, called hidden layers [ 17 , 18 , 19 ] . It was shown\nthat, under mild conditions, these models can approximate any decision\nfunction and its derivatives to any degree of accuracy.\n\nTo use a neural network for classification, we need to construct an\nequivalent function approximation problem by assigning a target value\nfor each class. For a two-class problem we can use a network with a\nsingle output, and binary target values: 1 for one class, and 0 for the\nother. We can thus interpret the network\u2019s output as an estimate of the\nprobability that a given pattern belongs to the \u20191\u2019 class. The training\nof the network is commonly performed using the popular mean square\nerror.\n\nFor multiclass classification problems ( @xmath -of- @xmath , where\n@xmath ) we use a network with @xmath outputs, one corresponding to each\nclass, and target values of 1 for the correct class, and 0 otherwise.\nSince these targets are not independent of each other, however, it is no\nlonger appropriate to use the same error measure. The correct\ngeneralization is through a special activation function (the softmax )\ndesigned so as to satisfy the normalization constraint on the total\nprobability [ 10 ] .\n\nHowever, this approach does not retain the ordinality or rank order of\nthe classes and is not, therefore, appropriate for ordinal multiclass\nclassification problems. An clear exception is the PRank algorithm by\nCrammer [ 20 ] , and its improvement by Harrington [ 21 ] , which is a\nvariant of the perceptron algorithm. As we progress in this work,\nseveral other approaches will be presented, making use of generic neural\nnetworks.\n\n### 1.4 Thesis\u2019 structure\n\nThis thesis introduces in chapter 2 the data replication method, a\nnonparametric procedure for the classification of ordinal data based on\nthe extension of the original dataset with additional variables,\nreducing the classification task to the well known two-class problem.\nStarting with the simpler linear case, the chapter evolves to the\nnonlinear case; from there the method is extended to incorporate the\nprocedure of Frank and Hall [ 22 ] . Finally, the generic version of the\ndata replication method is presented, allowing partial constraints on\nvariables.\n\nIn chapter 3 the data replication method is mapped into two important\nmachine learning algorithms: support vector machines and neural\nnetworks. A comparison is made with a previous SVM approach introduced\nby Shashua [ 4 ] , the minimum margin principle, showing that the data\nreplication method leads essentially to the same solution, but with some\nkey advantages. The chapter is elegantly concluded with a\nreinterpretation of the neural network model as a generalization of the\nordinal logistic regression model.\n\nThe second novel model, the unimodal model, is introduced in chapter 4 ,\nand a parametric version is mapped into neural networks. A parallelism\nof this approach with regression models concludes the chapter.\n\nChapter 5 introduces the experimental methodology and the algorithms\nthat were compared in the conducted experiments reported in the\nsucceeding chapters. Finally, results are discussed, conclusions are\ndrawn and future work is oriented in chapter 9 .\n\n### 1.5 Contributions\n\nWe summarize below the contributions of this thesis towards more\nefficient and parsimonious methods for classification of ordinal data.\nIn this thesis we have\n\n1.  introduced in the machine learning community the data replication\n    method , a nonparametric procedure for the classification of ordinal\n    categorical data. Presented also the mapping of this method for\n    neural networks and support vector machines;\n\n2.  unified under this framework two well-known approaches for the\n    classification of ordinal categorical data, the minimum margin\n    principle [ 4 ] and the generic approach by Frank and Hall [ 22 ] .\n    It was also presented a probabilistic interpretation for the neural\n    network model;\n\n3.  introduced the unimodal model, mapped to neural networks, a second\n    approach for the classification of ordinal data, and established\n    links to previous works.\n\n#### Publications related to the thesis\n\n[ 23 ] J.\u00a0S. Cardoso, J.\u00a0F.\u00a0P. da\u00a0Costa, and M.\u00a0J. Cardoso, \u201cSVMs\napplied to objective aesthetic evaluation of conservative breast cancer\ntreatment,\u201d in Proceedings of International Joint Conference on Neural\nNetworks (IJCNN) 2005 , 2005, pp. 2481\u20132486.\n\n[ 6 ] J.\u00a0S. Cardoso, J.\u00a0F.\u00a0P. da\u00a0Costa, and M.\u00a0J. Cardoso, \u201cModelling\nordinal relations with SVMs: an application to objective aesthetic\nevaluation of breast cancer conservative treatment,\u201d (ELSEVIER)Neural\nNetworks , vol.\u00a018, pp. 808\u2013817, june-july 2005.\n\n[ 24 ] J.\u00a0F.\u00a0P. da\u00a0Costa and J.\u00a0S. Cardoso, \u201cClassification of ordinal\ndata using neural networks,\u201d in Proceedings of European Conference\nMachine Learning (ECML) 2005 , 2005, pp. 690\u2013697.\n\n[ 25 ] J.\u00a0S. Cardoso and J.\u00a0F.\u00a0P. da\u00a0Costa, \u201cLearning to classify\nordinal data: the data replication method,\u201d (submitted) Journal of\nMachine Learning Research .\n\n## Chapter 2 The data replication method444Some portions of this chapter\nappeared in [6].\n\nLet us formulate the problem of separating @xmath ordered classes @xmath\n. Consider the training set @xmath , where @xmath denotes the class\nnumber, @xmath is the index within each class, and @xmath , with @xmath\nthe dimension of the feature space. Let @xmath be the total number of\ntraining examples.\n\nSuppose that a @xmath -class classifier was forced, by design, to have\n@xmath noncrossing boundaries , with boundary @xmath discriminating\nclasses @xmath against classes @xmath . As the intersection point of two\nboundaries would indicate an example with three or more classes equally\nprobable \u2013 not plausible with ordinal classes \u2013, this strategy imposes\nan (arguably) intuitive restriction. With this constraint emerges a\nmonotonic model, where a better value in an attribute does not lead to a\nlower decision class. For the linear case, this translates to choosing\nthe same weighted sum for all decisions \u2013 the classifier would be just a\nset of weights, one for each feature, and a set of biases, the scale in\nthe weighted sum. By avoiding the intersection of any two boundaries,\nthis simplified model captures better the essence of the ordinal data\nproblem. Another strength of this approach is the reduced number of\nparameters to estimate, which may lead to a more robust classifier, with\ngreater capacity for generalization.\n\nThis rationale leads to a straight-forward generalization of the\ntwo-class separating hyperplane [ 4 ] . Define @xmath separating\nhyperplanes that separate the training data into @xmath ordered classes\nby modeling the ranks as intervals on the real line \u2013 an idea with roots\nin the classical cumulative model, [ 3 , 26 ] . The geometric\ninterpretation of this approach is to look for @xmath parallel\nhyperplanes represented by vector @xmath and scalars @xmath , such that\nthe feature space is divided into equally ranked regions by the decision\nboundaries @xmath .\n\nIt would be interesting to accommodate this formulation under the\ntwo-class problem. That would allow the use of mature and optimized\nalgorithms, developed for the two-class problem. The data replication\nmethod allows us to do precisely that.\n\n### 2.1 Data replication method \u2013 the linear case\n\nTo outline the rationale behind the proposed model for the linear case,\nconsider first an hypothetical, simplified scenario with three classes\nin @xmath . The plot of the dataset is presented in figure 2.1(a) .\n\nUsing a transformation from the @xmath initial feature-space to a @xmath\nfeature space, replicate each original point, according to the rule\n(figure 2.1(b) ):\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nObserve that each any two points created from the same starting point\ndiffer only in the new variable.\n\nDefine now a binary training set in the high-dimensional space according\nto (figure 2.1(c) ):\n\n  -- -- -- -------\n           (2.1)\n  -- -- -- -------\n\nA linear two-class classifier can now be applied to the extended\ndataset, yielding a hyperplane separating the two classes \u2013 figure\n2.1(d) . The intersection of this hyperplane with each of the subspace\nreplicas (by setting @xmath and @xmath in the equation of the\nhyperplane) can be used to derive the boundaries in the original dataset\n\u2013 figure 2.1(e) .\n\nAlthough the foregoing analysis enables to classify unseen examples in\nthe original dataset, classification can be done directly in the\nextended dataset, using the binary classifier, without explicitly\nresorting to the original dataset. For a given example @xmath , classify\neach of its two replicas @xmath , obtaining a sequence of two labels\n@xmath . From this sequence infer the class according to the rule\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWith the material on how to construct a set of optimal hyperplanes for\nthe toy example, we are now in a position to formally describe the\nconstruction of a @xmath -class classifier for ordinal classification.\nDefine @xmath as the sequence of @xmath zeros and @xmath as the sequence\nof @xmath symbols @xmath , with @xmath in the @xmath -th position.\nConsidering the problem of separating @xmath classes @xmath with\ntraining set @xmath , define a new high-dimensional binary training\ndataset as\n\n  -- -------- -- -------\n     @xmath      (2.2)\n  -- -------- -- -------\n\nwhere the role of parameter @xmath is to bound the number of classes, to\nthe \u2018left\u2019 and to the \u2018right\u2019, involved in the constraints of a\nboundary. This allows to control the increase of data points inherent to\nthis method. The toy example in figure 2.1(b) was illustrated with\n@xmath ; setting @xmath would result as illustrated in 2.2 , with\nessentially the same solution.\n\nThen construct a linear two-class classifier on this extended dataset;\nto classify an unseen example obtain a sequence of @xmath labels @xmath\nby classifying each of the @xmath replicas in the extended dataset with\nthe binary classifier. Note that, because the @xmath boundaries do not\ncross each other, there are only @xmath different possible sequences.\nThe target class can be obtained by summing one to the number of @xmath\nlabels in the sequence.\n\n### 2.2 Data replication method \u2013 the nonlinear case\n\nSo far we have assumed linear boundaries between classes. There are\nimportant situations in which such a restriction does not exist, but the\norder of the classes is kept. Inspired by the data replication method\njust presented, we can look for boundaries that are level curves of some\nnonlinear function @xmath defined in the feature space. For the linear\nversion we take @xmath .\n\nExtending the feature space and modifying to a binary problem, as\ndictated by the data replication method, we can search for a partially\nlinear (nonlinear in the original variables but linear in the introduced\nvariables) boundary @xmath , with @xmath , and @xmath . The intersection\nof the constructed high-dimensional boundary with each of the subspace\nreplicas provides the desired @xmath boundaries. This approach is\nplotted in figure 2.3 for the toy example. ^(\u2020) ^(\u2020) \u2020 Although a\npartial linear function @xmath is the simplest to provide noncrossing\nboundaries in the original space (level curves of some function @xmath\n), it is by no means the only type of function to provide them.\n\n### 2.3 A general framework\n\nAs presented so far the data replication method allows only to search\nfor parallel hyperplanes ( level curves in the nonlinear case)\nboundaries. That is, a single direction is specified for all boundaries.\nIn the quest for an extension allowing more loosely coupled boundaries,\nlet us start by reviewing a method for ordinal data already presented in\nthe literature.\n\n#### 2.3.1 The method of Frank and Hall\n\nFrank and Hall [ 22 ] introduced a simple algorithm that enables\nstandard classification algorithms to exploit the ordering information\nin ordinal prediction problems. First, the data is transformed from a\n@xmath -class ordinal problem to @xmath binary class problems. Training\nof the @xmath -th classifier is performed by converting the ordinal\ndataset with classes @xmath into a binary dataset, discriminating @xmath\nagainst @xmath ; in fact it represents the test @xmath . To predict the\nclass value of an unseen instance, the @xmath binary outputs are\ncombined to produce a single estimation. Any binary classifier can be\nused as the building block of this scheme.\n\nObserve that, under our approach, the @xmath -th boundary is also\ndiscriminating @xmath against @xmath ; the major difference lies in the\nindependence of the boundaries found with Frank and Hall method.\n\n#### 2.3.2 A parameterized family of classifiers\n\nUp to now, when replicating the original dataset, the original @xmath\nvariables were the first @xmath variables of the @xmath variables of the\nnew dataset, for each subspace replica, as seen in ( 2.2 ).\n\nReturning to the toy example, assume that the replication was done not\naccording to ( 2.1 ) but instead using the following rule:\n\n  -- -- -- -------\n           (2.3)\n  -- -- -- -------\n\nwhere @xmath is the sequence of @xmath zeros. Intuitively, by\nmisaligning variables involved in the determination of different\nboundaries (variables in different subspaces), we are decoupling those\nsame boundaries.\n\nProceeding this way, boundaries can be designed almost independently\n(more on this later, when mapping to SVMs). In the linear case we have\nnow four parameters to estimate, the same as for two independent lines\nin @xmath . Intuitively, this new rule to replicate the data allows the\nestimation of the direction of each boundary essentially independently.\n\nThe general formulation in ( 2.2 ) becomes\n\n  -- -------- -- -------\n     @xmath      (2.4)\n  -- -------- -- -------\n\nwhere @xmath is the sequence of @xmath zeros, @xmath .\n\nWhile the linear basic data replication method requires the estimation\nof @xmath parameters, the new rule necessitates of @xmath , the same as\nthe Frank and Hall approach; this corresponds to the number of free\nparameters in @xmath independent @xmath -dimensional hyperplanes.\n\nWhile this does not aim at being a practical alternative to Frank\u2019s\nmethod, it does paves the way for intermediate solutions, filling the\ngap between the totally coupled and totally independent boundaries.\n\nTo constraint only the first @xmath variables of the @xmath initial\nvariables to have the same direction in all boundaries, while leaving\nthe @xmath final variables unconstrained, we propose to extend the data\naccording to\n\n  -- -------- -- -------\n     @xmath      (2.5)\n  -- -------- -- -------\n\nWith this rule @xmath , @xmath , parameters are to be estimated.\n\nThis general formulation of the data replication method allows the\nenforcement of only the amount of knowledge (constraints) that is\neffectively known a priori , building the right amount of parsimony into\nthe model.\n\n## Chapter 3 Mapping the data replication method to learning algorithms\n\nSuppose that examples in a classification problem come from one of\n@xmath classes, numbered from @xmath to @xmath , corresponding to their\nnatural order if one exists, and arbitrarily otherwise. The learning\ntask is to select a prediction function @xmath from a family of possible\nfunctions that minimizes the expected loss .\n\nIn the absence of reliable information on relative costs, a natural\napproach for unordered classes is to treat every misclassification as\nequally likely. This translates to adopting the non-metric indicator\nfunction @xmath if @xmath and @xmath if @xmath , where @xmath and @xmath\nare the predicted and true classes, respectively. Measuring the\nperformance of a classifier using the @xmath loss function is equivalent\nto simply considering the misclassification error rate. However, for\nordered classes, losses that increase with the absolute difference\nbetween the class numbers are more natural choices in the absence of\nbetter information [ 5 ] . This loss should be naturally incorporated\nduring the training period of the learning algorithm.\n\nA risk functional that takes into account the ordering of the classes\ncan be defined as\n\n  -- -------- -- -------\n     @xmath      (3.1)\n  -- -------- -- -------\n\nwith\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe empirical risk is the average of the number of mistakes, where the\nmagnitude of a mistake is related to the total ordering: @xmath .\n\nArguing as [ 3 ] , we see that the role of parameter @xmath (bounding\nthe loss incurred in each example) is to allow for an incorporation of a\npriori knowledge about the probability of the classes, conditioned by ,\n@xmath . This can be treated as an assumption on the concentration of\nthe probability around a \u201ctrue\u201d rank. Let us see how all this finds its\nplace with the data replication method.\n\n### 3.1 Mapping the data replication method to SVMs\n\n#### 3.1.1 The minimum margin principle\n\nLet us formulate the problem of separating @xmath ordered classes @xmath\nin the spirit of SVMs.\n\nStarting from the generalization of the two-class separating hyperplane\npresented in the beginning of previous section, let us look for @xmath\nparallel hyperplanes represented by vector @xmath and scalars @xmath ,\nsuch that the feature space is divided into equally ranked regions by\nthe decision boundaries @xmath .\n\nGoing for a strategy to maximize the margin of the closest pair of\nclasses, the goal becomes to maximize @xmath . Recalling that an\nalgebraic measure of the distance of a point to the hyperplane @xmath is\ngiven by @xmath , we can scale and @xmath so that the value of the\nminimum margin is @xmath .\n\nThe constraints to consider result from the @xmath binary\nclassifications related to each hyperplane; the number of classes\ninvolved in each binary classification can be made dependent on a\nparameter @xmath , as depicted in figure 3.1 . For the hyperplane @xmath\n, the constraints result as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nOur model can now be summarized as:\n\n  -- -------- -- -------\n     @xmath      (3.2)\n  -- -------- -- -------\n\nReasoning as in the two-class SVM for the non-linearly separable\ndataset, the model becomes\n\n  -- -------- -- -------\n     @xmath      (3.3)\n  -- -------- -- -------\n\nSince each point @xmath is replicated @xmath times, it is involved in\nthe definition of @xmath boundaries (see figure 3.1 ); consequently, it\ncan be shown to be misclassified @xmath times, where @xmath is the class\nestimated by the model. As with the two-class example, @xmath is an\nupperbound of @xmath , proportional to the empirical risk. ^(\u2020) ^(\u2020) \u2020\nTwo parameters named @xmath have been introduced. In section 2.1 the\n@xmath parameter bounds the number of classes involved in the definition\nof each boundary, controlling this way the growth of the original\ndataset. The parameter @xmath introduced in equation ( 3.1 ) bounds the\nloss incurred in each example. Here we see that they are the same\nparameter.\n\nContinuing the parallelism with the two-class SVM, the function to\nminimize simplifies to\n\n  -- -------- -- -------\n     @xmath      (3.4)\n  -- -------- -- -------\n\nsubject to the same constraints as ( 3.3 ).\n\nAs easily seen, the proposed formulation resembles the fixed margin\nstrategy in [ 4 ] . However, instead of using only the two closest\nclasses in the constraints of an hyperplane, more appropriate for the\nloss function @xmath , we adopt a formulation that captures better the\nperformance of a classifier for ordinal data.\n\nTwo issues were identified in the above formulation. First, this is an\nincompletely specified model because the scalars @xmath are not well\ndefined. In fact, although the direction of the hyperplanes is unique\nunder the above formulation (proceeding as [ 1 ] for the binary case),\nthe scalars @xmath are not uniquely defined, figure 3.2 .\n\nAnother issue is that, although the formulation was constructed from the\ntwo-class SVM, it is no longer solvable with the same algorithms. It\nwould be interesting to accommodate this formulation under the two-class\nproblem. Both issues are addressed by mapping the data replication\nmethod to SVMs.\n\n#### 3.1.2 The oSVM algorithm\n\nIn order to get a better intuition of the general result, consider first\nthe toy example previously presented.\n\nThe binary SVM formulation for the extended and binarized training set\ncan be described as ( with @xmath )\n\n  -- -- -- -------\n           (3.5)\n  -- -- -- -------\n\nBut because @xmath , and renaming @xmath to @xmath and @xmath to @xmath\nthe formulation above simplifies to\n\n  -- -------- -- -------\n     @xmath      (3.6)\n  -- -------- -- -------\n\nTwo points are worth to mention: a) this formulation, being the result\nof a pure SVM method, has an unique solution [ 1 ] ; b) this formulation\nequals the formulation ( 3.4 ) for ordinal data previously introduced,\nwith @xmath , @xmath , and a slightly modified objective function by the\nintroduction of a regularization member, proportional to the distance\nbetween the hyperplanes. The oSVM solution is the one that\nsimultaneously minimizes the distance between boundaries and maximizes\nthe minimum of the margins \u2013 figure 3.3 . The @xmath parameter controls\nthe tradeoff between the objectives of maximizing the margin of\nseparation and minimizing the distance between the hyperplanes.\n\nTo reiterate, the data replication method enabled us to formulate the\nclassification of ordinal data as a standard SVM problem, removing the\nambiguity in the solution by the introduction of a regularization term\nin the objective function.\n\nWith the material on how to construct a set of optimal hyperplanes for\nthe toy example, we are now in a position to formally describe the\nconstruction of a support vector machine for ordinal classification.\n\nConsider a general extended dataset, as defined in ( 2.2 ). After the\nsimplifications and change of variables suggested in the toy example,\nthe binary SVM formulation for this extended dataset yields\n\n  -- -------- -- -------\n     @xmath      (3.7)\n  -- -------- -- -------\n\nwith the same set of constraints as ( 3.3 ).\n\nThis formulation for the high-dimensional dataset matches the proposed\nformulation for ordinal data up to an additional regularization member\nin the objective function. This additional member is responsible for the\nunique determination of the biases. ^(\u2021) ^(\u2021) \u2021 Different regulation\nmembers could be obtained by different extensions of the dataset. For\nexample, if @xmath had been defined as the sequence @xmath , with @xmath\n@xmath \u2019s and @xmath @xmath \u2019s, the regularization member would be\n@xmath .\n\nIt is important to stress that the complexity of the SVM model does not\ndepend on the dimensionality of the data. So, the only increase in the\ncomplexity of the problem is due to the duplication of the data (more\ngenerally, for a @xmath -class problem, the dataset is increased at most\n@xmath times). As such, it compares favourably with the formulation in [\n27 ] , which squares the dataset.\n\n##### Nonlinear boundaries\n\nAs explained before, the search for nonlinear level curves can be\npursued in the extended feature space by searching for a partially\nlinear function @xmath . Since nonlinear boundaries are handled in the\nSVM context making use of the well known kernel trick, a specified\nkernel @xmath in the original feature space can be easily modified to\n@xmath in the extended space.\n\nSummarizing, the nonlinear ordinal problem can be solved by extending\nthe feature set and modifying the kernel function, figure 3.4 .\n\nAs we see, the extension to nonlinear decision boundaries follows the\nsame reasoning as with the standard SVM [ 1 ] .\n\n##### Independent boundaries\n\nConsidering now the setup for independent boundaries, as presented in (\n2.4 ), the linear, binary SVM formulation yields\n\n  -- -------- -- -------\n     @xmath      (3.8)\n  -- -------- -- -------\n\nWe see that if the regularization term @xmath is zero (in practice,\nsufficiently small), the optimization problem could be broken in @xmath\nindependent optimization problems, reverting to the procedure of Frank\nand Hall [ 22 ] .\n\n### 3.2 Mapping the data replication method to NNs\n\nBy letting @xmath be the output of a neural network, a flexible\narchitecture for ordinal data can be devised as represented\ndiagrammatically in figure 3.5 . @xmath is the output of a generic\nfeedforward network (in fact, it could be any neural network, with a\nsingle output), which is then linearly combined with the added @xmath\ncomponents.\n\nFor the simple case of searching for linear boundaries, the overall\nnetwork simplifies to a single neuron with @xmath inputs. A less\nsimplified model, also used in the conducted experiments, is to consider\na single hidden layer, as depicted in figure 3.6 .\n\nInterestingly, it is possible to provide a probabilistic interpretation\nto this neural network model.\n\n#### 3.2.1 Ordinal logistic regression model\n\nThe traditional statistical approach for ordinal classification models\nthe cumulative class probability @xmath by\n\n  -- -------- -- -------\n     @xmath      (3.9)\n  -- -------- -- -------\n\nRemember that @xmath , @xmath and @xmath .\n\nFor the linear version ( [ 28 , 26 ] ) we take @xmath . Mathieson [ 5 ]\npresents a nonlinear version by letting @xmath be the output of a neural\nnetwork. However other setups can be devised. Start by observing that in\n( 3.9 ) we can always assume @xmath by incorporating an appropriate\nadditive constant in @xmath . We are left with the estimation of @xmath\nand @xmath cut points. By fixing @xmath as the activation function in\nthe output layer of our oNN network, we can train the network to predict\nthe values @xmath , when fed with @xmath , @xmath . By setting @xmath\nand @xmath we see that the extended dataset as defined in ( 2.2 ) can be\nused to train the oNN network. The predicted cut points are simply the\nweights of the connection of the added @xmath components, scaled by\n@xmath .\n\nIllustrating this model with the synthetic dataset from Mathieson [ 5 ]\n, we attained the decision boundaries depicted in figure 3.7 .\n\n## Chapter 4 The unimodal method for NNs444The text and idea presented\nin this section is thanks to Prof. Joaquim F. Pinto da Costa. Some\nportions of this chapter appeared in [24].\n\nGiven a new query point , Bayes decision theory suggests to classify in\nthe class which maximizes the a posteriori probability @xmath . To do\nso, one usually has to estimate these probabilities, either implicitly\nor explicitly. Suppose for instance that we have 7 classes and, for a\ngiven point @xmath , the highest probability is @xmath ; we then assign\nclass @xmath to the given point. If there is not an order relation\nbetween the classes, it is perfectly natural that the second highest a\nposteriori probability is, for instance, @xmath . However, if the\nclasses are ordered, @xmath , classes @xmath and @xmath are closer to\nclass @xmath and therefore the second and third highest a posteriori\nprobabilities should be attained in these classes. This argument extends\neasily to the classes, @xmath and @xmath , and so on. This is the main\nidea behind the method proposed here, which is now detailed.\n\nOur method assumes that in a supervised classification problem with\nordered classes, the random variable class associated with a given query\nshould be unimodal. That is to say that if we plot the a posteriori\nprobabilities @xmath , from the first @xmath to the last @xmath , there\nshould be only one mode in this graphic. Here, we apply this idea in the\ncontext of neural networks. Usually in neural networks, the output layer\nhas as many units as there are classes, @xmath . We will use the same\norder for these units and the classes. In order to force the output\nvalues (which represent the a posteriori probabilities) to have just one\nmode, we will use a parametric model for these output units. This model\nconsists in assuming that the output values come from a binomial\ndistribution, @xmath . This distribution is unimodal in most cases and\nwhen it has two modes, these are for contiguous values, which makes\nsense in our case, since we can have exactly the same probability for\ntwo classes. This binomial distribution takes integer values in the set\n@xmath ; value @xmath corresponds to class @xmath , value 1 to class\n@xmath and so on until value @xmath to class @xmath . As @xmath is\nknown, the only parameter left to be estimated from this model is the\nprobability @xmath . We will therefore use a different architecture for\nthe neural network; that is, the output layer will have just one output\nunit, corresponding to the value of @xmath \u2013 figure 4.1 . For a given\nquery , the output of the network will be a single numerical value in\nthe range [0,1], which we call @xmath . Then, the probabilities @xmath\nare calculated from the binomial model:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn fact these probabilities can be calculated recursively, to save\ncomputing time:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand so\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe start with @xmath and compute the other probabilities, @xmath using\nthe above formula.\n\nWhen the training case is presented, the error is defined as\n\n  -- -------- -- -------\n     @xmath      (4.1)\n  -- -------- -- -------\n\nwhere @xmath and @xmath the true class of . The network is trained to\nminimize the average value over all training cases of such error.\nFinally, in the test phase, we choose the class @xmath which maximizes\nthe probability @xmath . As trivially confirmed, that simplifies to the\nrounding of @xmath to the nearest integer, where @xmath is the network\noutput.\n\n### 4.1 Connection with regression models\n\nConsider the following equivalences:\n\n@xmath\n\nLet @xmath the parameter that maximizes @xmath . For the binomial case\n@xmath . Then\n\n  -- -------- -- -------\n     @xmath      (4.2)\n  -- -------- -- -------\n\nand\n\n  -- -------- -- -------\n     @xmath      (4.3)\n  -- -------- -- -------\n\nboth attain the global optimal value at the same @xmath value. That is\nto say that the training of the network could be also performed by\nminimizing the error of the network output to the optimal parameter: a\nsimple case of regression of the parameter of the binomial distribution.\n\nNote that both approaches are not mathematically equivalent. Although\nthey share the same global optimum, the error surface is different and\nis natural that practical optimization algorithms stop at different\nvalues, maybe trapped at some local optimum value. Another way of\nlooking to the problem is to say that both are a regression of the\nparameter @xmath , using different error measures. The advantage of\nminimizing directly @xmath , or the squared version of it, is that it\nfits directly in existing software packages. However, both impose a\nunimodal distribution of the output probabilities.\n\nAs the above formulation suggests, the adjustment of any probability\ndistribution, dependent on a single parameter resumes to a regression of\nthat parameter against its optimal value. This approach is then part of\na larger set of techniques to estimate by regression any ordered scores\n@xmath \u2013 the simplest case would be the set of integers @xmath . [ 5 ,\n29 , 30 ]\n\nUsing a neural network with not one but two outputs, it is natural to\nextend the former reasoning to unimodal distribution with two\nparameters, as a greater flexibility should bring a better fitting to\nthe data. The training could be performed directly with some of the\nregression errors discussed above and the test phase would be just the\nselection of the mode class dictated by the network output.\n\n## Chapter 5 Experimental Results\n\nNext we present experimental results for several models based on SVMs\nand NNs, when applied to several datasets, ranging from synthetic\ndatasets, real ordinal data, to quantized data from regression problems.\n\n### 5.1 SVM based algorithms\n\nWe compare the following algorithms:\n\n-   A conventional multiclass SVM formulation (cSVM), based on the\n    one-against-one decomposition. The one-against-one decomposition\n    transforms the multiclass problem into a series of @xmath binary\n    subtasks that can be trained by a binary SVM. Classification is\n    carried out by a voting scheme.\n\n-   Pairwise SVM (pSVM): Frank and Hall [ 22 ] introduced a simple\n    algorithm that enables standard classification algorithms to exploit\n    the ordering information in ordinal prediction problems. First, the\n    data is transformed from a @xmath -class ordinal problem to @xmath\n    binary class problems. To predict the class value of an unseen\n    instance the probabilities of the @xmath original classes are\n    estimated using the outputs from the @xmath binary classifiers.\n\n-   Herbrich [ 27 ] model (hSVM), based on the correspondence of the\n    ordinal regression task and the task of learning a preference\n    relation on pairs of objects. A function loss was defined on pairs\n    of objects and the classification task formulated in this space. The\n    size of the new training set, derived from an @xmath -sized training\n    set, can be as high as @xmath . Only the direction was computed\n    directly from this model. Scalars @xmath were obtained in a second\n    step, performing a 1-dimensional SVM. Due to limitations of the\n    implementation of this method and its excessively long training\n    time, some results are not available (NA).\n\n-   Proposed ordinal method (oSVM), based on the data extension\n    technique, as previously introduced.\n\nExperiments were carried out in Matlab 7.0 (R14), using the Support\nVector Machine toolbox, version 2.51, by Anton Schwaighofer. This\ntoolbox was used to construct the oSVM classifier, the Herbrich [ 27 ]\nmodel and the pairwise SVM. It was also used the STPRtool, version 2.01,\nfor the implementation of the generic multiclass SVM. The @xmath and\n@xmath parameters were experimentally tuned for the best performance.\n\n### 5.2 Neural network based algorithms\n\nWe compare the following algorithms:\n\n-   Conventional neural network (cNN). To test the hypothesis that\n    methods specifically targeted for ordinal data improve the\n    performance of a standard classifier, we tested a conventional feed\n    forward network, fully connected, with a single hidden layer,\n    trained with the traditional least square approach and with the\n    special activation function softmax . For each case study, the\n    result presented is the best of the two configurations.\n\n-   Pairwise NN (pNN): mapping in neural networks the strategy of [ 22 ]\n    mentioned above for pSVM.\n\n-   Costa [ 31 ] , following a probabilistic approach, proposes a neural\n    network architecture (iNN) that exploits the ordinal nature of the\n    data, by defining the classification task on a suitable space\n    through a \u201cpartitive approach\u201d. It is proposed a feedforward neural\n    network with @xmath outputs to solve a @xmath -class ordinal\n    problem. The probabilistic meaning assigned to the network outputs\n    is exploited to rank the elements of the dataset.\n\n-   Proposed unimodal model (uNN). Several variants of the unimodal\n    model were gauged, ranging from one-parameter distributions, such as\n    the binomial and the poison, to two-parameter distributions, such as\n    the hypergeometric and the gaussian distribution. Other ideas such\n    as modifying a conventional neural network to penalise multimodal\n    outputs were also considered. However, models whose optimization did\n    not fit directly under a standard implementation of the\n    backpropagation algorithm were optimized with generic optimization\n    functions available in Matlab. Presumably due to that fact, the best\n    results were obtained when performing direct regression of the\n    binomial parameter, as in ( 4.3 ), for which we present the results.\n\n-   Proposed ordinal method (oNN), based on the data extension\n    technique, as previously introduced.\n\nExperiments were carried out in Matlab 7.0 (R14), making use of the\nNeural Network Toolbox. All models were configured with a single hidden\nlayer and trained with Levenberg-Marquardt back propagation method, over\n2000 epochs.\n\nThe number of neurons in the hidden layer was experimentally tuned for\nthe best performance.\n\n### 5.3 Measuring classifier performance\n\nHaving built a classifier, the obvious question is \u201chow good is it?\u201d.\nThis begs the question of what we mean by good. The obvious answer is to\ntreat every misclassification as equally likely, adopting the\nmisclassification error rate (MER) criterion to measure the performance\nof the classifier. However, for ordered classes, losses that increase\nwith the absolute difference between the class numbers are more natural\nchoices in the absence of better information [ 5 ] .\n\nThe mean absolute error (MAE) criterion takes into account the degree of\nmisclassification and is thus a richer criterion than MER. The loss\nfunction corresponding to this criterion is @xmath .\n\nA variant of the above MAE measure is the mean square error (MSE), where\nthe absolute difference is replaced with the square of the difference,\n@xmath .\n\nFinally, the performance of the classifiers was also assessed with the\nSpearman ( @xmath ) and Kendall\u2019s tau-b ( @xmath ) coefficients,\nnonparametric rank-order correlation coefficients well established in\nthe literature [ 32 ] . A proposal for yet another coefficient, @xmath ,\nwas also implemented. ^(\u2020) ^(\u2020) \u2020 The idea for this coefficient is\nthanks to Prof. Joaquim F. Pinto da Costa. To define @xmath , we start\nwith the @xmath data points @xmath and consider all @xmath pairs of data\npoints. Following the notation in [ 32 ] , we call a pair concordant if\nthe relative ordering of the ranks of the two @xmath \u2019s is the same as\nthe relative ordering of the ranks of the two @xmath \u2019s. We call a pair\ndiscordant if the relative ordering of the ranks of the @xmath \u2019s is\nopposite from the relative ordering of the ranks of the two @xmath \u2019s.\nIf there is a tie in either the ranks of the two @xmath \u2019s or the ranks\nof the two @xmath \u2019s, then we do not call the pair either concordant or\ndiscordant. If the tie is in the @xmath \u2019s, we will call the pair an\n\u201cextra @xmath pair\u201d, @xmath . If the tie is in the @xmath \u2019s, we will\ncall the pair an \u201cextra @xmath pair\u201d, @xmath . If the tie is both on the\n@xmath \u2019s and the @xmath \u2019s, we ignore the pair.\n\nInspired by the work of Lerman [ 33 , 34 ] , a simplified coefficient\nwas conceived from a set theoretic representation of the two variables\nto be compared. After a straight forward mathematical manipulation, the\n@xmath coefficient can be computed as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere the scale factor and bias are used just to set the parameter\nbetween @xmath and @xmath .\n\nThis expression shows a striking resemblance with the formula for\nKendall\u2019s @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n## Chapter 6 Results for a synthetic dataset\n\n### 6.1 Results for neural networks methods\n\nIn a first comparative study we generated a synthetic dataset in a\nsimilar way to Herbrich [ 27 ] .\n\nWe generated @xmath example points @xmath uniformly at random in the\nunit square @xmath . Each point was assigned a rank @xmath from the set\n@xmath , according to\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is a random value, normally distributed with zero mean and\nstandard deviation @xmath . Figure 6.1(a) shows the five regions and\nfigure 6.1(b) the points which were assigned to a different rank after\nthe corruption with the normally distributed noise.\n\nIn order to compare the different algorithms, and similarly to [ 27 ] ,\nwe randomly selected training sequences of point-rank pairs of length\n@xmath ranging from @xmath to @xmath . The remaining points were used to\nestimate the classification error, which were averaged over @xmath runs\nof the algorithms for each size of the training sequence. Thus we\nobtained the learning curves shown in figure 6.2 , for 5 neurons in the\nhidden layer.\n\n#### 6.1.1 Accuracy dependence on the number of classes\n\nTo investigate the relation between the number of classes and the\nperformance of the evaluated algorithms, we also ran all models on the\nsame dataset but with @xmath classes.\n\nThis time each point was assigned a rank @xmath from the set @xmath ,\naccording to\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is a random value, normally distributed with zero mean and\nstandard deviation @xmath . Figure 6.3(a) shows the ten regions and\nfigure 6.3(b) the points which were assigned to a different rank after\nthe corruption with the normally distributed noise.\n\nThe learning curves obtained for this arrangement are shown in figure\n6.4 (again, for 5 neurons in the hidden layer).\n\n#### 6.1.2 Accuracy dependence on the data dimension\n\nThe described experiments in @xmath were repeated for data points in\n@xmath , to evaluate the influence of data dimension on models\u2019 relative\nperformance.\n\nWe generated @xmath example points @xmath uniformly at random in the\nunit square in @xmath .\n\nFor @xmath classes, each point was assigned a rank @xmath from the set\n@xmath , according to\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is a random value, normally distributed with zero mean and\nstandard deviation @xmath .\n\nFinally, for @xmath classes the rank was assigned according to the rule\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is a random value, normally distributed with zero mean and\nstandard deviation @xmath . Class distributions are presented in figure\n6.5 ; the learning curves are shown in figures 6.6 and 6.7 , for 16\nneurons in the hidden layer.\n\n#### 6.1.3 Network complexity\n\nOne final point to make in any comparison of methods regards complexity.\nThe number of learnable parameters for each model is presented in table\n6.1 .\n\n### 6.2 Results for SVM methods\n\nBecause the comparative study for the SVM based methods followed the\nsame reasoning as for the neural network methods, we restrict to present\nhere the attained results in figures 6.8(a) , 6.8(b) , 6.8(c) and 6.8(d)\n. Because all classification indices portrayed essentially the same\nrelative performance, and to facilitate the comparison with results\npreviously reported in the literature, we will restrict here and in the\nfuture to the MER criterion.\n\n### 6.3 Discussion\n\nA first comment relates to the unfairness of comparing SVM to NN based\nmethods since the kernel parameters were illegally tuned to the\ndatasets. The main assertions concerns the superiority of all algorithms\nspecific to ordinal data over conventional methods, both for SVMs and\nNNs; the proposed method, in spite of being the simplest model, performs\nas good or better than the other models under comparison.\n\n## Chapter 7 Results for practical ordinal datasets\n\nThe next sections present results for datasets with real data.\n\n### 7.1 Pasture production\n\nThe next experiment is based on a publicly available dataset with\nreal-life data, available at the WEKA website ^(\u2020) ^(\u2020) \u2020\nhttp:\/\/www.cs.waikato.ac.nz\/ml\/weka\/ The information is a replica of the\nnotes made available with the data. . The objective was to predict\npasture production from a variety of biophysical factors. Vegetation and\nsoil variables from areas of grazed North Island hill country with\ndifferent management (fertilizer application\/stocking rate) histories\n(1973-1994) were measured and subdivided into 36 paddocks. Nineteen\nvegetation (including herbage production); soil chemical, physical and\nbiological; and soil water variables were selected as potentially useful\nbiophysical indicators \u2013 table 7.1 . The target feature, the pasture\nproduction, has been categorized in three classes (Low, Medium, High),\nevenly distributed in the dataset of 36 instances.\n\nThe results attained are summarized in table 7.2 . Before training, the\ndata was scaled to fall always within the range @xmath , using the\ntransformation @xmath . The fertiliser attribute was represented using 4\nvariables: LL = (1, 0, 0, 0), LN = (0, 1, 0, 0), HL = (0, 0, 1, 0) and\nHH = (0, 0, 0, 1).\n\nThe lack of motivation to impose an ordered relation in the fertiliser\nattribute, suggests a good scenario to apply the general version of the\ndata replication method, where only 21 attributes ( @xmath ) are\nconstrained to have the same direction, with the fertiliser attribute\nleft free. Using a linear kernel with @xmath ( @xmath , @xmath ) emerges\na classifier with expected MER of 22.2%. This way, a very simple\nclassifier was obtained at the best performance.\n\n### 7.2 Employee selection: the ESL dataset\n\nThe next experiment is also based on a publicly dataset available at the\nWEKA website. The ESL dataset contains @xmath profiles of applicants for\ncertain industrial jobs. Expert psychologists of a recruiting company,\nbased upon psychometric test results and interviews with the candidates,\ndetermined the values of the input attributes ( @xmath attributes, with\ninteger values from @xmath to @xmath ). The output is an overall score (\n@xmath ) corresponding to the degree of fitness of the candidate to this\ntype of job, distributed according to figure 7.1 .\n\nThe comparative study of the learning algorithms followed the same\nreasoning as for the synthetic datasets; therefore we restrict to\npresent here the attained results for the MER criterion \u2013 figures 7.2(a)\nand 7.2(b) .\n\nIn the pasture dataset conventional methods performed as well as ordinal\nmethods, while algorithms based on SVMs clearly outperformed NN based\nalgorithms \u2013 an expected result if we attend to the limited number of\nexamples in the dataset. On the other side, for the ESL dataset, there\nis no discernible difference between SVM and NN based algorithms, but\nconventional methods are clearly behind specific methods for ordinal\ndata.\n\n### 7.3 Aesthetic evaluation of breast cancer conservative\ntreatment444Some portions of this section appeared in [6, 23].\n\nIn this section we illustrate the application of the learning algorithms\nto the prediction of the cosmetic result of breast cancer conservative\ntreatment.\n\nBreast cancer conservative treatment (BCCT) has been increasingly used\nover the last few years, as a consequence of its much more acceptable\ncosmetic outcome than traditional techniques, but with identical\noncological results. Although considerable research has been put into\nBCCT techniques, diverse aesthetic results are common, highlighting the\nimportance of this evaluation in institutions performing breast cancer\ntreatment, so as to improve working practices.\n\nTraditionally, aesthetic evaluation has been performed subjectively by\none or more observers [ 35 , 36 , 37 ] . However, this form of\nassessment has been shown to be poorly reproducible [ 38 , 39 , 40 , 41\n] , which creates uncertainty when comparing results between studies. It\nhas also been demonstrated that observers with different backgrounds\nevaluate cases in different ways [ 42 ] .\n\nObjective methods of evaluation have emerged as a way to overcome the\npoor reproducibility of subjective assessment and have until now\nconsisted of measurements between identifiable points on patient\nphotographs [ 38 , 43 , 41 ] . The correlation of objective measurements\nwith subjective overall evaluation has been reported by several authors\n[ 39 , 40 , 41 , 44 ] . Until now though, the overall cosmetic outcome\nwas simply the sum of the individual scores of subjective and objective\nindividual indices [ 45 , 39 , 40 , 44 ] .\n\n#### 7.3.1 Data and method\n\nInstead of heuristically weighting the individual indices in an overall\nmeasure, we introduced pattern classification techniques to find the\ncorrect contribution of each individual feature in the final result and\nthe scale intervals for each class, constructing this way an optimal\nrule to classify patients.\n\n##### Reference classification\n\nTwenty-four clinicians working in twelve different countries were\nselected, based on their experience in BCCT (number of cases seen per\nyear and\/or participation in published work on evaluation of aesthetic\nresults). They were asked to evaluate individually a series of 240\nphotographs taken from 60 women submitted to BCCT (surgery and\nradiotherapy). Photographs were taken (with a 4M digital camera) in four\npositions with the patient standing on floor marks: facing, arms down;\nfacing, arms up; left side, arms up; right side, arms up \u2013 figure 7.3 .\n\nParticipants were asked to evaluate overall aesthetic results,\nclassifying each case into one of four categories: excellent \u2013 treated\nbreast nearly identical to untreated breast; good \u2013 treated breast\nslightly different from untreated; fair \u2013 treated breast clearly\ndifferent from untreated but not seriously distorted; poor \u2013 treated\nbreast seriously distorted [ 35 ] .\n\nIn order to obtain a consensus among observers, the Delphi process was\nused [ 46 , 47 ] . Evaluation of each case was considered consensual\nwhen more than 50% of observers provided the same classification. When\nthis did not occur, another round of agreement between observers was\nperformed. By means of the Delphi process each and every patient was\nclassified in one of the four categories (table 7.3 ): poor , fair ,\ngood , and excellent .\n\nThe evaluation of two individual aesthetic characteristics, scar\nvisibility and colour dissimilarities between the breasts, were asked to\nthe panel, using the same grading scale: excellent ; good ; fair ; poor\n.\n\n##### Feature Selection\n\nAs possible objective features we considered those already identified by\ndomain experts as relevant to the aesthetic evaluation of the surgical\nprocedure [ 38 , 43 ] . The cosmetic result after breast conserving\ntreatment is mainly determined by visible skin alterations or changes in\nbreast volume or shape. Skin changes may consist of a disturbing\nsurgical scar or radiation-induced pigmentation or telangiectasia [ 43 ]\n. Breast asymmetry was assessed by Breast Retraction Assessment (BRA),\nLower Breast Contour (LBC) or Upward Nipple Retraction (UNR) \u2013 figure\n7.4 .\n\nBecause breast asymmetry was insufficient to discriminate among\npatients, we adopted the mean of the scar visibility and skin colour\nchange, as measured by the Delphi panel, as additional features to help\nin the separation task, as we had not yet established the evaluation of\nthose features by quantitative methods [ 23 ] .\n\n##### Classifier\n\nThe leave one out method [ 8 ] was selected for the validation of the\nclassifiers: the classifier is trained in a round-robin fashion, each\ntime using the available dataset from which a single patient has been\ndeleted; each resulting classifier is then tested on the single deleted\npatient.\n\nWhen in possession of a nearly separable dataset, a simple linear\nseparator is bound to misclassify some points. But the real question is\nif the non-linearly-separable data indicates some intrinsic property of\nthe problem (in which case a more complex classifier, allowing more\ngeneral boundaries between classes may be more appropriate) or if it can\nbe interpreted as the result of noisy points (measurement errors,\nuncertainty in class membership, etc), in which case keeping the linear\nseparator and accept some errors is more natural. Supported by Occam\u2019s\nrazor principle (\u201cone should not increase, beyond what is necessary, the\nnumber of entities required to explain anything\u201d), the latter was the\noption taken in this research.\n\n#### Datasets\n\nA fast visual checking of the quality of the data (figure 7.5 ) shows\nthat there is a data value that is logically inconsistent with the\nothers: an individual (patient @xmath ) labeled as good when in fact it\nis placed between fair and poor in the feature space. The classifiers\nwere evaluated using datasets with and without this outlier in order to\nassess the behaviour in the presence of noisy examples.\n\nIn summary, results are reported for six different datasets: { LBC (arms\ndown); scar visibility (mean); skin colour change (mean)}, { BRA (arms\ndown); scar visibility (mean); skin colour change (mean)}, { UNR (arms\ndown); scar visibility (mean); skin colour change (mean)}, each with\n@xmath and @xmath examples. In [ 23 ] other datasets were evaluated,\nshowing similar behaviour.\n\n#### Results\n\nThe bar graph 7.6 summarizes the generalization error estimated for each\nclassifier. It is apparent that algorithms specially designed for\nordinal data perform better than generic algorithms for nominal classes.\nIt is also noticeable the superiority of the LBC measure over the other\nasymmetry measures under study to discriminate classes.\n\n## Chapter 8 Results for datasets from regression problems\n\nBecause of the general lack of benchmark datasets for ordinal\nclassification, we also performed experiments with datasets from\nregression problems, by converting the target variable into an ordinal\nquantity. The datasets were taken from a publicly available collection\nof regression problems ^(\u2020) ^(\u2020) \u2020 The datasets were selected from\nhttp:\/\/www.liacc.up.pt\/~ltorgo\/Regression\/DataSets.html .\n\n### 8.1 Abalone dataset\n\nThe goal is to predict the age of abalone from physical measurements.\n^(\u2021) ^(\u2021) \u2021 The information is a replica of the notes for the abalone\ndataset from the UCI repository. The age of abalone is determined by\ncutting the shell through the cone, staining it, and counting the number\nof rings through a microscope \u2013 a boring and time-consuming task. Other\nmeasurements, which are easier to obtain, are used to predict the age.\nFurther information, such as weather patterns and location (hence food\navailability) may be required to solve the problem.\n\nExamples with missing values were removed from the original data (the\nmajority missing the predicted value), and the ranges of the continuous\nvalues have been scaled for the use with an artificial neural network\n(by dividing by 200). The sex attribute was represented as @xmath ,\n@xmath , @xmath . The characteristics of the dataset are summarized in\ntable 8.1 , where are listed the attribute name, attribute type, the\nmeasurement unit and a brief description; the class distribution is\ndepicted in figure 8.1 .\n\nThe results obtained, table 8.3 , can be confronted with results\nreported in previous studies \u2013 table 8.2 .\n\nIf it is true that generally we might prefer simpler models for\nexplanation at the same performance \u2013 a parsimonious representation of\nthe observed data \u2013, then the simple weighted sum of the attributes\nyielded by the data replication method is clearly in advantage.\n\n### 8.2 CPU performance dataset\n\nThe goal is to predict the relative CPU performance. From the 10 initial\nattributes 6 were used as predictive attributes and 1 as the goal field,\ndiscarding the vendor name, model name and estimated relative\nperformance from the original article. The characteristics of the fields\nused are summarized in table 8.4 , for the 209 instances.\n\nBefore training, the predictive attributes were scaled to fall always\nwithin the range @xmath , using the transformation @xmath . The results\nobtained, table 8.6 , can be confronted with results reported in\nprevious studies \u2013 table 8.5 .\n\nThese results continue to suggest the merit of specific methods for\nordinal data over conventional methods, attaining the best performance\nat the greatest simplicity.\n\n## Chapter 9 Conclusion\n\nThis study focuses on the application of machine learning methods, and\nin particular of neural networks and support vector machines, to the\nproblem of classifying ordinal data. Two novel approaches to train\nlearning algorithms for ordinal data were presented. The first idea is\nto reduce the problem to the standard two-class setting, using the so\ncalled data replication method , a nonparametric procedure for the\nclassification of ordinal categorical data. This method was mapped into\nneural networks and support vector machines. Two well-known approaches\nfor the classification of ordinal categorical data were unified under\nthis framework, the minimum margin principle [ 4 ] and the generic\napproach by Frank and Hall [ 22 ] . Finally, it was also presented a\nprobabilistic interpretation for the neural network model.\n\nThe second idea is to retain the ordinality of the classes by imposing a\nparametric model for the output probabilities. The introduced unimodal\nmodel, mapped to neural networks, was then confronted with established\nregression methods.\n\nThe study compares the results of the proposed models with conventional\nlearning algorithms for nominal classes and with models proposed in the\nliterature specifically for ordinal data. Simple misclassification, mean\nabsolute error, root mean square error, Spearman and Kendall\u2019s tau-b\ncoefficients are used as measures of performance for all models and used\nfor model comparison. The new methods are likely to produce simpler and\nmore robust classifiers, and compare favourably with state-of-the-art\nmethods. However, the reported results must be taken with caution. In\nmost of the experiments the effort to find the correct setting for the\nparameters of the algorithms was limited (although unbiased among\nmethods). So, although reasonable conclusions are drawn from the\nexperiments, we do not wish to overstate our claims.\n\nThis thesis has covered the multiclass classification accuracy and\nclassifier simplicity, but a brief word on speed is in order. Comparing\ndifferent machine learning algorithms for speed is notoriously\ndifficult; we are simultaneously judging mathematical algorithms and\nspecific implementations. However, some useful general observations can\nbe made. Empirically, SVM training time tends to be superlinear in the\nnumber of the training points [ 48 ] . Armed only with this assumption,\nit is a simple exercise to conclude that the complexity of the data\nreplication formulation is placed between the simple approach of Frank\nand Hall and the pairwise of Herbrich.\n\nAn issue intentionally avoided until now was the very own definition of\nordinal classes. Although we do not wish to delve deeply on that now, a\nfew comments are in order.\n\nApparently, a model that restricts the search to noncrossing boundaries\nis too restrictive, imposing unnecessary and unnatural constraints on\nthe solution, limiting this way the feasible solutions to a subset of\nwhat we would expect to be a valid solution to an ordinal data problem.\nOn the other side, the unimodal model, more plausible and intuitive,\nseems to capture better the essence of the problem. However, it is a\nsimple exercise to verify that the unimodal model does not allow\nboundaries\u2019 intersections \u2013 the intersection point would indicate an\nexample where three or more classes are equally probable. For that\nreason, the unimodal model (parametric or not) seems to be a subset of\nthe noncrossing boundaries model. It is also reasonable to accept that\neach noncrossing boundary solution may be explained by, at least, an\nunimodal model (however, there is not a bijection between the two, as\ndifferent unimodal models may lead to the same noncrossing boundary\nsolution; in fact, non-unimodal models may also lead to noncrossing\nboundaries).\n\nIt is visible here a resemblance with the parallelism between parametric\nclassifiers that must estimate the probability density function for each\nclass in order to apply the bayes likelihood ratio test and classifiers\nthat specify the mathematical form of the classifier (linear, quadratic,\netc), leaving a finite set of parameters to be determined.\n\nWe are not advocating any model in particular. Pragmatically, see them\nas two more tools: only testing will say which is best in a specific\nmachine learning problem.\n\nFinally, as all unfinished jobs, this also leaves some interesting\nanchors for future work. As mentioned in this thesis, several unimodal\nmodels were implemented making use of a generic optimization function\navailable in Matlab. It would be most interesting to adapt the\nbackpropagation method to all unimodal models and perform a fair\ncomparison. The data replication method is parameterised by @xmath (and\n@xmath ); because it may be difficult and time consuming to choose the\nbest value for @xmath , it would be interesting to study possible ways\nto automatically set this parameter, probably as a function of the data\nand @xmath . It would also be interesting to study if these algorithms\ncan be successfully applied to nominal data. Although the data\nreplication method was designed for ordinal classes, nothing impedes its\napplication to nominal classes. It is expected that the classifier\nshould be evaluated for each possible order of the classes, choosing the\none conducting to the best performance (feasible only when the number of\nclasses is small). A systematic study of decision trees\u2019 algorithms for\nordinal data is also indispensable. It would be a significant\naccomplishment to map the models introduced in this thesis to decision\ntrees.\n","output":["Classification of ordinal data is one of the most important tasks of relation\nlearning. In this thesis a novel framework for ordered classes is proposed. The\ntechnique reduces the problem of classifying ordered classes to the standard\ntwo-class problem. The introduced method is then mapped into support vector\nmachines and neural networks. Compared with a well-known approach using\npairwise objects as training samples, the new algorithm has a reduced\ncomplexity and training time. A second novel model, the unimodal model, is also\nintroduced and a parametric version is mapped into neural networks. Several\ncase studies are presented to assert the validity of the proposed models.","Predictive learning has traditionally been a standard inductive\nlearning, where different sub-problem formulations have been identified.\nOne of the most representative is classification , consisting on the\nestimation of a mapping from the feature space into a finite class\nspace. Depending on the cardinality of the finite class space we are\nleft with binary or multiclass classification problems. Finally, the\npresence or absence or a \u201cnatural\u201d order among classes will separate\nnominal from ordinal problems.\n\nAlthough two-class and nominal classification problems have been\ndissected in the literature, the ordinal sibling has not yet received a\nlot of attention, even with many learning problems involving classifying\nexamples into classes which have a natural order. Scenarios in which it\nis natural to rank instances occur in many fields, such as information\nretrieval, collaborative filtering, econometric modeling and natural\nsciences.\n\nConventional methods for nominal classes or for regression problems\ncould be employed to solve ordinal data problems; however, the use of\ntechniques designed specifically for ordered classes yields simpler\nclassifiers, making it easier to interpret the factors that are being\nused to discriminate among classes, and generalises better. Although the\nordinal formulation seems conceptually simpler than nominal, some\ntechnical difficulties to incorporate in the algorithms this piece of\nadditional information \u2013 the order \u2013 may explain the widespread use of\nconventional methods to tackle the ordinal data problem.\n\nThis dissertation addresses this void by proposing a nonparametric\nprocedure for the classification of ordinal data based on the extension\nof the original dataset with additional variables, reducing the\nclassification task to the well-known two-class problem. This framework\nunifies two well-known approaches for the classification of ordinal\ncategorical data, the minimum margin principle and the generic approach\nby Frank and Hall. It also presents a probabilistic interpretation for\nthe neural network model. A second novel model, the unimodal model, is\nalso introduced and a parametric version is mapped into neural networks.\nSeveral case studies are presented to assert the validity of the\nproposed models.\n"]}
{"input":"## Chapter 1 Introduction\n\n### 1.1 Background and Research Motivation\n\nDengue is a vector-borne disease which is transmitted by mosquitoes.\nApproximately two thirds of the world\u2019s population is living in\ndengue-endemic regions, with around 390 million individuals infected\nannually [ 10 ] .\n\nThere are four serotypes of dengue: DEN1, DEN2, DEN3, and DEN4.\nIndividuals infected with one of the serotypes obtain life long immunity\nto that serotype, but only temporary immunity to the other serotypes.\nWhen infected with a second serotype, individuals are at greater risk of\ndeveloping severe forms of dengue such as Dengue Haemmorhagic Fever\n(DHF) and Dengue Shock Syndrome (DSS). Interactions between dengue\nserotypes may affect dengue transmission dynamics because of differences\nin epidemiological characteristics, and disease severity [ 92 , 4 , 79 ,\n87 , 74 , 27 ] between serotypes.\n\nFluctuations in mosquito populations due to climatic factors such as\ntemperature and rainfall results in seasonality in dengue transmission\ndynamics. In areas and regions where dengue is not endemic, but\nmosquitoes reside, dengue outbreaks are triggered by imported cases [ 46\n, 54 ] . These are individuals who have acquired dengue overseas and\nbrought it to the non-endemic regions. After mosquitoes are exposed to\ndengue, a certain period of time is required for the dengue viruses to\nreplicate in the mosquito\u2019s body so that the mosquito can transmit the\ndisease. This period is known as the extrinsic incubation period (EIP).\n\nA number of strategies for controlling dengue have been implemented, but\nthey are difficult to sustain [ 31 , 66 , 78 , 77 , 55 ] , particularly\nin the developing world. For example, the use of insecticides has become\nlargely ineffective as mosquitoes have developed resistance to the\nchemicals [ 31 , 66 , 55 ] . Therefore, new control strategies are\nnecessary.\n\nOne strategy that has been recently proposed is to infect mosquito\npopulations with the Wolbachia bacterium [ 11 , 62 , 67 , 41 , 94 , 29 ]\n. There are two mechanisms by which Wolbachia can work to control dengue\ntransmission. First, Wolbachia impairs the ability of the dengue virus\nto replicate inside the mosquito [ 11 , 67 , 41 , 94 , 29 ] ,\nparticularly in salivary gland [ 94 ] . Consequently, the ability of\nWolbachia -carrying mosquitoes to transmit dengue viruses can be\nreduced. Second, Wolbachia reduces the mosquito\u2019s lifespan [ 111 , 94 ]\n. As a result, the mosquito\u2019s lifespan may be lower than the extrinsic\nincubation period (EIP) so the transmission will not occur. However, in\norder for this intervention to be successful, it is necessary for\nWolbachia -carrying mosquitoes to be established and persist in the\nfield.\n\nStudies utilising mathematical models have suggested that Wolbachia\n-carrying mosquitoes are likely to persist in the field [ 70 , 34 , 33 ,\n17 ] . This has been confirmed by field experiments [ 39 , 41 , 94 ] .\nAn open question that then arises is \u201cto what extent can Wolbachia\nreduce dengue transmission?\u201d. This question forms the central focus of\nthis thesis.\n\nTo measure the effectiveness of Wolbachia in reducing dengue at the\npopulation level is challenging since many factors such as seasonality,\nimportation of dengue and dengue serotype characteristics affect dengue\ntransmission dynamics. An efficient way to measure the effectiveness of\nWolbachia is by the use of a mathematical model. A mathematical model\nallows us to determine the underlying causes of outbreaks and to\nunderstand the effectiveness of the control strategies that have been\nimplemented. To date, few studies have used mathematical models to\nunderstand the effect of Wolbachia in reducing dengue transmission, and\nhence our models will provide new insight on the effectiveness of\nWolbachia in reducing dengue at a population level. Further, we shall\ninvestigate the effects of seasonality, dengue importation, and dengue\nserotype characteristics, which have received relatively little\nattention.\n\nWe are particularly interested in quantifying the effectiveness of\nWolbachia -carrying mosquitoes on the reduction of dengue incidence once\ntheir population has been established. As a result, we shall assume that\nWolbachia -carrying mosquitoes persist and are established in the\npopulation, and shall not investigate the spread of mosquitoes carrying\nWolbachia into the population in this thesis.\n\nThroughout this thesis, the terminology \u201cdengue\/disease introduction\u201d\nrefers to dengue\/ disease importation. For clarity, two things should be\nnoted. When studying the effects of Wolbachia in the presence of a\nsingle dengue serotype, single and multiple dengue introductions mean\nthat we introduce a single dengue serotype once and multiple times,\nrespectively. Second, when studying the effects of Wolbachia in the\npresence of two dengue serotypes, dengue cases are introduced multiple\ntimes, with different dengue serotypes. The term, \u201cdengue introduction\nscenarios\u201d is used to refer to the manner in which a particular dengue\nserotype is introduced into the population.\n\n### 1.2 Research Aims\n\nThe main question addressed in this thesis is \u201cto what extent can\nWolbachia reduce dengue transmission?\u201d. This has been approached by\nformulating novel mathematical models in the absence and presence of\nWolbachia -carrying mosquitoes for single and two dengue serotypes. The\nspecific aims of this thesis are to:\n\n1.  [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n2.  Determine the level of reduction in dengue incidence caused by the\n    presence of Wolbachia -carrying mosquitoes.\n\n3.  Explore the effects of seasonality and other important parameters on\n    dengue transmission dynamics and the persistence of Wolbachia\n    -carrying mosquitoes.\n\n4.  Determine the effects of dengue introduction scenarios on the\n    performance of Wolbachia in reducing dengue incidence.\n\n5.  Investigate the effects of two dengue serotypes and dengue serotype\n    characteristics on the performance of Wolbachia in reducing dengue\n    incidence.\n\n### 1.3 Contributions\n\nThe novel contributions of this thesis are as follows.\n\n1.  [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n2.  Deterministic mathematical models of scenarios incorporating one and\n    two dengue serotypes in the absence and presence of Wolbachia\n    -carrying mosquitoes are produced, incorporating sinusoidally forced\n    death rates for the mosquitoes. These models take into account\n    important biological features of dengue and Wolbachia . The models\n    are used to study the effectiveness of Wolbachia in reducing the\n    incidence of dengue at a population level. Furthermore, these models\n    serve as a baseline for further investigation of Wolbachia\n    interventions. To the best of our knowledge, the two serotype dengue\n    model in the presence of Wolbachia is the first population level\n    model to investigate the effectiveness of Wolbachia in the presence\n    of more than one dengue serotype.\n\n3.  The important parameters of the models that drive dengue epidemics,\n    are determined using sensitivity analysis through the standard\n    combination of Latin Hypercube Sampling and Partial Rank Correlation\n    Coefficient (LHS\/PRCC) [ 13 , 56 , 103 ] , where the parameters\n    relative significances are ranked. These findings will be useful to\n    guide future data collections to better inform future models.\n\n4.  The ranges of biologically realistic parameter values, which\n    determine the persistence of Wolbachia -carrying mosquitoes and\n    dengue epidemics, are calculated. These findings confirm the\n    potential Wolbachia strains that can persist in the field, and also\n    the maximum benefits of Wolbachia for the different parameter\n    values.\n\n5.  The level of reduction in dengue incidence due to Wolbachia\n    intervention is determined by comparing the relative difference of\n    the outbreak sizes in the absence and presence of Wolbachia\n    -carrying mosquitoes. We estimate the level of reduction in dengue\n    incidence due to Wolbachia in scenarios where one and two dengue\n    serotypes are present. In the single serotype scenario, the levels\n    of dengue incidence reduction after single and multiple\n    introductions of dengue are determined. In the presence of two\n    dengue serotypes, the levels of dengue incidence reduction for\n    serotypes with symmetric and asymmetric epidemiological\n    characteristics are determined.\n\n### 1.4 Outline of the Thesis\n\nIn the next chapter, we present a review of literature related to this\nthesis, and then in the subsequent six chapters, we present the original\ncontributions of this thesis. These contributions are divided into two\nparts corresponding to the presence of one (Chapters 3 - 5 ) and two\n(Chapters 6 \u2013 8 ) dengue serotypes in the population. The final chapter\ndiscusses the conclusions drawn and future directions for research. A\nbrief overview of the contents of each chapter is given below.\n\nChapter 2 : Literature Review\nA review of literature is presented in this chapter. Chapter 2 contains\nreviews of relevant literature from two main viewpoints: biological and\nmathematical reviews. The biological literature reviewed presents\nbackground information about dengue, dengue vectors and Wolbachia . The\nmathematical reviews provide background on the deterministic SIR model,\nvector-borne disease modelling, seasonality, the basic reproduction\nnumber, and introduce models specific for Wolbachia population dynamics\nand models for dengue epidemiology in the absence and presence of\nWolbachia -carrying mosquitoes.\n\nChapter 3 : Mathematical Modelling of a Single Dengue Serotype\nThis chapter contains the full derivation of our single serotype dengue\nmodels in the absence and presence of Wolbachia -carrying mosquitoes.\nThe assumptions and important features of these models are described.\nThe models are an extension of previously published models by Ndii et\nal. [ 70 ] ^(*) ^(*) * This work was conducted during my Masters study\nat the ANU and introduce a human population in which dengue is present\nas well as seasonally varying death rates for adult mosquitoes. These\nmodels are then used to study the effect of single and multiple dengue\nintroductions, which are presented in Chapter 4 and Chapter 5 ,\nrespectively. The expressions for the basic and effective reproduction\nnumbers for these models are also derived.\n\nChapter 4 : Dengue Transmission Dynamics for a Single Introduction Event\nIn this chapter, the performance of Wolbachia in reducing dengue\nincidence after a single introduction of dengue cases is investigated.\nThe parameter estimation is also presented. We justify the parameter\nvalues chosen and explore the parameter spaces of several parameters. A\nglobal sensitivity analysis for the model is also conducted, and we\ncompare the reproduction numbers obtained in the absence and presence of\nWolbachia -carrying mosquitoes.\n\nChapter 5 : Dengue Transmission Dynamics for Multiple Introductions\nIn this chapter, we investigate multiple introductions of dengue cases\nover weekly, year-round and three month periods, and assess the\nperformance of Wolbachia in reducing dengue in these scenarios. We then\ninvestigate the potential for an outbreak, and the effects of the\ntransmission rate and seasonality on Wolbachia performance in reducing\ndengue. We also compare the effective reproduction number and our\nsimulations where dengue cases are introduced for one week of the year.\n\nChapter 6 : Mathematical Modelling of Two Dengue Serotypes\nAfter studying the performance of Wolbachia in reducing dengue incidence\nwhen only a single dengue serotype circulates, we turn our attention to\nthe performance of Wolbachia in reducing dengue in the presence of two\ndengue serotypes. We begin by developing two serotype dengue models in\nthe absence and presence of Wolbachia -carrying mosquitoes. These models\ntake into account antibody-dependent enhancement (ADE) and temporary\nimmunity. As a reminder for readers, we re-describe the parameter values\nused in our investigation. The models are then used to study the effects\nof the symmetric and asymmetric epidemiological characteristics of\ndengue serotypes which are presented in Chapters 7 and 8 , respectively.\n\nChapter 7 : Two Serotypes with Symmetric Epidemiological Characteristics\nIn this chapter, the symmetric epidemiological characteristics of dengue\nserotypes under different disease introduction scenarios are\ninvestigated. Two disease introduction scenarios are considered. First,\nindividuals carrying dengue serotype\u00a01 are introduced into the\npopulation at weekly intervals for one year, and then individuals\ncarrying another dengue serotype are introduced into the population at\nweekly intervals for another year. Second, individuals carrying dengue\nserotype\u00a01 are introduced into the population at weekly intervals over a\nperiod of two years, and then individuals carrying another dengue\nserotype are introduced into the population at weekly intervals over a\nfurther two year period. We explore the effects of the\nantibody-dependent enhancement and the transmission probability on\nWolbachia performance in reducing dengue incidence in these two\nscenarios.\n\nChapter 8 : Two Serotypes with Asymmetric Epidemiological\nCharacteristics.\nIn this chapter, we study the performance of Wolbachia in reducing\ndengue incidence when the epidemiological characteristics of dengue\nserotypes differ. As in Chapter 7 , we explore the effects of the\nantibody-dependent enhancement and the transmission probability on\nWolbachia performance in reducing dengue incidence.\n\nChapter 9 : Conclusions and Future Directions\nIn this chapter, we summarise the original results discovered in this\nthesis, present our conclusions and suggest several possible future\ndirections for research.\n\n## Chapter 2 Literature Review\n\nThe review of literature presented in this chapter is divided into two\nparts: a review of biological literature and a review of mathematical\nliterature. The biological literature review introduces dengue (Section\n2.1.1 ), the dengue vector (Section 2.1.2 ), and Wolbachia (Section\n2.1.3 ). The mathematical literature review explains the deterministic\nSIR model (Section 2.2.1 ), vector-borne disease modelling (Section\n2.2.2 ), the inclusion of seasonality in compartmental models (Section\n2.2.3 ), the basic reproduction number (Section 2.2.4 ), and introduces\na model for Wolbachia population dynamics (Section 2.2.5 ), a model for\ndengue in the absence (Section 2.2.6 ) and presence of Wolbachia\n(Section 2.2.7 ), and the Latin Hypercube Sampling (LHS) and Partial\nRank Correlation Coefficient (PRCC) methods (Section 2.2.8 ).\n\nWhen material from this review is required in later chapters, we shall\nreference the appropriate sections so that the interested reader can\nreview the details.\n\n### 2.1 Biological Review\n\nThis section presents background information about dengue, dengue\nvectors and Wolbachia .\n\n#### 2.1.1 Dengue\n\nDengue is a vector borne disease that is transmitted by mosquitoes, and\nhas attracted public health concern worldwide. Over 40% of the world\u2019s\npopulation are living in dengue-endemic regions and approximately 390\nmillion individuals are infected with dengue annually [ 10 ] .\nInfections with the dengue virus can lead to dengue fever (DF), dengue\nhaemorrhagic fever (DHF) and dengue shock syndrome (DSS), the last two\nof which are the most severe forms of dengue. The fatality rates for DHF\nand DSS can be as high as 20%, although this can be reduced to less than\n1% if the proper treatment is accessible [ 102 ] , which is generally in\ndeveloped countries.\n\nThe number of dengue cases is increasing worldwide [ 75 , 45 , 64 ] .\nFor example, in Australia, there has been an increasing trend in the\nnumber of dengue cases over the last two decades, an increase from\naround 17 in 1991 to over 1000 in 2015 [ 75 ] . In dengue endemic\ncountries there are also increasing numbers of dengue cases. In\nIndonesia, the incidence of dengue has been increasing since 1968 [ 45 ]\n. In Malaysia, the number of dengue cases increased by 14% annually from\n2000\u20132010 [ 64 ] .\n\nIn regions or countries where dengue is not endemic, outbreaks of the\ndisease are triggered by imported cases. These are individuals who have\nacquired dengue overseas. In Australia, local outbreaks are generally\ncaused by imported cases, with an estimated 1132 overseas-acquired cases\nof dengue entering Australia in 2010 [ 46 ] . In Taiwan, dengue\noutbreaks begin by importation of dengue. The disease then spreads until\ntransmission ends in winter due to the cold weather. The same pattern is\nrepeated every year [ 54 ] . These examples highlight the effect of\ndengue importation on disease transmission dynamics.\n\nThere are four serotypes of dengue viruses: DEN1, DEN2, DEN3 and DEN4.\nIndividuals obtain lifelong immunity to a given dengue serotype after\ninfection with it, and have a short-term antibody response to the other\nserotypes, which lasts for around 2\u20139 months [ 96 ] . If they are\nsubsequently infected by a different serotype, they are likely to\ncontract DHF or DSS. Patients with a severe form of dengue show peak\nviraemia levels (levels of the virus in the blood) 100\u20131000 times higher\nthan DF patients [ 92 ] .\n\nDHF is associated with the antibody dependent enhancement (ADE) of\ndengue virus replications. The ADE mechanism is as follows. An\nindividual who is primarily infected by a particular serotype will\nproduce neutralising antibodies to that serotype, but when the same\nindividual is secondarily infected with other serotypes, the\npre-existing antibodies to the previous infection do not neutralise, but\nrather enhance, the replication of the secondary virus [ 98 , 68 ] . ADE\nmay result in higher transmissibility rates of dengue from humans to\nmosquitoes.\n\nThere is variability in the epidemiological characteristics of the four\ndengue serotypes, and the severity of the disease varies between\nserotypes [ 92 , 4 , 79 , 87 , 74 , 27 ] . Nishiura and Halstead [ 74 ]\nfound that DEN1 infection causes more severe symptoms than DEN4, while\nTricou et al. [ 87 ] found that infections with DEN1 result in higher\nviraemia levels than infections with DEN2. Estimates of the basic\nreproduction numbers from serological data showed relatively little\ndifference between dengue serotypes [ 27 , 79 ] .\n\nThe distribution and the dominance of dengue serotypes in a given\noutbreak varies over time. In Thailand, all four dengue serotypes\ncirculated during the period 2000-2010, with DEN3 being dominant during\nthe periods 2000\u20132002 and 2008\u20132010, whereas DEN4 was most common\nbetween 2003 and 2008 as reported by Limkittikul et al . [ 53 ] . In\nMalaysia, DEN1 was dominant during 2004 and 2005, but was overtaken by\nDEN2, which was dominant during 2006 and 2007. Although all four dengue\nserotypes were circulating in 2014, none of them was dominant [ 64 ] .\nIn Taiwan, DEN2 dominated during 2002 and 2003, DEN3 dominated during\n2005\u20132006, and DEN1 dominated in 2004 and 2007 [ 54 ] . More information\nabout dengue epidemics in several countries can be found in the\nliterature (see, for example, [ 93 , 14 , 52 , 22 ] ).\n\nIn general, the characteristics of DF infection are high fever with a\ntemperature of approximately @xmath , severe headache, pain behind the\neyes, muscle and joint pains, nausea, vomiting, swollen glands or rash.\nThese symptoms last for approximately 2\u20137 days. People with a severe\nform of dengue exhibit all DF symptoms, together with plasma leakage,\nfluid accumulation, respiratory distress, severe bleeding, or organ\nimpairment, symptoms which may lead to death if proper treatment is not\nadministered [ 102 ] .\n\nThe dynamics of dengue transmission are very seasonal due to\nfluctuations in the dengue vector caused by climatic factors such as\ntemperature and rainfall. Furthermore, there are differences between\nregions or countries in the periods when epidemics occur. For example,\nin Thailand, the number of cases peaks between May and September each\nyear as reported by Limkittikul et al. [ 53 ] . In Taiwan, the peak is\naround October and then incidence diminishes around December [ 54 ] .\n\nThere are several important aspects to be considered when studying\ndengue dynamics at a population level: importation of dengue, dengue\nserotype characteristics and the seasonal factors which affect the\nmosquito population dynamics.\n\n#### 2.1.2 Dengue Vectors\n\nTwo vectors that transmit dengue are Aedes albocpictus and Aedes aegypti\n. The latter is considered to be the main vector. Aedes albocpictus\nmostly lives in rural areas and large water containers. Aedes aegypti is\nhighly anthropophilic, preferring to feed on humans only, and lives in\nurban and semi urban areas which are densely populated. Aedes aegypti\nmoves only short distances of around 300 @xmath during its lifetime [ 36\n] .\n\nFigure 2.1 shows the Aedes aegypti lifecycle, which consists of eggs,\nlarvae, pupae, young adult and adult Aedes aegypti . In modelling, eggs,\nlarvae and pupae are commonly grouped into one category because only\nadult mosquitoes can transmit dengue and the dengue virus cannot\ninfluence the aquatic stage of development. The mosquito life cycle is\nhighly dependent on climatic conditions such as temperature and\nrainfall. Figures 2.2 \u2013 2.3 show the plots of the aquatic death rate and\nthe adult mosquito death rate against temperature given by Yang et al. [\n108 , 109 ] . These figures show that the aquatic death rate and the\nadult mosquito death rate vary as the temperature changes. Figure 2.2\nshows that the aquatic death rate is high when the temperature is less\nthan approximately @xmath or greater than @xmath . The adult death rate\nis very high when the temperature is below @xmath (see Figure 2.3 ).\n\nWhen feeding on an infected human, Aedes aegypti ingests viraemic blood.\nAfter a period of time known as the Extrinsic Incubation Period (EIP),\nthe salivary glands of the mosquito become infected. During the EIP the\nviruses replicate and are internally disseminated within the mosquito.\nThe EIP varies depending on temperature, but on average lasts for one to\ntwo weeks [ 95 , 16 ] . Infected mosquitoes are able to transmit dengue\nif they live longer than the EIP. When an infected mosquito bites a\nsusceptible human, the human becomes exposed, but not yet infectious,\nfor approximately 4\u20137 days and then becomes infectious for the following\n3\u20137 days. If susceptible mosquito subsequently feeds on the infectious\nhuman, the cycle continues.\n\nTo date, no vaccines against dengue are commercially available. Although\nhuman behavioural changes can be helpful in reducing dengue\ntransmission, most interventions against dengue focus on vector control.\nA number of strategies have been implemented to control vector\npopulations, but they are difficult to sustain [ 31 , 66 , 78 , 77 , 55\n] , particularly in the developing world. Insecticides, for example,\nbecome less effective as mosquitoes develop resistance to the chemicals\n[ 31 , 66 , 55 ] . The removal of mosquito breeding sites is another\nintervention that has been carried out, but this must be repeated often,\nas has been found in Cairns and Singapore [ 78 , 77 ] . A promising\nstrategy against dengue is the Wolbachia intervention [ 11 , 62 , 67 ,\n41 , 94 , 29 ] . Details about Wolbachia are presented in the following\nsub-section.\n\n#### 2.1.3 Wolbachia\n\nThis section discusses the Wolbachia bacterium, its characteristics, and\neffects on mosquitoes and the dengue virus.\n\nWolbachia is a genus of bacteria which has infected around 66% of all\ndifferent species of insects [ 38 ] , but does not naturally infect\nAedes aegypti , the main vector transmitting dengue. Infecting Aedes\naegypti with Wolbachia has been found to reduce dengue viral load in\nmosquitoes [ 11 , 67 , 41 , 94 , 29 , 110 ] . Consequently, it has been\nproposed as a strategy to reduce the spread of dengue.\n\nWolbachia are maternally inherited intracellular bacteria that\nmanipulate the reproduction of a diverse range of arthropod hosts. One\nform of reproductive manipulation caused by Wolbachia infection is known\nas cytoplasmic incompatibility (CI) [ 86 , 97 , 41 , 94 ] . CI gives a\nfemale Aedes aegypti mosquito a reproductive advantage, the details of\nwhich are given below.\n\n1.  [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n2.   Wolbachia -carrying female mosquitoes produce viable offspring when\n    mating with either Wolbachia -carrying or non- Wolbachia male\n    mosquitoes, and immature mosquitoes mature to non Wolbachia and\n    Wolbachia -carrying mosquitoes.\n\n3.  Non- Wolbachia female mosquitoes can only reproduce successfully\n    with non- Wolbachia male mosquitoes, and immature mosquitoes mature\n    to non- Wolbachia mosquitoes only.\n\n4.  If non- Wolbachia female mosquitoes mate with Wolbachia -carrying\n    males, they cannot produce offspring successfully, although an\n    embryo is formed, further blocking reproduction [ 94 ] .\n\nLaboratory experiments have been conducted to assess the effects of\nWolbachia on Aedes aegypti . Two Wolbachia strains were used in these\nexperiments: WMelPop and WMel [ 41 , 88 , 94 , 90 ] . WMelPop halves the\nmosquito lifespan [ 111 , 94 ] and reduces egg viability [ 63 ] .\nWMelPop has been found to reduce blood feeding success [ 89 ] .\nFurthermore, a fecundity cost of up to 56% has been found in WMelPop\n-carrying mosquitoes [ 61 , 94 ] . By contrast, WMel reduces the\nmosquito lifespan by approximately 10% [ 94 ] , does not influence the\ntime development of Aedes aegypti and has no significant effect on egg\nviability after oviposition [ 94 ] . Both strains of Wolbachia have the\nability to reduce the levels of dengue viruses in the salivary glands of\nAedes aegypti [ 67 , 94 ] .\n\nIf Wolbachia causes a marked reduction in the mosquito lifespan,\nmultiple introductions of Wolbachia -carrying mosquitoes may be required\nto ensure Wolbachia persistence in the wild. The elapsed time between\nintroductions and the number of released mosquitoes determines the\nlikelihood of persistence [ 34 ] . The release of more males than\nfemales can also lead to Wolbachia persistence [ 35 , 113 ] .\n\nResults from field experiments show that Wolbachia -carrying mosquitoes\ncan persist [ 39 , 41 ] . These results suggest that the population of\nWolbachia -carrying mosquitoes can stabilise over time, and hence,\npotentially reduce dengue transmission. Furthermore, the proportion of\nWolbachia -carrying mosquitoes in the field has been found to be around\n90% in comparison to non- Wolbachia mosquitoes [ 41 , 39 ] . Moreover,\nthe maternal transmission of Wolbachia may be perfect or near to\nperfect, as seen in field trials [ 39 ] . Lower rates of infection with\ndengue viruses of serotypes 1\u20133 in mosquitoes carrying Wolbachia have\nalso been found.\n\nIn summary, there are several important characteristics of Wolbachia\nthat can affect the population dynamics of mosquitoes, namely\ncytoplasmic incompatibility (CI), the mosquito death rate and the\nmaternal transmission. Dengue-related characteristics such as reduced\nbiting rates, and reduced levels of dengue virus in mosquitoes are also\nkey to the potential reduction in dengue transmission.\n\n### 2.2 Mathematical Review\n\nThis section presents the mathematical theory used in this thesis. This\nincludes a formulation of the deterministic SIR model, an explanation of\nseasonality, and discussions of vector-borne disease modelling, the\nbasic reproduction number, a model specific for Wolbachia and dengue\ndynamics, and the latin hypercube sampling (LHS) and partial rank\ncorrelation coefficient (PRCC) methods for multivariate analysis.\n\n#### 2.2.1 The Deterministic SIR model\n\nA deterministic formulation of the SIR model is presented in this\nsection. A deterministic model is appropriate when studying disease\ntransmission dynamics in large populations, as is the case throughout\nthis thesis. The SIR model has been used as a cornerstone for the\ndevelopment of compartment-based models. The general principle of\ncompartment-based models is that the population is divided into\ndifferent sub-populations, according to their disease status. In the SIR\nmodel, the population is divided into three sub-populations, namely\nSusceptible (S), Infectious (I) and Removed (R).\n\nLet us consider the simple SIR model without demography and assume\nhomogenous and well-mixed populations. Humans are born susceptible to\ninfection and move to the infectious class at a rate @xmath after\ncontact with infectious individuals. After a period of time @xmath ,\nthey recover. This SIR model is governed by the following system of\ndifferential equations\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      (2.1)\n     @xmath   @xmath      (2.2)\n     @xmath   @xmath      (2.3)\n  -- -------- -------- -- -------\n\nwhere @xmath and @xmath are positive constants. Here the parameter\n@xmath represents a combination of the rate at which contact between\nsusceptible and infectious people is made and the probability that\ncontact results in the successful transmission of the disease, while the\nparameter @xmath is the recovery rate.\n\nWe can determine the threshold above which an epidemic occurs by\nrearranging the infected population equation (Equation 2.2 ), that is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIt is easy to see that the critical threshold is @xmath , where the\npopulations of @xmath and @xmath are in proportions. When an infectious\ncase is introduced to the population, an epidemic will proceed if the\nsusceptible population is higher than this critical threshold, otherwise\nan outbreak cannot occur. The inverse of this critical threshold is\ncalled the basic reproduction number (further explained in subsection\n2.2.4 ), which is defined to be the number of new cases generated by a\ntypical infectious individual in an entirely susceptible population.\n\nThe classical SIR model can be extended by adding other classes,\ndepending on the purpose of the model and the characteristics of the\ndisease being studied. For example, if a disease has a latent period,\none may add a latent compartment to the system of equations. Another\npossible extension would be to include demographic factors such as birth\nand death rates. As additional details are incorporated into the model,\nit becomes more complex, and typically the calculation of the basic\nreproduction number is conducted by constructing the next generation\nmatrix and finding the spectral radius of that matrix as described in\nSection 2.2.4 . Although some analytical expressions such as the steady\nstate or the critical threshold can be derived, deriving analytical\nsolutions in terms of S and I simultaneously is not straightforward [ 47\n] . This is particularly true when models become increasingly complex as\nadditional important features are included. One way to find the\nsolutions of a deterministic model is by the use of computational tools.\nThroughout this thesis, we use Matlab [ 58 ] to generate the solutions\nof the models.\n\n#### 2.2.2 Vector-borne Disease Modelling\n\nSome diseases such as malaria, chikungunya, and dengue are transmitted\nto humans via a vector and consequently their transmission dynamics are\naffected by the population dynamics of the vector. At the population\nlevel, the transmission dynamics of vector-borne diseases can be\ninvestigated using mathematical models [ 105 , 104 , 60 , 72 ] .\nDeterministic models provide one technique for modelling the\ntransmission dynamics of vector-borne diseases, particularly in large\npopulations. The simple SIR model presented in Section 2.2.1 can be\nextended into such a model by including the vector population and\nintroducing parameters which adjust for the biological features of the\nvectors and the disease. A review on vector-borne disease mathematical\nmodels can be found in Smith et al. [ 83 ] .\n\nWhen more than one vector is involved in the transmission of a disease,\nthe biological features of each vector such as its transmission rate,\nand birth and death rates influence disease transmission. In this\nthesis, we construct deterministic mathematical models including two\ntypes of mosquitoes: mosquitoes not carrying Wolbachia and mosquitoes\ncarrying Wolbachia (referred throughout this thesis as \u201cnon- Wolbachia \u201d\nand \u201c Wolbachia -carrying\u201d mosquitoes, respectively), together with the\nhuman population with dengue, and use these models to investigate the\nspread of dengue. We focus on the situation where an outbreak occurs and\nmeasure the reduction in the number of people infected due to the\nintroduction of Wolbachia -carrying mosquitoes.\n\n#### 2.2.3 Seasonality\n\nThe transmission of infectious diseases varies seasonally depending on\nvarious factors. Climatic fluctuation contributes to the seasonal\ndynamics of many infectious diseases because it affects pathogen\ntransmission rates [ 49 ] . For vector-borne diseases, climatic factors\nare linked to the fluctuation of vector populations and, hence, to\nvector-borne disease transmission.\n\nIn most mathematical models, the seasonal effect is captured by the use\nof sinusoidal and\/or square wave functions. For example, seasonal\nvariation in the transmission rate can be represented using a sinusoidal\nfunction such as\n\n  -- -------- -- -------\n     @xmath      (2.4)\n  -- -------- -- -------\n\nwhere @xmath is the transmission rate which varies seasonally, @xmath is\nthe average transmission rate, and @xmath is the amplitude of seasonal\nforcing of the transmission rate or \u201cstrength of seasonality\u201d and lies\nbetween @xmath and @xmath .\n\nSeasonal variation can also be modelled using a square wave function\nsuch as\n\n  -- -------- -- -------\n     @xmath      (2.5)\n  -- -------- -- -------\n\nwhere each year is divided into two different seasons: the high season\nand the low season. The parameter @xmath represents the degree of\nseasonality which varies between 0 and 1 (see [ 25 , 48 , 71 , 76 , 85 ]\n).\n\n#### 2.2.4 Basic Reproduction Number\n\nThe basic reproduction number is an important quantity in\nepidemiological modelling which is commonly estimated when data is\navailable [ 30 , 19 ] . The basic reproduction number, generally denoted\nby @xmath , is defined to be the number of secondary cases generated by\na typical infectious individual in an entirely susceptible population.\nThe expression for the basic reproduction number can be obtained by\nconstructing the next generation matrix (NGM) for the model [ 23 , 24 ,\n91 , 37 ] and finding its dominant eigenvalue. Another method to derive\nthe basic reproduction number for a non-seasonal model is to use the\n\u201csurvival function\u201d. However, this method becomes increasingly difficult\nwhen there are more infectious states and hence the use of the next\ngeneration approach is more appropriate [ 37 ] .\n\nDiekmann et al. [ 24 ] give a clear explanation of how to construct the\nNGM, which they denote by @xmath . The decomposition of the NGM relates\nto epidemiologically new infections only. For example, changes in the\npopulation in a model with latent and infectious compartments consist of\nnew infections into the latent compartment and members of the population\nmoving from the latent to the infectious compartment. The change from\nthe latent to the infectious compartment is not a new infection. A\nmatrix whose decomposition relates to the expected offspring of\nindividuals in any infected state is called a next generation matrix\nwith large domain and denoted by @xmath . Diekmann et al. showed that\nthe largest eigenvalue of the next generation matrix with large domain\nis equal to that of the next generation matrix, @xmath , and hence, to\nthe basic reproduction number, @xmath .\n\nThe steps for finding the basic reproduction number given in Diekmann et\nal . [ 24 ] are the following.\n\n1.  Let @xmath be the number of infected states, and @xmath be the\n    possible infected states of individuals. We write a linearised\n    infected subsystem around the disease-free steady state in the form\n\n      -- -------- -- -------\n         @xmath      (2.6)\n      -- -------- -- -------\n\n    where @xmath is the transmission matrix, which encodes the\n    production of new infection, and @xmath is the transition matrix,\n    which encodes the transition of infected individuals between\n    compartments including those that transfer out of compartments for\n    reasons such as the death of the individual.\n\n2.  The next generation matrix with large domain can be found using the\n    formula @xmath . The basic reproduction number is calculated by\n    finding the spectral radius of the matrix @xmath .\n\n#### 2.2.5 Mathematical Models for Wolbachia Population Dynamics\n\nA number of mathematical models have been developed to provide insight\ninto the population dynamics of Wolbachia -carrying mosquitoes [ 34 , 33\n, 17 , 70 , 112 , 113 , 57 ] . Hancock et al. [ 34 ] developed a\nmathematical model to explore the host population dynamics and Wolbachia\ninfection frequency with both single and multiple introductions\n(\u201cseeding\u201d) of Wolbachia -carrying mosquitoes. The same authors also\ndeveloped a metapopulation model to explore spatial dynamics and found\nthat spatial variations in density-dependent competition have an effect\non the spread of Wolbachia infection [ 33 ] . Chan and Kim [ 17 ]\ndeveloped a spatial mathematical model incorporating both slow and fast\ndispersal situations for the spread of mosquitoes. They found that\ntemperature affects the speed of Wolbachia invasion and that the death\nrate of Wolbachia -carrying mosquitoes influences their persistence.\nZhang et al. [ 112 ] developed a birth-pulse model of Wolbachia spread\nconsidering cyptoplasmic incompatibility and different density dependent\ndeath rates. They found that it is likely that mosquitoes carrying\nWolbachia will invade the population. Zheng et al. [ 113 ] developed a\nmathematical model to analyse the release of Wolbachia -carrying\nmosquitoes into the population, and found that the release of minimal\nnumbers of mosquitoes with Wolbachia can lead to persistence of\nWolbachia -carrying mosquitoes.\n\nNdii et al. [ 70 ] developed a mathematical model of mosquito population\ndynamics in the presence of Wolbachia which incorporated the effects of\nCI in the mating function and competition for resources in the aquatic\nstage. They found that Wolbachia -carrying mosquitoes and non- Wolbachia\nmosquitoes can coexist, and showed that the steady state where Wolbachia\n-carrying mosquitoes alone persist only exists when maternal\ntransmission is perfect, a finding which was confirmed by Chan and Kim [\n17 ] . Rodriguez et al. [ 57 ] used a mathematical model to analyse the\nchanges in the proportion of Wolbachia -carrying mosquitoes during the\nhost\u2019s life cycle on the dynamics of the spread of Wolbachia , and found\nthat the spread of Wolbachia may be affected by these changes.\n\nIn this thesis, we extend the model of Ndii et al. [ 70 ] to include a\nhuman population in which dengue is present. The extended model is used\nto investigate the performance of Wolbachia in reducing dengue. The\nmodel for mosquito population dynamics in the presence of Wolbachia\n-carrying mosquitoes as given by Ndii et al. [ 70 ] is governed by the\nfollowing differential equations\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (2.7)\n     @xmath   @xmath      (2.8)\n     @xmath   @xmath      (2.9)\n     @xmath   @xmath      (2.10)\n     @xmath   @xmath      (2.11)\n     @xmath   @xmath      (2.12)\n  -- -------- -------- -- --------\n\nwhere @xmath . Here @xmath , @xmath and @xmath denote aquatic, male and\nfemale mosquitoes, respectively, and the subscripts @xmath and @xmath\ndifferentiate between non- Wolbachia and Wolbachia -carrying mosquitoes.\nThe parameters @xmath and @xmath denote the respective proportions of\nnon- Wolbachia and Wolbachia -carrying mosquitoes that are male.\n\nThe effect of CI is represented by the following equations. Non-\nWolbachia aquatic mosquitoes are produced after non- Wolbachia male and\nfemale mosquitoes mate. The population\u2019s growth is limited by the\ncarrying capacity @xmath through the term\n\n  -- -------- -- --------\n     @xmath      (2.13)\n  -- -------- -- --------\n\nThe fact that Wolbachia -carrying females reproduce after mating with\nnon- Wolbachia or Wolbachia -carrying males is represented by the term\n\n  -- -------- -- --------\n     @xmath      (2.14)\n  -- -------- -- --------\n\nFurthermore, the effects of imperfect maternal transmission are also\nincluded in the model. That is, not all Wolbachia aquatic mosquitoes\nmature to be Wolbachia -carrying adult mosquitoes. A proportion of them\nmature to be non- Wolbachia adults. This proportion is represented by\nthe parameter @xmath . A proportion @xmath of the Wolbachia aquatic\nmosquitoes that mature to become non- Wolbachia mosquitoes become male\nand the rest become female mosquitoes.\n\n#### 2.2.6 Mathematical Models for Dengue in the Absence of Wolbachia\n\nA number of dengue models have been developed and analysed. A review of\nvarious deterministic dengue models can be found in Andraud et al. [ 6 ]\n. Dengue models were split into two categories: vector-host and\nhost-to-host transmission.\n\nTo capture the effect of seasonality, a sinusoidal function is generally\nused [ 60 , 5 ] . For example, McLennan-Smith and Mercer [ 60 ]\ndeveloped a mathematical model for dengue which included seasonality in\nthe transmission rate. The model was found to have increasingly complex\nbehaviour as the strength of seasonality was increased. Andraud et al. [\n5 ] used a periodically-forced model to estimate parameter values using\ndata from Singapore. They found a good fit between the output from the\nmodel and the data from Singapore, and showed that seasonality is an\nimportant factor driving dengue dynamics.\n\nYang and Ferreira [ 107 ] developed a dengue mathematical model with\nvariation in some parameter values over time. The parameters were set to\ndifferent values to represent favourable and unfavourable conditions for\nthe development of mosquitoes. Their model divided aquatic and adult\nmosquito populations into six compartments: eggs, larvae, pupae,\nsusceptible, exposed and infectious adults. They found that, although\ndengue persists in favourable conditions, there is a gap of several\nyears between successive outbreaks of dengue.\n\nSeveral studies have investigated the effects of introducing individuals\nwith dengue into the population [ 99 , 9 ] . Bannister-Tyrrell et al. [\n9 ] investigated the variation of dengue activity in Australia using a\nprocess based modelling approach in which dengue was introduced\nbimonthly, monthly and weekly. They found that increasing the frequency\nof introductions of dengue results in larger outbreaks. Williams et al.\n[ 99 ] used an existing dengue model, which involved an entomological\ncomponent (CIMSiM) and a disease component (DENSiM), to assess the\neffects of the importation rate on dengue outbreaks. They conducted\nweekly introductions with the number of imported dengue cases ranging\nfrom 1\u201325 individuals. They found that higher rates of importation each\nweek result in increased monthly dengue incidence. However, these\nstudies did not investigate the importation of different serotypes of\ndengue, a factor which is known to affect dengue transmission dynamics\nand have effects on secondary infections.\n\nA number of mathematical models considering multiple serotypes of dengue\nhave been developed [ 26 , 21 , 12 , 1 , 65 , 50 , 3 , 42 , 100 ] . An\nimportant issue that arises when investigating disease dynamics in the\npresence of multiple serotypes of dengue is the effect of antibody\ndependent enhancement (ADE) on dengue dynamics. Adams and Boots [ 1 ]\nused a two-serotype dengue model to study dengue transmission dynamics,\nand found that the enhancement of transmission does not lead to the\nexclusion of either serotype when both serotypes have the same basic\nreproduction number. Ferguson et al. [ 26 ] found that enhancement may\npermit the coexistence of all serotypes. Woodall and Adams [ 100 ]\ndeveloped a model in which they assumed that only small fraction of\nprimarily infected humans became susceptible to enhanced secondary\ninfection. They found that antibody-dependent enhancement may not be\ndriving the oscillatory dynamics of dengue. Aguiar et al. [ 3 ]\ndeveloped a seasonal multiple serotype dengue model and performed a\ncomparison study between non-seasonal, low seasonal and high seasonal\nmodels with a low importation rate of infected individuals. They found\ncomplex dynamics, and a match between empirical DHF monitoring data and\nmodel simulations. Romero et al. [ 65 ] found that the presence of ADE\nheterogenity can facilitate the persistence of dengue serotypes. Kooi et\nal. [ 50 ] used a mathematical model to analyse the characteristics of\ntwo dengue serotypes for which the force of infection differs. They\nconcluded that models that include the assumption of identical\nepidemiological characteristics are useful when the difference between\ndengue serotype characteristics is not great, otherwise an exploration\nof different (asymmetric) epidemiological characteristics is required.\nHowever, most of these studies did not consider different disease\nintroduction strategies (or Wolbachia ).\n\nMost multiple serotype dengue models do not take vector population\ndynamics into account. Hu et al. [ 42 ] investigated the effect of\nincluding the mosquito population and the host incubation period on the\ndynamics of dengue when multiple serotypes are circulating. In this\nhost-only model, they found a large degree of frequency instability\nwhich made future predictions difficult. However, this behaviour\ndisappears when the vector is included in the model. Their findings\nemphasize the importance of including vectors of dengue in mathematical\nmodels.\n\nAnother area of deficiency in the mathematical literature lies in the\nscarcity of studies investigating Wolbachia intervention using\nmathematical models which include both non- Wolbachia and Wolbachia\n-carrying mosquitoes. Given that the presence of multiple serotypes of\ndengue has been observed to influence dengue dynamics, a study of the\neffectiveness of the Wolbachia intervention in reducing dengue in the\npresence of more than one dengue serotype is also worthwhile.\n\n#### 2.2.7 Mathematical Models for Dengue in the Presence of Wolbachia\n\nFew mathematical models have been developed that couple a model of the\nWolbachia -carrying mosquito population with a human dengue model [ 43 ,\n35 ] . Hughes et al. [ 43 ] developed a mathematical model considering\nthe situation where only either non- Wolbachia or Wolbachia -carrying\nmosquitoes persist in the population. They found that Wolbachia can be a\npowerful control for dengue when @xmath is not too large ( @xmath ).\nHancock et al. [ 35 ] explored a scenario of Wolbachia release and its\neffects on vector-borne diseases, but did not specifically consider\ndengue. They found that the male-biased release of Wolbachia -carrying\nmosquitoes can reduce disease transmission. Ferguson et al. [ 28 ]\nformulated and estimated a basic reproduction number ( @xmath ) for\ndengue, and found that Wolbachia can reduce the basic reproduction\nnumber by 66\u201375 %. A reduction of the basic reproduction number by 66\u201375\n% should be sufficient to reduce dengue incidence in areas with low to\nmoderate transmission settings, that is, with typical @xmath [ 28 ] .\nHowever, if @xmath , a reduction of 66-75% still results in @xmath and\nhence, dengue outbreaks can still occur. Although the effective\nreproduction number is still higher than unity, the presence of\nWolbachia can still reduce the number of dengue cases, though the\nproportional reduction in dengue incidence is not high.\n\nThe existing studies have not investigated the effect of disease\nintroduction scenarios on Wolbachia performance. This is important as\nthe introduction of dengue into the population is irregular, and it is\nuncertain which dengue serotypes will enter the population at any given\ntime. If the characteristics of dengue serotypes differ [ 92 , 4 , 79 ,\n87 , 74 , 27 ] , undertanding the effects of these factors on Wolbachia\nperformance in reducing dengue incidence is important. To our knowledge,\nno population level models have been developed to study the performance\nof Wolbachia in reducing dengue incidence when more than one dengue\nserotype circulates. In this thesis, we develop models in which two\ndengue serotypes circulate and study the performance of Wolbachia in\nreducing dengue incidence under these conditions.\n\n#### 2.2.8 Latin Hypercube Sampling and Partial Rank Correlation\nCoefficient\n\nThe degree of certainty in models for infectious disease dynamics is not\nalways known. Although some parameter values can be estimated from data,\nthere remains uncertainty in estimates. Other parameter values are\ndifficult to estimate from data. For example, data sets generally do not\nprovide information on the number of asymptomatic cases, or the exact\ntime a pathogen infects people. Therefore, it is important to conduct\nsensitivity analyses of the model parameters in order to determine which\nparameters have the greatest effects on the model outcomes of interest,\nand to assess the likely impact of changes in parameters within\nreasonable bounds.\n\nIf the inputs such as parameters or initial conditions are known with\nlittle uncertainty, we can estimate the degree of uncertainty in the\noutput by finding the partial derivative of the output function with\nrespect to the input parameters [ 56 , 18 ] . This is known as a local\nsensitivity analysis. In epidemiological models, most parameters are\nvery uncertain, and so a global sensitivity analysis is more\nappropriate.\n\nLatin Hypercube Sampling (LHS), in conjuction with Partial Rank\nCorrelation Coefficient (PRCC) multivariate analysis [ 56 , 13 ] , is\noften used for global sensitivity analysis. LHS is a stratified Monte\nCarlo sampling method, where the random parameter distributions are\ndivided into @xmath equal probability intervals [ 56 , 103 , 13 , 59 ] .\nHere @xmath is the sample size. Each interval of each parameter is\nsampled only once without replacement, and the entire range of each\nparameter is explored [ 56 , 103 , 13 , 59 ] . Inputs and outputs are\nthen ranked before PRCC indices are determined.\n\nSuppose we have @xmath parameters and @xmath samples. Then the LHS\nmatrix, @xmath , and the output, @xmath , are\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHere the output is calculated from the solution of the mathematical\nmodel using the input parameters given in the matrix. We can rank the\nsamples of each parameter (the entries in each row of the matrix @xmath\n), and the entries of the output @xmath , in order of increasing size to\ngive matrices\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwith entries @xmath and @xmath , where @xmath is the rank of parameter\n@xmath in our parameter sample ordering and @xmath is the rank of output\n@xmath in the ordering of our output values.\n\nThe partial rank correlation coefficient between @xmath and @xmath\n@xmath is found using the formula [ 20 , 56 ]\n\n  -- -------- -- --------\n     @xmath      (2.15)\n  -- -------- -- --------\n\nwhere @xmath and @xmath are the sample means, and @xmath .\n\nThe partial rank correlation coefficient is then inspected to assess the\nsensitivity of the parameters. If the coefficient is close to 1 or -1,\nthe parameters are more sensitive, with negative values indicating an\ninverse relationship between the inputs and outputs. For example, an\nincrease in the inputs leads to a decrease in outputs, and conversely.\nAs the PRCC measures the nonlinear but monotonic relationships between\ninputs and outputs, then the output should be increasing monotonic\nfunction. In our analysis, the output is the cumulative number of\ninfectious humans.\n\nSignificance tests can be performed to assess whether PRCC ( @xmath ) is\nsignificantly different from zero. This is tested using the statistic [\n20 , 13 ]\n\n  -- -------- -- --------\n     @xmath      (2.16)\n  -- -------- -- --------\n\nIf the PRCC value is higher than the T-test value, it is statistically\nsignificant.\n\n### 2.3 Summary\n\nThis chapter is summarised in two sections, covering biological and\nmathematical reviews.\n\n#### 2.3.1 Biological Aspects\n\n1.  [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n2.  The increasing number of dengue cases in many countries is an\n    indication of the threat it poses.\n\n3.  There are four dengue serotypes. Individuals infected by one of the\n    seroptypes gain life long immunity to that serotype, but are more\n    likely to develop a more severe form of dengue called Dengue\n    Haemorhagic Fever (DHF) or Dengue Shock Syndrome (DSS) when they are\n    later infected by other serotypes. A particular risk associated with\n    secondary infections is higher viral loads, which can lead to higher\n    transmissibility and death.\n\n4.   Aedes albopictus and Aedes aegypti are mosquitoes that transmit\n    dengue. The latter is considered to be the main vector. The death\n    rate of mosquitoes is environmentally-dependent.\n\n5.   Wolbachia gives female mosquitoes a reproductive advantage, known\n    as cytoplasmic incompatibility (CI). Wolbachia reduces the lifespan\n    of mosquitoes by up to 50% for the WMelPop strain and 10% for the\n    WMel strain. It also reduces the reproductive rate and viral load in\n    the mosquitoes.\n\n6.  The higher death rates for mosquitoes carrying Wolbachia may result\n    in Wolbachia -carrying mosquitoes being unable to persist in the\n    field.\n\n7.  Little research has been conducted to investigate potential\n    reductions in dengue when the Wolbachia intervention is implemented\n    in the field.\n\n8.  The times of importation of dengue into the population are\n    irregular, and the dengue serotypes that enter the population are\n    uncertain.\n\n9.  Little research has considered the effects of different disease\n    importation strategies on Wolbachia performance in reducing dengue.\n\n#### 2.3.2 Mathematical Aspects\n\n1.  [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n2.  A deterministic model can be utilised to understand disease\n    transmission dynamics, in particular, for large populations.\n\n3.  The basic reproduction number @xmath is the average number of new\n    cases generated by one infected individual in an entirely\n    susceptible population. @xmath is used to determine whether\n    epidemics can occur.\n\n4.  Mathematical models for single and multiple serotypes of dengue have\n    been developed, but only a few include a Wolbachia -carrying\n    mosquito population.\n\n5.  Seasonal effects can be captured using sinusoidal or square wave\n    functions.\n\n6.  A global sensitivity analysis is highly relevant as most parameters\n    of epidemiological models are very uncertain. Latin Hypercube\n    Sampling, in conjunction with the Partial Rank Correlation\n    Coefficient calculation, can be used to understand the sensitivity\n    of the outcome variables to the input parameters.\n\n7.  Only a few mathematical models have been developed to study the\n    effect of Wolbachia on dengue transmission dynamics.\n\n8.  Very few mathematical models have been developed to study the\n    performance of Wolbachia in reducing dengue when more than one\n    dengue serotype circulates in the population.\n\n## Part 1: A Single Dengue Serotype\n\nIn part 1 of this thesis, we investigate the performance of Wolbachia in\nreducing the incidence of dengue in populations where a single dengue\nserotype is circulating. The focus is on single and multiple\nintroductions of dengue cases into the population. This part comprises\nChapters 3 \u2013 5 , and the results are summarised below.\n\n### Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   Single serotype dengue transmission models in the absence and\n    presence of Wolbachia -carrying mosquitoes are developed in Sections\n    3.1 (Equations\u00a0( 3.1 )\u2013( 3.8 )) and 3.2 (Equations\u00a0( 3.18 )\u2013( 3.29\n    )), respectively.\n\n-   We estimated parameter values for the model against data from\n    Cairns, Australia, presented in Table 4.1 , Section 4.5.1 .\n\n-   Sensitivity analyses, conducted in Sections 4.5.1 and 4.5.2 ,\n    reveals that the transmission probability, the biting rate and the\n    average adult mosquito death rate are the most influential\n    parameters (see Figures 4.3 and 4.4 ).\n\n-   Using the WMel strain allows Wolbachia -carrying mosquitoes to\n    persist according to our steady state analysis of the model (Section\n    4.2 , Figure 4.1 ).\n\n-   We show in Section 4.5.4 that Wolbachia reduces the number of days\n    at which the reproduction number is higher than unity ( @xmath ) by\n    up to 78 days (Section 4.5.4 , Figure 4.6 ).\n\n-    Wolbachia introduction reduces the lengths of the potential seasons\n    in which epidemics occur by up to six weeks as shown in Section\n    5.2.1 , Figure 5.2 .\n\n-    Wolbachia is effective in reducing dengue incidence by up to 80% in\n    areas or regions with low and medium seasonality and moderate\n    transmission rates as shown in Sections 5.2.2 and 5.2.3 , Figures\n    5.3 and 5.4 , respectively.\n\n## Chapter 3 Mathematical Modelling of a Single Dengue Serotype***The\nmodels are part of the manuscripts that have been published as\n\u201cModelling the transmission dynamics of dengue in the presence of\nWolbachia\u201d, Meksianis Z. Ndii, R. I. Hickson, David Allingham, G.N.\nMercer, in Mathematical Biosciences (2015) and submitted as \u201cThe effect\nof Wolbachia on dengue outbreaks when dengue is repeatedly introduced\u201d,\nMeksianis Z. Ndii, David Allingham, R.I. Hickson, Kathryn Glass.\n\nIn this chapter, seasonal dengue models for a single serotype in the\nabsence and presence of Wolbachia -carrying mosquitoes are developed.\nThe models are an extension of the model developed by Ndii et al. [ 70 ]\nfor mosquito populations, which was reviewed in Section 2.2.5 . The aim\nof this chapter is to present a full derivation and important features\nof the models. In Chapters 4 and 5 we shall use these models to\ninvestigate the effects of Wolbachia on dengue transmission dynamics\nunder single and multiple introductions of dengue.\n\n### 3.1 Model in the Absence of Wolbachia\n\nIn this section we formulate the baseline model, that is, the model in\nthe absence of Wolbachia -carrying mosquitoes. Our model includes\npopulations of humans and non- Wolbachia mosquitoes.\n\nThe human and mosquito populations in this model are assumed to be\nhomogeneous and well-mixed, and we assume that only one dengue serotype\nis circulating. The model comprises human and vector (mosquito)\npopulations, with births and seasonally forced deaths for the adult\nmosquito population. As the ratio between male and female mosquitoes is\napproximately 1.02:1 [ 7 ] , the numbers of male and female mosquitoes\nare assumed to be equal. As only female mosquitoes feed on blood from\nhumans as part of their reproductive cycle, only female mosquitoes can\ntransmit dengue. Consequently, this model only considers female\nmosquitoes. Vertical transmission of dengue in mosquitoes can occur\n(see, for example, [ 44 , 51 ] ), however this tends to be at low levels\n[ 51 ] , and there is no evidence this level changes with the\nintroduction of Wolbachia , and so we ignore vertical transmission. A\nschematic representation of the model is given in Figure 3.1 . Here the\nsubscript @xmath denotes the human population and the subscript @xmath\ndenotes the non- Wolbachia mosquito population.\n\nThe human population is divided into four subpopulations, namely\nSusceptible ( @xmath ), Exposed ( @xmath ), Infectious ( @xmath ) and\nRecovered ( @xmath ). Furthermore, a constant human population size is\nassumed, and hence human birth and death rates are assumed to be equal,\nthat is, @xmath and @xmath .\n\nThe mosquito population is divided into subpopulations of Aquatic (\n@xmath ) comprised of eggs, larvae and pupae, Susceptible ( @xmath ),\nExposed ( @xmath ) and Infectious ( @xmath ) mosquitoes. The total adult\nfemale mosquito population is @xmath . The subscript @xmath is used to\ndenote non- Wolbachia mosquitoes. We use this subscript here for\nconsistency and to differentiate from the Wolbachia -carrying mosquitoes\nincluded in the models in later sections. We group eggs, larvae and\npupae into one compartment as they are not involved in the transmission\nof dengue. Without loss of generality, they can be represented by a\nsingle death rate and maturation rate for the purpose of modelling. No\nrecovered class is required for mosquitoes as they remain infected for\nthe rest of their lives.\n\nThe model is then governed by the following system of differential\nequations,\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      (3.1)\n     @xmath   @xmath      (3.2)\n     @xmath   @xmath      (3.3)\n     @xmath   @xmath      (3.4)\n     @xmath   @xmath      (3.5)\n     @xmath   @xmath      (3.6)\n     @xmath   @xmath      (3.7)\n     @xmath   @xmath      (3.8)\n  -- -------- -------- -- -------\n\nThe probability of transmission from a non- Wolbachia mosquito to a\nhuman is assumed to be the same as the reverse, hence we let @xmath .\nThe variation in the adult mosquito death rate is strongly influenced by\nenvironmental factors such as temperature, humidity, and rainfall [ 109\n] and in our model is sinusoidally forced,\n\n  -- -------- -- -------\n     @xmath      (3.9)\n  -- -------- -- -------\n\nHere @xmath is the amplitude of seasonal forcing in the adult death\nrate, which will be called the strength of seasonality throughout this\nthesis. Further, @xmath is the average adult death rate, @xmath is time\nand @xmath is the phase shift, which is used to align the cosine\nfunction with the seasonal factors in Far North Queensland. This forcing\nof the adult death rate results in appropriate seasonal fluctuations in\nthe adult mosquito population, in turn leading to a seasonal aquatic\npopulation through the mating function. Hence, there is no need to force\nthe reproductive rate, and we keep it constant.\n\nA human becomes exposed (but not yet infectious) after being bitten by\nan infectious mosquito at rate @xmath (Equations ( 3.1 ) and ( 3.2 )),\nwhere @xmath is the successful biting rate and @xmath is the\ntransmission probability from non- Wolbachia mosquitoes to humans and\nthe reverse. Exposed humans then become infectious at rate @xmath and\nrecover from dengue at rate @xmath .\n\nThe aquatic population increases as the male and female mosquitoes mate\nand breed, but the population is limited by carrying capacity @xmath\nthrough a logistic term\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince there are equal numbers of male and female mosquitoes, @xmath ,\nthis becomes @xmath (Equation ( 3.5 )). Members of the aquatic\npopulation die at rate @xmath and mature into susceptible female\nmosquitoes at rate @xmath , where only half of the maturing aquatics are\nfemale. Susceptible mosquitoes progress to the exposed class after\nbiting infectious humans at rate @xmath . They then become infectious at\nrate @xmath (Equation ( 3.8 )), where @xmath is the extrinsic incubation\nperiod.\n\nThe populations of both humans and mosquitoes are non-dimensionalised by\nletting @xmath , @xmath , @xmath , @xmath and @xmath , @xmath , @xmath ,\nand @xmath . Since the carrying capacity, @xmath , is related to the\nnumber of available breeding sites, which depends on the number of\nhumans, @xmath . Hence @xmath , where @xmath is the ratio of the\ncarrying capacity to the total human population. The model, after\nremoving the hats for the sake of simplicity, is then reduced to\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (3.10)\n     @xmath   @xmath      (3.11)\n     @xmath   @xmath      (3.12)\n     @xmath   @xmath      (3.13)\n     @xmath   @xmath      (3.14)\n     @xmath   @xmath      (3.15)\n     @xmath   @xmath      (3.16)\n     @xmath   @xmath      (3.17)\n  -- -------- -------- -- --------\n\nwhere @xmath , but the mosquito population does not necessarily sum to\none due to the relationship with the carrying capacity and the\nsinusoidal forcing term.\n\n### 3.2 Model in the Presence of Wolbachia\n\nIn this section the formulation of the model in the presence of\nWolbachia is presented. This extends the model in the absence of\nWolbachia -carrying mosquitoes given in Equations\u00a0( 3.1 )\u2013( 3.8 ) by\nincluding a Wolbachia -carrying mosquito population.\n\nThe population of Wolbachia -carrying mosquitoes is divided into\nsubpopulations of Aquatic @xmath comprised of eggs, larvae and pupae,\nSusceptible ( @xmath ), Exposed ( @xmath ) and Infectious ( @xmath )\nmosquitoes, where @xmath . The subscript @xmath is used to denote\nWolbachia and to differentiate between non- Wolbachia and Wolbachia\n-carrying mosquitoes. The model comprises twelve compartments in total,\nfour for each of the three modelled populations: two mosquito\npopulations and one human population. A schematic representation of the\nmodel is given in Figure 3.2 .\n\nThe model is governed by the following system of differential equations\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (3.18)\n     @xmath   @xmath      (3.19)\n     @xmath   @xmath      (3.20)\n     @xmath   @xmath      (3.21)\n     @xmath   @xmath      (3.22)\n     @xmath   @xmath      (3.23)\n     @xmath   @xmath      (3.24)\n     @xmath   @xmath      (3.25)\n     @xmath   @xmath      (3.26)\n     @xmath   @xmath      (3.27)\n     @xmath   @xmath      (3.28)\n     @xmath   @xmath      (3.29)\n  -- -------- -------- -- --------\n\nIn this model, the exposure rates for humans are different from those in\nthe model in the absence of Wolbachia , as seen in Equations ( 3.1 ). In\nthis model, a susceptible human becomes exposed after being bitten by\neither non- Wolbachia or Wolbachia -carrying infectious mosquitoes at\nrate @xmath or @xmath , respectively (see Equations ( 3.18 ) and ( 3.19\n)). Here @xmath is the biting rate for Wolbachia -carrying mosquitoes\nand @xmath is the transmission probability from Wolbachia -carrying\nmosquitoes to humans. Note that the transmission probability from humans\nto Wolbachia -carrying mosquitoes is assumed to be equal to that of\nhumans to non- Wolbachia mosquitoes, so @xmath . By contrast, there are\ndifferences in the transmission probabilities of dengue from mosquitoes\nto humans for Wolbachia and non- Wolbachia mosquitoes (see Section 4.2\nfor an explanation).\n\nThe effects of cytoplasmic incompatibility and imperfect maternal\ntransmission on the mosquito populations are included in this model. The\neffect of CI is incorporated by differences in the mating functions.\nThat is, the non- Wolbachia females can only reproduce when mating with\nWolbachia mosquito males, giving\n\n  -- -------- -- --------\n     @xmath      (3.30)\n  -- -------- -- --------\n\nwhere @xmath . As the ratio of male to female mosquitoes is assumed to\nbe 1:1, this is reduced to @xmath (see Equation ( 3.22 )). The aquatic\nWolbachia mosquitoes are produced when Wolbachia -carrying female\nmosquitoes mate with either non- Wolbachia or Wolbachia males, giving\nthe term\n\n  -- -------- -- --------\n     @xmath      (3.31)\n  -- -------- -- --------\n\nwhere @xmath , which simplifies to @xmath (Equation ( 3.26 )). The\ngrowth of aquatic mosquitoes is limited by carrying capacity @xmath , so\nthat each mating function is multiplied by\n\n  -- -------- -- --------\n     @xmath      (3.32)\n  -- -------- -- --------\n\nWolbachia -carrying aquatic mosquitoes mature to be Wolbachia -carrying\nadult mosquitoes at rate @xmath . To capture the imperfect maternal\ntransmission of Wolbachia [ 94 , 40 ] , we assume that a proportion\n@xmath of them become Wolbachia -carrying adults and a proportion (\n@xmath ) become non- Wolbachia adults (see Equations ( 3.23 ) and ( 3.27\n)). In a similar manner to that for non- Wolbachia mosquitoes, the death\nrate of Wolbachia -carrying adult mosquitoes varies seasonally ( @xmath\n. More explanation of about this relationship is given in Section 4.2 ).\n\nThe non-dimensionalised model form is a useful generalisation, with the\nindependence of variable scale allowing the solution to be applicable in\nother settings, such as for a different population size. Therefore, as\nin the model in the absence of Wolbachia -carrying mosquitoes, the\npopulations of both human and mosquitoes are non-dimensionalised by\ndividing the human subpopulations by @xmath and the mosquito\nsubpopulations by @xmath . The model is then reduced to\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (3.33)\n     @xmath   @xmath      (3.34)\n     @xmath   @xmath      (3.35)\n     @xmath   @xmath      (3.36)\n     @xmath   @xmath      (3.37)\n     @xmath   @xmath      (3.38)\n     @xmath   @xmath      (3.39)\n     @xmath   @xmath      (3.40)\n     @xmath   @xmath      (3.41)\n     @xmath   @xmath      (3.42)\n     @xmath   @xmath      (3.43)\n     @xmath   @xmath      (3.44)\n  -- -------- -------- -- --------\n\nThe parameter descriptions and values can be found in Table 4.1 , Page\n4.1 .\n\n### 3.3 Basic and Effective Reproduction Number\n\nThe basic reproduction number @xmath is one of the most important\nquantities in infectious disease modelling, acting as an epidemic\nthreshold. If @xmath , an outbreak may occur, whereas it cannot if\n@xmath . We determine @xmath for our model in order to investigate the\neffect of introducing Wolbachia -carrying mosquitoes on the epidemic\nthreshold.\n\nFollowing Diekmann, Heesterbeek and Roberts [ 24 ] , to construct a next\ngeneration matrix, we need to first identify the subsystem of ODEs that\ndescribes the production of new cases and the changes between infectious\nclasses or groups, which is called the infected subsystem. From the\nmodel\u00a0( 3.18 )\u2013( 3.29 ), the infected subsystem is\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (3.45)\n     @xmath   @xmath      (3.46)\n     @xmath   @xmath      (3.47)\n     @xmath   @xmath      (3.48)\n     @xmath   @xmath      (3.49)\n     @xmath   @xmath      (3.50)\n  -- -------- -------- -- --------\n\nAt the infection-free steady state, @xmath , and @xmath . For small\n@xmath , the linearised infected subsystem is approximated by\nEquations\u00a0( 3.45 )\u2013( 3.50 ), with @xmath .\n\nLet @xmath . We want to write the linearised infected subsystem in the\nform\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is the transmission matrix, whose entries correspond to\ntransmission events, and @xmath is the transition matrix, whose entries\ncorrespond to movement between the infected compartments including\ndeaths. The transmission matrix @xmath is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath and @xmath are the population of mosquitoes with and\nwithout Wolbachia . As mosquito populations vary seasonally, both of\nthese are functions of time. The transition matrix @xmath is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe next find the inverse of the transition matrix @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe multiply the transmission matrix and the inverse of transition matrix\nto obtain\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe spectral radius of the matrix @xmath is the basic reproduction\nnumber, that is,\n\n  -- -- -- --------\n           (3.51)\n  -- -- -- --------\n\nEquation\u00a0( 3.51 ) gives the basic reproduction number in the presence of\nWolbachia . In the absence of Wolbachia , after setting all Wolbachia\n-related parameters to zero, Equation 3.51 is reduced to\n\n  -- -------- -- --------\n     @xmath      (3.52)\n  -- -------- -- --------\n\nThe disease-free equilibrium results in all humans becoming susceptible\n( @xmath ). However, the equilibrium mosquito population includes both\nsusceptible adults ( @xmath and @xmath ) and mosquitoes in the aquatic\nphase ( @xmath , @xmath ). Thus we explicitly include @xmath and @xmath\nin the formula for @xmath and @xmath .\n\nThe basic reproduction number found here can be considered to be an\ninstantaneous basic reproduction number which depends on fluctuations in\nthe mosquito population, @xmath and @xmath .\n\nBesides determining the basic reproduction number, it is also important\nto determine time-dependent variations in the potential for transmission\nof infectious disease. This is usually conducted by evaluating the\neffective reproduction number. The effective reproduction number is the\naverage number of secondary cases generated by a primary case [ 73 , 106\n] . The effective reproduction number is different to the basic\nreproduction number in that it takes into account the depletion of\nsusceptible individuals and any public health intervention [ 30 ] . To\nmake it easier for readers to differentiate between basic and effective\nreproduction numbers in this thesis we will refer to the reproduction\nnumber as the basic reproduction number if the population is entirely\nsusceptible, even where there is a Wolbachia intervention.\n\nThe effective reproduction number can be obtained by multiplying the\nbasic reproduction number by the proportion of the population that is\nsusceptible populations [ 73 ] . The first term of Equation\u00a0( 3.51 ) is\nthe average number of secondary infectious humans produced by one\nprimary human case in a completely susceptible population of humans and\nnon- Wolbachia mosquitoes. The second term of Equation\u00a0\u00a0( 3.51 ) is the\nsame as the first term, but where mosquitoes carry Wolbachia . The\neffective reproduction number can be obtained as the sum of the first\nterm multiplied by @xmath and the second term multiplied by @xmath .\nThat is,\n\n  -- -------- -- --------\n     @xmath      (3.53)\n  -- -------- -- --------\n\nwhere\n\n  -- -- -- --------\n           (3.54)\n  -- -- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (3.55)\n  -- -------- -- --------\n\nIn the absence of Wolbachia -carrying mosquitoes, the effective\nreproduction number is\n\n  -- -------- -- --------\n     @xmath      (3.56)\n  -- -------- -- --------\n\n### 3.4 Discussion\n\nMathematical models developed in this chapter are used to investigate\nthe effectiveness of a Wolbachia control strategy in reducing the number\nof human dengue cases under scenarios of single and multiple\nintroductions of human dengue cases. In these models, we assume a\nwell-mixed and homogeneous population and ignore heterogeneity in the\npopulation, although our models could be extended to include this.\nFurthermore, although we assume the transmission probabilities from\nhumans to mosquitoes and mosquitoes to human are the same, the force of\ninfections of humans and mosquitoes are different due to differences in\nthe proportions of infectious humans and mosquitoes (Equations ( 3.1 )\nand ( 3.6 ) , respectively). Vertical transmission of dengue in\nmosquitoes can occur (see, for example, [ 44 , 51 ] ), however this\ntends to be at low levels [ 51 ] . Furthermore, Adams and Boots [ 2 ]\nfound that vertical transmission is not an important factor for\ndetermining dengue persistence. As the purpose of this thesis is to\ndetermine the indicative reduction in the number of dengue cases due to\na Wolbachia intervention, the assumptions used in this thesis are\nsufficient. Further explorations can be conducted and suggestions are\ndetailed in Section 9.3 .\n\n### 3.5 Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   Single serotype dengue models in the absence and presence of\n    Wolbachia -carrying mosquitoes are developed (Sections 3.1 and 3.2\n    ).\n\n-   We provide dimensionalised and non-dimensionalised models (Sections\n    3.1 and 3.2 ).\n\n-   The death rate of mosquitoes is sinusoidally forced (Section 3.1 ,\n    Equation\u00a0( 3.9 )).\n\n-   The basic and effective reproduction number is derived, which can be\n    considered to be an instantaneous basic reproduction number (Section\n    3.3 , Equations\u00a0( 3.51 )\u2013( 3.56 )).\n\n-   The basic and effective reproduction number depends on fluctuations\n    in the mosquito population (Section 3.3 , Equations\u00a0( 3.51 )\u2013( 3.56\n    )).\n\n## Chapter 4 Dengue Transmission Dynamics for a Single Introduction\nEvent ***This work is part of the manuscript that has been published as\nMeksianis Z. Ndii, R. I. Hickson, David Allingham, G. N. Mercer.\nModelling the transmission dynamics of dengue in the presence of\nWolbachia. Mathematical Biosciences. 262:157\u2013166. 2015.\n\nThe aim of this chapter is to study the effects of Wolbachia on dengue\ntransmission dynamics in the case where there is a single introduction\nof dengue cases into the human population.\n\nThe mathematical models developed in Chapter 3 are used to investigate\nthe effects of Wolbachia on dengue transmission dynamics for a single\nstrain. We consider a single outbreak with a duration of approximately\none year, and hence omit human births and deaths from our models by\nsetting @xmath . We work with our non-dimensionalised models in the\nabsence (Equations ( 3.10 )\u2013( 3.17 )) and presence (Equations ( 3.33 )\u2013(\n3.44 )) of Wolbachia -carrying mosquitoes.\n\n### 4.1 Data and Parameter Estimation\n\nCairns is the largest city in the region of Australia where Aedes\naegypti are present and local dengue transmission occurs, and is also\nwhere the Wolbachia field trials, which began in 2011, are being\nconducted [ 41 ] . In summer 2008\/2009, there was a DEN3 outbreak in\nCairns [ Ritchie2013 ] and we use data from this outbreak to estimate\nthe parameter values of transmission probability ( @xmath ), strength of\nseasonality ( @xmath ) and seasonal phase ( @xmath ) for the baseline\nmodel, for example, in the absence of Wolbachia , represented by\nEquations ( 3.10 )\u2013( 3.17 ). The other parameter values were obtained\nfrom the literature and are given in Table 4.1 . The Cairns data covers\nthe period from 2nd November 2008 to 31st May 2009 and was extracted\nfrom Figure 2 of the paper by Ritchie et al. [ Ritchie2013 ] . As our\nmodel is formulated as a proportion of the population, each data point\nis divided by 150,000, which was the approximate population of Cairns in\n2008 [ 15 ] .\n\nWe minimise the sum of the squared error between the model and data,\nwhich is given by\n\n  -- -------- -- -------\n     @xmath      (4.1)\n  -- -------- -- -------\n\nwhere @xmath is the total proportion of human dengue cases up to the\n@xmath week from the observed data, and @xmath is the total proportion\nof human dengue cases up to the @xmath week from the model simulations.\nThe lsqnonlin built-in function in Matlab [ 58 ] is then used to\nestimate the @xmath , @xmath and @xmath parameter values.\n\n### 4.2 Wolbachia Parameters\n\nIn this section, model parameters relating to Wolbachia -carrying\nmosquitoes are presented and discussed. Most of these are given in terms\nof non- Wolbachia mosquitoes, following the conventions in the\nliterature. The relationships between Wolbachia and non- Wolbachia\nparameters,\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      (4.2)\n     @xmath   @xmath      (4.3)\n     @xmath   @xmath      (4.4)\n     @xmath   @xmath      (4.5)\n  -- -------- -------- -- -------\n\nThe reproductive rate of Wolbachia -carrying mosquitoes is generally\nlower than that for non- Wolbachia -carrying mosquitoes ( @xmath ).\nThere is a significant difference in reproductive rates for the WMelPop\nand a marginal difference for the WMel strain. This is because WMelPop\ndecreases the viability of eggs [ 63 ] , whereas WMel does not have a\nsignificant effect on them [ 94 ] .\n\nThe death rate of Wolbachia -carrying mosquitoes is higher than that of\nnon- Wolbachia mosquitoes ( @xmath ) because Wolbachia reduces the\nmosquito lifespan [ 111 , 94 ] . WMel and WMelPop reduce the lifespan of\nmosquitoes by up to 10% and 50%, respectively [ 111 , 94 ] .\n\nWolbachia also inhibits viral replication and dissemination in the\nmosquitoes [ 11 , 67 , 41 , 94 , 29 ] . This results in a lower dengue\nviral load in the Wolbachia -carrying mosquitoes, and to reflect this,\nwe set the transmission probability from infectious Wolbachia -carrying\nmosquitoes to humans to less than that for Wolbachia -free mosquitoes (\n@xmath ). Additionally, Wolbachia causes a condition known as bendy\nproboscis [ 89 ] which inhibits feeding and lowers the successful biting\nrate ( @xmath ). This lower biting rate also captures the effect that,\ndue to the inhibition of viral replication, some Wolbachia -carrying\nmosquitoes are effectively not infected with dengue, and so the overall\ntransmission rate from humans is lower (that is, @xmath ).\n\nFor the parameter values used in this paper, there are only two\nrealistic stable states, which are that only non- Wolbachia -carrying\nmosquitoes persist, and that both populations persist (Figure 4.1 ). An\nadditional stable state does exist in which only the Wolbachia -carrying\nmosquitoes persist, but this requires the perfect maternal transmission\nof Wolbachia , and may not be realistic [ 94 ] . This state was also\nfound by Ndii et al. [ 70 ] for an autonomous system. When both\npopulations persist in this model, the proportion of Wolbachia -carrying\nmosquitoes is around 86%, which compares well with the 90% observed in\nHoffmann et al. [ 41 , 39 ] .\n\n### 4.3 Measurement of the Effect of Wolbachia on Dengue Outbreaks\n\nA measure is needed to assess the impact of the Wolbachia intervention\non dengue transmission. We do this by comparing the total numbers of\nhuman dengue cases in the absence and presence (for example,\npersistence) of Wolbachia -carrying mosquitoes. The relative effect is\nexpressed as a percentage, given by\n\n  -- -------- -- -------\n     @xmath      (4.6)\n  -- -------- -- -------\n\nwhere @xmath is the final proportion of dengue cases, with subscripts to\ndenote the absence (A) and presence (P) of Wolbachia -carrying\nmosquitoes.\n\n### 4.4 Sensitivity Analysis\n\nA global sensitivity analysis is performed using the standard\ncombination of Latin Hypercube Sampling (LHS) and Partial Rank\nCorrelation Coefficient (PRCC) multivariate analysis [ 56 , 59 , 103 ,\n13 ] . LHS is a stratified Monte Carlo sampling method, in which the\nrandom parameter distributions are divided into @xmath equal probability\nintervals and samples are taken from each [ 56 , 59 , 103 , 13 ] . Here\n@xmath is the sample size for each parameter. Each interval of each\nparameter is sampled exactly once without replacement, so that the\nentire range of each parameter is explored [ 56 , 103 , 13 ] .\nParameters are sampled from a triangular probability distribution\nbecause we expect that the values close to the peak of the triangular\ndistribution pattern are those which are more likely to occur. The\nminimum, maximum and expected values are given in Table 4.1 .\n\nPRCC is an efficient method for measuring the nonlinear, but monotonic\nrelationship between inputs and the model outcome of interest [ 56 , 103\n, 13 , 20 ] . In this paper, the inputs are the parameters as well as\nthe initial number of exposed humans, while the model outcome is the\ncumulative proportion of infectious individuals, which is the solution\nof the differential equation\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe ranges of the input parameters are available in the literature and\nonly samples of the parameter values that result in the persistence of\nmosquitoes are included in the calculation. The PRCC is computed for the\nfull length of 31 weeks, the period of time for which data is available\n(see Richie et. al [ Ritchie2013 ] ). The most significant parameters\nare those for which a small change in value leads to a significant\nchange in the output, that is in the cumulative number of infectious\nhumans.\n\n### 4.5 Results\n\nIn this section the model simulation and sensitivity analysis results\nare presented for both models. The governing systems of differential\nequations are integrated using MATLAB\u2019s inbuilt routine \u201code45\u201d, with\nthe parameter values given in Table 4.1 . We run the model until the\nmosquito population reaches the periodic stable state, before the\ninfected humans are introduced into the population on the @xmath of\nNovember. That is, the transient dynamics of the introduction of the\nWolbachia mosquitoes into the system are not considered. In Far North\nQueensland, dengue is not endemic, hence dengue outbreaks occur as\ndengue cases are introduced into the population. For both models, the\ninitial conditions for the human population are @xmath , @xmath and\n@xmath .\n\n#### 4.5.1 Parameter Estimation and Sensitivity of the Model in the\nAbsence of Wolbachia\n\nIn this section we consider the model in the absence of Wolbachia , that\nis, Equations\u00a0( 3.10 )\u2013( 3.17 ), as described in Chapter 3 , which\nserves as a baseline model for comparison with the Wolbachia\nintervention. Most of the parameters are obtained from the literature,\nas per the references in Table 4.1 . The remaining three parameters,\n@xmath , @xmath and @xmath , are estimated via optimisation using Matlab\n\u2019s lsqnonlin function. We constrain the optimisation by physical limits,\nthat is, between 0 and 1 for @xmath since it is a probability, 0 to 365\nfor the seasonal phase @xmath , and 0 to 1 for @xmath , so that the\ndeath rate @xmath remains positive at all times. The ranges of parameter\nvalues are chosen such a way that it is biologically realistic and\nresult in the persistence of Wolbachia -carrying mosquitoes.\n\nWe fit the parameters as follows. The model is run to its periodic\nstable state and then two exposed humans are introduced. The sum of\nsquares error is calculated using the cumulative 31-week proportional\nweekly data of Ritchie et al. [ Ritchie2013 ] . The parameters are then\nestimated using Matlab \u2019s lsqnonlin function, with a final sum of\nsquares error equal to @xmath . The resulting parameter values @xmath ,\n@xmath and @xmath are given in Table 4.1 . To assess the\ngoodness-of-fit, we calculated the @xmath statistic for the model\nresiduals using Matlab \u2019s chi2gof function. This returned a p-value of\n0.3713, and so we failed to reject the hypothesis that the residuals are\nfrom a normal distribution. There is some systematic bias in the\nresiduals around the start of the outbreak, evident in Figure 4.2 ,\nwhere the observed outbreak rises slightly faster than the model. While\nmodel embellishments could be added to account for this, here we\nconsider that the standard SEIR model of infectious disease is\nsufficient for our intended purpose: comparing the outbreak dynamics in\nthe absence and presence of Wolbachia .\n\nThe sensitivity analysis was performed by executing 5,200 runs (to\nreduce variance) to assess the model\u2019s sensitivity to the parameters.\nThe parameter ranges used are given in Table 4.1 . The range of the\nnumber of initially-exposed humans is taken to be between one and five\nindividuals. This is realistic as only a small number of initial cases\nis needed to trigger an outbreak [ Ritchie2013 ] .\n\nThe changes in parameter sensitivity exhibited over time are common for\nSEIR models due to the changes in disease dynamics over time, as seen in\nFigures 4.3 and 4.4 . Figure 4.3 shows that, for most of the time\nperiod, the most influential parameters are the transmission probability\n( @xmath ), the biting rate ( @xmath ) and the average adult death rate\n( @xmath ), where the latter has a negative correlation. The phase,\n@xmath , influences the outbreak size by shifting the peaks and troughs\nof the mosquito population in time; outbreaks tend to take off around\nthe peaks. Because of the sinusoidal nature of the seasonality, the\ncorrelation between @xmath and the outbreak size changes sign over time.\nThe parameter @xmath determines the progression rate of humans from the\nexposed to the infectious class. In the early days, when exposed\nindividuals are introduced, this parameter drives an increase in the\nnumber of infectious humans. If this parameter has a high value, the\ninitial introduced cases will quickly move into the infectious class.\n\nAs the epidemic takes off, the cumulative number of infectious\nindividuals is determined more by the biting rate @xmath and the\ntransmission probability @xmath , and so @xmath declines in importance.\nMoreover, the dynamics of the mosquito population have a larger\ninfluence on the disease dynamics once the epidemic has taken off.\n\nWhen there are many susceptible mosquitoes in the population, there will\nbe many infectious mosquitoes and hence many infected humans. An\nincrease in the number of susceptible mosquitoes is regulated by the\nparameter @xmath and so this parameter has an important impact in the\nlater period after the epidemic has taken off. As expected, the\ncumulative number of infectious individuals is most sensitive to the\nnumber of initially-exposed humans ( @xmath ) at early times since they\nare immediately added to this output. However, for the range considered,\n@xmath does not change the proportion of dengue reduction due to the\nintroduction of Wolbachia -carrying mosquitoes.\n\n#### 4.5.2 Sensitivity Analysis of the Model in the Presence of\nWolbachia\n\nIn this section the effects of Wolbachia -carrying mosquitoes on the\ndengue dynamics are investigated. Variations in parameter values are\nexplored to quantify the persistence of Wolbachia -carrying mosquitoes\nand its effects on the number of human dengue cases. The initial\nconditions for the two mosquito populations are @xmath , @xmath , @xmath\n, @xmath , @xmath , and @xmath , which are obtained by running Matlab\nsimulations of the model in the absence of dengue to the periodic stable\nstate. Since the WMel strain of Wolbachia is used in the Cairns field\nexperiments [ 41 ] , we use its expected parameter values in our model.\n\nThe results of the sensitivity analysis are similar to those for the\nmodel in the absence of Wolbachia , and are shown in Figure 4.4 . The\ntransmission probability ( @xmath ), the biting rate ( @xmath ) and the\naverage adult mosquito death rate ( @xmath ) are the most influential\nparameters on the model outcome. Furthermore, at early times, the\ncumulative number of infectious individuals is sensitive to @xmath and\n@xmath . An exploration of the ratios of transmission probability,\n@xmath , biting rate, @xmath , and death rate, @xmath , is also carried\nout as they relate to the most influential parameters. We also explore\nthe ratio of the reproductive rates for Wolbachia and non- Wolbachia\nmosquitoes, @xmath , to obtain information regarding its effect on\ndengue disease dynamics and on the parameter range for which Wolbachia\n-carrying mosquitoes persist.\n\n#### 4.5.3 Parameter Exploration\n\nAlthough we are using values for @xmath , @xmath , @xmath and @xmath\nfrom the literature, the provided values are generally qualitative\ndescriptions, or come from laboratory trials which may not be\nrepresentative of what happens in the field, and hence the correct\nparameter values may differ. Therefore, in this Section, we vary these\nparameters, one at a time, to determine their effects on human dengue\nincidence as measured by the relative effect given in Equation\u00a0( 4.6 ).\nThus, we quantify the effect of introducing Wolbachia -carrying\nmosquitoes on dengue transmission for a range of realistic parameter\nvalues.\n\nWe consider two scenarios, and their resulting effects on dengue cases\nare shown in Figure 4.5 . The first uses the expected values for WMel\nfor the non-varied Wolbachia parameters (indicated by the solid line in\nthe Figure). The second scenario uses the non- Wolbachia mosquito\nvalues, allowing us to explore the effect of cytoplasmic incompatibility\n(CI) on the dengue transmission dynamics, assuming that Wolbachia has no\nother effect on mosquito physiology. This second scenario is represented\nby the dashed line in the figure.\n\nThe vertical lines in Figure 4.5 (a) and\u00a0(b), for @xmath and @xmath ,\nrespectively, denote the boundary between persistence ( @xmath ) and\nnon-persistence ( @xmath ) for the Wolbachia -carrying mosquitoes. Both\nscenarios show that as the death rate of Wolbachia -carrying mosquitoes\nincreases, the relative effect on dengue incidence also increases up to\nthe point where the Wolbachia -carrying mosquitoes no longer persist,\naround @xmath for the solid line and @xmath for the dashed line. The\ndefault values, with @xmath , are identified on the figure by a cross,\nshowing that WMel should reduce human dengue incidence by approximately\n96%. Interestingly, in the second scenario, when @xmath , we see that\neven if all of the Wolbachia parameters are equal to their non-\nWolbachia counterparts, human dengue incidence is still reduced by\napproximately 16%. This occurs due to the combination of CI and\ncompetition, with the total female mosquito population ( @xmath ) being\nreduced.\n\nThe CI means Wolbachia -free and Wolbachia -carrying mosquitoes have\ndifferent mating functions, and, in particular, that no non- Wolbachia\noffspring are produced from the combination of a non- Wolbachia female\nand a Wolbachia -carrying male (there is effectively a @xmath term in\nEquation 3.22 ). This difference in the mating functions, combined with\nthe competition in the aquatic phase, results in a reduced total\nmosquito population, and hence less dengue. This provides the new\ninsight that CI, when considered in isolation, alters the dengue\ntransmission dynamics.\n\nThe solid line with expected WMel values in Figure 4.5 (b) shows that\nwhen the reproductive rate of Wolbachia -carrying mosquitoes is too low\ncompared to non- Wolbachia mosquitoes, the Wolbachia -carrying\nmosquitoes no longer persist, and hence have no effect on human dengue\nincidence. This occurs at approximately @xmath for the expected\nparameter values (solid line), and @xmath for @xmath (dashed line). When\nWolbachia -carrying mosquitoes do persist, their effect on human dengue\nincidence decreases with increasing @xmath since the total number of\nmosquitoes increases, despite CI. However, this effect is negligible for\nthe expected parameter values (solid line), with an over 90% reduction\nin dengue for all values where Wolbachia -carrying mosquitoes persist.\n\nThe results given in Figure 4.5 (c) show that even if @xmath\n(transmission is not directly affected by Wolbachia ), a reduction in\nhuman dengue incidence of approximately 76% is still obtained due to the\nother effects of Wolbachia on mosquito physiology. In addition, as shown\nin Figure 4.5 (d), a 90% reduction in human dengue incidence is obtained\neven though the biting rate of Wolbachia -carrying mosquitoes is close\nto that of non- Wolbachia mosquitoes ( @xmath ).\n\n#### 4.5.4 The Basic Reproduction Number\n\nUsing the formula for the basic reproduction number in Chapter 3 , we\ninvestigate the basic reproduction number. Figure 4.6 shows the effects\nof seasonal forcing on the basic reproduction number. This can be\nconsidered to be an instantaneous basic reproduction number. The results\nshow that the basic reproduction number is greater than one, meaning an\noutbreak may occur, for approximately 208 out of 365 days for the model\nwhere Wolbachia is absent, and 130 days for the model where Wolbachia is\npresent. That is, Wolbachia intervention reduces the number of days when\nan outbreak can occur by 78 days a year in this deterministic model. If\ninfected humans are introduced in favourable conditions, where the basic\nreproduction number is higher than unity, then outbreaks can still occur\n[ Grassly2006 , Coutinho2006 ] . This means that introducing Wolbachia\n-carrying mosquitoes reduces the chance that a dengue outbreak will\nhappen by reducing the number of days when the conditions are\nfavourable. The basic reproduction number is a function of the parameter\nvalues, and is affected in the following way by key ones. If the\ntransmission probability increases, the basic reproduction number also\nincreases. When the ratio of death rate of Wolbachia -carrying to non-\nWolbachia mosquitoes (f) increases, the basic reproduction number\ndecreases, but then increases when f > 1:3. This is realistic because if\nf > 1:3, Wolbachia -carrying mosquitoes die out and non- Wolbachia\nmosquitoes dominate the population, which then results in a higher\n@xmath . If the vertical transmission is not ignored, the basic\nreproduction number would be different. That is, some proportion of\nmosquitoes mature to be exposed mosquitoes. However, the modelling\nmethod would be the same.\n\n### 4.6 Discussion and Conclusions\n\nWe have developed a mathematical model for dengue transmission dynamics\nin the presence of a Wolbachia -carrying mosquito population in order to\nquantify the effects of a Wolbachia intervention on human dengue\nincidence. Our model incorporates seasonal forcing through the adult\nmosquito death rate, the effect of cytoplasmic incompatibility, and\ncompetition for resources in the aquatic stage. This model considers the\ncirculation of only a single dengue serotype with the mosquito\npopulation in a periodic stable state, appropriate to the study of a\nsingle dengue outbreak. It is assumed that half of the mosquito\npopulation mature into female adults, that a single introduction event\noccurs, and that there is no initial dengue immunity in the human\npopulation. These effects will have an impact on dengue transmission\ndynamics, with initial dengue immunity reducing the relative effect of\nthe Wolbachia introduction due to smaller outbreak sizes. However, the\npurpose of this model was to obtain an indication of the effect of the\nintroduction of Wolbachia -carrying mosquitoes on dengue transmission\ndynamics. Extensions to the model which consider the effect of immunity\nin the human population are considered in Chapters 5 , 7 , and 8 .\n\nA model which does not incorporate seasonality can only fit the data for\nFar North Queensland in one of two ways. First, nearly all humans need\nto have been previously infected and now recovered ( @xmath ), which is\nnot realistic. Second, all mosquitoes can die out, as they would at some\ntime in a one year period in a model which incorporated seasonal\neffects. However, unlike in a model which includes seasonal effects, the\nmosquito population cannot re-emerge, so this finding is again not\nrealistic. Thus seasonality must be incorporated into our model if we\nwish it to fit the data for Far North Queensland.\n\nThe key parameter ranges were explored in order to determine the level\nof dengue incidence reduction due to Wolbachia and the persistence of\nWolbachia -carrying mosquitoes. This was an important part of our work\nas definite values for many parameters are not known. A global\nsensitivity analysis was used to determine the most influential\nparameters.\n\nWe found that inoculating mosquitoes using the Wolbachia strain WMel ,\nwhich reduces the mosquito lifespan by at most 10%, allows Wolbachia\n-carrying mosquitoes to persist. This result is compatible with the\nrecommendations of Walker et al. [ 94 ] and the results from field\nexperiments [ 41 , 39 ] . Furthermore, we obtain new insight from Figure\n4.5 into the importance of cytoplasmic incompatibility as a biological\nfactor. CI not only gives a reproductive advantage to Wolbachia\n-carrying female mosquitoes, but also influences the transmission\ndynamics of dengue as it reduces the mosquito population. The release of\nmore Wolbachia -carrying males than females is being considered by\nHancock et al. [ 35 ] , and their analysis may be important in\nconsidering the effect of cytoplasmic incompatibility on dengue\ntransmission dynamics, and the possible feminisation of the Wolbachia\n-carrying mosquito population. However, our results suggest that, with\nequal numbers of males and females, Wolbachia -carrying mosquitoes can\npersist, and hence a reduction in dengue human incidence can be obtained\nthrough the use of this intervention.\n\nThe ratios of the transmission probability, @xmath , and of the biting\nrate, @xmath , determine the level of reduction in human dengue\nincidence due to the introduction of Wolbachia . By contrast, the ratios\nof the death rate, @xmath , and of the reproductive rate, @xmath ,\ndetermine the persistence of Wolbachia -carrying mosquitoes. This\nfinding is corroborated by our sensitivity analysis. Additionally, the\nbiting and reproductive rates are linked, since female mosquitoes feed\non human blood during their reproductive cycle. However, we treat the\nbiting and reproductive rates as independent when exploring the\nparameter space and note that the relative behaviour of these parameters\nis as shown in Figure 4.5 . A significant reduction in human dengue\nincidence due to the introduction of Wolbachia is also corroborated by\nthe results found for the reproduction number. Figure 4.6 shows that the\nnumber of days where this quantity is higher than unity is reduced by\naround 78 days when Wolbachia -carrying mosquitoes are introduced,\nindicating that the chance of a dengue outbreak occurring is reduced.\nThis indicates that, in our seasonal model, the time of introduction of\ndengue is important. When individuals with dengue enter the population\nat the appropriate time of the year, an outbreak can occur. This is\nfurther explored in Chapter 5 .\n\nIn conclusion, a one-strain dengue mathematical model incorporating\nWolbachia -carrying mosquitoes has been developed and analysed for a\nsingle outbreak. We quantify the effect that Wolbachia will have on\nhuman dengue cases, once the mosquito populations have reached their\nperiodic stable states. Wolbachia comes with a fitness cost but also a\nreproductive advantage (CI) to Aedes aegypti mosquitoes, and we explore\nthe parameter values for which Wolbachia will persist in the mosquito\npopulation. Our results show that for realistic WMel parameter values,\nWolbachia -carrying mosquitoes can greatly reduce the transmission of\ndengue. We also show that in the absence of any other effect on the\nmosquito physiology by Wolbachia , cytoplasmic incompatibility alone\naffects the transmission of dengue, reducing the human incidence.\n\nThe results discovered this chapter provide an indication that Wolbachia\nis effective in reducing dengue transmission. This chapter focuses on a\nsingle introduction of dengue cases. Generally, individuals with dengue\nenter the population multiple times, and the elapsed time between\nintroductions is irregular. Therefore, understanding the effect of\nWolbachia on dengue transmission dynamics when individuals carrying\ndengue enter the population multiple times is important. In the next\nchapter, multiple introductions of dengue cases into the population are\ninvestigated to assess their effects on the performance of Wolbachia in\nreducing dengue transmission.\n\n### 4.7 Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   We estimated the parameter values against data for Cairns, Australia\n    in Section 4.5.1 .\n\n-    Wolbachia is expected to reduce dengue transmission by over 90%\n    (Section 4.5.3 , see Figure 4.5 ).\n\n-   Using the WMel strains that reduces the mosquito lifespan by\n    approximately 10% allows the mosquitoes carrying Wolbachia to\n    persist in the wild (Sections 4.2 and 4.5.3 , Figures 4.1 and 4.5\n    (a).)\n\n-   A global sensitivity analysis reveals that the transmission\n    probability, the average death rate and the biting rate are the\n    important parameters (Sections 4.5.1 and 4.5.2 , see Figures 4.3 and\n    4.4 ).\n\n-   The presence of Wolbachia reduces the number of days at which basic\n    reproduction number is higher than one by around 78 days in a year\n    (Section 4.5.4 , Figure 4.6 ).\n\n-   In the absence of any other effect on the mosquito physiology by\n    Wolbachia , cytoplasmic incompatibility (CI) alone reduces the\n    dengue incidence (Section 4.5.3 , Figure 4.5 ).\n\n## Chapter 5 Dengue Transmission Dynamics for Multiple\nIntroductions***This work is part of the manucript that has been\nsubmitted for publication as Meksianis Z. Ndii, David Allingham, R.I.\nHickson, Kathryn Glass. The effect of Wolbachia on dengue outbreaks when\ndengue is repeatedly introduced.\n\nIn the previous chapter, we studied the effect of Wolbachia on dengue\ntransmission dynamics for a single introduction of dengue cases. In this\nchapter, we study the effect of Wolbachia on dengue transmission\ndynamics for multiple introductions of dengue. The aim of this chapter\nis to investigate the performance of Wolbachia in reducing dengue\nincidence when dengue cases are introduced into the population multiple\ntimes.\n\nWe work with our dimensionalised models from Chapter 3 in the absence\n(Equations ( 3.1 )\u2013( 3.8 )) and presence (Equations ( 3.18 )\u2013( 3.29 ))\nof Wolbachia -carrying mosquitoes.\n\n### 5.1 Introduction\n\nThe transmission dynamics of dengue are very seasonal due to\nfluctuations in the mosquito population as a result of variations in\nclimatic conditions such as temperature and rainfall. In regions with\nstrongly seasonal climatic conditions, epidemics generally occur at\ncertain times of the year and are mostly triggered by the importation of\ndengue cases. This means that the time period in which an infected\nindividual enters the population is an important factor in determining\nwhether an outbreak will occur.\n\nOnly a few research projects have considered the effects of multiple\nintroduction times on dengue outbreaks (see Section 2.2.6 ). Some\nstudies have investigated the effects of the frequency of dengue\nintroductions on dengue transmission dynamics [ 9 , 99 ] .\nBannister-Tyrrell et al. [ 9 ] investigated the variation in dengue\nactivity in Australia using a process-based modelling approach in which\ndengue cases were introduced once a year, bimonthly, monthly and weekly.\nWilliams et al. [ 99 ] used an existing dengue model, which involved an\nentomological component (CIMSiM) and a disease component (DENSiM), to\nassess the effects of the importation rate on dengue outbreaks. They\nassumed that between 1 and 25 dengue cases were introduced into the\npopulation at weekly intervals. A few mathematical models have been\ndeveloped to study the effects of Wolbachia on dengue transmission\ndynamics. In this chapter, we investigate the combined influence of\nthese two factors on dengue transmission dynamics by exploring the\nperformance of Wolbachia in reducing dengue incidence when dengue cases\nare repeatedly introduced into the population.\n\nMathematical models describing dengue transmission dynamics in the\nabsence and presence of Wolbachia -carrying mosquitoes are given in\nChapter 3 . The model incorporates seasonality through a function\ncontrolling the adult mosquito death rate and is parameterised for\nCairns, Australia. However, this model can be generalised to simulate\ndengue transmission dynamics in other places where dengue outbreaks are\ntriggered by the importation of dengue cases. We measure the\neffectiveness of the Wolbachia intervention by comparing the incidence\nof dengue in the absence and presence of Wolbachia , and use this to\ncompute the proportional reduction in dengue incidence. The formula for\nthis reduction is given in Equation\u00a0( 4.6 ) on Page 4.6 .\n\n#### 5.1.1 Simulation Procedure\n\nWe run simulations for our model using the built-in MATLAB functions\node45 and odextend . The initial conditions used for the simulations are\n@xmath [ 15 ] , @xmath , @xmath [ 19 ] , @xmath [ 94 ] , and the\nremaining populations are set to zero. In experiments conducted to\nassess the spread of Wolbachia and its persistence, Wolbachia and non-\nWolbachia mosquitoes were released in the ratio 2:1 [ 94 ] , and so we\nset @xmath . In the absence of Wolbachia -carrying mosquitoes, @xmath .\nIn this analysis, the phase, @xmath , is shifted 60 days ( @xmath days)\nas our start time is January.\n\nWe use the following procedure for our simulations. First, the model is\nrun without dengue using the initial conditions described above until\nthe mosquito population reaches the periodic stable state, and then\nindividuals with dengue are introduced. Second, we continue the\nsimulation using \u201codextend\u201d for another week, after which dengue is\nreintroduced. The reintroduction procedure is repeated until the final\nintroduction for the year. Step two is repeated for the same periods of\neach following year until the human infected population has remained\nconstant for at least 75 consecutive years. As we assume a constant\nhuman population, when individuals with dengue are introduced, the same\nnumber of individuals are removed from the susceptible human class,\n@xmath . We are particularly interested in the occurrence of outbreaks\nas the aim of this chapter is to determine the reduction in dengue\noutbreak size due to Wolbachia . To ensure that the disease does not\npersist when the infected human population is less than one individual,\nthe infected population is set to zero if it falls below a threshold of\n0.5, which is a deterministic proxy for stochastic fade-out.\n\n#### 5.1.2 Introduction Scenarios\n\nWe consider weekly year-round introductions and weekly three-month\nintroduction periods. Plots of the time series for infected humans when\nwe introduce dengue every week in a year (1 @xmath scenario) and every\nweek in a three month period (2 @xmath and 3 @xmath scenarios) are given\nin Figure 5.1 . In the second scenario, dengue cases are introduced\nweekly from June to August, while in the third scenario, dengue cases\nare introduced weekly from September to November. The introduction\nperiods are represented by rectangles at the top of Figure 5.1 . In the\nsecond and third scenarios, the disease dies out over winter, but the\noverall dynamics for each of the three scenarios are very similar due to\nthe level of introduction.\n\nThe true number of imported cases is very uncertain and differs across\ngeographic regions [ 80 ] . In Queensland, for instance, the number of\nimported dengue cases was around 202 in 2010 and 118 in 2011 [ 46 ] .\nThe number of imported cases in Taiwan has increased over time from one\nindividual in 1998 to around 15 individuals in 2007 [ 82 ] . In our\nmodel, two dengue cases are introduced each week, with a total of 104\nimported cases for year-round introduction (scenario 1) and 26 imported\ncases for each of the three month periods of introduction (scenarios 2\nand 3).\n\n### 5.2 Results\n\nIn this section, we assess the potential for an outbreak, the effect of\nthe strength of seasonality and the transmission rate, and investigate\nthe effective reproduction number.\n\n#### 5.2.1 Potential for an Outbreak\n\nHere we explore the impact of the season in which dengue is imported.\nFigure 5.2 shows the outbreak size with and without Wolbachia for\ndifferent values of @xmath , the parameter representing the strength of\nseasonality. In all simulations, dengue is introduced over a three month\nperiod (Scenarios 2 and 3), with the week of the first introduction\ngiven on the x-axis. Figure 5.2 shows that the lengths of the potential\noutbreak seasons have been reduced in the presence of Wolbachia\n-carrying mosquitoes for all three values of @xmath . The maximum\npotential outbreak size occurs when dengue is first introduced between\nJune and September. Furthermore, the outbreak season contracts as the\nstrength of seasonality ( @xmath ) increases.\n\nIn investigating the effects of the transmission rate and the strength\nof seasonality under the assumption that dengue is introduced over a\nperiod of three months, we use the June to August (scenario 2) and\nSeptember to November (scenario 3) time periods of introduction as\noutbreaks can potentially occur when dengue is introduced in these\nperiods. We use three-month periods of introduction as these are\nequivalent to the approximate length of a climatic season such as Summer\nor Winter.\n\n#### 5.2.2 The Effect of the Strength of Seasonality\n\nThe strength of seasonality is one of the key factors to explore since\nit affects vector dynamics. As the strength of seasonality ( @xmath )\nincreases, the outbreak size increases both in the absence and presence\nof Wolbachia -carrying mosquitoes (Figure 5.3 ). When we look at the\noverall effects of Wolbachia on dengue, we see that the proportional\nreduction in dengue decreases as the strength of seasonality increases.\nFurthermore, the time of introduction also affects the impact of\nWolbachia on dengue incidence. The reduction in dengue incidence when\ncases are introduced weekly throughout the year (scenario 1) is lower\nthan that for either of the scenarios modelling three months of\nintroduction, and hence Wolbachia is less effective in this scenario.\nFor low values of the strength of seasonality, the proportional\nreduction in dengue is approximately 80% for year-round introduction\n(scenario 1) and over 80% for the three month periods of introduction\n(scenarios 2 and 3). In general, the Wolbachia intervention is most\neffective when the amplitude of seasonality is low.\n\n#### 5.2.3 The Effect of the Transmission Rate\n\nThe transmission probability @xmath and the biting rate @xmath are the\nmost influential parameters in the model [ 69 ] and so we explore the\neffects of these parameters on dengue dynamics in the presence of\nWolbachia . As these two parameters have similar effects on the disease\ndynamics, we combine them into one parameter, @xmath which we refer to\nas the transmission rate. In Chapter 4 , the fitted value for @xmath ,\nappropriate for Cairns in northern Australia, was calculated to be\n0.1648 day @xmath .\n\nFigure 5.4 shows that as @xmath increases, the proportional reduction in\ndengue, @xmath , peaks and then decreases. Figure 5.4 also reveals that\nthe maximum proportion of dengue reduction is slightly less than 80% for\nthe year-round introduction (scenario 1), and around 80% for weekly\nintroduction during June to August (scenario 2) and September to\nNovember (scenario 3). For Cairns, the proportional reduction in dengue\nis around 50% for year-round introduction and 60% for three-month\nintroductions.\n\n#### 5.2.4 The Effective Reproduction Number\n\nUsing the formula for the effective reproduction number in Chapter 3 ,\nPage 3.53 for the model in dimensionalised form, we investigate the\ntransmission potential of dengue in the long-term. The equilibrium\nsusceptible populations are obtained by simulating the model with weekly\nyear-round introduction until the human infected population remains the\nsame for 75 years. The equilibrium susceptible populations are then used\nto calculate the effective reproduction number. We then simulate our\nmodel where two dengue cases are introduced once a year in a specific\nweek (we implement a thresholding of 0.5 to keep consistency), and\ncompare this with the results of the effective reproduction number.\n\nA comparison of the effective reproduction number ( @xmath ) and with\nthe outbreak size shows a similar threshold (Figure 5.5 ). If we\nintroduce dengue cases in the week at which @xmath , an outbreak is\nlikely to occur (Figure 5.5 ). There is a slight difference between the\nweek in which @xmath and the week in which outbreak takes off. The\noutbreak takes off around two weeks later in the absence of Wolbachia\nand four weeks later in the presence of Wolbachia -carrying mosquitoes.\n\n### 5.3 Discussion and conclusions\n\nWe investigated the effects of Wolbachia on dengue transmission dynamics\nusing a mathematical model which includes the importation of humans\ninfected with dengue.\n\nWe found that, in the presence of Wolbachia -carrying mosquitoes, the\ntime-window in which epidemics can occur is reduced by between two and\nsix weeks (see Figure 5.2 ), depending on the strength of seasonality.\nThis is driven by a decline in the mosquito population size, likely\ncaused by a reduction in the mosquito lifespan and, thus, in the\nmosquito\u2019s reproductive rate. An increase in the strength of seasonality\nfurther reduces the time-window in which an outbreak can occur due to\nthe presence of a limited number of mosquitoes over winter. In this\ncase, the decline in the mosquito population numbers is due to a short\nlifespan driven by seasonality. The model provides the insight that the\npresence of Wolbachia -carrying mosquitoes reduces the length of the\npotential seasons in which an outbreak can occur.\n\nWe also compared the time-dependent reproduction number and the\nsimulation, and found the time at which an outbreak occurs qualitatively\nmatches. That is, an outbreak occurs when the reproduction number is\ngreater than one. The models agree within 2\u20134 weeks and this slight\ndiscrepancy is likely due to a combination of disease importation\nassumptions and thresholding rules that lead to outbreak fadeout for\nsome reproductions numbers close to one. As the purpose of this thesis\nis to obtain general understanding of the performance of Wolbachia in\nreducing dengue incidence, the general consistency in these approaches\nis sufficient and reassuring.\n\nIn comparing the outbreak sizes, as the strength of seasonality is\nincreased, we found that outbreak sizes increase and the benefits of\nWolbachia decrease. This increase in outbreak size is caused by a larger\nmosquito population since the mosquito lifespan is longer when\nseasonality is at its highest. This larger mosquito population increases\nthe chance that a human in the population is infected. In contrast, as\nthe transmission rate increases, there is an intermediate level of\ntransmission (around 0.08 to 0.12) at which Wolbachia is most effective.\nAt these transmission rates, outbreaks will occur in the absence of\nWolbachia , but only either very small or no outbreaks will occur in the\npresence of Wolbachia -carrying mosquitoes. When the strength of\nseasonality is around 0.02-0.30 and the transmission rates are around\n0.08 to 0.12 day @xmath , dengue incidence can be reduced by more than\n80%, depending on the time of year in which dengue cases are introduced.\nIn reality, infected individuals enter populations year-round, according\nto a number of different factors. However, our results across scenarios\n1\u20133 show that the effect of Wolbachia is largely independent of the time\nof introduction. Overall, our results suggest that dengue incidence can\nbe reduced by up to 80% in populations where dengue is repeatedly\nintroduced.\n\nIn this chapter, multiple introductions of a single dengue strain were\nexplored. Although these findings provide insights into the performance\nof Wolbachia in reducing dengue incidence, generally individuals with\ndifferent dengue serotypes enter the population at random times.\nMoreover, since four dengue serotypes are circulating in most places [\n53 , 64 ] , the effects of Wolbachia on dengue transmission dynamics\nwith multiple serotypes are of interest. This may influence Wolbachia\nperformance in reducing dengue. However, generally only one serotype\ndominates a given outbreak [ 84 , 53 , 64 ] . In the following three\nchapters, the performance of Wolbachia in reducing dengue when more than\none dengue serotype circulates in the population is investigated.\n\n### 5.4 Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   We conducted multiple introductions of a single dengue serotype to\n    investigate the performance of Wolbachia in reducing dengue\n    incidence.\n\n-   When dengue is not endemic, timing of imported cases determines the\n    likelihood of an outbreak (Sections 5.2.1 and 5.2.4 , see Figures\n    5.2 and 5.5 ).\n\n-   We found that the time window in which outbreak occurs has been\n    reduced by up to six weeks in the presence of Wolbachia -carrying\n    mosquitoes (Section 5.2.1 , Figure 5.2 ).\n\n-   A reduction of 80% in dengue incidence can be obtained when the\n    strength of seasonality and the transmission rates are around\n    0.02\u20130.3 and 0.08\u20130.12, respectively (Sections 5.2.2 and 5.2.3 , see\n    Figures 5.3 and 5.4 ).\n\n## Part 2: Two Dengue Serotypes\n\nIn this part of the thesis, the performance of the Wolbachia\nintervention when two dengue serotypes circulate is studied. In\naddition, the effects of symmetric and asymmetric epidemiological\ncharacteristics on Wolbachia performance in reducing dengue incidence\nare explored. This part comprises Chapters 6 \u2013 8 , and the results are\nsummarised below.\n\n### Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   Two-serotype dengue models in the absence and presence of Wolbachia\n    -carrying mosquitoes are developed (Chapter 6 , Equations\u00a0( 6.3 )\u2013(\n    6.14 ) and \u00a0( 6.24 )\u2013( 6.39 )).\n\n-   The procedure for simulation is the same as that in Chapter 5 ,\n    except here the dengue serotype being introduced varies according to\n    the scenario of dengue introductions (Section 7.2 ).\n\n-   Different disease introduction scenarios are explored and the\n    results show that varying the disease introduction scenario does not\n    affect Wolbachia performance in reducing dengue incidence, with up\n    to 80% reduction in human dengue cases (Chapter 7 , Sections 7.3.1\n    and 7.3.2 ).\n\n-   Although the antibody-dependent enhancement parameter affects the\n    performance of Wolbachia in reducing dengue incidence, the\n    transmission probability remains the key parameter regulating the\n    dengue dynamics, and, hence, Wolbachia performance in reducing\n    dengue incidence (Chapters 7 and 8 ).\n\n-   When one serotype is more transmissible, that serotype will dominate\n    the primary infections, and the secondary infections will be\n    dominated by the less transmissible serotype. The performance of\n    Wolbachia in reducing dengue infection caused by the more\n    transmissible serotype subsequently declines (Section 8.2.2 ).\n\n-   The proportional reduction in secondary infections due to the\n    Wolbachia intervention is higher than that for primary infections\n    (Chapters 7 and 8 ).\n\n## Chapter 6 Mathematical Modelling of Two Dengue Serotypes dengue***The\nmathematical models presented here are part of the manuscript that has\nbeen submitted for publication as M.Z. Ndii, D. Allingham, R. I.\nHickson, K. Glass. The effect of Wolbachia on dengue dynamics in the\npresence of multiple serotypes of dengue: symmetric and asymmetric\nepidemiological characteristics.\n\nIn order to investigate the performance of Wolbachia in reducing dengue\nincidence when more than one dengue serotype circulates, we develop\ntwo-serotype models for dengue in the absence and presence of Wolbachia\n-carrying mosquitoes. In this chapter, we present a full derivation of\nthese models and explain their important features. In Chapters 7 and 8\nwe use our models to study the effects of symmetric and asymmetric\nepidemiological characteristics of the serotypes on dengue transmission\ndynamics.\n\n### 6.1 Model Formulation\n\nIn these models, human and mosquito populations are assumed to be\nwell-mixed and homogenous, and we include two serotypes of dengue. The\nratio between male and female mosquitoes is 1.02:1 [ 7 ] . For\nsimplicity, we assume that the numbers of male and female mosquitoes are\nequal, that is, @xmath and @xmath . Subscripts @xmath , @xmath , @xmath\ndenote humans, non- Wolbachia and Wolbachia -carrying mosquitoes,\nrespectively. Superscripts @xmath and @xmath denote serotypes @xmath or\n@xmath . This chapter is organised as follows. First, we present the\nformulation of the model in the absence of Wolbachia , and then the\nmodel in the presence of Wolbachia . Finally, we remind the reader of\nthe relationships between and the values of several important parameters\nfor the models.\n\n#### 6.1.1 Model in the Absence of Wolbachia\n\nA two-serotype dengue model in the absence of Wolbachia -carrying\nmosquitoes is formulated. This model is an extension of the single\nserotype dengue model in the absence of Wolbachia -carrying mosquito\npopulation given in Equations\u00a0( 3.1 )\u2013( 3.8 ) on page 3.1 . The model\ncomprises human and non- Wolbachia mosquito populations, and the\nschematic representation of the model is given in Figure 6.1 .\nSuperscripts @xmath and @xmath denote dengue serotypes, where @xmath and\n@xmath .\n\nThe human population is divided into 14 different classes:\n\n-   Susceptible to all serotypes, @xmath .\n\n-   Exposed and infectious with serotype @xmath , @xmath and @xmath\n    respectively.\n\n-   Temporarily immune to all serotypes, but previously infected by\n    serotype @xmath , @xmath .\n\n-   Susceptible to serotype @xmath and previously infected by serotype\n    @xmath , @xmath .\n\n-   Exposed and infectious to serotype @xmath and previously infected by\n    serotype @xmath , @xmath and @xmath respectively.\n\n-   Recovered from all serotypes, @xmath .\n\nThe total human population is then given by the equation\n\n  -- -------- -- -------\n     @xmath      (6.1)\n  -- -------- -- -------\n\nThe non- Wolbachia mosquito population is divided into six compartments:\n\n-   Mosquitoes in the aquatic stage, @xmath .\n\n-   Susceptible, @xmath .\n\n-   Exposed to either serotype, @xmath .\n\n-   Infectious with either serotype, @xmath .\n\nThe mosquitoes remain infectious throughout their lifetime, hence no\nrecovered class for mosquitoes is required. We also assume that the\nmosquitoes are never co-infected with both serotypes. The total\npopulation of non- Wolbachia mosquitoes, @xmath , is given by the\nequation\n\n  -- -------- -- -------\n     @xmath      (6.2)\n  -- -------- -- -------\n\nThe model is governed by the following system of differential equations\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (6.3)\n     @xmath   @xmath      (6.4)\n     @xmath   @xmath      (6.5)\n     @xmath   @xmath      (6.6)\n     @xmath   @xmath      (6.7)\n     @xmath   @xmath      (6.8)\n     @xmath   @xmath      (6.9)\n     @xmath   @xmath      (6.10)\n     @xmath   @xmath      (6.11)\n     @xmath   @xmath      (6.12)\n     @xmath   @xmath      (6.13)\n     @xmath   @xmath      (6.14)\n  -- -------- -------- -- --------\n\nHumans are born susceptible at rate @xmath and then exposed to dengue\nafter being bitten by non- Wolbachia infectious mosquitoes at rate\n@xmath , which is governed by the equation\n\n  -- -------- -- --------\n     @xmath      (6.15)\n  -- -------- -- --------\n\nHere @xmath is the biting rate of non- Wolbachia mosquitoes, @xmath is\nthe transmission probability from non- Wolbachia mosquitoes with\nserotype @xmath to humans, and @xmath is the total human population,\ngiven in Equation 6.1 . The transmission probability between humans and\nnon- Wolbachia mosquitoes is assumed to be the same, and is denoted by\n@xmath .\n\nExposed individuals progress to the infectious class at rate @xmath ,\nand then to the temporary immunity class at rate @xmath . After spending\n@xmath time units in the temporary immunity class, they become\nsusceptible to the other serotype @xmath , where @xmath . They may then\nbecome exposed to dengue after being bitten by non- Wolbachia mosquitoes\ncarrying dengue serotype @xmath at rate\n\n  -- -------- -- --------\n     @xmath      (6.16)\n  -- -------- -- --------\n\nFollowing re-exposure, they become infectious at rate @xmath , and\nrecover from the secondary infection at rate @xmath . We assume that\ndengue is not fatal, so that humans die only at the natural death rate,\n@xmath . As explained in Section 2.1.1 , fatality due to the severe\nforms of dengue is only 1% in developed nations and we focus on the\ndifference in dengue cases in the presence versus absence of Wolbachia\n-carrying mosquitoes, so use this simplification.\n\nNon- Wolbachia aquatic mosquitoes are produced when non- Wolbachia\nfemale @xmath and male @xmath mosquitoes mate. The growth of the aquatic\nmosquito population is limited by the carrying capacity @xmath , through\nthe inclusion of the term:\n\n  -- -------- -- --------\n     @xmath      (6.17)\n  -- -------- -- --------\n\nAs the ratio between males and females is around 1.02:1 [ 7 ] , we\nassume that there are equal populations of male and female mosquitoes,\n@xmath . Therefore, Equation 6.17 is reduced to\n\n  -- -------- -- --------\n     @xmath      (6.18)\n  -- -------- -- --------\n\nNon- Wolbachia aquatic mosquitoes become adult susceptible mosquitoes at\nrate @xmath . The susceptible mosquitoes are infected with dengue after\nbiting infectious humans with either primary or secondary infections at\nrate\n\n  -- -------- -- --------\n     @xmath      (6.19)\n  -- -------- -- --------\n\nHere @xmath is the antibody-dependent enhancement of serotype @xmath ,\nwhich is higher than one since infectious individuals with a secondary\ninfection have a higher viral load, and hence, a higher transmission\nrate. The exposed mosquitoes become infectious at rate @xmath . The\ndeath rate of adult mosquitoes is sinusoidally forced according to the\nequation\n\n  -- -------- -- --------\n     @xmath      (6.20)\n  -- -------- -- --------\n\nwhere @xmath is average death rate, @xmath is the amplitude of\nseasonality and @xmath is a phase shift as also done in Section 3.1 .\n\n#### 6.1.2 Model in the Presence of Wolbachia\n\nIn this section, a two-serotype dengue model in the presence of\nWolbachia -carrying mosquitoes is formulated. The model is an extension\nof the model in the absence of Wolbachia -carrying mosquitoes given in\nEquations\u00a0( 6.3 )\u2013( 6.14 ) of the previous section. The flowchart for\nthis model is given in Figure 6.2 . The two-serotype dengue model in the\npresence of Wolbachia -carrying mosquitoes is governed by Equations\u00a0(\n6.24 )\u2013( 6.39 ).\n\nThe model comprises human, non- Wolbachia and Wolbachia -carrying\nmosquito populations. The human and non- Wolbachia mosquito compartments\nare the same as in the model in the absence of Wolbachia -carrying\nmosquitoes. The population of Wolbachia -carrying mosquitoes is grouped\ninto six compartments, which are mosquitoes in the aquatic stage, @xmath\n, susceptible, @xmath , exposed to either serotype @xmath , @xmath , and\ninfectious with either serotype @xmath , @xmath . The total population\nof Wolbachia -carrying mosquitoes is\n\n  -- -------- -- --------\n     @xmath      (6.21)\n  -- -------- -- --------\n\nand the total population of non- Wolbachia mosquitoes is given in\nEquation\u00a0( 6.2 ).\n\nUnlike in the model in the absence of Wolbachia , susceptible humans are\nexposed to dengue after being bitten by either infectious non- Wolbachia\nor Wolbachia -carrying mosquitoes, that is, at a rate governed by\n\n  -- -------- -- --------\n     @xmath      (6.22)\n  -- -------- -- --------\n\nHere @xmath is the transmission probability from Wolbachia -carrying\nmosquitoes to humans. The parameter @xmath is the successful biting rate\nof Wolbachia -carrying mosquitoes, where @xmath since Wolbachia reduces\nthe biting rate [ 89 ] . Exposed individuals progress to infectious,\ntemporary immunity and secondary susceptible classes at the same rates\nas in model in the absence of Wolbachia -carrying mosquitoes.\nIndividuals who were previously infected by serotype @xmath are\nre-infected by dengue serotype @xmath at rate\n\n  -- -------- -- --------\n     @xmath      (6.23)\n  -- -------- -- --------\n\nwhere @xmath . Infectious individuals then move to secondary infectious\nand recovered classes at the same rates as in the model in the absence\nof Wolbachia . All humans die at the natural death rate, @xmath .\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (6.24)\n     @xmath   @xmath      (6.25)\n     @xmath   @xmath      (6.26)\n     @xmath   @xmath      (6.27)\n     @xmath   @xmath      (6.28)\n     @xmath   @xmath      (6.29)\n     @xmath   @xmath      (6.30)\n     @xmath   @xmath      (6.31)\n     @xmath   @xmath      (6.32)\n     @xmath   @xmath      (6.33)\n     @xmath   @xmath      (6.34)\n     @xmath   @xmath      (6.35)\n     @xmath   @xmath      (6.36)\n     @xmath   @xmath      (6.37)\n     @xmath   @xmath      (6.38)\n     @xmath   @xmath      (6.39)\n  -- -------- -------- -- --------\n\nIn the presence of Wolbachia , the effects of cytoplasmic\nincompatibility (CI) on mosquito reproduction are included in the model.\nNon- Wolbachia mosquitoes are produced when non- Wolbachia females and\nmales mate, and the growth of the aquatic non- Wolbachia mosquito\npopulation is limited by the carrying capacity, @xmath , through the\nexpression\n\n  -- -------- -- --------\n     @xmath      (6.40)\n  -- -------- -- --------\n\nAs we assume that there are equal numbers of male and female mosquitoes,\n@xmath and @xmath , this expression reduces to\n\n  -- -------- -- --------\n     @xmath      (6.41)\n  -- -------- -- --------\n\nWolbachia -carrying mosquitoes are reproduced after Wolbachia -carrying\nfemales mate with either Wolbachia -carrying or non- Wolbachia males,\naccording to the expression\n\n  -- -------- -- --------\n     @xmath      (6.42)\n  -- -------- -- --------\n\nwhich, can be similarly reduced to\n\n  -- -------- -- --------\n     @xmath      (6.43)\n  -- -------- -- --------\n\nNon- Wolbachia mosquitoes in the aquatic stage mature into susceptible\nnon- Wolbachia mosquitoes at rate @xmath . Wolbachia -carrying\nmosquitoes in the aquatic stage mature into susceptible mosquitoes at\nrate @xmath , with @xmath of them becoming Wolbachia -carrying\nmosquitoes and the remaining @xmath becoming non- Wolbachia mosquitoes.\nMosquitoes in the aquatic stage die at rate @xmath . Susceptible\nmosquitoes are exposed to dengue after biting infectious humans with\neither primary or secondary infections at rates\n\n  -- -------- -- --------\n     @xmath      (6.44)\n  -- -------- -- --------\n\nfor Wolbachia -carrying mosquitoes and @xmath as given in Equation\u00a0(\n6.19 ) for non- Wolbachia mosquitoes. The transmission probability from\nhumans to Wolbachia -carrying mosquitoes is assumed to be the same as\nthat between humans and non- Wolbachia mosquitoes, which is represented\nby @xmath . The exposed mosquitoes progress to the infectious class at\nrate @xmath for non- Wolbachia mosquitoes and @xmath for Wolbachia\n-carrying mosquitoes.\n\n### 6.2 Parameter Descriptions\n\nParameter descriptions, values and sources are given in Table 6.1 . Most\nof parameters are the same as in Chapter 4 , but we remind the reader of\nthe relationships between and the values of several important\nparameters. The transmission probabilities between humans and non-\nWolbachia mosquitoes, and from humans to Wolbachia -carrying mosquitoes\nare assumed to be equal and are represented by @xmath . However, the\ntransmission probability from Wolbachia -carrying mosquitoes to humans,\n@xmath , is lower than @xmath since Wolbachia reduces the level of\ndengue virus in the salivary glands of the mosquito. The biting and\nreproductive rates of Wolbachia -carrying mosquitoes are reduced, and\nhence @xmath and @xmath , respectively. Furthermore, because Wolbachia\nreduces the mosquito lifespan, the death rate of the Wolbachia -carrying\nmosquitoes is higher than that of non- Wolbachia mosquitoes ( @xmath ).\n\nThe period of temporary immunity is taken to be half a year or 6 months\n[ 96 ] , hence @xmath day @xmath . As individuals with secondary\ninfections have higher viral loads, this leads to higher transmission\nrates. Therefore, the antibody-dependent enhancement, @xmath , is set to\n@xmath [ 42 ] .\n\n### 6.3 Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   Two-serotype dengue models in the absence and presence of Wolbachia\n    -carrying mosquitoes are developed in Sections 6.1.1 and 6.1.2 ,\n    Equations\u00a0( 6.3 )\u2013( 6.14 ) and ( 6.24 )\u2013( 6.39 ), respectively.\n\n-   In the absence of Wolbachia -carrying mosquitoes, individuals are\n    infected after being bitten by infectious non- Wolbachia mosquitoes.\n\n-   In the presence of Wolbachia -carrying mosquitoes, individuals are\n    infected after being bitten by infectious non- Wolbachia or\n    Wolbachia -carrying mosquitoes.\n\n-   Antibody dependent enhancement (ADE) is included, where the ADE is\n    represented by @xmath . Antibody dependent enhancement increases\n    infectivity of individuals with secondary infections. This can lead\n    to more severe forms of dengue.\n\n-   The temporary immunity class is included in the model. Individuals\n    in this class have recovered from primary infections and have a\n    temporary immunity to all serotypes of dengue. They later become\n    susceptible to the serotypes with which they have not previously\n    been infected.\n\n## Chapter 7 Two serotypes with symmetric epidemiological\ncharacteristics ***The results of scenario one form part of the\nmanuscript that has been submitted for publication as M.Z. Ndii, D.\nAllingham, R.I. Hickson, K. Glass. The effect of Wolbachia on dengue\ndynamics in the presence of two serotypes of dengue: symmetric and\nasymmetric epidemiological characteristics.\n\nIn Chapters 4 \u2013 5 , we studied the effect of Wolbachia on dengue\ndynamics when a single serotype of dengue was circulating. We considered\nscenarios when dengue cases were introduced into the population once,\nand multiple times. In this chapter and the next, we use the\nmathematical models formulated in Chapter 6 to study the effect of\nWolbachia on dengue dynamics when two serotypes of dengue are\ncirculating, assuming first symmetric and then asymmetric\nepidemiological characteristics of the serotypes. The aim of this\nchapter is to investigate the effectiveness of Wolbachia in reducing\ndengue transmission for two serotypes with symmetric epidemiological\ncharacteristics under different disease introduction scenarios.\n\n### 7.1 Introduction\n\nSeveral mathematical models have been developed to investigate dengue\ndynamics in the absence of Wolbachia -carrying mosquitoes when more than\none dengue serotype circulates [ 26 , 21 , 12 , 1 , 65 , 50 , 3 , 42 ,\n100 ] . However, these models did not consider differing disease\nintroduction scenarios, a factor which can influence disease\ntransmission dynamics. In addition, to the best of our knowledge, no\nmodelling studies have been conducted to investigate the effects of\nWolbachia on dengue dynamics when more than one dengue serotype\ncirculates under different disease introduction scenarios.\n\nUnderstanding the effect of different disease introduction scenarios on\nWolbachia performance in reducing dengue incidence is of importance,\nbecause the exposure of the population to different dengue serotypes may\nalter the disease dynamics.\n\nIn this chapter, we assume that the two circulating dengue serotypes\nhave identical epidemiological characteristics (the symmetric case).\n\n### 7.2 Scenarios of Dengue Introduction\n\nDeciding on an exact strategy for the introduction of dengue serotypes\ninto the population is a challenging task because individuals with a\nparticular dengue serotype enter the population at irregular intervals [\n53 ] . Furthermore, the dominant dengue serotype in any one location\nvaries over time. For example in Thailand, DEN3 was common during\n2002\u20132004 and 2008\u20132010, whereas DEN4 was common during 2003\u20132008 [ 53 ]\n.\n\nHere we consider two disease introduction scenarios as illustrated in\nFigures 7.1 and 7.2 . In the first scenario, individuals carrying dengue\nserotype 1 are introduced weekly over a one year period, and individuals\ncarrying another dengue serotype are introduced weekly over an\nadditional one year period (Figure 7.1 ). In the second scenario,\nindividuals carrying dengue serotype 1 are introduced weekly for a\nduration of two years, and then individuals carrying another dengue\nserotype are introduced weekly over an additional two year period\n(Figure 7.2 ). These patterns are then repeated for many years.\nThroughout this chapter and in Chapter 8 , serotypes 1 and 2 refer to\ntwo different dengue serotypes, but do not specifically refer to DEN1\nand DEN2.\n\nWe use simulations to investigate the effect of Wolbachia when two\ndengue serotypes circulate under two disease introduction scenarios. Our\nsimulations are conducted in the same way as that presented in Chapter 5\n, Page 5.1.1 , except for differences in the dengue serotypes, depending\non the disease introduction scenario. The effects of the\nantibody-dependent enhancement rate ( @xmath ) and the transmission\nprobability ( @xmath ) on Wolbachia performance in reducing dengue are\nexamined for all scenarios.\n\nThe effectiveness of the Wolbachia intervention is measured by comparing\nthe relative differences in the outbreak sizes in the absence and\npresence of Wolbachia -carrying mosquitoes, which is given by\n\n  -- -------- -- -------\n     @xmath      (7.1)\n  -- -------- -- -------\n\nHere @xmath is the final number of dengue cases in the human population,\nwith subscripts to denote in the absence (A) and presence (P) of\nWolbachia . In order to ensure that the two disease introduction\nscenarios are comparable, a four-year outbreak size is used to calculate\nthe proportional reduction in dengue due to Wolbachia . This gives two\noutbreaks of dengue caused by each serotype in both disease introduction\nscenarios as shown in Figure 7.3 .\n\n### 7.3 Results\n\nThe performance of Wolbachia in reducing dengue is explored under two\ndisease introduction scenarios. The antibody-dependent enhancement (ADE)\nand the transmission probabilities for the two serotypes are set to be\nequal. That is, @xmath and @xmath . The parameter @xmath is the\ntransmission probability between humans and non- Wolbachia mosquitoes\nand from humans to Wolbachia -carrying mosquitoes. The transmission\nprobability from Wolbachia -carrying mosquitoes to humans is set to\n@xmath , because Wolbachia reduces the level of dengue virus in\nmosquitoes [ 11 , 67 , 41 , 94 , 29 , 110 ] and hence reduces\ntransmission.\n\n#### 7.3.1 First Dengue Introduction Scenario\n\nWhen we explore the case where the dengue serotypes have the same ADE,\nwe find that as the ADE increases, the overall outbreak size and the\noutbreak sizes for the primary and secondary infections in the absence\nand presence of Wolbachia -carrying mosquitoes increase. In addition,\nthe proportional reductions in the overall numbers of dengue cases, and\nthe reductions in the numbers of primary and secondary infections due to\nthe Wolbachia intervention decrease (Figure 7.4 ). The proportional\nreduction in the incidence of secondary infections is higher than that\nof primary infections, with the maximum reduction in secondary\ninfections found to be approximately 78%, compared to a reduction in\nprimary infections of around 45%.\n\nWhen we vary the ADE and the transmission probability simultaneously, we\nfind that the transmission probability has the greater effect on the\nperformance of Wolbachia in reducing dengue incidence (see Figures 7.5 \u2013\n7.7 ). Furthermore, lower transmission probability values do not result\nin outbreaks. In the presence of Wolbachia -carrying mosquitoes, the\nrange of transmission probabilities for which epidemics do not occur is\nlarger than that in the absence of Wolbachia -carrying mosquitoes (for\noverall cases, it is around 0\u20130.1 in the absence of Wolbachia , compared\nto 0\u20130.18 in the presence of Wolbachia -carrying mosquitoes). This means\nthat the presence of Wolbachia -carrying mosquitoes raises the threshold\nat which epidemics occur. The maximum overall reduction in dengue\nincidence due to Wolbachia is around 70-80%, which occurs when the\ntransmission probability lies in the range 0.14\u20130.22. In this range of\ntransmission probabilities, epidemics either do not occur or the\noutbreak size is smaller when Wolbachia -carrying mosquitoes are present\n(Figures 7.5 ). Moreover, as the transmission probability increases, the\nreduction in secondary infections due to Wolbachia is greater than that\nof primary infections (Figures 7.6 and 7.7 ). This reduction in\nsecondary infections can reach up to 90%.\n\n#### 7.3.2 Second Dengue Introduction Scenario of Dengue\n\nThe performance of Wolbachia in reducing dengue in the second scenario\nof dengue introduction is similar to that in the first scenario. An\nincrease in the ADE rate leads to an increase in the outbreak size of\ndengue infections in both in the absence and in the presence of\nWolbachia -carrying mosquitoes (Figure 7.8 ). When the ADE is higher,\nthe level of reduction in dengue incidence caused by Wolbachia slightly\ndecreases. The reduction in the number of secondary infections is higher\nthan that of primary infections, with the level of overall reduction and\nreduction in primary and secondary infections similar to those found for\nthe first scenario of disease introduction.\n\nWhen the ADE and the transmission probability are varied simultaneously,\nwe find that the transmission probability has more impact on the\nperformance of Wolbachia in reducing dengue incidence than the ADE. The\npresence of Wolbachia raises the threshold at which epidemics occur (see\nFigures 7.9 \u2013 7.11 ). The maximum overall reduction in dengue reaches\n80% for a similar range of transmission probabilities (around 0.14-0.22)\nto the one found for the first disease introduction scenario (Figure 7.9\n). The effects of ADE become stronger for higher values of the\ntransmission probability. The proportional reduction in secondary\ninfections is higher than that for primary infections. The maximum\nreduction in primary infections is 80%, compared to more than 90% for\nsecondary infections.\n\n### 7.4 Discussion and Conclusions\n\nIn this chapter, we analysed the effect of Wolbachia on dengue dynamics\nunder different disease introduction scenarios, when two dengue\nserotypes with symmetric epidemiological characteristics are\ncirculating. We found that the benefits of Wolbachia are similar\nregardless of the disease introduction scenario. Since the time of\nintroduction of a particular dengue serotype into the population is very\nuncertain, it is not easy to predict the dominant serotype before an\nepidemic occurs. Predicting the dominant dengue serotype before an\nepidemic takes off may be important from the public health perspective\nas the presence of different serotypes may change the severity of the\nepidemic [ 74 , 87 , 92 ] . However, our findings suggest that\nuncertainty around dengue serotypes is not a hurdle for the\nimplementation of the Wolbachia intervention. Although all dengue\nserotypes circulate in the population, and the times at which\nindividuals infected with different dengue serotypes enter the\npopulation are irregular, Wolbachia will still reduce the number of\ndengue cases. This is particularly true for secondary infections which\ncan result in more severe forms of dengue.\n\nOur results for both disease introduction scenarios show that the\noutbreak size increases as the transmission probability increases.\nFurthermore, we found that the ADE does not have a noticeable impact on\nthe effectiveness of Wolbachia unless the transmission probability is\nhigh. The maximum overall reduction in dengue cases is obtained for\ntransmission probabilities in the range 0.14-0.22, and a considerable\nreduction in secondary infections of 70-90% is achieved. However, if the\ntransmission probability is high, reductions in dengue incidence of only\n20-40% are likely. This implies that Wolbachia will be most effective in\nreducing dengue transmission if dengue serotypes are not strongly\ntransmissible, a similar finding to the results of Chapter 5 for a\nsingle serotype. As the transmission probability is one of the\nparameters that regulates the basic reproduction number, our results are\nconsistent with the finding by Hughes and Britton [ 43 ] and Ferguson et\nal [ 28 ] that Wolbachia will be effective if the basic reproduction\nnumber is not too high. Our finding that differences in the ADE levels\nbetween serotypes have much less impact on dengue dynamics than\ndifferences in the transmission probability indicates that a better\nunderstanding of serotype-specific transmission probabilities may be\nneeded to optimize the delivery of the Wolbachia intervention.\n\nIn order to confirm our results, two further scenarios of dengue\nintroductions were explored: introducing individuals carrying serotype\u00a01\nfor the first six months and individuals carrying another dengue\nserotype for a further six months, and introducing individuals carrying\ndengue serotypes\u00a01 and\u00a02 at the same time. We found similar results to\nthose presented in this chapter.\n\nResearch has shown that the epidemiological characteristics of dengue\nserotypes may be different [ 92 , 4 , 79 , 87 ] . Although our results\nin this chapter, assuming symmetric epidemiological characteristics,\nprovide insights into the effectiveness of Wolbachia in reducing human\ndengue incidence in the presence of more than one dengue serotype, an\nanalysis of asymmetric epidemiological characteristics is of importance\nto further our understanding of Wolbachia performance in reducing human\ndengue incidence. The effects of Wolbachia on dengue transmission\ndynamics when the epidemiological characteristics between serotypes\ndiffer are explored in the next chapter.\n\n### 7.5 Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   We investigate the effect of Wolbachia in reducing dengue incidence\n    under different disease introduction scenarios when the\n    antibody-dependent enhancement (ADE) and the transmission\n    probability of serotypes are the same.\n\n-   We found that different disease introduction scenarios do not affect\n    the performance of Wolbachia in reducing dengue incidence (Sections\n    7.3.1 and 7.3.2 ).\n\n-   The level of ADE does not have a noticeable effect on dengue\n    transmission dynamics (Sections 7.3.1 and 7.3.2 , see Figures 7.4 \u2013\n    7.11 ).\n\n-   The proportional reduction in secondary infections (up to 90%) is\n    higher than that in the primary infections (up to 80%; Sections\n    7.3.1 and 7.3.2 , see Figures 7.4 \u2013 7.11 ).\n\n## Chapter 8 Two Serotypes with Asymmetric Epidemiological\nCharacteristics***Results and discussions in this chapter form part of\nthe manuscript that has been submitted for publication as M.Z. Ndii, D.\nAllingham, R.I. Hickson, K. Glass. The effect of Wolbachia on dengue\ndynamics in the presence of two serotypes of dengue: symmetric and\nasymmetric epidemiological characteristics.\n\nIn the previous chapter, we studied the effect of Wolbachia on dengue\ntransmission dynamics under different disease introduction scenarios\nwhen the epidemiological characteristics of the serotypes were assumed\nto be symmetric. In this chapter, we study the effect of Wolbachia on\ndengue transmission dynamics when the epidemiological characteristics of\nthe serotypes are asymmetric. That is, we explore the case where one\nserotype is more transmissible or has a higher ADE than the other.\n\n### 8.1 Introduction\n\nResearch has shown that the characteristics of dengue serotypes may be\ndifferent [ 92 , 4 , 79 , 87 , 74 , 27 ] . For example, the severity of\ndisease varies between serotypes [ 92 ] , DEN1 may result in more severe\nsymptoms than DEN4 [ 74 ] , and infections with DEN1 may result in\nhigher viraemia levels than infections with DEN2 [ 87 ] . These\ndifferences may affect the performance of Wolbachia in reducing dengue\ntransmission.\n\nModelling studies have investigated the effects of asymmetric\nepidemiological characteristics on dengue dynamics in the absence of\nWolbachia -carrying mosquitoes [ 65 , 50 ] . However, little has been\ndone to investigate the effects of asymmetric epidemiological\ncharacteristics of dengue serotypes on the performance of Wolbachia in\nreducing dengue transmission. In this chapter, we use the mathematical\nmodels formulated in Chapter 6 to study the effects of Wolbachia in\nreducing dengue incidence when the epidemiological characteristics of\nthe two circulating serotypes differ, Equations\u00a0( 6.3 )\u2013( 6.14 ) and\nEquations\u00a0( 6.24 )\u2013( 6.39 ). The characteristics of interest are the\nantibody-dependent enhancement parameter, @xmath , and the transmission\nprobability, @xmath .\n\nThe equations from Chapter 6 describing the forces of infection for\nhumans, non- Wolbachia mosquitoes and Wolbachia -carrying mosquitoes\nare, respectively,\n\n  -- -------- -- -------\n     @xmath      (8.1)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (8.2)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (8.3)\n  -- -------- -- -------\n\nHere @xmath is the transmission probability of serotype @xmath between\nhumans and non- Wolbachia mosquitoes, and from humans to Wolbachia\n-carrying mosquitoes. The parameter @xmath is the ADE for serotype\n@xmath , and the parameters @xmath and @xmath are the biting rates of\nnon- Wolbachia and Wolbachia -carrying mosquitoes, respectively. The\nparameter @xmath is the transmission probability from Wolbachia\n-carrying mosquitoes with serotype @xmath to humans, and it is set to\n@xmath . In our investigations, the ADE and the transmission probability\nfor serotype\u00a02 are set to be higher than those for serotype\u00a01 as\nfollows:\n\n  -- -------- -------- -------- -------\n     @xmath   @xmath            (8.4)\n              @xmath   @xmath   \n  -- -------- -------- -------- -------\n\nHere @xmath [ 42 ] and @xmath [ 69 ] . The parameter @xmath varies\nbetween 0 and 1.9 ( @xmath ) and the parameter @xmath varies between 0\nand 0.2387 ( @xmath ). Thus @xmath and @xmath , which are reasonable\nranges for ADE and the transmission probability [ 42 , 6 ] . Therefore,\nthe force of infection for humans, non- Wolbachia mosquitoes and\nWolbachia -carrying mosquitoes of serotype\u00a02 is higher than that of\nserotype 1:\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince, as we discovered in Chapter 7 , disease introduction scenarios do\nnot appear to influence the performance of Wolbachia in reducing dengue\ntransmission, only one disease introduction scenario is used in this\nanalysis. That is, each dengue serotype is introduced weekly in\nalternate years. Although the strategy of dengue introductions is\ndifferent, the total outbreak sizes caused by different serotypes were\nsimilar for both scenarios. This means that although @xmath is\ndifferent, the outbreak size caused by each dengue serotype would be\nsimilar for different scenarios of dengue introductions. Therefore, in\nthis analysis, we use the scenario where each dengue serotype is\nintroduced weekly in alternate years.\n\nThe outbreak size over two years is used to quantify the proportional\nreduction in dengue incidence due to Wolbachia as it includes the sizes\nof the outbreaks caused by both serotypes. The four-year outbreak size\nused in the preceding chapter is unnecessary here because we are not\ncomparing the performance of Wolbachia in reducing dengue under\ndifferent disease introduction scenarios. The simulation procedures used\nhere are the same as those used in the previous chapters (Chapters 5 and\n7 ).\n\n### 8.2 Results\n\nIn this section, the results of simulations exploring the effects of\nasymmetry in the antibody-dependent enhancement (ADE) (Section 8.2.1 )\nand the transmission probabilities (Section 8.2.2 ) on Wolbachia\nperformance in reducing dengue incidence are presented. A discussion and\nconclusion appears in Section 8.3 .\n\n#### 8.2.1 Effect of Asymmetric Antibody-Dependent Enhancement\n\nIn our simulations for this section, the ADE for serotype\u00a02 is varied\nand that of serotype\u00a01 is fixed.\n\nWhen the dengue serotypes have different ADE, an increase in the ADE for\nserotype\u00a02 leads to slight increases in the overall outbreak size and\nthe outbreak size due to primary and secondary infections in the absence\nand presence of Wolbachia -carrying mosquitoes. The proportional\nreduction in dengue incidence caused by Wolbachia also decreases (Figure\n8.1 ). The proportional reduction in secondary infections (73\u201378%) is\nhigher than that of primary infections (40\u201345%), and the overall\nreduction in dengue incidence varies between 53% and 58%.\n\nWhen looking at the effects of each dengue serotype on the performance\nof Wolbachia in reducing dengue incidence, we see that the serotype with\nthe higher ADE (serotype 2) contributes more to the primary infections,\nwhereas the serotype with the lower ADE (serotype 1) contributes more to\nthe secondary infections (see Figure 8.2 ). As the ADE for serotype 2\nincreases, the overall outbreak size and the outbreak size for primary\ninfections due to serotype 2 in the absence of Wolbachia increases,\nwhereas the outbreak size for secondary infections due to serotype 2 in\nthe absence of Wolbachia decreases. The same behaviour is found in the\npresence of Wolbachia -carrying mosquitoes, except that the outbreak\nsize for secondary infections with serotype 2 slightly increases. On the\nother hand, as the ADE for serotype 2 increases, the overall outbreak\nsize for serotype 1 in the absence of Wolbachia -carrying mosquitoes\nremains constant because the decrease in the number of primary\ninfections is offset by the slight increase in the number of secondary\ninfections. Similar behaviour is found in the presence of Wolbachia\n-carrying mosquitoes. Moreover, as the ADE for serotype 2 increases, the\nperformance of Wolbachia in reducing the number of dengue cases due to\nserotype 2 decreases, though the reduction in the secondary infections\n(70\u201378%) is higher than that in the primary infections (40\u201345%). The\nperformance of Wolbachia in reducing dengue infections due to serotype\u00a01\nis similar to its performance against infections caused by serotype\u00a02.\n\n#### 8.2.2 Effect of Asymmetric Transmission Probabilities\n\nIf the transmission probability of serotype 2 is higher than that of\nserotype 1, the overall outbreak size and the outbreak sizes for primary\nand secondary infections in the absence and presence of Wolbachia\n-carrying mosquitoes increases, and the proportional reduction in\noverall, primary and secondary cases due to Wolbachia decreases (see\nFigure 8.3 ). The overall reduction varies between 31% and 58%, and the\nreduction in primary and secondary infections decreases from 45% to 13%\nand 78% to 60%, respectively.\n\nA strong effect on the Wolbachia performance in reducing dengue caused\nby differences in the transmission probabilities between dengue\nserotypes is observed (Figure 8.4 ). Generally, the more transmissible\nserotype (serotype\u00a02) will dominate the primary infections, while the\nless transmissible serotype (serotype 1) will dominate the secondary\ninfections. The overall outbreak size of dengue caused by serotype 1\nremains constant as the decrease in the number of primary infections is\nbalanced by the increase in the number of secondary infections.\nInterestingly, in the presence of Wolbachia -carrying mosquitoes,\nalthough the number of primary infections due to serotype 1 decreases,\nthe number of secondary infections due to serotype 2 slightly increases,\nbut the latter is still lower than the former. Furthermore, the results\nshow that the reduction in secondary infections is higher than that in\nprimary infections (see Figure 8.4 ). Moreover, Wolbachia can still\nreduce the number of dengue cases caused by the more transmissible\nserotype (serotype\u00a02).\n\n### 8.3 Discussion and Conclusions\n\nIn this chapter, we investigated the effect of asymmetric\nepidemiological characteristics on the performance of Wolbachia in\nreducing dengue incidence. Although ADE influences the performance of\nWolbachia in reducing dengue incidence, the transmission probability is\nstill the most influential parameter. The results are consistent with\nour previous findings for dengue serotypes with symmetric\nepidemiological characteristics. In the simulations conducted for this\nchapter, the reduction in secondary dengue infections due to Wolbachia\nis higher than that for primary infections.\n\nAs the ADE of serotype 2 is varied, the overall outbreak sizes in the\nabsence and presence of Wolbachia -carrying mosquitoes increases.\nFurthermore, the reduction in primary and secondary infections due to\nWolbachia declines slightly as the ADE of serotype 2\u00a0( @xmath )\nincreases. This implies that ADE does not have a large impact on the\nperformance of Wolbachia in reducing dengue. When looking at the effect\non individual serotypes, as the ADE of serotype 2 increases, the\noutbreak sizes of serotype\u00a02 primary infections increase and the\nincidence of serotype 1 primary infections decreases. Serotype\u00a02\ncontributes more to primary infections than serotype\u00a01 as the ADE of\nserotype\u00a02 increases. Because more individual humans are primarily\ninfected by serotype\u00a02, secondary infections are dominated by\nserotype\u00a01. If there are two serotypes circulating in the population and\nmore individuals have primary infections with one of the serotypes, then\nit is likely that more individuals have secondary infections with the\nother serotype.\n\nInterestingly, we find that although the number of primary infections\ndue to serotype\u00a01 decreases in the presence of Wolbachia -carrying\nmosquitoes, the number of secondary infections caused by serotype\u00a02\nincreases slightly. However, the number of secondary infections caused\nby serotype 2 is still lower than the number of primary infections\ncaused by serotype 1. This may be for the following reasons. As the ADE\nof serotype\u00a02 increases, there are more individuals primarily infected\nwith serotype\u00a02 than serotype\u00a01. The higher number of primary infections\nwith serotype\u00a02 affects the force of infection, resulting in a greater\nlikelihood of secondary infection with serotype 2 for individuals\npreviously infected with serotype\u00a01. Hence, as the ADE for serotype\u00a02\nincreases, the number of secondary infections caused by serotype\u00a02\nincreases. This implies that there is a complex interaction between\nvariables regulating the force of infections. Note that similar\nbehaviour is also found when varying the transmission probability of\nserotype\u00a02.\n\nA strong effect on the performance of Wolbachia in reducing dengue\ntransmission is found when the transmission probability of one of the\nserotypes is greatly different from the transmission probability of the\nother. When the transmission probability of one serotype is higher than\nthat of the other serotype, the number of primary infections caused by\nthat serotype (the serotype with higher transmission probability (\n@xmath )) is increased and secondary infections are more likely to be\ncaused by the other serotype (the serotype with the lower transmission\nprobability ( @xmath )). This is biologically realistic because when\n@xmath , more individuals are primarily infected with serotype\u00a02 and\nthus they are more likely to be secondarily infected with serotype\u00a01.\nFurthermore, Wolbachia will be less effective in in reducing the overall\nnumber of dengue cases caused by the more transmissible serotype.\nAlthough asymmetry in the transmission probabilities can lead to a\nhigher number of secondary infections due to the less transmissible\nserotype, this incidence can be reduced by up to 78% with the\nimplementation of the Wolbachia intervention.\n\nOur findings suggest that if the more transmissible serotype is\nresponsible for more severe illness, then reducing the incidence of\nprimary infections may be of concern. This is because the more\ntransmissible serotype will cause more primary infections. Although\nsecondary infections can lead to more severe forms of dengue, paying\nattention to primary infections is also important given that the level\nof reduction in dengue primary infections due to the Wolbachia\nintervention is not as great as the reduction in secondary infections.\nFurthermore, our finding that differences in antibody-dependent\nenhancement rates between serotypes have a much smaller effect on dengue\ndynamics than differences in the transmission probabilities indicates\nthat a better understanding of serotype-specific transmission\nprobabilities may be needed in order to develop strategies to optimize\nthe delivery of Wolbachia interventions.\n\nFurther investigation of the variables that regulate the force of\ninfections is needed to advance our understanding of Wolbachia\nperformance in reducing dengue incidence. A further exploration of\nserotype-specific effects on the performance of Wolbachia in reducing\ndengue incidence is one possible avenue for future exploration. Ferguson\net al. [ 28 ] estimated the basic reproduction numbers for the four\ndengue serotypes. If the data becomes available, one could find similar\nestimates for the parameters that govern the force of infection or the\nbasic reproduction number. Our theoretical explorations provide insights\ninto the performance of Wolbachia when two dengue serotypes circulate in\nthe population, and, in particular, when the epidemiological\ncharacteristics between serotypes differ. The results are consistent\nwith our findings for a single serotype presented in part 1 of this\nthesis. It may be of future interest to explore Wolbachia performance\nwhen more than two dengue serotypes circulate.\n\n### 8.4 Summary\n\n-   [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n-   We investigate the performance of Wolbachia in reducing dengue\n    incidence when the level of antibody-dependent enhancement (ADE) and\n    the transmission probability of dengue serotypes are different\n    (Sections 8.2.1 and 8.2.2 ).\n\n-   When a dengue serotype has higher ADE or transmission probability,\n    that serotype will contribute more to primary infections, whereas\n    the other serotype will contribute more to secondary infections\n    (Sections 8.2.1 and 8.2.2 , see Figures 8.2 and 8.4 ).\n\n-   The proportional reduction in secondary infections is higher than\n    that in primary infections when one serotype is more transmissible\n    that the other serotype (around 60\u201378% compared to around 13\u201345%;\n    see Section 8.2.2 ) or has higher ADE than the other serotype\n    (73\u201378% compared to 40\u201345%; see Section 8.2.1 ) .\n\n## Chapter 9 Conclusions and Future Directions\n\nThe central question addressed by this thesis is \u201cto what extent can\nWolbachia reduce dengue transmission?\u201d. We have approached this question\nby formulating novel mathematical models for populations in which one\nand two dengue serotypes circulate in the absence and presence of\nWolbachia -carrying mosquitoes. The details of these mathematical models\nare given in Chapter 3 (single serotype dengue models) and Chapter 6\n(two-serotype dengue models). As discussed in Section 1.2 , the aims of\nthis thesis are to\n\n1.  [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n2.  Determine the level of reduction in dengue incidence caused by the\n    presence of Wolbachia -carrying mosquitoes.\n\n3.   Explore the effects of seasonality and other important parameters\n    on dengue transmission dynamics and the persistence of Wolbachia\n    -carrying mosquitoes.\n\n4.  Determine the effects of dengue introduction scenarios on the\n    performance of Wolbachia in reducing dengue incidence.\n\n5.  Investigate the effects of two dengue serotypes and dengue serotype\n    characteristics on the performance of Wolbachia in reducing dengue\n    incidence.\n\nOur original results, presented in Chapters 3 \u2013 8 , fulfil the aims of\nthis thesis as listed above. Aim 1 is satisfied in Chapters 4 , 5 , 7\nand 8 . Aim 2 is satisfied in Chapter 4 . Aim 3 is satisfied in Chapters\n5 and 7 , while Aim 4 is satisfied in Chapters 7 \u2013 8 . A summary of the\noriginal results contained in this thesis is given below in Section 9.1\n.\n\n### 9.1 Summary of the Results\n\nThe original findings discovered in this thesis can be grouped into two\nparts: results which consider the circulation of a single dengue\nserotype and results which consider the circulation of two dengue\nserotypes.\n\nPart 1 of this thesis (Chapters 3 - 5 ), is concerned with the\ndevelopment of novel mathematical models for dengue transmission\ndynamics where it is assumed that a single dengue serotype is\ncirculating in the population. Separate models are developed to consider\nboth the absence and presence of Wolbachia -carrying mosquitoes. These\nmodels are then used to analyse the effects of Wolbachia on dengue\ntransmission dynamics when dengue cases are introduced once and multiple\ntimes.\n\nWhen dengue cases are introduced into the population once, and Wolbachia\n-carrying mosquitoes persist, a reduction in dengue incidence of up to\n90% can be obtained. Furthermore, the choice of Wolbachia strain for\ninoculation of the mosquitoes has a significant effect on the ability\nfor Wolbachia -carrying mosquitoes to persist in competition with non-\nWolbachia mosquitoes. The WMel strain, which reduces the lifespan of the\nmosquito by at most 10%, allows the Wolbachia -carrying mosquitoes to\npersist, whereas the WMelPop strain is unlikely to allow persistence\nsince it reduces the mosquito lifespan by up to 50%.\n\nCytoplasmic incompatibility, when considered in isolation from all other\nphysiological effects of Wolbachia on the mosquitoes, was found to\nreduce the number of human dengue cases. When exploring the key\nparameters for our models, we found the range of the ratios of\nreproductive and death rates for adult non- Wolbachia mosquitoes which\nallowed Wolbachia -carrying mosquitoes to persist. Furthermore, the\ntransmission probability, the biting rate and the average death rate\nwere found to be the most influential parameters, the latter having a\nnegative relationship with the cumulative number of infectious\nindividuals. The results for the basic reproduction number, @xmath ,\nshow that Wolbachia reduces the number of days for which @xmath .\n\nWhen investigating multiple introductions of dengue cases into the\npopulation, we simulated weekly introductions of dengue cases into the\npopulation throughout the year and over three month periods. We found\nthat Wolbachia reduces the potential length of the season in which\nepidemics are likely to occur by up to six weeks, depending on the\nstrength of seasonality. The largest reduction in dengue incidence found\nwas around 80%, which is obtained when the strength of the seasonal\nforcing is low. The efficacy of Wolbachia also depends on the\ntransmission rate, with the bacteria most effective in reducing dengue\nincidence at moderate transmission rates ranging from 0.08\u20130.12. This is\nconsistent with fitted estimates for Cairns, Australia as given in\nChapter 4 .\n\nIn part 2 of the thesis (Chapters 6 \u2013 8 ), the performance of Wolbachia\nin reducing dengue incidence when two serotypes of dengue circulate in\nthe population is investigated.\n\nWhen considering the case where epidemiological characteristics of these\nserotypes are the same (the \u2018symmetric case\u2019), we found that varying the\ndisease introduction scenario does not affect dengue transmission\ndynamics. Although the timing of dengue introductions is irregular and\nis not easy to investigate, the results for the disease introduction\nscenarios that we simulated suggest that the Wolbachia intervention can\nbe implemented, regardless of the disease introduction scenario.\nFurthermore, the antibody-dependent enhancement rate does not noticeably\naffect the impact of Wolbachia on dengue incidence unless the\ntransmission probability is high. A considerable reduction in secondary\ninfections of 60-80% is achieved through the Wolbachia intervention.\n\nWhen the epidemiological characteristics of the dengue serotypes differ,\nthere is a shift towards greater numbers of primary infections of the\nserotype with the higher enhancement rate or higher transmission\nprobability. Where only the antibody-dependent enhancement rate differs\nbetween serotypes, we find relatively little decline in the\neffectiveness of Wolbachia . However, if one serotype is more\ntransmissible than the other, Wolbachia is less effective in reducing\ndengue cases caused by the more transmissible serotype. Although the\nnumber of secondary infections caused by the less transmissible serotype\nis higher, a reduction of around 78% in the number of secondary\ninfections can be obtained by the implementation of the Wolbachia\nintervention.\n\n### 9.2 Conclusions\n\nIn this thesis we sought to answer the question: \u201cto what extent can\nWolbachia reduce dengue transmission?\u201d.\n\nWe found that once mosquitoes carrying the Wolbachia bacterium persist,\na reduction in dengue incidence of up to 80% can be obtained in the\npresence of one or two circulating dengue serotypes. A higher reduction\nin the incidence of secondary infections can be obtained regardless of\nthe epidemiological characteristics of the serotypes. Different disease\nintroduction scenarios and levels of antibody-dependent enhancement in\nsecondary cases do not affect the performance of Wolbachia in reducing\ndengue incidence. By contrast, differences in the transmission\nprobabilities of the serotypes have a much greater effect. If the\ntransmission probability is high, Wolbachia can reduce the number of\ndengue cases by only around 20%-40%. Where serotypes have different\nepidemiological characteristics, the more transmissible serotype will\ndominate primary infections, and the less transmissible serotype will\ndominate secondary infections.\n\nOur findings suggest that Wolbachia should reduce the number of primary\ndengue cases in areas with moderate transmission levels, and cause even\ngreater reductions in the incidence of secondary cases. Given the higher\nrisk of severe outcomes in secondary cases, Wolbachia has great\npotential for improving public health.\n\n### 9.3 Future Directions\n\nThe work contained in this thesis makes a significant contribution to\nthe current knowledge of dengue transmission dynamics and provides\nevidence of the effectiveness of the Wolbachia intervention in reducing\ndengue transmission. To advance our understanding of the performance of\nWolbachia in reducing dengue incidence, several possible directions are\nopen for study. These may utilise our work as a baseline.\n\n1.  [wide=0pt,labelwidth = 1.3333em, labelsep = 0.3333em, leftmargin = ]\n\n2.  In this thesis, deterministic mathematical models are formulated,\n    which are appropriate for large population sizes. A stochastic\n    approach could be used to further our understanding of the impact of\n    small infected population sizes on dengue dynamics in the presence\n    of Wolbachia -carrying mosquitoes. Alternatively, a hybrid modelling\n    approach, coupling deterministic and stochastic models could be\n    used. In such an approach, a stochastic model would be used when the\n    infected population becomes small, and a deterministic model when\n    the infected population exceeds a certain threshold value.\n\n3.  We found that the biting rate is one of the important parameters\n    that regulates the transmission dynamics of dengue. In this thesis,\n    the biting rate is assumed to be fixed. To further our understanding\n    of the effect of the biting rate on dengue transmission dynamics in\n    the presence of Wolbachia -carrying mosquitoes, it may be of\n    interest to explore variations in the biting rate of mosquitoes.\n    Such variations could occur as mosquitoes get older and may have an\n    impact on regulating the transmission dynamics of dengue.\n\n4.  It may be of interest to explore the effect of feminisation of the\n    population of Wolbachia -carrying mosquitoes on the performance of\n    Wolbachia in reducing dengue transmission. The release of more males\n    than females seems to have an effect on the mosquito population\n    dynamics [ 35 , 113 ] , and, hence, on dengue transmission dynamics.\n\n5.  We define an \u201cinstantaneous basic reproduction number\u201d using a\n    formula for autonomous systems and replace the equilibrium mosquito\n    population with a time-varying mosquito population. It may be\n    interesting to derive the basic reproduction number for the full\n    seasonally-dependent model, or use the concept proposed by Bacaer [\n    8 ] to investigate the epidemic threshold.\n\n6.  A different approach such as metapopulation modelling or\n    integro-differential equations may be used to investigate the\n    effects of human movements on dengue transmission dynamics.\n\n## Appendix A Appendix Basic Reproduction Number\n\nWe derive the basic reproduction number for dimensionalised models. The\ninfected subsystem of the single serotype dengue model in the persence\nof Wolbachia -carrying mosquitoes (Equations\u00a0( 3.33 )\u2013( 3.44 )) is given\nby\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      (A.1)\n     @xmath   @xmath      (A.2)\n     @xmath   @xmath      (A.3)\n     @xmath   @xmath      (A.4)\n     @xmath   @xmath      (A.5)\n     @xmath   @xmath      (A.6)\n  -- -------- -------- -- -------\n\nAt the infection-free steady state, @xmath , and @xmath . For small\n@xmath , the linearised infected subsystem is approximated by\nEquations\u00a0( A.1 )\u2013( A.6 ), with @xmath .\n\nLet @xmath . We want to write the linearised infected subsystem in the\nform\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath is the transmission matrix, whose entries correspond to\ntransmission events, and @xmath is the transition matrix, whose entries\ncorrespond to movement between the infected compartments including\ndeaths.\n\nThe transmission matrix @xmath is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath and @xmath are the number of mosquitoes with and without\nWolbachia . As mosquito populations vary seasonally, both of these are\nfunctions of time. The transition matrix @xmath is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe next find the inverse of the transition matrix @xmath :\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe multiply the transmission matrix and the inverse of transition matrix\nto obtain\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe spectral radius of the matrix @xmath is the basic reproduction\nnumber, that is,\n\n  -- -------- -- -------\n     @xmath      (A.7)\n  -- -------- -- -------\n\nEquation\u00a0( A.7 ) gives the basic reproduction number in the presence of\nWolbachia . In the absence of Wolbachia , after setting all Wolbachia\n-related parameters to zero, Equation A.7 is reduced to\n\n  -- -------- -- -------\n     @xmath      (A.8)\n  -- -------- -- -------\n\nThe basic reproduction number found here can be considered to be an\ninstantaneous basic reproduction number which depends on fluctuations in\nthe mosquito population, @xmath and @xmath .\n","output":["The introduction of Wolbachia-carrying mosquitoes into the population has\nrecently been proposed as an alternative strategy against dengue. Although\nlaboratory experiments have shown that the Wolbachia bacterium can reduce the\nlevels of dengue virus in mosquitoes, it is also important to assess the\nperformance of Wolbachia in reducing the incidence of dengue in human\npopulations.In this thesis, deterministic mathematical models of human and\nmosquito populations in which either one or two dengue serotypes circulate are\ndeveloped. We adapt these models to enable the investigation of dengue disease\ndynamics in the absence and presence of Wolbachia in order to assess the\nperformance of Wolbachia as a strategy to reduce human dengue incidence. When\nstudying the situation in which a single dengue serotype is present in the\npopulation, we consider scenarios where dengue is introduced into the human\npopulation once and multiple times.","The introduction of Wolbachia -carrying mosquitoes into the population\nhas recently been proposed as an alternative strategy against dengue.\nAlthough laboratory experiments have shown that the Wolbachia bacterium\ncan reduce the levels of dengue virus in mosquitoes, it is also\nimportant to assess the performance of Wolbachia in reducing the\nincidence of dengue in human populations.\n\nIn this thesis, deterministic mathematical models of human and mosquito\npopulations in which either one or two dengue serotypes circulate are\ndeveloped. We adapt these models to enable the investigation of dengue\ndisease dynamics in the absence and presence of Wolbachia in order to\nassess the performance of Wolbachia as a strategy to reduce human dengue\nincidence.\n\nWhen studying the situation in which a single dengue serotype is present\nin the population, we consider scenarios where dengue is introduced into\nthe human population once and multiple times. We find that when\nmosquitoes infected with the Wolbachia strain WMel , which reduces the\nmosquito lifespan by at most 10%, are released into the population, the\nWolbachia -carrying mosquitoes persist. The ranges of the reproductive\nand death rates for Wolbachia -carrying mosquitoes which allow\nmosquitoes carrying Wolbachia to persist in competition with non-\nWolbachia carrying mosquitoes are also found. Furthermore, the\ntransmission probability, the biting rate and the average death rate are\nthe parameters exerting the most influence on the cumulative number of\ninfectious individuals in the population. An analysis of the basic\nreproduction number, @xmath , for the model considering the absence and\npresence of Wolbachia -carrying mosquitoes shows that the presence of\nWolbachia -carrying mosquitoes reduces the number of days for which\n@xmath . When multiple introductions of dengue are considered, it is\nfound that the presence of Wolbachia reduces the potential lengths of\nthe seasons in which epidemics are likely to occur. The strength of\nseasonality also affects the reduction in dengue incidence caused by the\nintroduction of Wolbachia : if seasonality is strong, then there are\nsome seasons when mosquitoes have longer life spans and more individuals\nare infected in each outbreak so that Wolbachia becomes less effective\nin reducing dengue incidence.\n\nOur two-serotype dengue models are used to investigate dengue serotypes\nwith symmetric and asymmetric characteristics. For serotypes with\nsymmetric characteristics, we investigate the performance of Wolbachia\nin reducing dengue incidence under different disease introduction\nscenarios, and find that a difference in the disease introduction\nscenario does not affect the performance of Wolbachia in reducing dengue\nincidence. Furthermore, the transmission probability is a more\ninfluential parameter regulating dengue dynamics than antibody-dependent\nenhancement. When dengue serotype characteristics differ (asymmetry),\nthe more transmissible dengue serotype will dominate the primary\ninfection, while the other serotype will dominate the secondary\ninfections. The number of secondary infections caused by the more\ntransmissible serotype can still be reduced by the introduction of\nWolbachia -carrying mosquitoes, but the proportional reduction in dengue\ncases is not as high.\n\nOur findings suggest that Wolbachia intervention can be used as an\neffective alternative strategy against dengue. Wolbachia should reduce\nthe number of primary dengue cases in areas with moderate transmission\nlevels, and can provide an even greater reduction in the number of\nsecondary cases. Given the higher risk of severe outcomes in secondary\ncases, Wolbachia has great potential for improving public health.\n"]}
{"input":"##### Acknowledgements. This thesis is the final result of almost three\nyears of hard work and God only knows how much this has coasted me in\nterms of personal affections and sacrifices, but I would do it again. It\nhas been a really great experience and has given me the opportunity to\nrealise myself as the theoretical cosmologist that I always wanted to\nbe. Living in UK was not easy at the beginning, but now I am perfectly\nintegrated with this country that I consider my second home. I have\nlearned not to complain about the weather and the food since there are\nother things that make life worth living. At the end of this adventure I\nhave discovered that all the joys and sorrows I went through have made\nme a much better person. I really have to thank my supervisor Ed\nCopeland who gave me this chance without knowing me, a chance that my\nhome country refused to offer to me. I am particularly thankful to him\nfor allowing me to develop my own ideas about research projects, ideas\nthat we improved together through open minded discussions. I also thank\nthe Institute of Cosmology of Portsmouth for their welcoming hospitality\nduring these many years. It has been a pleasure to start a fruitful\ncollaboration with Bruce Bassett and Carlo Ungarelli and if this has\nbeen possible I have to thank my dear friend Cristiano Germani with whom\nI established a strong brotherhood. I thank Luca Amendola for the\nhospitality during my visit at the Astronomical Observatory of Rome and\nthe Physics Department of Dartmouth College (New Hampshire) where a\nlarge part of this thesis was written. In particular it is a pleasure to\nthank Marcelo Gleiser, Robert Caldwell and Michael Doran for the\nwelcoming atmosphere I found in Dartmouth, for the useful and\ninteresting physics discussions and for bearing the visit of a crazy\nroman. I am particularly grateful to Andrew Liddle, Nelson Nunes, Nicola\nBartolo, Martin Kunz and Michael Malquarti for the many cosmological\ndiscussions and all the members of the physics and astronomy group, in\nparticular Mark Hindmarsh, Andre Lukas, Peter Schroder, Beatriz de\nCarlos and David Bailin, for the pleasant and friendly environment of\nthe Sussex group. I am glad to have met and mention an enormous number\nof friends: first of all my friend Gonzalo Alvarez, also Lys Geherls,\nJane Hunter, Gemma Dalton, Electra Lambiri, Isaac Neumann, Asher\nWeinberg, my flat mates Stephen Morris and particularly Neil McNair for\nbooking concert tickets so many times , Matteo and Chiara Santin for\ntheir kind and nice friendship, Fernando Santoro, James Gray, Malcom\nFairbairn, Seung-Joo Lee, Maria Angulo, Liam O\u2019Connell for is effort to\nexplain to me the rules of cricket during the world cup football\nmatches, James Fisher, Jon Roberts, Neil Bevis and in particular Yaiza\nSchmohe. I will never forget the amazing Sweet Charity Band and its\nconductor Chloe Nicholson who gave me the opportunity to play my\nclarinet on the stage again. They made me remember who I truly am deep\nin my soul, simply a clarinet player. A particularly express my thanks\nto my parents for their moral support and for paying the flight tickets\nto Italy. This thesis is dedicated to the memory of Franco Occhionero,\nhe was an extraordinary scientist and one of the most lovely people I\nhave ever met. Always generous in helping and guiding his students he\npaid attention to teaching and researching as much as to the\npopularization of science. I will never forget his public lectures, his\nkindness and the strength and genuine humility of his personality. My\napproach to Cosmology is the result of the daily interaction with such a\ngreat man and I am proud of being one of his many pupils. Finally I\nwould like to conclude with a little bit of the sarcasm that plays a\nfundamental role in my life. It may be that all this work is entirely\nwrong, I do not think it is since I am responsible for it, but in the\nremote eventuality I would like to remind the reader of Francis Bacon\u2019s\nwords: \u2018The truth arises more from the errors rather than from the\nconfusion\u2019 .\n\nTo the memory of\n\nProf. Franco Occhionero\n\n###### Contents\n\n-    \\thechapter The dark side of the Universe\n    -    1 A historical introduction\n    -    2 Standard cosmology\n    -    3 Observational evidence\n        -    3.1 CMB anisotropies\n        -    3.2 Clustering of matter\n        -    3.3 Age of the Universe\n        -    3.4 Supernovae Ia and luminosity distance measurements\n    -    4 Cosmic complementarity\n-    \\thechapter An explanation for the dark energy?\n    -    5 Vacuum energy\n    -    6 Anthropic solutions\n    -    7 Quintessence\n        -    7.1 Scalar field dynamics\n        -    7.2 Quintessential problems\n    -    8 Supergravity inspired models\n        -    8.1 Exponential Times Inverse Power Law potential\n        -    8.2 Two Exponential potential\n-    \\thechapter Quintessence field fluctuations\n    -    9 Quintessence perturbations in Newtonian gauge\n    -    10 Evolution of perturbations\n        -    10.1 Analytical solution in the tracker regime\n        -    10.2 Numerical analysis\n-    \\thechapter Constraining the quintessence potential\n    -    11 Upper bounds on the cosmic equation of state\n    -    12 Parameterized quintessence potential\n    -    13 CMB peaks\n    -    14 Likelihood analysis and results\n        -    14.1 Constraints from supernovae\n        -    14.2 Constraints from Doppler peaks and Sn Ia\n    -    15 Discussion\n-    \\thechapter A model independent approach to the dark energy\n    equation of state\n    -    16 The effective equation of state\n    -    17 Cosmological distance fitting functions\n    -    18 Statefinder method\n    -    19 Low redshift parameterization\n    -    20 An exact parameterization for the dark energy equation of\n        state\n-    \\thechapter Dark energy effects in the Cosmic Microwave Background\n    Radiation\n    -    21 A beginner\u2019s guide to CMB physics\n        -    21.1 Basic equations\n        -    21.2 CMB anisotropies\n    -    22 Dark energy and the Integrated Sachs-Wolfe effect\n    -    23 Differentiating dark energy models with CMB measurements\n    -    24 Testing dark energy with ideal CMB experiments\n-    \\thechapter Alternative cosmological test with higher order\n    statistics\n    -    25 Higher order statistics\n    -    26 Frequentist approach and estimation of higher moments\n    -    27 Modelling localized non-Gaussian anisotropies\n    -    28 Discussion\n\n\\starttext\n\n## Introduction\n\nThe set of astrophysical observations collected in the past decades and\nthe theoretical and experimental developments in high energy physics\nhave provided the natural framework that defines Cosmology as a\nscientific discipline. The identification of the \u2018Hot Big-Bang\u2019 scenario\nas a paradigm has been of crucial importance for the beginning of\nCosmology as a modern science. In fact it has allowed us to address a\nnumber of questions about the nature and the evolution of the Universe\nthat otherwise would have been the subject of investigation of\nphilosophers and theologians. Since this paradigm has been accepted by\nthe majority of the scientific community, more specific and detailed\nstudies have been undertaken in order to extend the validity of the\nparadigm to a wider class of phenomena such as the formation of the\nstructures we observe in the Universe. As result of this intense\nactivity, that the philosopher of science T.S.\u00a0Kuhn would define as\nnormal science investigation [ 1 ] , the initial paradigm of Cosmology\nhas been extended in order to include the inflationary mechanism and\ndark matter, two necessary ingredients to explain a number of issues\nthat arise within the \u2018Hot Big-Bang\u2019 scenario. This extended paradigm is\nextremely successful and recent measurements in observational cosmology\nhave widely confirmed its prediction. It is very remarkable that long\nbefore the recent developments of the cosmological science, T.S.\u00a0Kuhn\nidentified the basic steps that a scientific discipline follows in its\nevolution, steps that applies to modern Cosmology too. In particular he\nhas pointed out that there are phenomena which evading an explanation of\nthe paradigm are the subject of \u2018extraordinary\u2019 investigations, in\nopposition to the \u2018ordinary\u2019 normal science activity. Most of the time\nthese studies lead to a crisis of the underlying paradigm and trigger\nwhat he has called a \u2018scientific revolution\u2019. In this light the\ndiscovery that the Universe is dominated by a dark energy component that\naccounts for @xmath of the total matter budget belongs to this class of\nphenomena. This is the subject of this thesis. In Chapter \\thechapter we\nwill describe the observational evidence of dark energy and in Chapter\n\\thechapter we will review some of proposed explanations. From Kuhn\u2019s\npoint of view these explanations would represent the attempt to force\nNature to fit within the \u2018Hot Big-Bang\u2019 paradigm. In fact these models\nfail to succeed since they manifest inconsistencies with the\nexpectations of particle physics theories that are included in the\nstandard cosmological paradigm. The solution to this difficulty most\nprobably will need a new paradigm. This necessity will be more urgent if\nthe observational data will indicate a time dependence of the dark\nenergy properties. In this perspective the aim of this thesis is to\ninvestigate some of the phenomenological aspects of minimally coupled\nquintessence scalar field scenarios. In Chapter \\thechapter we describe\nthe evolution of fluctuations in the quintessence field. In Chapter\n\\thechapter we discuss the constraints on a general class of\nquintessence potentials obtained from the analysis of the position of\nthe acoustic peaks in the Cosmic Microwave Background (CMB) anisotropy\npower spectrum and the Sn Ia data. In Chapter \\thechapter we describe\nsome of the methods used to constrain the dark energy. We then introduce\na model independent approach that allows us to study the full impact a\ngeneral dark energy fluid has had in Cosmology. In fact this fluid\ndescription, based on a very general parameterization of the dark energy\nequation of state, allows us to infer the dark energy properties from\ncosmological observations, instead of constraining specific classes of\ndark energy models. In Chapter \\thechapter we study the effects dark\nenergy produces in the CMB anisotropy power spectrum and show that\nclustering of dark energy leaves a distinguishable signature only for a\nspecific class of models. In Chapter \\thechapter we present the results\nof preliminary work that aims to develop alternative cosmological tests\nusing the non-gaussianity produced by localized sources of CMB\nanisotropies. We hope that the work reviewed in this thesis will provide\nthe basis for those \u2018extraordinary\u2019 investigations that will help us in\ndeveloping the new paradigm that modern Cosmology needs.\n\n## Chapter \\thechapter The dark side of the Universe\n\nThe recent results obtained in different areas of observational\ncosmology provide an astonishing picture about the present matter\ncontent of the Universe. The accurate measurements of the Cosmic\nMicrowave Background radiation (CMB) give strong evidence that the\ncurvature of the space-time is nearly flat. On the other hand the\nanalysis of large scale structure surveys shows that the amount of\nclustered matter in baryonic and non-baryonic form can account only for\nthirty per cent of the critical energy density of the Universe. In order\nto be consistent these two independent analyses require the existence of\nan exotic form of matter, that we call dark energy . More direct\nevidence is provided by the Hubble diagram of type Ia supernova (Sn Ia)\nat high redshifts. It suggests that the Universe is undergoing an\naccelerated expansion sourced by this dark energy component that is\ncharacterized by a negative value of its equation of state. A lot of\ncriticism has been levelled to these measurements. In fact the physics\nof Sn Ia is still a matter of debate and consequently their use as\nstandard candles has not yet convinced the whole astronomical community.\nIn spite of such an important issue it is worth underlining that the\ncombination of CMB and supernova data constrains the amount of clustered\nmatter in the Universe to a value that is consistent with the large\nscale structure observations. As we shall review in this chapter,\nindirect evidence for a dominant dark energy contribution comes mainly\nfrom the combination of CMB results and the constraints on the density\nof baryons and cold dark matter. The simplest explanation for the dark\nenergy would be the presence for all time of a cosmological constant\nterm @xmath in Einstein\u2019s equations of General Relativity. However\nevidence for a non vanishing value of @xmath raises a fundamental\nproblem for theoretical physics, (for a review of the subject [ 2 , 3 ,\n4 , 5 , 6 , 7 ] ). In fact, as we shall see later, it is rather\ndifficult to explain the small observed value of @xmath from the\nparticle physics point of view. In this chapter we will briefly review\nsome historical developments of the dark energy problem. We will\nintroduce the standard cosmological model and the equations describing\nthe expansion of the Universe. Then we will discuss the build up of\nobservational evidence for dark energy.\n\n### 1 A historical introduction\n\nThe cosmological constant was initially introduced by Einstein in the\nequations of General Relativity (GR) as a term that could provide static\ncosmological solutions [ 8 ] . Motivated by the observed low velocities\nof the stars, he assumed that the large scale structure of the Universe\nis static. We should remind ourselves that the notion of the existence\nof other galaxies had been established only a few years later. Besides,\nEinstein believed that the GR equations had to be compatible with the\nMach\u2019s principle, which in a few words states that the metric of the\nspace-time is uniquely fixed by the energy momentum tensor describing\nthe matter in the Universe. For this reason he thought the Universe had\nto be closed. These two assumptions were, however, not compatible with\nthe original form of the GR equations. In fact a matter dominated closed\nUniverse is not static, therefore he needed to introduce a term leading\nto a repulsive force that could counterbalance the gravity. In such a\ncase he found a static and closed solution that preserved Mach\u2019s\nprinciple. But in the same year, 1917, de Sitter discovered an apparent\nstatic solution that incorporated the cosmological constant but\ncontained no matter [ 9 ] . As pointed out by Weyl, it was an\nanti-Machian model with an interesting feature: test bodies are not at\nrest and an emitting source would manifest a linear redshift distance\nrelation. Such an argument was used by Eddington to interpret Slipher\u2019s\nobservations of the redshift of spiral nebula (galaxies). Subsequently\nexpanding matter dominated cosmological solutions without a cosmological\nconstant were found by Friedman [ 10 , 11 ] and Hubble\u2019s discovery of\nthe linear redshift distance relation [ 12 ] made these models the\nstandard cosmological framework. The cosmological constant was then\nabandoned. For some time a non vanishing @xmath was proposed to solve an\n\u2018 age problem \u2019. Eddington pointed out the Hubble time scale obtained by\nusing the measured Hubble constant was only 2 billion years in contrast\nwith the estimated age of the Earth, stars and stellar systems. In the\n1950s the revised values of the Hubble parameter and the improved\nconstraints on the age of stellar objects resolved the controversy and\nthe cosmological constant became unnecessary. However in 1967 it was\nagain invoked to explain a peak in the number count of quasars at\nredshift @xmath . It was argued that the quasars were born during a\nhesitation era , at the transition between the matter and the @xmath\ndominated era. More observational data confirmed the existence of this\npeak and allowed for a correct interpretation as simply an evolutionary\neffect of active galactic nuclei, with no necessity for @xmath . We\nshall discuss the theoretical implications of the cosmological constant\nin Chapter 2, here we would like to stress that in the past few decades\nthe @xmath term has played the role of a fitting parameter necessary to\nreconcile theory and observations which has been discarded every time\nsystematic effects were considered. It is therefore natural to ask the\nquestion if today we are facing a similar situation. In what follows we\nwill try to show that this turns not to be the case and the dark energy\nis indeed most likely to be present in our Universe.\n\n### 2 Standard cosmology\n\nThe Einstein field equations are:\n\n  -- -------- -- -----\n     @xmath      (1)\n  -- -------- -- -----\n\nwhere @xmath is the Ricci tensor, @xmath is the Ricci scalar, @xmath is\nthe cosmological constant term and @xmath is the matter energy momentum\ntensor which determines the dynamics of the Universe. When different non\ninteracting sources are present the energy momentum tensor is the sum of\nthe energy momentum tensor of each of the sources. Assuming an isotropic\nand homogeneous space-time the large scale geometry can be described by\nthe Friedman-Robertoson-Walker metric:\n\n  -- -------- -- -----\n     @xmath      (2)\n  -- -------- -- -----\n\nwhere @xmath is a function of time (called the scale factor ) and @xmath\nsets a flat, open (-1) or close (+1) geometry. Spatial homogeneity and\nisotropy implies that the energy momentum tensor of each component is\ndiagonal:\n\n  -- -------- -- -----\n     @xmath      (3)\n  -- -------- -- -----\n\nwhere @xmath is the energy density and @xmath is the pressure of the i\n-th matter component (radiation, baryons, cold dark matter, etc..). In\nthe FRW metric the Einstein equations ( 1 ) with a mixture of different\nmatter components are the Friedman equations:\n\n  -- -------- -- -----\n     @xmath      (4)\n  -- -------- -- -----\n\n  -- -------- -- -----\n     @xmath      (5)\n  -- -------- -- -----\n\nWe define the density parameters @xmath , @xmath and @xmath where @xmath\nis the critical energy density. Then the Friedman equation Eq.\u00a0( 4 ) can\nbe rewritten as:\n\n  -- -------- -- -----\n     @xmath      (6)\n  -- -------- -- -----\n\nshowing that the spatial curvature is fixed by the total matter content.\nSince the different components do not interact with each other, their\nenergy momentum tensor must satisfy the energy conservation equation\n@xmath . Hence in addition to the Friedman equations the evolution of\nthe energy density of each matter component is given by:\n\n  -- -------- -- -----\n     @xmath      (7)\n  -- -------- -- -----\n\nIt is worth remarking that, as has been stressed by T. Padmanabhan [ 16\n] , \u2018absolutely no progress in cosmology can be made until a\nrelationship between @xmath and @xmath is provided in the form of the\nfunctions @xmath \u2019 . In fact once these relations are known, we can\nsolve the dynamical equations and make predictions about the evolution\nof the Universe, that can be tested by cosmological observations. If the\nmatter components consist of normal laboratory matter, then the\nknowledge of how the matter equation of state @xmath evolves at\ndifferent energy scales is provided by particle physics. At present the\nbehaviour of matter has been tested up to about @xmath GeV, in this\ndomain the relation between energy density and pressure can be taken to\nbe that of an ideal fluid, @xmath , with @xmath for non relativistic\nmatter and @xmath for relativistic matter and radiation. However if a\ncosmological model based on conventional matter components fails to\naccount for cosmological observations, we could interpret this fact as a\nfailure of the cosmological model or as a signal for the existence of a\nsource not seen in laboratories. For instance the cosmological constant\nterm behaves as a perfect fluid with negative pressure. This can be seen\nrewriting the @xmath term in Eq.\u00a0( 4 ) and Eq.\u00a0( 5 ) as an energy\ndensity and a pressure term. Then one finds @xmath . The effect of such\na component on the expansion of the Universe can be seen from Eq.\u00a0( 5 ),\nand the value of deceleration parameter today is\n\n  -- -------- -- -----\n     @xmath      (8)\n  -- -------- -- -----\n\nand we have neglected the radiation. For @xmath the expansion of the\nUniverse is accelerated since @xmath . Hence in a Universe dominated by\nthe cosmological constant the expansion is eternally accelerating. In\nsummary the dynamics of our Universe is observationally determined by\ntwo geometrical quantities, the Hubble parameter @xmath , which provides\nus with a measure of the observable size of the Universe and its age,\nand the deceleration parameter @xmath which probes the equation of state\nof matter and the cosmological density parameter.\n\n### 3 Observational evidence\n\nDifferent cosmological tests can be used to constrain the geometry and\nthe matter content of the Universe. We shall briefly review the latest\nlimits on @xmath and @xmath obtained by recent experiments in cosmology.\n\n#### 3.1 CMB anisotropies\n\nDuring the last few years an avalanche of balloon and ground\nexperiments, together with the most recent WMAP satellite observatory\nhave measured the small angular temperature fluctuations of the Cosmic\nMicrowave Background Radiation. Such measurements have detected a series\nof acoustic peaks in the anisotropy power spectrum and confirmed early\npredictions about the evolution of pressure waves in the primordial\nphoton-baryon plasma [ 17 , 18 ] . The specific features of such peaks\nare sensitive to the value of the cosmological parameters, in particular\nto @xmath , @xmath and the scalar spectral index @xmath . The\nsensitivity to the curvature of the Universe however does not allow us\nto constrain independently @xmath and @xmath , that are consequently\ndegenerates. The earlier analysis of the Boomerang experiment [ 19 , 20\n, 21 ] found @xmath and the latest data released constrain the total\nenergy density to be @xmath [ 22 ] . Such a result is consistent with\nthe ones found by other CMB experiments. For instance, the data from\nMAXIMA-1, another balloon experiment, when combined with the COBE-DMR\ndata suggest @xmath [ 23 ] . Similarly the two ground experiments, DASI\nand CBI provide @xmath [ 24 ] and @xmath [ 25 ] respectively. Recently\nthree more groups, ARCHEOPS [ 26 ] , VSA [ 27 ] and ACBAR [ 28 ] have\nreleased their data finding similar results. The constraints on the\nbaryon density are in good agreement with the prediction of the Big-Bang\nNucleosynthesis (BBN) and the scalar spectral index is found to be of\norder unity, as predicted by generic inflationary paradigms. However CMB\nalone poorly determines @xmath and a vanishing cosmological constant\ncannot be excluded at @xmath . Nonetheless due to the strong constraint\non the curvature of the Universe, it is reasonable to restrict the data\nanalysis to the flat cosmological models ( @xmath ). In this case,\nassuming the so called \u2018HST prior\u2019 on the value of the Hubble constant,\n@xmath [ 29 ] , then all the CMB data constrain the cosmological\nconstant density parameter to be @xmath [ 25 ] . The WMAP satellite\nprovided CMB data with such an high level of accuracy that is worth\nmentioning a part. The experiment has measured CMB anisotropies in\ndifferent frequency bands, allowing for an efficient removal of the\nforeground emissions. The measurements mapped the full sky in the\nunpolarized and polarized components providing an accurate determination\nof the temperature power spectrum (TT) and the temperature-polarization\ncross-correlation spectrum (TE) [ 30 ] . The position of the first peak\nin the TT spectrum constrain the curvature to be @xmath [ 31 ] . The\ncombination of WMAP data with ACBAR and CBI, 2dF measurements and Lyman\n@xmath forest data find the best fit cosmological parameters: @xmath ,\nthe baryon density @xmath , the dark matter density @xmath , the optical\ndepth @xmath , the scalar spectral index @xmath and the amplitude of the\nfluctuations @xmath [ 32 ] . The value of @xmath comes from an excess of\npower on the large angular scales of the TE spectrum [ 33 ] . This\nsignal cannot be explained by systematic effects or foreground emissions\nand has a natural interpretation as the signature of early reionization,\nmost probably occurred at redshift @xmath . This conflicts with the\nmeasurements of the Gunn-Peterson absorption trough in spectra, which\nindicate the presence of neutral hydrogen at redshift @xmath [ 34 ] .\nTherefore we have evidence for a complex ionization history of the\nUniverse, which most probably underwent two reionization phases, an\nearly and a late one. Of particular interest is the running of the\nscalar spectral index that provides a better fit to the data when WMAP\nis combined with small angular scale measurements such as ACBAR, CBI,\n2dF galaxy survey and Lyman @xmath . Another interesting finding of the\nWMAP TT spectrum is the lack of power at low multipole. In particular\nthe quadrupole and the octupole are suppressed compared to the\nexpectation of the best fit @xmath CDM model. It has been claimed that\nsuch suppression could be the signature of new physics [ 35 , 36 ] .\n\n#### 3.2 Clustering of matter\n\nThe cosmological structures we observe today have been formed by the\ngravitational amplification of small density perturbations. The amount\nof such inhomogeneities at different cosmological scales is measured by\nthe matter power spectrum. This is estimated from the statistical\nanalysis of a large sample of galaxies and provides a measurement of the\namount of clustered matter in the Universe. Recently two large galaxy\nsurveys, the 2dF Galaxy Redshift Survey [ 37 ] and the Sloan Digital Sky\nSurvey [ 38 ] , have probed intermediate scales ( @xmath Mpc). The fit\nto the power spectrum data of the 2dF yields @xmath and the baryon\nfraction @xmath [ 37 ] . Such a low value of @xmath gives indirect\nevidence for a large non vanishing cosmological constant contribution\nwhen this LSS data is combined with the CMB. A joint analysis of the CMB\nand 2dF data indicates @xmath at @xmath [ 39 ] . An independent estimate\nof @xmath is provided by the peculiar velocities of galaxies. In fact\nmass density fluctuations cause galaxy motion with respect to the Hubble\nflow. Such a motion reflect the matter distribution and therefore is\nsensitive to @xmath . The analysis of the Mark III and SFI catalogs\nconstrain @xmath [ 40 ] . Low values of @xmath are also indicated by the\nstudies of cluster of galaxies, where it is assumed the amount of matter\nin rich clusters provides a fair sample of the matter content of the\nUniverse. Recent surveys have precisely determined the local X-ray\nluminosity function. Using the observed mass-luminosity relation, the\ncluster mass function has been compared with the prediction from\nnumerical simulations. This analysis constrains @xmath at @xmath [ 41 ]\n(see also [ 42 ] ). This result is in agreement with the limits found by\nan alternative study from which, @xmath at @xmath [ 43 ] . Another way\nof estimating the amount of dark matter is to measure the baryon\nfraction @xmath from X-ray cluster observations. In fact the ratio of\nthe baryonic to total mass in cluster should closely match the ratio\n@xmath . Therefore a measurement of @xmath combined with accurate\ndetermination of @xmath from BBN calculation can be used to determine\n@xmath . Using such a method it was found @xmath for @xmath [ 44 ] .\nThis is in agreement also with the value obtained by a study of the\nredshift dependence of the baryon fraction, that indicates @xmath [ 45 ]\n. Similarly a different analysis based on gravitational lens statistics\nprovides @xmath [ 46 ] .\n\n#### 3.3 Age of the Universe\n\nThe Friedman equation Eq.\u00a0( 4 ) can be integrated to obtain the age of a\ngiven cosmological model:\n\n  -- -------- -- -----\n     @xmath      (9)\n  -- -------- -- -----\n\nThe numerical solutions are shown in figure 1 . The solid lines\ncorrespond to increasing value of @xmath in the @xmath plane. It is easy\nto see that for fixed values of @xmath the age of the Universe increases\nfor larger values of @xmath . Since matter dominated cosmological models\nare younger than globular clusters, in the past few decades the\npossibility of an \u2018age problem\u2019 has been a matter of debate. The\npresence of a cosmological constant can alleviate such a problem.\nHowever a key role is played by the Hubble parameter, in fact low values\nof @xmath increase @xmath . The age of globular clusters is estimated to\nbe about @xmath Gyr [ 47 ] , therefore a purely matter dominated\nUniverse ( @xmath and @xmath ) cannot be excluded if @xmath . However\nsuch a low value of @xmath seems to be inconsistent with the accepted\nvalue of @xmath [ 29 ] . It is worth mentioning that the determination\nof the age of high redshift objects can be used to constrain @xmath by\nstudying the redshift evolution of the age of the Universe [ 48 ] .\n\n#### 3.4 Supernovae Ia and luminosity distance measurements\n\nSupernovae type Ia are violent stellar explosions, their luminosity at\nthe peak becomes comparable with the luminosity of the whole hosting\ngalaxy. For such a reason they are visible to cosmic distances. These\nsupernovae appear to be standard candles and therefore are used to\nmeasure cosmological distances by means of the magnitude-redshift\nrelation:\n\n  -- -------- -- ------\n     @xmath      (10)\n  -- -------- -- ------\n\nwhere @xmath is the apparent magnitude, @xmath is absolute magnitude and\n@xmath is the luminosity distance which depends upon the geometry of the\nspace and its matter content. In the standard scenario a white dwarf\naccretes mass from a companion star. Once the Chandrasekhar mass limit\nis reached, the burning of carbon is ignited in the interior of the\nwhite dwarf. This process propagates to the exterior layers leading to a\ncomplete destruction of the star. The physics of these objects is not\ncompletely understood yet. It requires the use of numerical simulations\nfrom which it appears that the thermonuclear combustion is highly\nturbulent. Such theoretical uncertainties prevent us from having\nreliable predictions of possible evolutionary effects. It is also matter\nof debate as to whether the history of the supernova progenitors can\nhave important effects in the final explosion (see [ 49 ] for a general\nreview). For these reasons it is a rather unreliable assumption that\nsupernova Ia are perfect standard candles. However the observations show\nthe existence of an empirical relation between the absolute peak\nluminosity and the light curve shapes. There are also correlations with\nthe spectral properties. Using such relations it is possible to reduce\nthe dispersion on magnitude of each supernova to within @xmath\nmagnitudes allowing them to be used for cosmological distance\nmeasurements (see [ 50 ] and references therein). The Supernova\nCosmology Project [ 51 ] and the High-Z Supernova Research Team [ 52 ]\nhave observed and calibrated a large sample of supernovae at low and\nhigh redshifts. The result of their analysis [ 53 , 52 ] shows that\ndistant supernovae are on the average about 0.20 magnitudes fainter than\nwould be expected in a Milne universe (empty). The likelihood analysis,\ndue to the degeneracy of the luminosity distance with the values of\n@xmath and @xmath , constrains these parameters in a region approximated\nby @xmath . The data give evidence for a non vanishing cosmological\nconstant. Including the farthest supernova Sn 1997f with @xmath [ 54 ] ,\nthe data analysis shows that at redshift @xmath the Universe was in a\ndecelerating phase. However the presence of possible systematic\nuncertainties has attracted some criticism. In particular there could be\na dimming of the light coming from the supernovae due to intergalactic\ndust. Moreover the Sn Ia might have an evolution over the cosmic time,\ndue to changes in characteristics of the progenitors so as to make their\nuse as standard candles unreliable. The argument against the extinction\nis that high-redshift supernovae suffer little reddening. While the fact\nthat their spectra appear similar to those at low-redshift seems to\nexclude the possibility of evolutionary effects in the data. For\ninstance in [ 55 ] , the Hubble diagram of distant type Ia supernovae\nsegregated according to the type of host galaxy has been analysed. The\nresults shows that host galaxy extinction is unlikely to systematically\naffect the luminosity of Sn Ia in a manner that would produce a spurious\ncosmological constant. In reality only a theoretical prediction, not\navailable at the present time, would convince the entire community.\nNevertheless none of these systematic errors can reconcile the data with\na vanishing @xmath .\n\n### 4 Cosmic complementarity\n\nFigure 2 shows the region of the @xmath constrained by different\ncosmological observations.\n\nIt appears evident that the joint analysis of the recent CMB, large\nscale structure and Sn Ia observations, previously reviewed, indicate a\nregion of the parameter space where they are consistent [ 56 , 57 , 58 ]\n. In particular the likelihood contours of Sn Ia and CMB are orthogonal\nand therefore their combination breaks the geometric degeneracy between\n@xmath and @xmath . Such consistency tells us that the Universe is\nnearly flat, the structures we observe today are the result of the\ngrowth of initial density fluctuations characterized by a nearly scale\ninvariant spectrum as predicted by inflationary scenarios. The matter\ncontent of the Universe consist of baryons ( @xmath ), while most of the\nclustered matter consists of cold dark particles that account for only\n@xmath of the total energy density. About @xmath of the matter is in a\n\u2018dark energy\u2019 form and is responsible for the present accelerated\nexpansion. In spite of any astronomical uncertainties, the limits on\n@xmath impose that @xmath GeV @xmath . Understanding the origin and the\nsmallness of this term is the challenge of modern theoretical physics.\nIn principle nothing prevents the existence of a @xmath -term in the\nEinstein equations. However if @xmath appears on the left hand side, the\ngravitational part of the Einstein-Hilbert action will depend on two\nfundamental constants, @xmath and @xmath , which differ widely in scale.\nFor instance the dimensionless combination of fundamental constants\n@xmath . On the other hand we know that several independent phenomena\ncan contribute as an effective @xmath term on the right hand side of the\nEinstein equations [ 2 ] . However, as we shall see in the next chapter,\nin order to reproduce the small observed value, these terms have to be\nfine tuned with bizarre accuracy. Therefore the solution to such an\nenigma may well lead us to the discovery of new physics.\n\n## Chapter \\thechapter An explanation for the dark energy?\n\nThe cosmological constant can be naturally interpreted as the energy\ncontribution of the vacuum. However its measured value turns out to be\nextremely small compared to the particle physics expectations. Therefore\nalternative candidates for the dark energy component have been\nconsidered. In particular a light scalar field rolling down its\nself-interacting potential can provide the missing energy in the\nUniverse and drive a late time phase of accelerated expansion. A lot of\neffort has gone into justifying the existence of this field, called\nquintessence , within the context of particle theories beyond the\nStandard Model. Different versions of this original idea have been\ndeveloped in the literature. In this Chapter we will review the vacuum\nenergy problem. Then we will discuss the application of the anthropic\nprinciple to the solution of the \u2019coincidence problem\u2019. We will describe\nthe main characteristic of a minimally coupled quintessence scenario. At\nthe end we will analyse the dynamics of two specific scalar field\nmodels.\n\n### 5 Vacuum energy\n\nIt was initially pointed out by Y.B. Zeldovich [ 59 ] that in Minkowski\nspace-time, Lorentz invariance constrains the energy momentum tensor of\nzero point vacuum fluctuations to be proportional to the Minkowski\nmetric, i.e. @xmath . This relation can be generalized to the case of a\ncurved space-time with metric @xmath . The principle of general\ncovariance requires that @xmath , which has the form of a cosmological\nconstant. This implies that in General Relativity, since the\ngravitational field couples through the Einstein equations with all\nkinds of energy, the vacuum energy contributes to the total curvature of\nspace-time. The vacuum state of a collection of quantum fields, that\ndescribes the known forces and particles, is defined to be the lowest\nenergy density state. If we think of the fields as a set of harmonic\noscillators the total zero point energy is given by:\n\n  -- -------- -- ------\n     @xmath      (11)\n  -- -------- -- ------\n\nthat diverges as @xmath (ultraviolet divergence). However any quantum\nfield theory is valid up to a limiting cut-off scale, beyond which it is\nnecessary to formulate a more fundamental description. Consequently the\nintegral Eq.\u00a0( 11 ) can be regularized imposing a cut-off @xmath , and\nwe obtain\n\n  -- -------- -- ------\n     @xmath      (12)\n  -- -------- -- ------\n\nIf we set the cut-off @xmath at the Planck scale, the energy density of\nthe vacuum is @xmath GeV @xmath which is about @xmath orders of\nmagnitude larger than the observed value of @xmath . Fixing the cut-off\nscale at the QCD phase transition, @xmath , we find @xmath GeV @xmath\nwhich is still 44 orders of magnitude above the expected one. On the\nother hand if Supersymmetry is realized in nature, the cosmological\nconstant vanishes because the vacuum energy contribution of the bosonic\ndegree of freedom exactly cancels that of the fermionic ones. However,\nbecause we do not observe super-particles, Supersymmetry must be broken\nat low energy. This implies that the cosmological constant vanishes in\nthe early Universe and reappears later after SUSY breaking. Assuming\nthat Supersymmetry is broken at @xmath the resulting @xmath is about 60\norders of magnitude larger then the observational upper bounds. Hence\nany cancellation mechanism will require a bizarre fine tuning in order\nto explain the huge discrepancy between @xmath and @xmath . By the\npresent time we do not have any theoretical explanation for this\ncosmological constant problem. Moreover such a tiny value presents an\nother intriguing aspect. In fact we could ask why @xmath has been fixed\nat very early time with such an extraordinary accuracy that today it\nbecomes the dominant component of the Universe. In other words we should\nexplain why the time when @xmath starts dominating nearly coincides with\nthe epoch of galaxy formation. This is the so called coincidence or \u2019why\nnow\u2019 problem. The solution to the cosmological constant problem will\nprovide an explanation also for this cosmic coincidence. On the other\nhand it could be easier to justify a vanishing cosmological constant\nassuming the existence of some unknown symmetry coming from quantum\ngravity or string theory [ 60 ] . As we shall see in the following\nsections, alternative scenarios of dark energy formulate the initial\ncondition problem and the coincidence problem in a different way.\n\n### 6 Anthropic solutions\n\nThe use of anthropic arguments in cosmology has been often seen as an\nanti-scientific approach. However a different use of the \u2018Anthropic\nPrinciple\u2019 has been recently proposed in the literature and for a review\nof the subject we refer to [ 61 ] . We should always have in mind that\nat the speculative level our Universe can be one particular realization\nof possible universes. Therefore the fact that we live in this Universe\nmakes us privileged observers, since under other circumstances we would\nnot be here. For instance several authors pointed out that not all\nvalues of @xmath are consistent with the existence of conscious\nobservers [ 62 , 63 , 64 ] . The reason is that in a flat space-time the\ngravitational collapse of structure stops at the time @xmath , as\nconsequence universes with large values of @xmath will not have galaxies\nformed at all. This argument can be used to put an anthropic bound on\n@xmath by requiring that it does not dominate before the redshift @xmath\nwhen the earliest galaxy formed. In [ 64 ] assuming @xmath it was found\n@xmath . However it was suggested in [ 65 , 66 ] that observers are in\ngalaxies and therefore there is a conditional probability to observe a\ngiven value of @xmath . In particular this value will be the one that\nmaximizes the number of galaxies. In such a case the probability\ndistribution can be written as\n\n  -- -------- -- ------\n     @xmath      (13)\n  -- -------- -- ------\n\nwhere @xmath is the a priori probability density distribution and @xmath\nis the average number of galaxies that form per unit volume with a given\nvalue of @xmath . The calculation of @xmath can be done using the\nPress-Schechter formalism. Assuming a flat a priori probability density\ndistribution the authors of [ 67 ] found that the peak of @xmath is\nclose to the observed value of @xmath . This anthropic solution to the\ncosmological constant problem would be incomplete without an underlying\ntheory that allows @xmath to take different values and predicts a flat\n@xmath . The recent developments in string\/M theory seems to provide a\nnatural framework where such issues can be addressed (see [ 68 ] ).\n\n### 7 Quintessence\n\nA non-anthropic solution to the cosmic coincidence problem would be an\nexotic form of matter playing the role of dark energy. The existence of\nsuch a component should be the prediction of some fundamental theory of\nparticle physics. For instance it was initially suggested that a network\nof topological defects could provide such a form of energy [ 69 , 70 ,\n71 ] . In fact topological defects are characterized by a negative value\nof the equation of state @xmath and lead to an accelerated expansion if\nthey dominate the energy budget of the Universe. However these models\nare ruled out by current cosmological observations. On the other hand,\nlong before the time of Sn Ia measurements, it was considered that an\nevolving scalar field, called quintessence, could take into account for\nthe missing energy of the Universe [ 72 , 73 , 74 , 75 , 76 , 77 , 78 ]\n. In this scenario the cosmic coincidence problem is formulated in a\ndifferent way. In fact the evolution of the quintessence is determined\nby the initial conditions and by the scalar field potential.\nConsequently there would be no coincidence problem only if the\nquintessence becomes the dominant component today independently of the\ninitial conditions, that have been set at very early time. It was\npointed out by Zlatev, Wang and Steinhardt [ 79 , 80 ] that viable\nquintessence potentials are those manifesting \u2018tracking\u2019 properties. In\nthese cases, for a wide range of initial conditions, the scalar field\nevolves towards an attractor solution such that at late time it\ndominates over the other matter components. However such a time will\ndepend on the energy scale of the potential and is fixed in way such\nthat @xmath reproduces the observed amount of dark energy. In other\nwords the tracker quintessence solves the initial conditions problem,\nbut the \u2018why now\u2019 problem is related to the energy scale of the model.\nIf such a scale is consistent with the high energy physics scales there\nis no fine tunning and the fact that the acceleration starts only by the\npresent time does not have any particular meaning. On the contrary the\ncoincidence problem would result if such a scale is much smaller than\nany particle physics scale, because this will require a fine tuning\nsimilar to the cosmological constant case. As we shall see consistent\nquintessence model building is a difficult challenge [ 81 ] . Cosmic\ncoincidence is absent in quintessence models where the scalar field is\nnon-minimally coupled to the cold dark matter [ 82 , 83 , 84 , 85 ] .\nCoupling with baryons is strongly constrained by tests of the\nequivalence principle, however a coupling with cold dark matter cannot\nbe excluded. In this case the coupling will naturally produce the\ngravitational collapsing time scale of the order of the time when the\n@xmath field starts dominating, @xmath . Moreover in these models\nstructure formation can occur even during the accelerated phase of\nexpansion and consequently no coincidence have to be explained [ 86 ] .\nIt may be argued that for this class of models to fully succeed what has\nto be explained is the strength of the couplings. However the non\nuniversality of the couplings may arise in the context of brane models,\nwhere dark energy and dark matter belong to an hidden sector.\n\n#### 7.1 Scalar field dynamics\n\nA multiple fluid system consisting of a scalar field, pressureless\nmatter and radiation interacting through the gravitational field is\ndescribed by the action:\n\n  -- -------- -- ------\n     @xmath      (14)\n  -- -------- -- ------\n\nwhere @xmath is the Ricci scalar and @xmath Lagrangian density of the\nmatter and radiation and @xmath is the Lagrangian density of the\nquintessence field which is given by:\n\n  -- -------- -- ------\n     @xmath      (15)\n  -- -------- -- ------\n\nThe scalar field energy-momentum tensor then reads as\n\n  -- -------- -- ------\n     @xmath      (16)\n  -- -------- -- ------\n\nIn a FRW flat Universe for a nearly homogeneous scalar field, the\nquintessence pressure and energy density are @xmath and @xmath . The\nquintessence behaves as perfect fluid with a time dependent equation of\nstate which is given by:\n\n  -- -------- -- ------\n     @xmath      (17)\n  -- -------- -- ------\n\nThe scalar field evolution is described by the Klein-Gordon equation,\n\n  -- -------- -- ------\n     @xmath      (18)\n  -- -------- -- ------\n\nwith\n\n  -- -------- -- ------\n     @xmath      (19)\n  -- -------- -- ------\n\nwhere @xmath and @xmath are the matter and radiation energy densities\nand evolve according to the energy conservation equation Eq.\u00a0( 7 ). As\nan example we analyse the dynamics of this system in the case of an\nInverse Power Law potential [ 73 , 79 ] :\n\n  -- -------- -- ------\n     @xmath      (20)\n  -- -------- -- ------\n\nwhere @xmath and we set @xmath such that @xmath . We solve numerically\nthe equations of motion. In figure 3 we show the evolution with redshift\nof the energy density of radiation (blue dash line), matter (green dot\nline) and quintessence (red solid line). Different red lines correspond\nto different initial conditions, we may distinguish two distinct\nbehaviours. For initial values of the quintessence energy density larger\nthan matter energy density, @xmath , @xmath rapidly decreases. This\nregime is called kination . In fact, as we can see in figure 4 a, the\nkinetic energy rapidly falls off while the potential energy remains\nnearly constant. The overshooting is then followed by the frozen field\nphase, where the energy density is dominated by the potential. During\nthis period @xmath remains constant until the kinetic energy becomes\ncomparable with the potential one and the field reaches the tracker\nregime . In the tracker solution the kinetic and potential energies\nscale with a constant ratio, therefore the equation of state is constant\nor slowly varying. For a given potential the existence of a period of\ntracking is guaranteed by the condition @xmath [ 80 ] . Moreover during\nthis phase the value of the quintessence equation of state mimics the\nvalue @xmath of the background component according to the relation:\n\n  -- -------- -- ------\n     @xmath      (21)\n  -- -------- -- ------\n\nFor inverse power law potentials @xmath . At late time the field leaves\nthe tracker solution, the potential energy starts dominating over the\nkinetic one (figure 4 b) and the equation of state tends to negative\nvalues. During this final phase the field becomes the dominant component\nof the Universe and drives the accelerated expansion. The same arguments\nhold for initial conditions corresponding to @xmath . In such a case the\nquintessence starts its evolution in the frozen regime. Such a behavior\noccurs over a range of initial conditions that covers more then 100\norders of magnitude, consequently the quintessence dominated period is\nobtained with no need of fine tunning of the initial conditions.\n\nFor tracker models the final value of the equation of state depends on\nthe parameter @xmath or equivalently on @xmath and on the slope of the\npotential. In general for large values of @xmath or flat potential\n@xmath , in the case of the Inverse Power Law potential small values of\n@xmath corresponds to large negative value of @xmath (figure 5 ).\n\n#### 7.2 Quintessential problems\n\nThe existence of the tracker phase cancels any knowledge of the initial\ncondition of the scalar field providing an elegant way of solving the\ncoincidence problem. Nevertheless it is a rather difficult task to build\nconsistent particle physics models of quintessence. One of the reasons\nit that for a given tracker potential, @xmath , the cosmic coincidence\nis fully solved only if the scale @xmath is consistent with the energy\nscale of the underlying particle physics theory that predicts the shape\n@xmath of the quintessence potential. For example let us consider the\nInverse Power Law model. It was shown in [ 87 , 88 ] that it can be\nderived from a Supersymmetric extension of QCD. By the present time the\ncondition @xmath has to hold in order to guarantee the Universe is\naccelerating, this implies that today the scalar field @xmath . Since\nthe observations suggest @xmath , for values of the slope @xmath we find\nthat @xmath GeV, a very reasonable scale from the particle theory point\nof view. On the other hand for tracker models the slope of the potential\nis constrained by measurements of the present value of the quintessence\nequation of state @xmath that indicate a low value of @xmath . But, as\nwe can see in figure 6 for values of @xmath the energy scale is much\nsmaller than any known particle physics scale. Therefore the Inverse\nPower Law seems not to be a viable quintessence model.\n\nAlternative models have been proposed in the literature, they can be\ndistinguished into two categories, dilatonic and supersymmetric\nquintessence. The former class of models assume that the quintessence\nfield is the dilaton, this possibility has been studied in [ 89 , 90 ] .\nThe dilaton is predicted by all string theory models and it couples to\nall the fields including gravity [ 91 ] . Therefore it could be a good\ncandidate for dark energy. However it predicts a running of the\ndifferent coupling constants, that are strongly constrained by present\nobservations and the violation of the equivalence principle.\nNevertheless these models deserve more investigation and some of these\nissues have been recently addressed in [ 92 , 93 ] . It is worth\nmentioning that the non-minimally coupled scalar field models which\nsolve the coincidence problem belong to this category [ 82 , 83 , 84 ,\n85 , 94 , 95 ] . In the second class of models the quintessence is one\nof the scalar fields predicted by Supersymmetric extensions of the\nStandard Model of particle physics. In particular a lot of effort has\nbeen recently devoted to the formulation of viable quintessence models\nin the context of Supergravity theory. In fact it was noticed that\nInverse Power Law potentials generated by Supersymmetric gauge theories\nare stable against quantum and curvature corrections, but not against K\n@xmath hlerian corrections [ 96 , 97 , 98 ] . Since @xmath ,\nSupergravity (SUGRA) corrections cannot be neglected and therefore any\nrealistic model of quintessence must be based on SUGRA. It is argued\nthat also this class of models lead to violation of the equivalence\nprinciple, the quintessence field can in fact mediate a long range fifth\nforce that we do not observe. However we want to stress that in the\ncontext of Supersymmetric theories this is not the main problem. The\nreason is that the quintessence can belong to a hidden sector of the\ntheory that couples only gravitationally to the visible sector. It was\npointed out in [ 81 ] that any supersymmetric inspired model has to\naddress two specific issues. The first one concerns the case of\nSupersymmetry breaking quintessence, if the quintessence field belongs\nto a sector of the theory that breaks Supersymmetry, because of the\nshape of the potential it turns out it cannot be the main source of\nbreaking. In such a case SUSY can be broken by the presence of an F-term\nthat leads to an intolerably large vacuum energy contribution that\ncompletely spoils the nice properties of the quintessence potential. The\nother difficulty arises from the coupling of quintessence to the field\nresponsible for the supersymmetry breaking. Such a coupling leads to\ncorrections of the scalar field potential such that the quintessence\nacquires a large mass. Some alternatives have been recently\ninvestigated, for instance a way of avoiding such problems has been\nconsidered in [ 99 ] , where a Goldstone-type quintessence model in\nheterotic M-theory has been proposed.\n\n### 8 Supergravity inspired models\n\nWe now review some of the properties of two models proposed in the\ncontext of Supergravity theories: the Exponential Times Inverse Power\nLaw potential and the Two Exponential potential.\n\n#### 8.1 Exponential Times Inverse Power Law potential\n\nThe authors of [ 96 ] have shown that taking into account Supergravity\ncorrections to the Inverse Power Law potential, the quintessence\npotential takes the form:\n\n  -- -------- -- ------\n     @xmath      (22)\n  -- -------- -- ------\n\nwhere @xmath . This potential is an improvement the Inverse Power Law.\nIn fact the dynamic remains unchanged during the radiation and the\nmatter dominated era, while the presence of the exponential term flatten\nthe shape of the potential in the region corresponding to the late time\nevolution of the scalar field. This allows for more negative values of\nthe equation of state today independently of the slope of the inverse\npower law. Consequently we can have a reasonable particle physics energy\nscale even for large values of @xmath . For instance for @xmath and\n@xmath we have @xmath GeV and the present value of the equation of state\nis @xmath , in better agreement with observational constraints.\n\n#### 8.2 Two Exponential potential\n\nThe dynamics of cosmologically relevant scalar fields with a single\nexponential potential has been largely studied in the literature and\nwithin a variety of contexts (see for instance [ 77 ] ). The existence\nof scalar field dominated attractor solutions is well known, however for\nthis class of models an accelerated phase of expansion can be obtained\nwith an extreme fine tunning of the initial conditions [ 102 ] . It has\nbeen shown in [ 100 , 101 ] that quintessence Supergravity inspired\nmodels predict the scalar field potential to be of the form:\n\n  -- -------- -- ------\n     @xmath      (23)\n  -- -------- -- ------\n\nwhere @xmath is a free parameter, while @xmath has to be fixed such that\n@xmath . This potential has a number of interesting features. As it has\nbeen pointed out by the authors of [ 100 ] in the form given by the\nEq.\u00a0( 23 ) all the parameters are of the order of the Planck scale. Only\n@xmath has to be adjusted so that @xmath , it turns out to be @xmath .\nFor a large range of initial conditions the quintessence field reaches\nthe tracker regime during which it exactly mimics the evolution of the\nbarotropic fluid and at some recent epoch it evolves into a quintessence\ndominated regime. It is useful to rewrite the two exponential potential\nas:\n\n  -- -------- -- ------\n     @xmath      (24)\n  -- -------- -- ------\n\nwhere @xmath is the usual energy scale parameter. For a given value of\n@xmath the slopes @xmath fix the final value of the equation of state.\nThe sign of the slopes distinguish this class of potentials into two\ncategories: @xmath and @xmath , @xmath . For both the cases the Q-field\ninitially assumes negative values and rolls down the region of the\npotential dominated by the exponential of @xmath . When it reaches the\ntracker regime its equation of state exactly reproduces the value of the\nbackground dominant component, @xmath and the energy density is given by\n\n  -- -------- -- ------\n     @xmath      (25)\n  -- -------- -- ------\n\nThe late time evolution is determined by the value of @xmath that fixes\nthe present value of the equation of state. In the case of slopes with\nthe same sign @xmath for small value of @xmath , while for @xmath and\n@xmath with opposite sign the scalar field reaches by the present time\nthe minimum of potential at @xmath . Consequently @xmath after a series\nof small damped oscillations. This can be seen in figure 7 where we plot\nthe evolution of the quintessence energy density parameter @xmath and\nthe equation of state @xmath for @xmath , @xmath and @xmath , @xmath .\nIn the latter model the equation of rapidly drops to @xmath after few\ndamped oscillations, while the former shows a more smooth behaviour. It\nis worth remarking that for the two exponential potential with same sign\nof the slopes the accelerated phase can be a transient regime. This can\noccurs for large value of @xmath , in such a case after a short period\ndominated by the potential energy the scalar field acquires kinetic\nenergy so that the equation of state can be @xmath . As we may note in\nfigure 7 , because Eq.\u00a0( 25 ) holds during the tracker regime, for small\nvalues of @xmath the quintessence energy density assumes non-negligible\nvalues at early times. Such an early contribution during the radiation\ndominated era is constrained by nucleosynthesis bound to be @xmath MeV\n@xmath . This implies that @xmath . Such a limit has pushed toward\nlarger value by a new analysis of the Big-Bang nucleosynthesis [ 103 ]\nthat constrains @xmath MeV @xmath at 2 @xmath .\n\nIn principle this bound can be avoided if the tracker regime starts\nafter Big-Bang nucleosynthesis. However this can be obtained only by\ntuning the scalar field initial conditions in a restricted range of\nvalues. Moreover a recent analysis of the large scale structure data and\nCMB measurements strongly constrain the value of @xmath during the\nmatter dominated era [ 104 ] .\n\n## Chapter \\thechapter Quintessence field fluctuations\n\nThe cosmological constant is a smooth component and therefore does not\nplay any active role during the period of structure formation. On the\ncontrary a peculiar feature of the quintessence field is that it is\nspatially inhomogeneous just as any other scalar field. Therefore it is\npossible that the clustering properties of the dark energy can play a\ndeterminant role in revealing the nature of this exotic fluid. In this\nChapter we introduce the scalar field fluctuation equations in the\nNewtonian gauge. We derive an analytical solution of the quintessence\nperturbation in the tracking regime and describe the behaviour during\ndifferent cosmological epochs. We then present the numerical analysis of\nthe perturbations in a multiple fluids system in the particular cases of\nan Inverse Power law potential and the two exponential potential.\n\n### 9 Quintessence perturbations in Newtonian gauge\n\nThe evolution of minimally coupled scalar field perturbations has been\nstudied in a number of papers. For instance in [ 73 , 77 , 105 , 106 ]\nthe analysis has been done in the synchronous gauge, while in [ 107 ,\n108 , 109 ] the authors have used the Newtonian gauge. In what follows\nwe use the Newtonian gauge. When compared to the synchronous one it has\na number of advantages. In fact since the gauge freedom is fully fixed\nthere are no gauge modes that can lead to misleading conclusions about\nthe evolution of superhorizon modes. Besides, the metric perturbations\nplay the role of the gravitational potential in the Newtonian limit. The\nequations we need to linearize are the Einstein\u2019s equations\n\n  -- -------- -- ------\n     @xmath      (26)\n  -- -------- -- ------\n\nthe Klein-Gordon equation\n\n  -- -------- -- ------\n     @xmath      (27)\n  -- -------- -- ------\n\nand the conservation equation of the stress energy tensor of the\ndifferent matter components\n\n  -- -------- -- ------\n     @xmath      (28)\n  -- -------- -- ------\n\nIn the Newtonian gauge the line element in a spatially flat FRW\nbackground reads as\n\n  -- -------- -- ------\n     @xmath      (29)\n  -- -------- -- ------\n\nwhere @xmath is the metric perturbation and @xmath is the real time. We\nconsider a multiple fluid system composed of a scalar field, cold dark\nmatter and radiation. Expanding the fluid variables at first order\naround the homogeneous value we have:\n\n  -- -------- -- ------\n     @xmath      (30)\n  -- -------- -- ------\n\nwhere @xmath is the density perturbation of the @xmath -th component,\n\n  -- -------- -- ------\n     @xmath      (31)\n  -- -------- -- ------\n\nwhere @xmath is the scalar field fluctuation and @xmath is the\nhomogenous part of the quintessence field. The linearized Eq.\u00a0( 26 ),\nEq.\u00a0( 27 ) and Eq.\u00a0( 28 ) provide a set of differential equations for\nthe metric, scalar field, radiation and cold dark matter perturbations.\nIn Fourier space the equations are:\n\n  -- -------- -- ------\n     @xmath      (32)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (33)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (34)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (35)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (36)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (37)\n  -- -------- -- ------\n\nwhere @xmath and @xmath are the density perturbations of cold dark\nmatter and radiation, while @xmath and @xmath are the corresponding\nvelocity perturbations. The perturbed quintessence energy density and\npressure are,\n\n  -- -------- -- ------\n     @xmath      (38)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (39)\n  -- -------- -- ------\n\n### 10 Evolution of perturbations\n\n#### 10.1 Analytical solution in the tracker regime\n\nFrom Eq.\u00a0( 33 ) we note that the perturbations of the other fluids feed\nback onto the scalar field perturbations through the gravitational\npotential @xmath . Deep during the radiation and the matter dominated\neras the gravitational potential is constant and therefore the first\nterm on the right-hand-side can be neglected. As a first approximation\nwe ignore the second term as well, hence Eq.\u00a0( 33 ) becomes\n\n  -- -------- -- ------\n     @xmath      (40)\n  -- -------- -- ------\n\nWe can find an analytical solution during the tracker regime when\n\n  -- -------- -- ------\n     @xmath      (41)\n  -- -------- -- ------\n\nwith @xmath a constant that depends on the specifics of the potential\nand on the equation of state of the background dominant component. This\ncan be obtained as follows. Consider the adiabatic definition of the\nsound speed associated with the quintessence field:\n\n  -- -------- -------- -------- -------- ------\n     @xmath   @xmath   @xmath            (42)\n                       @xmath   @xmath   \n  -- -------- -------- -------- -------- ------\n\nDuring the tracker regime the quintessence equation of state is nearly\nconstant implying that @xmath . Hence by differentiating Eq.\u00a0( 42 ) with\nrespect to time and dividing by @xmath we have\n\n  -- -------- -- ------\n     @xmath      (43)\n  -- -------- -- ------\n\nFrom Eq.\u00a0( 43 ) using the second of the Hubble equations @xmath , with\n@xmath being the equation of state of the background dominant fluid, we\nfinally obtain:\n\n  -- -------- -- ------\n     @xmath      (44)\n  -- -------- -- ------\n\nIt is useful to rewrite Eq.\u00a0( 40 ) in conformal time, which is defined\nas @xmath ,\n\n  -- -------- -- ------\n     @xmath      (45)\n  -- -------- -- ------\n\nwhere a prime denotes the derivative with respect to @xmath . In the\nradiation dominated era the scale factor evolves as @xmath , while the\nHubble rate is given by @xmath , hence Eq.\u00a0( 45 ) becomes:\n\n  -- -------- -- ------\n     @xmath      (46)\n  -- -------- -- ------\n\nwith @xmath being the value of @xmath in radiation dominated era. During\nthe tracker regime @xmath and @xmath . In such a case the characteristic\nroots of Eq.\u00a0( 46 ) are complex and the solutions are of the form:\n\n  -- -------- -- ------\n     @xmath      (47)\n  -- -------- -- ------\n\nwhere @xmath and @xmath are integration constants and\n\n  -- -------- -- ------\n     @xmath      (48)\n  -- -------- -- ------\n\nEq.\u00a0( 47 ) is a damped oscillatory solution with frequency @xmath , On\nlarge scales ( @xmath Mpc @xmath ) the frequency of these oscillations\nis scale independent and is set by the tracker properties ( @xmath ). On\nthe other hand if @xmath , Eq.\u00a0( 46 ) has real roots and the solutions\ncontain a constant mode and a decaying one. Similar solutions can be\nfound in the matter dominated era. The addition of the source term\n@xmath on the right-hand-side of Eq.\u00a0( 33 ) leads to an attractor\nsolution for the quintessence perturbations in the long-wavelength\nlimit, @xmath . In fact from Eq.\u00a0( 33 ) we obtain:\n\n  -- -------- -- ------\n     @xmath      (49)\n  -- -------- -- ------\n\nthat is constant as long as the quintessence is in the tracker regime.\nAs a consequence this solution does not hold in the kinetic and\nparticularly in the potential phase when the quintessence exits away\nfrom the tracker.\n\n#### 10.2 Numerical analysis\n\nIn this section we present the analysis of the numerical solution of the\nsystem of equations Eq.\u00a0( 32 - 37 ), where we have imposed adiabatic\ninitial conditions. We consider a quintessence SUGRA inspired model\ndescribed in Chapter \\thechapter . The scalar field potential is\nspecified by Eq.\u00a0( 22 ) where we set the slope @xmath and the parameter\n@xmath such that today @xmath . The initial conditions for the\nhomogeneous part of the scalar field @xmath have been set such that the\ntracker solution is reached deep in the radiation dominated era. In\nfigure 8 we plot the behaviour of @xmath against the conformal time for\nthree different wavenumbers.\n\nWe can see that as the system enters the tracker regime, decaying\noscillations are set for all the three modes with a constant frequency\ngiven by Eq.\u00a0( 48 ). Since @xmath is negligible in Eq.\u00a0( 48 ) the\nfrequency of these oscillations is the same for all modes. When the\nsecond term in the right-hand-side of Eq.\u00a0( 33 ) becomes comparable to\nthe term @xmath the fluctuations evolves onto the attractor solution\ngiven by Eq.\u00a0( 49 ). In the specific case we consider there is not an\nexact tracking and consequently the ratio @xmath scales linearly and not\nsteadily as in the exact tracking case. This explains why @xmath\nincreases with time in the long wavelength mode. As different scales\ncross the horizon they leave this attractor solution. For instance the\nshortest wavelengths ( @xmath ) enter the horizon after matter radiation\nequality. Due to the decay of the gravitational potential the first term\non the right-hand-side of Eq.\u00a0( 33 ) becomes large leading to a decaying\nsolution with small damped oscillations whose frequency is set by the\neffective mass term @xmath on the left-hand-side of Eq.\u00a0( 33 ). The\npresence of an attractor solution for the scalar field perturbations is\nevident in figure 9 , where we plot the phase space @xmath .\n\nAs the system evolves in the tracker regime, @xmath and @xmath spiral\ntoward the attractor point @xmath . As soon as the tracker terminates\nthe long wavelength fluctuations have converged to the same values and\ntheir evolution is indistinguishable. In minimally coupled quintessence\nmodels the effects of the scalar field perturbations on the structure\nformation process are negligible. This is because the quintessence\ninteracts only gravitationally with the other fluid components and it is\nusually a subdominant component during the epochs that are relevant for\nthe formation of the early structures. Therefore the clustering of the\ndark energy can have detectable effects only at late times through the\ntime evolution of the gravitational potentials. As we shall see in\nChapter \\thechapter this produces a characteristic imprint in the CMB\nanisotropy power spectrum. In figure 10 we plot the behaviour of the\ngravitational potential @xmath normalized to the cosmological constant\ncase for @xmath (upper panel) and @xmath for three different\nquintessence models whose dynamics have been described in Chapter\n\\thechapter : (model A) the SUGRA potential Eq.\u00a0( 22 ) with slope @xmath\n(blue solid line); (model B) the two exponential potential Eq.\u00a0( 23 )\nwith @xmath and @xmath (red dash line) and (model C) @xmath and @xmath\n(blue dash dot line). We may note a number of features that arises from\nthe presence of dark energy perturbations and a different expansion rate\nof the Universe compared to the @xmath CDM model. Let us consider the\nmode @xmath that crosses the horizon during the matter era. For model B\n(red dash line) the quintessence energy density is always negligible\nduring the matter era and consequently there are no effects due to the\nperturbations in the evolution of the gravitational potential. On the\nother hand because of the scalar field dynamics the late time expansion\nrate of the Universe is different compared to the @xmath case, hence\n@xmath diverges from the unity. In contrast in models A and C the\nquintessence energy density dominates earlier, especially in model C\nwhere @xmath is a large fraction of the total energy density (see figure\n7 ). In this case we can distinguish two different evolutionary regimes\nof the gravitational potential. At redshift @xmath the Universe is\nmatter dominated and the quintessence is in the tracker solution with an\nequation of state very close to the matter value. Therefore during this\nperiod the expansion rate is the same as in the @xmath model and we\nwould expect @xmath . The fact this ratio deviates from unity is due to\nthe presence of the dark energy perturbations. On the other hand the\nevolution of the gravitational potential at @xmath is caused by the\naccelerated phase of expansion. This can be seen by the change of the\nslope of @xmath at a redshift @xmath when the acceleration starts. The\nlate time decay of the gravitational potential sources the formation of\nCMB anisotropy through the late Integrated Sachs-Wolfe effect (ISW). The\nsame arguments hold for the mode @xmath that enters the horizon soon\nafter matter-radiation equality. However it is worth noticing that in\nthe case of model C, the early contribution of dark energy causes the\nscalar field perturbations to produce a bigger effect on the decay of\n@xmath , leading to a larger early ISW effect. From this analysis we\nconclude that different dark energy models will lead to a characteristic\nsignature in the CMB power spectrum and will prove this point in a more\ngeneral way in Chapter \\thechapter .\n\n## Chapter \\thechapter Constraining the quintessence potential\n\nCosmological distance measurements test the expansion rate of the\nUniverse at different redshifts. Therefore they can be used to constrain\nthe dark energy properties and eventually disprove the @xmath CDM model.\nA lot of effort has gone into constraining the value of the dark energy\nequation of state with the current available data. In this Chapter we\nwill review some of the constraints obtained in previous works. Then we\nwill describe the analysis of the Sn Ia data and the measured position\nof the CMB peaks that we performed to constrain the shape of a general\nquintessence potential [ 110 ] . We will comment on our results and\ncompare them to those obtained in other related work.\n\n### 11 Upper bounds on the cosmic equation of state\n\nDifferent dark energy models are usually constrained assuming that the\ndark energy behaves as a perfect fluid with a constant equation of state\n@xmath . This can take into account for models such as a network of\ntopological defects with @xmath ( @xmath is the dimension of the defect)\n[ 111 ] and as first approximation time dependent tracker quintessence\nmodels with @xmath . Different values of @xmath will lead to a different\nexpansion rate and consequently to a different cosmological distance. In\nparticular for larger negative values of @xmath the phase of\nacceleration starts at earlier times and therefore cosmological distance\nindicators will appear farther than in models with smaller negative\nvalues of @xmath . This can be seen in figure 11 , we plot in the solid\nline the redshifts @xmath when the Universe starts accelerating and in a\nstarred line the redshift @xmath when the dark energy starts dominating\nas a function of @xmath for different values of @xmath . For a flat\nUniverse The redshift @xmath is given by\n\n  -- -------- -- ------\n     @xmath      (50)\n  -- -------- -- ------\n\nand the redshift @xmath is\n\n  -- -------- -- ------\n     @xmath      (51)\n  -- -------- -- ------\n\nNote for @xmath we have @xmath . For a flat Universe the effect on\ncosmological distances produced by varying @xmath is degenerate with\n@xmath and with the Hubble parameter @xmath .\n\nBy making use of the Sn Ia data the authors of [ 53 , 112 ] find the\nconstraint @xmath (2 @xmath ) for @xmath . We will comment in the next\nChapter about the bias effect introduced in the analysis of data by\nassuming a constant equation of state. The position of the Doppler peaks\nin the CMB anisotropy power spectrum is another indicator of the\ncosmological distance to the last scattering surface and hence can be\nused to constrain @xmath . In [ 113 ] a constant effective equation of\nstate\n\n  -- -------- -- ------\n     @xmath      (52)\n  -- -------- -- ------\n\nhas been constrained with the Sn Ia, CMB and the LSS data. The authors\nfind @xmath (2 @xmath ) with @xmath being best fit. They comment that\ntracker models can marginally accommodate the Sn Ia and LSS constraints\nat the same time (see figure 12 ).\n\nSuch an inconsistency can be explained as follows. The supernova\nluminosity distance is sensitive to the value of @xmath , while large\nscale structure data are more sensitive to the amount of clustered\nmatter @xmath through the matter power spectrum. This implies that dark\nenergy models with different values of @xmath will not change the\nlikelihood in @xmath of the large scale structure data. In fact assuming\nthe value of the effective equation of state to be @xmath , this shifts\nthe Sn Ia likelihood towards smaller values of @xmath ( i.e. larger\nvalues of @xmath ). As we will show later, extending the likelihood\nanalysis to the slope of the tracker potential enables us to find models\nthat simultaneously fit the whole data. Similar constraints from Sn Ia\nand CMB data have been found by Efstathiou [ 114 ] , namely @xmath (2\n@xmath ). In a different approach Saini et al. [ 115 ] have\nparameterized the luminosity distance and by constraining their\nparameter space with the Sn Ia data they have been able to reconstruct\nthe redshift dependence of the dark energy equation of state. They find\na time dependence with @xmath today and @xmath at @xmath . Waga and\nFrieman have constrained the slope of the Inverse Power Law potential\n@xmath (see Eq.\u00a0( 20 )) by making use of the Sn Ia and lensing statistic\ndata [ 116 ] . Imposing @xmath they obtain an upper limit on the present\nvalue of the equation of state @xmath that implies @xmath . The combined\nanalysis of the CMB power spectrum measured by the Boomerang and MAXIMA\nexperiments with Sn Ia and large scale structure, limits a constant\nequation of state to be @xmath with @xmath being the favoured value [\n117 ] .\n\n### 12 Parameterized quintessence potential\n\nWe have seen in Chapter \\thechapter that for tracker models the present\nvalue of the equation of state depends of the shape of the scalar field\npotential. In particular for SUGRA inspired models [ 100 , 118 , 96 ,\n101 ] the equation of state parameter varies in the range @xmath , while\nInverse Power Law potentials require larger values. A general potential\nwhich can accommodate for these classes of scenarios is:\n\n  -- -------- -- ------\n     @xmath      (53)\n  -- -------- -- ------\n\nwhere @xmath and @xmath is fixed in such a way that today @xmath , where\n@xmath is the critical energy density. For @xmath Eq.( 53 ) becomes an\ninverse power law, while for @xmath we have the SUGRA potential proposed\nby [ 96 ] . For @xmath , @xmath and starting with a large value of\n@xmath , the Quintessence field evolves in a pure exponential potential\n[ 77 ] . We do not consider this case further since it is possible to\nhave a dark energy dominated universe, but at the expense of fine tuning\nfor the initial conditions of the scalar field. Larger values of @xmath\nmimic the late time evolution of the model studied in [ 101 ] . For\n@xmath the potential has a minimum, the dynamics can be summarized as\nfollows: for small values of @xmath and for a large range of initial\nconditions, the field does not reach the minimum by the present time and\nhence @xmath . For example, if the Quintessence energy density initially\ndominates over the radiation, the @xmath field quickly rolls down the\ninverse power law part of the potential eventually resting in the\nminimum with @xmath after a series of damped oscillations [ 119 ] . This\nbehaviour however requires fine tuning the initial value of @xmath to be\nsmall. On the other hand, this can be avoided if we consider large\nvalues of @xmath and @xmath (figure 13 a). In these models the\nfractional energy density of the quintessence field, @xmath , is always\nnegligible during both radiation and matter dominated eras. In fact, for\nsmall initial values of @xmath , @xmath acts like an inverse power law\npotential, hence as @xmath enters the scaling regime its energy density\nis subdominant compared to that of the background component. Therefore\nnucleosynthesis constraints [ 103 ] are always satisfied and there are\nno physical effects on the evolution of the density perturbations. The\nmain consequence is that for a different value of @xmath the Universe\nstarts to accelerate at a different redshift (figure 13 b).\n\nThis implies that different values of @xmath and @xmath lead to a\ndifferent luminosity distance and angular diameter distance.\nConsequently by making use of the observed distances we may in principle\ndetermine an upper limit on @xmath , potentially constraining the\nallowed shape of the quintessence potential [ 120 ] .\n\n### 13 CMB peaks\n\nThe CMB power spectrum provides information on combinations of\nfundamental cosmological parameters. The physical processes responsible\nfor the anisotropy are well understood allowing us to accurately predict\nthe shape of the anisotropy power spectrum for a given cosmological\nmodel. The presence of acoustic oscillations of the photon-baryon plasma\nbefore the recombination epoch establishes a multiple peaks pattern in\nthe power spectrum. For a review of the subject we refer to [ 121 ] .\nDuring the radiation dominated era the equation describing the effective\ntemperature fluctuation @xmath of the CMB is of the form [ 122 ] :\n\n  -- -------- -- ------\n     @xmath      (54)\n  -- -------- -- ------\n\nwhere @xmath is the gravitational potential sourced by the energy\ndensity perturbations in the different matter components, @xmath is the\nsound speed of the barotropic fluid and the primes are derivatives with\nrespect to @xmath , @xmath being the conformal time and @xmath the\ncomoving wavenumber. Eq.\u00a0( 54 ) has the form of a perturbed harmonic\noscillator, therefore when the photons decouple from the baryons their\nenergy carries an imprint of such oscillations. The characteristic\nfrequency of these oscillations is fixed by the size of the sound\nhorizon at the decoupling @xmath . Therefore we have a series of\ncompressions and rarefactions at scales @xmath . Today such scales\nappear at angles that are multiple integers of the angular size of the\nsound horizon at the decoupling @xmath , where @xmath is the distance to\nthe last scattering surface for a space-time with curvature @xmath . As\na consequence of these the position of the \u2018Doppler\u2019 peaks in the power\nspectrum depends on the geometry of the Universe. For a flat Universe\nthe peaks will appear at the multipoles\n\n  -- -------- -- ------\n     @xmath      (55)\n  -- -------- -- ------\n\nwhere @xmath is the mean sound speed and @xmath , @xmath are the\nconformal time today and at last scattering respectively. However the\nacoustic oscillations are perturbed by the evolution of the\ngravitational potential @xmath on the right-hand-side of Eq.\u00a0( 54 ),\nwhich shifts the position of the peaks by an amount that depends on the\ncosmological parameters that are relevant before the recombination. This\nresults in a better estimate for the peak positions being given by:\n\n  -- -------- -- ------\n     @xmath      (56)\n  -- -------- -- ------\n\nwhere @xmath is an overall shift [ 122 ] and @xmath is the shift of the\n@xmath -th peak. These corrections depend on the amount of baryons\n@xmath , on the fractional quintessence energy density at last\nscattering ( @xmath ) and today ( @xmath ), as well as on the scalar\nspectral index @xmath . Analytic formulae, valid over a large range of\nthe cosmological parameters, have been provided to good accuracy for\n@xmath and @xmath [ 123 ] . Of crucial importance is the observation\nthat the position of the third peak appears to remain insensitive to\nother cosmological quantities. This is because at small scales, well\ninside the horizon, @xmath is usually negligible, hence we recover the\nunperturbed harmonic oscillator equation for Eq.\u00a0( 54 ) that describes\noscillations with zero point offset. Hence we can make use of this fact\nto test dark energy models [ 124 , 125 ] . As we shall discuss in more\ndetail in Chapter \\thechapter , the quintessence field can leave a\ndistinctive signature on the shape of the CMB power spectrum through\nboth the early integrated Sachs-Wolfe effect (ISW) and the late one [\n126 ] . The former is important if the dark energy contribution at the\nlast scattering surface is not negligible [ 100 , 118 ] or in\nnon-minimally coupled models [ 82 , 127 , 128 ] , whereas the late ISW\nis the only effect in models with @xmath such as those described by our\nparameterized quintessence potential [ 129 ] . However the late ISW\nproduces an imprint on the CMB power spectrum of the order of @xmath and\ntherefore is not detectable with the pre-WMAP measurements. In such a\ncase an accurate determination of the position of the Doppler peaks is\nmore sensitive to the actual amount of dark energy.\n\n### 14 Likelihood analysis and results\n\n#### 14.1 Constraints from supernovae\n\nWe want to constrain the set of parameters @xmath , @xmath and @xmath\nconfined in the range: @xmath , @xmath and @xmath , subject to the\nassumption of a flat universe. This choice of the parameters allows us\nto account for a large number of models. We use the Sn Ia data fit C of\nPerlmutter et al. (1999) [ 53 ] , that excludes 4 high redshift data\npoints, which are very likely reddened by their host galaxies. The\nmagnitude-redshift relation is given by:\n\n  -- -------- -- ------\n     @xmath      (57)\n  -- -------- -- ------\n\nwhere @xmath is the \u2018Hubble constant free\u2019 absolute magnitude and @xmath\nis the free-Hubble constant luminosity distance. In a flat universe\n\n  -- -------- -- ------\n     @xmath      (58)\n  -- -------- -- ------\n\nwhere @xmath is the conformal time today and @xmath is the conformal\ntime at the red-shift @xmath of the observed supernova. Both of these\nquantities are calculated solving numerically Eq.\u00a0( 18 ) and Eq.\u00a0( 19 )\nfor each value of @xmath and @xmath . In @xmath we neglect the\ndependence on a fifth parameter ( @xmath in [ 53 ] ) and assume it to be\n0.6, the best fit value in [ 53 ] . We then obtain a gaussian likelihood\nfunction @xmath , by marginalizing over @xmath . In figure 14 a we\npresent the one-dimensional likelihood function normalized to its\nmaximum value for @xmath . When considering only Sn Ia data, there is a\nmaximum at @xmath , such a high value of @xmath is required if we impose\nthe constraint @xmath and it is in agreement with the analysis in [ 130\n] . In figure 15 a we present the likelihood contours in the @xmath\nparameter space, obtained after marginalizing over @xmath . Note that\nall values are allowed at the @xmath level. The confidence regions for\nthe Sn Ia data correspond to Quintessence models with @xmath for @xmath\n, an upper limit that agrees with those found in [ 53 , 114 ] .\n\n#### 14.2 Constraints from Doppler peaks and Sn Ia\n\nWe now compute the position of the three Doppler peaks @xmath and @xmath\nusing Eq.\u00a0( 56 ). In addition to the parameter space used in the\nsupernovae analysis we consider the physical baryon density and the\nscalar spectral index varying respectively in the range @xmath and\n@xmath . The Hubble constant is set to @xmath in agreement with the\nrecent HST observations [ 29 ] . It is worth remarking that the baryons\ndensity and @xmath are degenerate with the quintessence parameters. In\nfact increasing @xmath reduces the value of @xmath causing a shift of\nthe CMB peaks towards large multipoles. The same effect occurs for low\nvalues of the Hubble constant, therefore the results of this analysis\nwill depend on the HST prior. The predicted peak multipoles are then\ncompared with those measured in the Boomerang and DASI spectra [ 131 ] .\nNote, that the third peak has been detected in the Boomerang data but\nnot in the DASI data. In table 1 we report the position of the peaks\nwith @xmath errors estimated from the Boomerang, DASI and WMAP data with\na model independent analysis. Since the errors are non Gaussian (see\nalso [ 132 ] ), to be conservative we take our @xmath errors on the data\nto be larger than those reported in [ 131 ] , so that our analysis is\nsignificant up to @xmath .\n\nWe then evaluate a gaussian likelihood function @xmath . The combined\none-dimensional likelihood function for the peaks is shown in figure 14\nb, where we find @xmath . The likelihood for all the data sets combined\nis shown in figure 14 c, where we find @xmath . These results are in\nagreement with the analysis in [ 148 , 21 , 133 ] .\n\nThe likelihood functions, combining all the CMB peaks data, for the\nscalar spectral index and the physical baryon density are shown in\nfigure 16 . Since the dependence of the peak multipoles on @xmath and\n@xmath is weak, it is not possible to obtain some significant\nconstraints on these cosmological parameters. In figure 15 b- 15 d we\nplot the two-dimensional likelihood function in the plane @xmath for\neach peak, obtained after having marginalized over @xmath , @xmath and\n@xmath . Their shape reflects the accuracy in the estimation of the\nposition of the peaks. Actually the first one is very well resolved,\nwhile we are less confident with the location of the second and third\npeak. Therefore their likelihoods are more spread and flat in the @xmath\nplane. The @xmath confidence contour (figure 15 b) for the first\nacoustic peak constrains the slopes of our potential in the range:\n@xmath and @xmath . In particular the likelihood has a maximum at @xmath\nand @xmath , corresponding to an equation of state @xmath for @xmath ,\nin agreement with the recent analysis in [ 133 ] . However, the second\nand third peaks constrain a complementary region where the equation of\nstate is compatible with the cosmological constant value. Therefore the\neffect of including all the data in the likelihood analysis is to move\nthe constraint from models with @xmath to models with an equation of\nstate @xmath . The constraints on the slopes of the quintessence\npotential allows us to infer an upper limit on the present value of the\nequation of state only after having fixed the value of @xmath . In fact\nthe scalar field potential Eq.\u00a0( 53 ) is fully specified by three\nnumbers that are @xmath . However the map @xmath is not one-to-one and\ntherefore it is not possible to transform the likelihood @xmath .\nTherefore there is a substantial difference between inferring the bounds\non the dark energy equation of state by directly constraining its\npresent value and constraining the scalar field potential. As we can see\nin figure 18 the values of @xmath and @xmath , allowed by the likelihood\nincluding all the data (figure 17 ), correspond to our models with\nvalues of @xmath in the range @xmath at @xmath for our prior probability\n@xmath . Assuming smaller values of @xmath relaxes the constraints on\n@xmath , for instance for @xmath we have @xmath at @xmath . The results\nof our analysis can be interpreted as follows. At the @xmath level the\nposition of the first peak is inconsistent with the position of the\nother two. A possible explanation of this discrepancy is that the\nmultipoles @xmath and @xmath are less sensitive to small shifts induced\nby the dependence on @xmath and @xmath . Therefore we can obtain a\ndifferent constraint on the dark energy equation of state if we consider\nthe peaks individually. It is worth remarking that the position of the\nfirst peak in the Boomerang data prefers slightly spatially closed\nmodels. Having assumed a flat geometry affects our upper bounds on the\nslope of the potential in a region corresponding to @xmath . On the\nother hand the location of the third peak inferred in [ 131 ] , is at\n@xmath , for which values of @xmath fit this multipole better than\nmodels with @xmath . In fact the peaks are shifted toward larger\nmultipoles as @xmath approaches the cosmological constant value. This is\nbecause, in models with @xmath the Universe starts to accelerate earlier\nthan in those with @xmath , consequently the distance to the last\nscattering surface is farther and hence the sound horizon at the\ndecoupling is projected onto smaller angular scales.\n\nA possible source of bias in our analysis is due to the prior on the\nvalue of @xmath , in fact assuming @xmath implies that models with a\nlarge negative equation of state and large value of @xmath are\npreferred. However our results are consistent with other studies which\nassume similar priors. For instance in [ 133 ] , using the complete set\nof available CMB measurements the slope of the Inverse Power Law\npotential has been constrained to be @xmath under the prior @xmath ,\ncorresponding to @xmath . Similarly in [ 134 ] , by making use of the\nCMB, Sn Ia and large scale structure data, it has been found @xmath for\na constant equation of state. A time dependent dark energy equation of\nstate, characterized by a late time transition, has been constrained\nusing all cosmological data in [ 135 ] , where it has been found @xmath\n.\n\n### 15 Discussion\n\nThe analysis of Sn Ia data and the location of the CMB peaks in\nBoomerang and DASI data constrain the slope of a general quintessence\npotential in a range of values such that the quintessence field is\nundergoing small damped oscillations around a minimum of the potential\n(see figure 13 ). Such a situation implies that the value of the\nquintessence equation of state has to be very close to @xmath . However\nthis does not imply that the dark energy is the cosmological constant.\nWhat our result means is that the quintessence field today is evolving\nin a nearly vacuum state. In fact models where the scalar field is\nrolling down a very flat region of the potential can fit the data and\npass the constraints even though they are not included in our analysis.\nAnother important caveat is that this study does not take into account\nquintessence scenarios where the contribution of the dark energy is not\nnegligible. In such a case we would have to take into account physical\neffects not only on distance measurements, but on the structure\nformation process itself (see for instance [ 136 , 104 ] ). These\neffects however are not detectable with the level of accuracy provided\nby the recent balloon and ground CMB experiments. A revised analysis of\nthe Boomerang data has been recently published in [ 22 ] , the position\nof the peaks has been determined with a better accuracy, in particular\nthe third peak is shifted at a smaller multipole than previously\ndetected. This slightly changes our results, relaxing the lower bounds\non the slope @xmath . Here we want to stress the fact that it seems\nlikely the present value of the dark energy equation of state is close\nto @xmath . However the possibility that the equation of state was\nlargely different from @xmath cannot be excluded, as it is shown by the\nclass of models that best fit the Sn Ia data and the CMB peaks. The new\ngeneration of satellite experiments we will probably be able to detect\nthe specific effects produced by a time varying dark energy component.\n\n## Chapter \\thechapter A model independent approach to the dark energy\nequation of state\n\nThe detection of time variation in the dark energy equation of state can\nbe considered as the \u2018smoking gun\u2019 for the cosmological constant\nscenario. The new generation of experiments in cosmology will provide\nhigh precision measurements that in principle can discriminate between\ndifferent dark energy candidates. On the other hand it is unrealistic to\nassume we can infer some general information constraining some\nparticular quintessence model. In fact a plethora of scalar field\npotentials have been proposed, all leading to similar late time\nbehaviour of the universe, hence to a lack of predictability. In this\nChapter, we first review some of the methods that have been proposed in\nthe literature to constrain the time features of a general quintessence\ncomponent. We then introduce a model independent approach which simply\ninvolves parameterizing the dark energy equation of state in terms of\nknown observables [ 137 ] . This allows us to analyse the impact dark\nenergy has had on cosmology without the need to refer to particular\nscalar field models and opens up the possibility that future experiments\nwill be able to constrain the dark energy equation of state in a model\nindependent manner.\n\n### 16 The effective equation of state\n\nMeasuring the present value of the dark energy equation of state can\ndistinguish between a cosmological constant scenario and a\nquintessential component if @xmath . Using the tracker properties of the\nquintessence field, the most reliable method to infer a bound on @xmath\nwould be to constrain directly the quintessence potential. However this\ncould result in a difficult challenge, for instance in Table 2 we show a\nlist of proposed tracker quintessence potentials. Therefore, because\nthere are no fundamental physical principles that can specify the nature\nof the dark energy, we are left with a potentially infinite set of\nfamilies of theoretical models to compare with the data.\n\nAs a consequence of this it is to be hoped that a more general way of\nconstraining the dark energy can be developed. A simple method to take\ninto account a large number of dark energy models is to consider a\nconstant effective equation of state defined by Eq.\u00a0( 52 ). Using the\nenergy conservation equation, the redshift evolution of the dark energy\ndensity is given by\n\n  -- -------- -- ------\n     @xmath      (59)\n  -- -------- -- ------\n\nThe effective equation of state appears through the Hubble equation in\nthe coordinate distance defined by:\n\n  -- -------- -- ------\n     @xmath      (60)\n  -- -------- -- ------\n\nHence the value of @xmath can be constrained by measurements of the\nluminosity distance and the angular diameter distance, that in a flat\nspace-time read as @xmath and @xmath respectively. There is a general\nconsensus that an accurate determination of @xmath from high redshift Sn\nIa measurements with the proposed SNAP satellite [ 140 ] can determine\n@xmath to better than 5 per cent [ 141 ] . In such a case if @xmath is\nmuch larger than @xmath it will be possible to rule out the @xmath CDM\nmodel. However if @xmath the results of the data analysis have to be\ncarefully considered. In fact it has been shown by Maor et al. [ 142 ]\nthat assuming a constant @xmath introduces a bias that leads to\nmisleading conclusions about the properties of the dark energy. In order\nto make this point clear, let us consider a sample of mock data\ngenerated from a dark energy model with an equation of state of the form\n\n  -- -------- -- ------\n     @xmath      (61)\n  -- -------- -- ------\n\nwith @xmath and @xmath . The constraints on a constant equation of state\n@xmath obtained from the statistical analysis of such a sample, will\npush the bounds towards values of @xmath . This effect has been noticed\nalso in other works, see for instance [ 145 , 146 ] and can be explained\nas follows. For a model with @xmath given by Eq.\u00a0( 61 ) the energy\ndensity evolves as:\n\n  -- -------- -- ------\n     @xmath      (62)\n  -- -------- -- ------\n\nAs we may note, comparing Eq.\u00a0( 59 ) with Eq.\u00a0( 62 ), if @xmath and\n@xmath , fitting the data with a constant equation of state roughly\nrequires @xmath . In other words the fitting procedure will pick out\nvalues of @xmath that are more negative than the fiducial one. Hence a\ntime varying dark energy component can be confused with a cosmological\nconstant, while allowing @xmath to vary in a range of values more\nnegative than -1, will shift the best fit models towards @xmath .\nTherefore it is very possible that the claims for the existence of\nphantom matter (with @xmath ) [ 143 , 144 ] are just a consequence of\nassuming a constant equation of state in the data analysis.\n\n### 17 Cosmological distance fitting functions\n\nSeveral methods to constrain the time dependence of the dark energy\nequation of state have been discussed in the literature [ 115 , 147 ,\n148 , 149 , 150 , 151 , 145 , 152 , 153 , 146 ] . Since the dark energy\nbecame dominant only recently, it is reasonable to concentrate on local\nredshift measurements, such as the Sn Ia. The coordinate distance and\nthe Hubble parameter are uniquely related by @xmath . Thus we can\nestimate @xmath from cosmological distance indicators and unambiguously\ncalculate @xmath and @xmath . This allows us to reconstruct @xmath\nprovided the value of @xmath is given. In fact the Hubble equations in\nthe presence of matter and a scalar field are:\n\n  -- -------- -- ------\n     @xmath      (63)\n  -- -------- -- ------\n\nand\n\n  -- -------- -- ------\n     @xmath      (64)\n  -- -------- -- ------\n\nwhere the dot is the derivative with respect to the time. These\nequations can be rewritten in the form:\n\n  -- -------- -- ------\n     @xmath      (65)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (66)\n  -- -------- -- ------\n\nwhere @xmath . Using the definition of the scalar field equation of\nstate we find:\n\n  -- -------- -- ------\n     @xmath      (67)\n  -- -------- -- ------\n\nThe idea is then to introduce a fitting function for the coordinate\ndistance, so that once its parameters have been determined from the data\nanalysis, its first and second derivatives with respect to the redshift\ncan be analytically calculated. The authors of [ 115 ] suggest\n\n  -- -------- -- ------\n     @xmath      (68)\n  -- -------- -- ------\n\nwhere @xmath , @xmath and @xmath are fitting parameters, while Huterer\n@xmath Turner [ 147 ] consider both a polynomial fitting function\n\n  -- -------- -- ------\n     @xmath      (69)\n  -- -------- -- ------\n\nand a Pade\u2019 approximate\n\n  -- -------- -- ------\n     @xmath      (70)\n  -- -------- -- ------\n\nIt has been pointed out in [ 146 ] that such a general method fails to\naccurately reproduce the correct behaviour of given scalar field models,\neven assuming strong priors on the value of @xmath . The difficulty\narises because the formula Eq.\u00a0( 67 ) depends on the derivatives of\n@xmath . Therefore even though @xmath can mimic the @xmath of a specific\nmodel, this may be not true for its derivatives.\n\n### 18 Statefinder method\n\nA different approach has been developed by Sahni et al. [ 154 , 155 ] .\nThey suggest a method to distinguish amongst different dark energy\nscenarios by measuring geometrical parameters that are constructed in\nsuch a way they are more sensitive to the expansion rate of the\nUniverse. Such parameters, called Statefinder pair, are defined by:\n\n  -- -------- -- ------\n     @xmath      (71)\n  -- -------- -- ------\n\nFor a flat Universe the relation to the dark energy equation of state\n@xmath and its time derivative @xmath is:\n\n  -- -------- -- ------\n     @xmath      (72)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (73)\n  -- -------- -- ------\n\nwhere @xmath is the Hubble parameter. In general the value of such\nparameters evolves with the time, but for the cosmological constant (\n@xmath ) we have @xmath at all the times. Moreover, since @xmath are\ngeometrical quantities, they can naturally take into account braneworld\nmodels in which the accelerated expansion is caused by five dimensional\ngravity effects and which lead to modifications of the Hubble equations.\nThe Statefinder pair can be estimated using the following ansatz for the\nHubble parameter,\n\n  -- -------- -- ------\n     @xmath      (74)\n  -- -------- -- ------\n\nwhere @xmath , and @xmath . In such a case @xmath are of the form:\n\n  -- -------- -- ------\n     @xmath      (75)\n  -- -------- -- ------\n\n  -- -------- -- ------\n     @xmath      (76)\n  -- -------- -- ------\n\nThe value of the fitting parameters @xmath can be inferred from a\nlikelihood analysis of cosmological distance measurements, such as the\nSn Ia. From Eq.\u00a0( 75 ) it appears obvious that an accurate estimation of\n@xmath needs a precise knowledge of the amount of non-relativistic\nmatter. In [ 155 ] it has been shown that imposing a Gaussian prior\nprobability distribution on @xmath with variance @xmath , the high\nredshift Sn Ia measurements provided by the proposed SNAP satellite will\naccurately determine the Statefinder pair offering the chance to\ndistinguish between different dark energy models. Therefore the\nStatefinder method seems to be highly sensitive to the nature of dark\nenergy and avoids the main difficulties of the reconstructing procedure.\nIn fact it only needs to constrain fitting parameters that appear in the\nHubble equation and does not constrain directly the equation of state\nthat affects the expansion rate apart from through a time integrated\neffect. A potential limitation of such an approach is that the\ndetermined values of @xmath do not give us any information about the\nphysical properties of the dark energy, unless their values are a priori\nknown for specific classes of models.\n\n### 19 Low redshift parameterization\n\nIn the absence of theoretically motivated dark energy models we can\nconsider a low redshift expansion for @xmath and the parameters of such\nan expansion can be interpreted as fundamental dark energy parameters.\nTherefore the constraints on a parameterization of the equation of state\nwould provide a model independent determination of the dark energy\nproperties. Such a parameterization should satisfy the following\nrequirements:\n\n-   it should depend on a minimal number of parameters @xmath that\n    specify the physical properties of the dark energy;\n\n-   the functional form of the parameterization has to be such that for\n    a given set @xmath the behavior of the equation of state @xmath\n    reproduces the @xmath predicted by proposed quintessence models and\n    can account also for more general cases.\n\nIn [ 148 , 146 ] it was suggested the use of a logarithmic expansion,\n\n  -- -------- -- ------\n     @xmath      (77)\n  -- -------- -- ------\n\nwhile the authors of [ 145 , 151 , 153 ] used a polynomial fitting\nfunction,\n\n  -- -------- -- ------\n     @xmath      (78)\n  -- -------- -- ------\n\nThe general drawback of using a redshift expansion formula for the dark\nenergy equation of state is that the number of fitting parameters is now\nlarger than assuming a simple time constant behaviours and consequently\nthe degeneracy in the dark energy parameter space is enlarged. In fact\nthe coordinate distance is related by a multi-integral expression to the\nequation of state and therefore widely different @xmath can have the\nsame multi-integral value. There is a general consensus that assuming\nstrong priors on the value of @xmath it will be possible to tightly\nconstrain @xmath , but it will be more difficult to put tight bounds on\nthe other parameters. The solution would be to combine different data\nsets that can break the degeneracy in the parameter space. The\nexpansions specified by Eq.\u00a0( 77 ) and Eq.\u00a0( 78 ) both have limited\napplicability. For instance Eq.\u00a0( 77 ) can take into account only for\nquintessence models with slowly varying behaviours and breaks down at\nlarge redshifts, as we can see in figure 19 .\n\nOn the other hand the polynomial expansion Eq.\u00a0( 78 ) introduces a\nnumber of unphysical parameters whose values are not directly related to\nthe properties of a dark energy fluid. The consequence is that, unless\nwe pay the cost of considering very unphysical values, their application\nis limited to low redshift measurements and cannot be extended to the\nanalysis of high redshift data sets such as the CMB data. An interesting\nalternative to the fitting expansion approach, has recently been\nproposed in [ 156 ] . The authors of this study developed a method to\nreconstruct the time behavior of the equation of state from cosmological\ndistance measurements without assuming the form of its parameterization.\nIn spite of the efficiency of such an approach, it does not take into\naccount the effects of the possible clustering properties of dark energy\nwhich become manifest at higher redshifts. Hence its application has to\nbe limited to the effects dark energy can produce on the expansion rate\nof the universe at low redshifts. On the other hand, it has been argued\nthat dark energy does not leave a detectable imprint at higher\nredshifts, since it has only recently become the dominant component of\nthe universe. Such a statement, however, is model dependent, on the face\nof it there is no reason why the dark energy should be negligible deep\nin the matter dominated era. For instance CMB observations constrain the\ndark energy density at decoupling to be less then 10 per cent of the\ncritical one [ 104 ] . Such a non negligible contribution can be\nrealized in a large class of models and therefore cannot be a priori\nexcluded. Consequently it is of crucial importance to find an\nappropriate parameterization for the dark energy equation of state that\nallows us to take into account the full impact dark energy has on\ndifferent types of cosmological observations.\n\n### 20 An exact parameterization for the dark energy equation of state\n\nOur goal is to determine an appropriate analytical form of the equation\nof state @xmath valid at all redshifts in terms of physical quantities,\nso that it can describe a general fluid and take into account most of\nthe proposed dark energy models. In Chapter 2 we have seen that the\nspecific evolution of @xmath , depends on the shape of the potential,\nhowever there are some common features in its behaviour that can be\ndescribed in a model independent manner and which allow us to introduce\nsome physical parameters. As we have seen in Chapter 2 a large number of\nquintessence models are characterized by the existence of the \u2019tracker\nregime\u2019. It consists of a period during which the scalar field, while it\nis approaching a late time attractor, evolves with an almost constant\nequation of state whose value can track that of the background\ncomponent. Here we consider a broad class of tracking potentials. These\ninclude models for which @xmath evolves smoothly, as with the inverse\npower law [ 73 ] , @xmath (INV) and the supergravity inspired potential\n[ 96 ] , @xmath (SUGRA). Late time rapidly varying equation of states\narise in potentials with two exponential functions [ 100 ] , @xmath\n(2EXP), in the so called \u2018Albrecht & Skordis\u2019 model [ 118 ] (AS) and in\nthe model proposed by Copeland et al. [ 101 ] (CNR). To show this in\nmore detail, in figure 20 we plot the equation of state obtained by\nsolving numerically for each of these potentials the scalar field\nequation of motion defined by Eq.\u00a0( 18 ) and Eq.\u00a0( 19 ).\n\nThere are some generic features that appear to be present, and which we\ncan make use of in our attempts to parameterize @xmath . For a large\nrange of initial conditions of the quintessence field, the tracking\nphase starts before matter-radiation equality. In such a scenario @xmath\nhas three distinct phases, separated by two \u2018phase transitions\u2019. Deep\ninto both the radiation and matter dominated eras the equation of state,\n@xmath , takes on the values @xmath and @xmath respectively, values that\nare related to the equation of state of the background component @xmath\nthrough:\n\n  -- -------- -- ------\n     @xmath      (79)\n  -- -------- -- ------\n\nwhere @xmath and @xmath etc. For the case of an exponential potential,\n@xmath , with @xmath , but in general @xmath . Therefore if we do not\nspecify the quintessence potential the values of @xmath and @xmath\nshould be considered as free parameters. The two transition phases can\neach be described by two parameters; the value of the scale factor\n@xmath when the equation of state @xmath begins to change and the width\n@xmath of the transition. Since @xmath is constant or slowly varying\nduring the tracker regime, the transition from @xmath to @xmath is\nalways smooth and is similar for all the models (see figure 20 ). To be\nmore precise, we have found that @xmath and @xmath during this\ntransition, the former number expected from the time of matter-radiation\nequality and the latter from the transition period from radiation to\nmatter domination. However, when considering the transition in @xmath\nfrom @xmath to the present day value @xmath , we see from figure 20 that\nthis can be slow ( @xmath ) or rapid ( @xmath ) according to the slope\nof the quintessence potential. For instance in models with a steep slope\nfollowed by a flat region or by a minimum, as in the case of the two\nexponentials, the AS potential or the CNR model, the scalar field\nevolves towards a solution that approaches the late time attractor,\nfinally deviating from the tracking regime with the parameter @xmath\nrapidly varying. In contrast the inverse power law potential always has\na slower transition since @xmath is constant for all times. Given these\ngeneral features we conclude that the behavior of @xmath can be\nexplained in terms of functions, @xmath , involving the following\nparameters: @xmath , @xmath , @xmath , @xmath and @xmath . The authors\nof [ 135 ] have recently used an expansion in terms of a Fermi-Dirac\nfunction in order to constrain a class of dark energy models with rapid\nlate time transitions.\n\nIn what follows we find that a generalisation of this involving a linear\ncombination of such functions allows for a wider range of models to be\ninvestigated. To be more precise, we propose the following formula for\n@xmath :\n\n  -- -------- -- ------\n     @xmath      (80)\n  -- -------- -- ------\n\nwith\n\n  -- -------- -- ------\n     @xmath      (81)\n  -- -------- -- ------\n\nThe coefficients @xmath , @xmath and @xmath are determined by demanding\nthat @xmath takes on the respective values @xmath , @xmath , @xmath\nduring radiation ( @xmath ) and matter ( @xmath ) domination as well as\ntoday ( @xmath ). Solving the algebraic equations that follow we have:\n\n  -- -------- -------- -------- -- ------\n     @xmath   @xmath   @xmath      (82)\n                                   \n     @xmath   @xmath   @xmath      \n                                   \n     @xmath   @xmath   @xmath      (84)\n  -- -------- -------- -------- -- ------\n\nwhere @xmath , and the value of and @xmath and @xmath can be arbitrarily\nchosen in the radiation and matter era because of the almost constant\nnature of @xmath during those eras. For example in our simulations we\nassumed @xmath and @xmath . In table LABEL:fitpar we present the best\nfit parameters obtained by minimizing a chi-square for the models we\nhave considered and in figure 21 we plot the associated fitting\nfunctions @xmath . It is encouraging to see how accurately the\nFermi-Dirac functions mimic the exact time behavior of @xmath for the\nmajority of the potentials.\n\nIn figure 22 we plot the absolute value of the difference @xmath between\n@xmath and @xmath . The discrepancy is less then @xmath for redshifts\n@xmath where the energy density of the dark energy can produce\nobservable effects in these class of models and it remains below @xmath\nbetween decoupling and matter-radiation equality. Only the CNR case is\nnot accurately described by @xmath due to the high frequency\noscillations of the scalar field which occur at low redshift as it\nfluctuates around the minimum of its potential. In fact these\noscillations are not detectable, rather it is the time-average of @xmath\nwhich is seen in the cosmological observables, and can be described by\nthe corresponding @xmath . There are a number of impressive features\nthat can be associated with the use of @xmath in Eq.\u00a0( 80 ).\n\nFor instance it can mimic the behavior of more general models. As an\nexample of this in figure 23 we plot @xmath that approximately\ncorresponds to three cases: a K-essence model [ 157 ] (blue solid line);\na rapid late time transition [ 158 ] (red dash-dot line) and finally one\nwith an equation of state @xmath (green dash line). The observational\nconstraints on @xmath , @xmath , @xmath , @xmath and @xmath lead to\nconstraints on a large number of dark energy models, but at the same\ntime it provides us with model independent information on the evolution\nof the dark energy. It could be argued that the five dimensional\nparameter space we have introduced is too large to be reliably\nconstrained. Fortunately this can be further reduced without losing any\nof the essential details arising out of tracker solutions in these\nQuintessence models. In fact nucleosynthesis places tight constraints on\nthe allowed energy density of any dark energy component, generally\nforcing them to be negligible in the radiation era [ 103 , 159 ] . The\nreal impact of dark energy occurs after matter-radiation equality, so we\ncan set @xmath . Consequently we end up with four parameters: @xmath ,\n@xmath , @xmath and @xmath . Although they increase the already large\nparameter space of cosmology, they are necessary if we are to answer\nfundamental questions about the nature of the dark energy. The\nparameters make sense, if @xmath evolves in time, we need to know when\nit changed ( @xmath ), how rapidly ( @xmath ) and what its value was\nwhen it changed ( @xmath ). Neglecting the effects during the radiation\ndominated era it proves useful to provide a shorter version of Eq.\u00a0( 80\n), in fact since we can neglect the transition from radiation to matter\ndominated eras, then the linear combination Eq.\u00a0( 80 ) can be rewritten\nas \u00b9 \u00b9 1 We thank Eric Linder for pointing this out to us. :\n\n  -- -------- -- ------\n     @xmath      (85)\n  -- -------- -- ------\n\nAs we can see in figure 24 , the relative difference between the exact\nsolution @xmath of the Klein-Gordon equation and Eq.\u00a0( 85 ) is smaller\nthan @xmath for redshifts @xmath , therefore it provides a very good\napproximation for the evolution of the quintessence equation of state.\nBoth Eq.\u00a0( 80 ) and Eq.\u00a0( 85 ) are very useful in that they allow us to\ntake into account the clustering properties of dark energy (see for\ninstance [ 160 ] ) and to combine low redshift measurements with large\nscale structure and CMB data.\n\n## Chapter \\thechapter Dark energy effects in the Cosmic Microwave\nBackground Radiation\n\nThe physics of the Cosmic Microwave Background radiation has been deeply\nstudied during the past 30 years. The theoretical developments in\nunderstanding the different processes responsible for the temperature\nanisotropies have given to us the possibility to accurately predict the\nspectrum of the CMB fluctuations for a given cosmological model. The\nexistence of these cosmological temperature fluctuations was initially\nconfirmed by the COBE satellite [ 163 ] , but it is only with the recent\ngeneration of balloon and ground experiments, such as Boomerang [ 19 ] ,\nMaxima [ 23 ] and DASI [ 24 ] , that the observations reached the level\nof accuracy necessary for testing different cosmological scenarios. As\nwe have reviewed in Chapter \\thechapter , these measurements have\ndetected the multiple peak structure of the CMB power spectrum,\nproviding an accurate determination of the cosmological parameters. The\nimprovements in the CMB experiments are mainly due to the high\nperformance of the new high frequency microwave detectors. The recent\nWMAP satellite, using this technology has started a new generation of\nsatellite experiments that will measure the temperature and polarization\nanisotropies close to the theoretical \u2018cosmic variance\u2019 limit. It is\ntherefore of crucial importance to study the imprint dark energy leaves\nin the anisotropy power spectrum. In this Chapter we start reviewing the\nmain concepts of the CMB physics. Using a model independent approach we\nstudy the impact of different dark energy models in the CMB spectrum. In\nparticular we find that features of the dark energy equation of state\ncan leave a characteristic imprint in the Integrated Sachs-Wolfe effect\n[ 161 , 162 ] . We will identify the dark energy models that are\ndistinguishable from the cosmological constant. In conclusion we will\nshow the limits on a class of dark energy models that can be obtained by\ncosmic variance limited experiments.\n\n### 21 A beginner\u2019s guide to CMB physics\n\nThe starting point of the CMB anisotropy calculation is the kinetic\ntheory of photons in a perturbed space-time. Here we shall briefly\nreview the main concept of the subject and for more authoritative\nreviews we refer to [ 126 , 121 , 164 ] .\n\n#### 21.1 Basic equations\n\nLet us consider a flat pertubed background. In the Newtonian gauge the\nmetric element is\n\n  -- -------- -- ------\n     @xmath      (86)\n  -- -------- -- ------\n\nwhere @xmath and @xmath are the metric perturbations and @xmath is the\nconformal time. The properties of a gas of photons propagating in this\nspace-time are described by the distribution function @xmath that\ndepends on the three spatial coordinates @xmath and the three conjugate\nmomenta @xmath . In the Newtonian gauge the relation between @xmath and\nthe proper momentum @xmath measured by an observer at a fixed spatial\ncoordinate is given by @xmath . In order to eliminate the metric\nperturbations from the definition of the momenta it is convenient to\nreplace @xmath with @xmath , where @xmath , @xmath and @xmath being the\nmodule and the cosine directions respectively. In the early Universe the\nphotons propagate in a hot ionized medium and interact through the\nCompton scattering with free electrons and ions. As a consequence of\nthis the distribution function is conserved along the perturbed geodesic\napart for a collisional term. The evolution of the distribution function\nis described by the Boltzmann equation:\n\n  -- -------- -- ------\n     @xmath      (87)\n  -- -------- -- ------\n\nwhere @xmath accounts for the Compton scattering and the geodesic\nequation\n\n  -- -------- -- ------\n     @xmath      (88)\n  -- -------- -- ------\n\nIn addition the linearized Einstein equations determine the equations\nfor the metric perturbations @xmath and @xmath in term of the\nperturbations in the multiple fluids system. At the zeroth order we can\nconsider the Universe as being unperturbed, in such a case @xmath is\nindependent of @xmath and @xmath and if the collision between photons\nand charged particles conserve energy, then @xmath is time independent\nand consequently @xmath is as well. This is a good approximation, since\nthe free electrons are non-relativistic and the Compton scattering is\nprimarily Thomson scattering in which momentum and not energy is\ntransferred. The equilibrium distribution function @xmath is\n\n  -- -------- -- ------\n     @xmath      (89)\n  -- -------- -- ------\n\nwhere the factor 2 accounts for the number of polarization states of the\nphoton and @xmath is the temperature of the radiation today. The effects\nof the perturbed background can be described by expanding the\ndistribution function @xmath about the equilibrium state,\n\n  -- -------- -- ------\n     @xmath      (90)\n  -- -------- -- ------\n\nwhere @xmath is given by Eq.\u00a0( 89 ) and @xmath is the perturbed part of\nthe distribution function. Substituting Eq.\u00a0( 90 ) into Eq.\u00a0( 87 ) and\ntaking only the first order terms we obtain:\n\n  -- -------- -- ------\n     @xmath      (91)\n  -- -------- -- ------\n\nFor practical purposes it is convenient to write the perturbed part of\nthe distribution function in term of the brightness function @xmath ,\nthat is the fractional perturbation in the effective temperature of the\nphotons, @xmath . Expanding @xmath around @xmath we have:\n\n  -- -------- -------- -------- -------- ------\n     @xmath   @xmath   @xmath            (92)\n                                @xmath   \n                                @xmath   \n  -- -------- -------- -------- -------- ------\n\nComparing Eq.\u00a0( 90 ) with Eq.\u00a0( 92 ) we obtain\n\n  -- -------- -- ------\n     @xmath      (93)\n  -- -------- -- ------\n\nSubstituting Eq.\u00a0( 93 ) into Eq.\u00a0( 91 ) and taking the Fourier transform\nthe Boltzmann equation becomes [ 18 ] :\n\n  -- -------- -- ------\n     @xmath      (94)\n  -- -------- -- ------\n\nwhere @xmath and\n\n  -- -------- -- ------\n     @xmath      (95)\n  -- -------- -- ------\n\nwhere @xmath is the differential optical depth, with @xmath the\nionization fraction, @xmath the electron number density and @xmath the\nThomson cross section; @xmath is the isotropic component of @xmath ,\n@xmath is the baryon velocity and @xmath is the anisotropic stress\nperturbation for the photons. Hence the collisional term couples the\nevolution of the photon perturbation to that of the baryons. The\nequations for the baryon perturbations are obtained by linearizing the\nconservation equation of the stress energy tensor:\n\n  -- -------- -------- -------- -- ------\n     @xmath   @xmath   @xmath      (96)\n     @xmath   @xmath   @xmath      (97)\n  -- -------- -------- -------- -- ------\n\nwhere @xmath is the velocity perturbation of the photons. It is useful\nto expand the brightness function in a Legendre series:\n\n  -- -------- -- ------\n     @xmath      (98)\n  -- -------- -- ------\n\nUsing the definition of the photon stress energy tensor in term of the\ndistribution function @xmath , it can be shown that @xmath and @xmath .\nSubstituting Eq.\u00a0( 98 ) in Eq.\u00a0( 94 ) and using the explicit form of the\nCompton scattering term Eq.\u00a0( 95 ) we obtain the hierarchy equations [\n165 , 166 ] :\n\n  -- -------- -- ------\n     @xmath      (99)\n  -- -------- -- ------\n\n  -- -------- -- -------\n     @xmath      (100)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (101)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (102)\n  -- -------- -- -------\n\nThe anisotropy power spectrum is defined as:\n\n  -- -------- -- -------\n     @xmath      (103)\n  -- -------- -- -------\n\nFrom Eq.\u00a0( 94 ) we note there are two sources of anisotropy formation,\nthe Compton scattering that couples the photons to the baryons and the\ngravitational effect produced by the presence of density fluctuations in\nall the matter components.\n\n#### 21.2 CMB anisotropies\n\n##### Acoustic Oscillations\n\nBefore recombination the differential optical depth @xmath is very large\nand the scattering between photons and baryons is extremely rapid and\nefficient. In this regime, called the tight coupling limit ( @xmath ),\nthe photons and the baryons behave as a single fluid. Because of this\nthe baryons and photons velocity are the same at the zeroth order,\n@xmath . In such a case Eq.\u00a0( 97 ) becomes:\n\n  -- -------- -- -------\n     @xmath      (104)\n  -- -------- -- -------\n\nwhere @xmath is the baryon to photon ratio. Inverting this equation in\nterms of @xmath and substituting in Eq. ( 100 ) we obtain the iterative\nfirst order solution,\n\n  -- -------- -- -------\n     @xmath      (105)\n     @xmath      (106)\n  -- -------- -- -------\n\nThese equations can be combined into a single second order equation [\n167 ] ,\n\n  -- -------- -- -------\n     @xmath      (107)\n  -- -------- -- -------\n\nwhere @xmath . The source function @xmath arises from the gravitational\npotentials and is given by\n\n  -- -------- -- -------\n     @xmath      (108)\n  -- -------- -- -------\n\nFrom Eq.\u00a0( 107 ) we can distinguish three different contributions to the\nevolution of the isotropic part of the brightness function during the\ntight coupling regime:\n\n-   the radiation pressure given by the term @xmath which dominates on\n    subhorizon scales and supports oscillations of the photon-baryon\n    plasma;\n\n-   the gravitational infall of the photon-baryon fluctuations in the\n    potential well, @xmath ;\n\n-   the @xmath term that sources the oscillations at scales that enter\n    in the horizon between the epochs of matter-radiation equality and\n    decoupling. The @xmath term contribute as a friction term.\n\nNeglecting time variations in the gravitational potentials, Eq.\u00a0( 107 )\ndescribes a forced harmonic oscillator equation. On subhorizon scales\nthe photon pressure balances the gravitational collapse of the\nperturbations and causes the propagation of pressure waves in the\nphoton-baryon plasma. The characteristic scale upon which these waves\ncan propagate is fixed by the size of the sound horizon @xmath . When\nthe photons last scatter, the imprint of these compression and\nrarefaction regions will appear as a series of peaks in the anisotropy\npower spectrum on the angular scales smaller than the angle subtended by\nthe sound horizon at the decoupling. The odd and the even peaks\ncorrespond to photons coming from regions that are respectively in\ncompression and expansion phases at last scattering. However the\ncompression and rarefaction phases are not completely equivalent. In\nfact the baryons increase the effective mass of the barotropic fluid and\nconsequently the gravitational infall generated by the density\nfluctuations leads to a deeper trough during the compression phase (\nbaryon drag ). The compression is enhanced over rarefaction resulting in\na larger amplitude of the odd peaks relative to the even ones. Therefore\nthe relative heights of the acoustic peaks is extremely sensitive to the\nbaryon density @xmath . An additional source of anisotropies is due to\nthe motion of the fluid at the last scattering surface due to the\nDoppler shift of the CMB photons. However due to the large value of\n@xmath this effect is subdominant.\n\n##### Sachs-Wolfe effect\n\nIn the large wavelength limit ( @xmath ) the Boltzmann equation Eq.\u00a0( 99\n) reduces to the form @xmath ( @xmath ). The solution of this equation\ndepends on the initial condition of the solution of the linear density\nperturbation equations. In fact @xmath and for adiabatic initial\nconditions @xmath , reflecting the fact that the photons are\noverdensities inside the potential well. However due to the decay of the\ngravitational potential after matter-radiation equality the photon\ntemperature at decoupling becomes @xmath , where @xmath is the conformal\ntime at decouplings. When the photons last scatter they climb out of the\npotential well @xmath so that the effective superhorizon perturbations\nin the photon temperature is:\n\n  -- -------- -- -------\n     @xmath      (109)\n  -- -------- -- -------\n\nThis is the so called Sachs-Wolfe effect [ 168 ] . It is the dominant\nsource of anisotropies on large angular scales and is responsible for\nthe plateau at the low multipoles in the CMB power spectrum. Since these\nscales are superhorizon at the time of decoupling the amplitude of this\nSachs-Wolfe depends on the primordial spectrum of the density\nfluctuations.\n\n##### The Integrated Sachs-Wolfe effect\n\nThe time evolution of the gravitational potentials is a source of\nprimary anisotropies, in fact as the photons free stream after\ndecoupling the solution to the Boltzmann equation is given by [ 169 ] :\n\n  -- -------- -- -------\n     @xmath      (110)\n  -- -------- -- -------\n\nwhere @xmath are the Bessel functions. The first term represents the\ncontribution of the Sachs-Wolfe effect, while the second term is the\nIntegrated Sachs-Wolfe effect (ISW) [ 170 ] . We can distinguish two\ncontributions to the ISW: an early and a late ISW. The former is due to\nthe decays of the gravitational potentials after horizon crossing at the\nend of the radiation dominated era. The latter occurs in dark energy\ndominated cosmologies, as the Universe starts accelerating the rapid\nexpansion causes the decay of the density fluctuations that drive the\ndecay of the gravitational potentials. The combined effect of the SW and\nthe two components of the ISW can be studied by analysing the the\nanisotropy power spectrum per logarithmic @xmath and @xmath interval\ndefined by\n\n  -- -------- -- -------\n     @xmath      (111)\n  -- -------- -- -------\n\nIn figure 25 we show the density plots of Eq.\u00a0( 111 ) integrated up to\n@xmath ( left panel ) and to @xmath ( right panel ) for a @xmath CDM\nwith @xmath . The brighter regions correspond to values of the\nwavenumbers and multipoles where there is more power. Since for the\nmodel we have considered the acceleration starts at redshift @xmath ,\nthe contribution of the late ISW can be emphasized by comparing the\ndistribution of power in the left panel with that in the right panel. As\nwe expect, we note that due to the projection onto the last scattering\nsurface the wavenumbers @xmath and the multipoles @xmath are strongly\ncorrelated. As a consequence of this the power at redshift @xmath is\nshifted toward lower multipoles than at @xmath . This is simply because\nthe last scattering surface is closer to the observer at redshift @xmath\nand different scales are projected on larger angles. The filamentary and\nperiodic structure of the density plots are due to the Bessel functions.\nWe therefore expect a different structure in the case of an open or\nclosed space-time. Note that the power is distributed along an upper and\na lower ridge respectively. The latter is the contribution of the\nSachs-Wolfe effect caused by modes that are superhorizon at decoupling (\n@xmath ) while the upper ridge is produced by the early ISW. Since this\nlatter effect arises closer to the present time, the corresponding\nanisotropies are projected on angular scales larger than the SW effect\nitself. The bright spot at the top of the panels correspond to the rise\nof the first Doppler peak, the other peaks do not appear in these plots\nsince we limited our analysis to scales larger than the horizon at\ndecoupling ( @xmath ). As we can see in the right panel, integrating the\nmodes over the period of time when the Universe started to accelerate\nboosts the power at lower multipoles. In fact the signature of the late\nISW can be noticed from the fact that the upper ridge becomes brighter\nthan that in the right panel. Note that the two plots have slightly\ndifferent brightness scales, this is because the late ISW overlaps with\nthe SW leading to a different distribution of the power on the large\nangular scales.\n\n##### Damping mechanisms\n\nThe overall amplitude of the CMB power spectrum is suppressed by the\neffects of diffusive mechanisms. The most important of these effects is\ndue to the diffusion of the photons on scales smaller than their mean\nfree path @xmath . In fact due to the Compton scattering the photons\nrandomly walk through the baryons with a mean free path @xmath . After\n@xmath collisions the diffusive length is @xmath . Consequently on\nscales @xmath the diffusion exponentially suppresses the amplitude of\nanisotropies. The baryons suffer a similar effect, in fact from Eq.\u00a0( 97\n) we can see that on scales @xmath the Compton scattering can drag the\nbaryons in and out of the potential wells leading to a destruction of\nthe baryonic oscillations ( Silk damping [ 171 ] ). Another damping\neffect arises from the fact that he last scattering process is not\ninstantaneous. The photons we observe today in a given direction of the\nsky may have decoupled from different points along the line of sight.\nTherefore fluctuations on scales smaller then the thickness of the last\nscattering surface have destructively interfered causing a \u2018washing out\u2019\nof the anisotropies on very small angular scales. The reionization\nhistory of the Universe also contributes to the overall damping of the\ntemperature anisotropy power spectrum. In fact when the first stars form\nthey reionize the intergalactic medium, therefore a fraction of the CMB\nphotons are scattered on scales smaller then size of the horizon at the\nepoch of reionization. This lead to a suppression of the power at large\nmultipoles. In light of the recent WMAP measurements of the\ntemperature-polarization cross power spectrum, it is worth mentioning\nthat the reionization sources the polarization of the anisotropies.\nConsequently a late reionization, @xmath , will produce significant\npower at low multipoles in the temperature-polarization spectrum.\n\n### 22 Dark energy and the Integrated Sachs-Wolfe effect\n\nWe have previously discussed the importance of distinguishing between\ndifferent dark energy models from the \u201cconcordance\u201d @xmath CDM model.\nThe ISW is particularly sensitive to the late time evolution of the\nUniverse. In fact during the matter dominated era the gravitational\npotential @xmath associated with the density perturbations is constant\nand there is no ISW effect. However, we have seen that in @xmath CDM\nmodels @xmath starts decaying at redshifts when @xmath starts to\ndominate, producing large angular scale anisotropies [ 172 ] . In dark\nenergy scenarios the cosmic acceleration is not the only contribution to\nthe decay of @xmath : on large scales the clustering properties alter\nthe growth rate of matter perturbations [ 76 , 173 ] . It is the signal\nof this clustering [ 174 ] that we are hunting in as model-independent a\nway as possible. We assume a flat spatial geometry and fix the value of\nthe Hubble constant @xmath Km @xmath @xmath , and the amount of matter\n(CDM) @xmath . We can usefully distinguish two classes of models,\n\n-   those with a slowly varying equation of state for which @xmath , as\n    in the case of the inverse power law potential [ 79 ] ;\n\n-   a rapidly varying @xmath , such as the \u2019Albrecht-Skordis\u2018 model [\n    118 ] and the two exponential potential [ 100 ] , with @xmath . This\n    class also includes many interesting radical models such as vacuum\n    metamorphosis [ 175 ] , late-time phase transitions [ 176 ] , and\n    backreaction-induced acceleration [ 177 ] .\n\nWe show these two classes in figure 26 . The red solid line corresponds\nto dark energy that tracks the dust during the matter era ( @xmath ) and\nevolves slowly toward @xmath , and the blue dotted line corresponds to a\nmodel with a rapid transition in its equation of state at @xmath (\n@xmath ). Given current data it is worth studying the case with @xmath ,\n(since it is also the most difficult to distinguish from @xmath CDM)\nwhilst allowing the other parameters @xmath and @xmath , to vary. We\nhave modified the CMBFAST code [ 178 ] in order to include the effects\nof a dark energy fluid and its perturbations by specifying the time\nevolution of the equation of state.\n\nFigure 27 shows the anisotropy power spectrum, @xmath , produced through\nthe integrated Sachs-Wolfe effect by a rapidly evolving ( @xmath @xmath\n) and a slowly evolving ( @xmath @xmath ) equation of state; the red\n(solid) line corresponds to the @xmath CDM model. As we can see in the\ntop left panel (figure 27 a), varying @xmath can produce a strong ISW.\nThe effect is larger if the transition in the equation of state occurs\nat redshifts @xmath . On the other hand the @xmath is the same as in the\ncosmological constant regime if @xmath ( @xmath ). In the top right\npanel (figure 27 b) we plot the ISW for two different values of @xmath ,\ncorresponding to @xmath (dashed line) and @xmath (dot-dash line). We\nnote that the signal is larger if the quintessence field is perfectly\ntracking the background component. But as @xmath diverges from the dust\nvalue the ISW effect approaches that of @xmath CDM. This means that even\nfor rapidly varying @xmath (small @xmath ), the ISW is distinguishable\nfrom that in the @xmath CDM scenario only if @xmath during matter\ndomination closely mimics the dust value and the transition occurs at\nlow redshifts, @xmath .\n\nWe can see that the amplitude of the integrated Sachs-Wolfe effect is\nsmaller in slowly varying models ( @xmath @xmath ). As we expect the\n@xmath is independent of @xmath (figure 27 c), since for these models a\ndifferent value in the transition redshift does not produce a large\neffect on the evolution of the dark energy density. In figure 27 d, the\nISW power spectrum is large for @xmath (dash line) and becomes smaller\nthan the cosmological constant on horizons scales as @xmath has negative\nvalues (dot-dashed line), and increases toward @xmath for @xmath\napproaching @xmath . This class of models is then more difficult to\ndistinguish from the @xmath CDM if the equation of state today is close\nto @xmath . This can be qualitatively explained noting that perfect\ntracking between dark energy and CDM causes a delay in the time when the\ngravitational potential starts to decay, compared to the case of @xmath\nCDM. This effect is stronger for models with a rapidly varying equation\nof state since the rapid change in @xmath produces a stronger variation\nin the gravitational potential.\n\n### 23 Differentiating dark energy models with CMB measurements\n\nThe information in the CMB power spectrum can be encoded in the position\nof the first three Doppler peaks, @xmath , @xmath and @xmath and in\nthree parameters, @xmath , @xmath and @xmath that account for the\namplitude [ 179 ] . These are the height of the first peak relative to\nthe power at @xmath ,\n\n  -- -------- -- -------\n     @xmath      (112)\n  -- -------- -- -------\n\nthe height of the second peak relative to the first,\n\n  -- -------- -- -------\n     @xmath      (113)\n  -- -------- -- -------\n\nand the height of the third peak relative to the first,\n\n  -- -------- -- -------\n     @xmath      (114)\n  -- -------- -- -------\n\nIn principle the position of the second and third peaks is not necessary\nto characterize the CMB power spectrum, since their value is set by the\nposition of the first peak through the harmonic relation Eq.\u00a0( 55 ).\nHowever, as we have previously discussed in Chapter \\thechapter this\nrelation is affected by pre-recombination effects and therefore the\nvalue of @xmath and @xmath carry information about a combination of the\ncosmological parameters. Since @xmath , @xmath and @xmath quantify the\namplitude of the power spectrum on different multipoles we expect they\nare sensitive in different ways to the cosmological parameters. For\ninstance since @xmath depends on the ratio between @xmath and @xmath it\nmainly depends on the scalar spectral index @xmath , the physical baryon\ndensity @xmath due to the baryon drag that changes @xmath , @xmath\nthrough the ISW and the reionization since increasing @xmath will lower\nthe first peak. On the other hand @xmath is sensitive only to @xmath and\n@xmath . Since the baryons affect in the same way the height of the\nthird and first peak, @xmath depends only on the matter density @xmath\nand @xmath . This implies that if the amplitude of the first three peaks\nis accurately determined the degeneracy between @xmath and @xmath can be\nbroken and their value can be measured with high precision. We use\n@xmath , @xmath and @xmath to determine the overall effect of the dark\nenergy in the CMB spectrum. In particular we expect @xmath to be\nextremely sensitive to a quintessential effect through the ISW, while\n@xmath and @xmath are weak indicators of such a signal. We have computed\nthe CMB spectra for the class of models with @xmath described in the\nprevious section and we have inferred the values of @xmath and compared\nthem with those of the @xmath CDM model for the same values of the\ncosmological parameters.\n\nIn figure 28 we plot the absolute value of the relative difference of\n@xmath , @xmath and @xmath to the @xmath CDM model. The rapidly varying\nmodels are shown in the top panels. We can see the strong ISW effects\nproduced by changing @xmath are now evident in the large discrepancy\nbetween @xmath and @xmath (blue line) (figure 28 a): it can be larger\nthen 20 per cent for @xmath . The effect on @xmath and @xmath is\nsmaller. However varying @xmath (figure 28 b) produces a discrepancy of\nonly order @xmath per cent on @xmath , while @xmath and @xmath remain\nthe same as in @xmath CDM. For a slowly varying equation of state,\n@xmath , @xmath and @xmath are independent of @xmath (figure 28 c). The\ndark energy imprint is only on @xmath for which the discrepancy to the\n@xmath case is about 10 per cent. This discrepancy decreases when\nchanging the value of the quintessence equation of state during matter\nfrom @xmath to @xmath (figure 28 d). Values of the equation of state\ntoday @xmath imply a stronger ISW effect. Consequently the curves of\nfig.3 are shifted upwards. For instance in figure 29 we plot the class\nof models previously analysed, with @xmath . We note the same behavior\nas we vary the dark energy parameters, but the discrepancy with the\n@xmath CDM model is now larger. In figure 29 d it is worth noticing the\ncase @xmath , that corresponds to a model very similar to a \u2018k-essence\u2019\nmodel [ 157 ] . We can see that the relative difference with the @xmath\nCDM case is of the order of a few percent, in agreement with [ 180 ] for\nthe same value of @xmath . At this point we ask the key question whether\nsuch differences are observable. We have shown that @xmath is a good\nestimator of the ISW effect, and that it is a tracer of the dark energy\nimprint on the CMB. However its estimation from the data will be\naffected by cosmic variance at @xmath . Hence with even perfect\nmeasurements of the first acoustic peak the uncertainty on @xmath will\nbe dominated by the @xmath per cent uncertainty due to cosmic variance.\nWith the plots of figures 28 - 29 in mind, this means that if the\npresent value of the equation of state is close to @xmath , slowly\nvarying dark energy models are hardly distinguishable from @xmath CDM,\nwhile rapidly varying ones can produce a detectable signature only if\nthe transition in the equation occurred at @xmath , but in any case it\nwill be difficult to constrain @xmath . Moreover it should be taken into\naccount that @xmath is degenerate with other cosmological parameters,\nsuch as the scalar spectral index @xmath , the optical depth @xmath and\nthe scalar to tensor ratio @xmath . Hence only an accurate determination\nof the angular diameter distance, inferred from the location of the\nacoustic peaks, would allow detection of such deviations from the\ncosmological constant model.\n\nThe shift of the multipole positions ( @xmath ) of the acoustic peaks\ncaused by the evolution of the dark energy in the class of models\nanalysed in figure 27 can be seen in figure 30 , where we plot the\nrelative difference of @xmath and @xmath to the @xmath case. We note\nthat due to the additional shift induced on the first acoustic peak by\nthe ISW effect the difference with the @xmath CDM model for the first\npeak is generally larger than for the second and third peaks. As with\nthe comparison of the amplitude of the CMB spectrum, the largest effect\nis produced by models with a rapid transition occurring at small\nredshifts. However the degeneracy of the angular diameter distance, in\nparticular with the value of Hubble constant and the amount of dark\nenergy density, will limit our ability to put tight constraints on the\ndark energy parameters. There are alternative ways in which these\nproblems can be alleviated, for instance cross-correlating the ISW\neffect with the large scale structure of the local universe [ 181 , 182\n, 183 ] . An efficient approach would be to combine different\nobservations in order to break the degeneracies with the cosmological\nparameters [ 184 , 185 ] .\n\n### 24 Testing dark energy with ideal CMB experiments\n\nThe new generation of CMB satellite experiments is going to provide an\nestimation of the anisotropy power spectrum close to the ideal case,\nwhere the only source of indetermination is due to the cosmic variance.\nIt is therefore interesting to test the sensitivity of such CMB\nmeasurements to the dark energy effects. As we have described in the\nprevious section, the class of models most difficult to distinguish from\nthe @xmath CDM case corresponds to a dark energy fluid with a slowly\nvarying equation of state characterized by @xmath . This can be\nconsidered as the most pessimistic situation since it can prevent us\nfrom understanding the nature of the dark energy. We have studied the\ninformation on this class of models that can be inferred from cosmic\nvariance limited measurements [ 162 ] and generated a sample of ideal\nCMB power spectrum data assuming a fiducial model specified by the\nfollowing values of the cosmological parameters: @xmath , @xmath Km\n@xmath @xmath , @xmath , @xmath , @xmath , @xmath . Assuming a flat\ngeometry, no tensor contribution, the scalar spectral index @xmath and\nthe baryon density @xmath , we have binned the input power spectrum in\n@xmath data points plotted in figure 31 . A library of CMB spectra has\nthen been generated using a modified version of CMBFAST [ 178 ] assuming\nthe following uniform priors: @xmath , @xmath , @xmath , @xmath and\n@xmath . As extra priors we have assumed @xmath (slowly varying equation\nof state) and the remaining parameters have been set as follows: @xmath\n, @xmath and @xmath . Since we are not considering the effect of\nsystematics, but only cosmic variance errors we evaluate a simple\nlikelihood defined as\n\n  -- -------- -- -------\n     @xmath      (115)\n  -- -------- -- -------\n\nwhere @xmath are the likelihood parameters, @xmath is a normalization\nconstant and @xmath is the cosmic variance at @xmath . The superscripts\n@xmath and @xmath refer to the theoretical quantity and to the real data\nrespectively.\n\nThe results are shown in figure 32 , where we plot the two dimensional\nlikelihood contours in the @xmath (left panels) and @xmath (right\npanels) planes respectively. We find @xmath , @xmath , whereas assuming\na prior on @xmath improves the constraints on @xmath to @xmath at @xmath\n. The likelihood plot in the @xmath plane shows that @xmath is\nundetermined. This result is expected since for this class of models the\nvalue of @xmath does not affect the evolution of the dark energy. On the\ncontrary we find @xmath , but the @xmath case cannot be excluded at\n@xmath . The constraint does not improve assuming the @xmath prior. This\nis because @xmath and @xmath are degenerate, hence marginalizing the\nlikelihood over @xmath shifts the best fit value of @xmath towards more\nnegative values. However it is remarkable that there is still some\nsensitivity to the value of @xmath , such that the best fit is not for\n@xmath . Therefore we can conclude that if @xmath , a large class of\nmodels will not be distinguished from a @xmath CDM scenario even with\nideal CMB measurements. It is possible that by combining different\ncosmological data, as Sn Ia, large scale structure and quasar clustering\nthe degeneracy between @xmath and @xmath can be broken and more\ninformation on this class of dark energy models can be inferred [ 185 ]\n.\n\n## Chapter \\thechapter Alternative cosmological test with higher order\nstatistics\n\nIn the recent past the number of papers devoted to the analysis of high\norder statistics of the CMB anisotropy has dramatically increased. In\nfact the simplest inflationary models predict to first order a Gaussian\ndistribution of temperature fluctuations, and deviations from\ngaussianity could be the signature of other phenomena occurring in the\nanisotropy formation process. On top of that different mechanisms can\nalso be a source of non-Gaussian signals at different angular scales.\nThis is the case of non-linear effects during the inflationary epoch or\nthe presence of topological defects. The present CMB data strongly\nconstrains the level of non-gaussianity on the scales so far probed by\nthe experiments. In this Chapter we will briefly review the higher order\nstatistics of the CMB anisotropies. We will focus on the use of the\nangular bispectrum as an estimator of non-gaussianity, and introduce a\nformalism that allows us to analytically calculate the spectrum and\nbispectrum in the case of a random distribution of localized\nanisotropies in the CMB sky. We will argue that applying this analytical\napproach to the analysis of localized anisotropies such as the\nSunyaev-Zeldovich effect or radio point sources, it is possible to\nconstrain the clustering properties of these objects and determine the\ncosmological parameters.\n\n### 25 Higher order statistics\n\nLet us expand the temperature fluctuation field in the direction @xmath\nof the sky into spherical harmonics:\n\n  -- -------- -- -------\n     @xmath      (116)\n  -- -------- -- -------\n\nthe @xmath are the multipole coefficients that contain all the\nstatistical information of the anisotropy field. For @xmath these are\ncomplex numbers satisfying the condition @xmath . The statistics of the\nCMB anisotropies depends on the physical process responsible for the\ngeneration of the initial density perturbations. Simple inflationary\nmodels predicts a Gaussian spectrum of fluctuations [ 186 , 187 ] ,\nconsequently we expect the anisotropy field to be Gaussian. In such a\ncase the @xmath are random Gaussian variables with Gaussian distributed\namplitudes and with uniformly distributed phases. As consequence of this\nthe statistical distribution of the CMB anisotropies is entirely\nspecified by its second order moment ( i.e. the power spectrum),\n\n  -- -------- -- -------\n     @xmath      (117)\n  -- -------- -- -------\n\nIn this Gaussian case the higher odd moments of the distribution vanish,\nwhile the even moments can be expressed in term of the variance @xmath .\nTherefore any deviation from gaussianity will inevitably produce non\nvanishing high order statistics. Since there is a potentially infinite\nnumber of higher moments, the non-Gaussian hypothesis cannot be\ndisproved. Several methods have been proposed in the literature to\nmeasure statistical estimators of the skewness (third moment) and\n(kurtosis) from the analysis of CMB maps (for a list of these methods we\nrefer to [ 188 ] ). A simple method is to measure the correlation\nbetween the temperature fluctuations in different directions of the sky.\nIn this case the higher order moments are estimated by the angular\ncorrelation functions. For instance the @xmath angular correlation\nfunction is defined as:\n\n  -- -- -- -------\n           (118)\n  -- -- -- -------\n\nwhere @xmath are unitary vectors pointing at @xmath directions of the\nsky and the average @xmath is taken over the whole sky. In particular an\nestimate of the skewness is provided by the collapsed three-point\ncorrelation functions @xmath , that is a specific configuration of the\nthree-point correlation function between two points of the sky separated\nby an angle @xmath and defined as:\n\n  -- -------- -- -------\n     @xmath      (119)\n  -- -------- -- -------\n\nwhere @xmath . In terms of the multipoles it reads as:\n\n  -- -------- -- -------\n     @xmath      (120)\n  -- -------- -- -------\n\nwhere @xmath is the Legendre polynomial of degree @xmath , @xmath is the\nexperimental window function in the multipole space and\n\n  -- -------- -- -------\n     @xmath      (121)\n  -- -------- -- -------\n\nare a combination of the Wigner-3J symbols. The @xmath measured from the\nCOBE-DMR sky maps has been found to be consistent with the Gaussian\nhypothesis within the cosmic variance errors [ 188 ] . These results\nstrongly limit the allowed amount of non-gaussianity in the CMB\nanisotropies at large angular scales, in particular they constrain the\nparameter space of a class of non-Gaussian models [ 189 , 190 , 191 ,\n192 ] . Similarly the collapsed three-point correlation function\ninferred from the WMAP data is also consistent with Gaussian\nexpectations [ 193 ] . Any non-gaussian analysis can be carried out in\nthe multipole space as well, in this case the equivalent of the\nthree-point correlation function is the angular bispectrum defined by:\n\n  -- -------- -- -------\n     @xmath      (122)\n  -- -------- -- -------\n\nThis estimator is rotationally invariant [ 194 , 195 ] and satisfies\ngeometrical conditions such that the only non vanishing @xmath are those\nwith @xmath ( @xmath ) for all permutations of indices and @xmath . A\nnormalized version of the angular bispectrum has been applied to the\nanalysis of COBE-DMR maps for the configuration @xmath [ 196 , 197 , 199\n, 198 ] . More recently the bispectrum has been estimated from the WMAP\nmap and has been found to be consistent with the Gaussian hypothesis [\n200 ] .\n\n### 26 Frequentist approach and estimation of higher moments\n\nThe frequentist approach is the usual procedure adopted to test\ngaussianity. This implies the measured value of a higher order\nstatistical estimator is compared against the probability distribution\nfunction obtained from random Gaussian simulations of the data sample.\nIf there is a low probability that the measured value is consistent with\nthe Gaussian simulation, then the Gaussian hypothesis is ruled out. For\ninstance this approach allowed the authors of [ 196 ] to rule out the\ngaussianity of the anisotropies at multipole @xmath in the COBE-DMR\ndata. However it is worth mentioning that so far only the diagonal\ncomponent of the bispectrum has been measured and in order to be\nstatistically significant the data analysis should be extended to the\nestimation of the non-diagonal term of the bispectrum. If this is not a\nproblem at low multipoles it could be a computationaly challenge at\nhigher orders. On the other hand it has been pointed out in a number of\npapers [ 199 , 201 ] that within the frequentist approach some\nnon-Gaussian theories will be indistinguishable from the Gaussian one.\nWe will try to make this point more clear with a specific example and we\nrefer to the fundamental statistics textbook [ 202 ] for a more detailed\nderivation of the formula used in what follows.\n\nLet us consider a sample of data @xmath ( @xmath ) generated from a\nrandom Gaussian process @xmath such that each @xmath is an independent\nGaussian random variable with zero mean @xmath and the second order\nmoment @xmath ,\n\n  -- -------- -- -------\n     @xmath      (123)\n  -- -------- -- -------\n\nIn order to avoid confusion we will use Greek letters for the moments of\nthe generating function @xmath , @xmath its @xmath -th moment and Roman\nletters for the moments obtained from the statistics of the data sample.\nIn particular the @xmath -th moment @xmath is given by:\n\n  -- -------- -- -------\n     @xmath      (124)\n  -- -------- -- -------\n\nwhere @xmath is the mean value of the sample. Making @xmath realizations\nof this data sample, @xmath ( @xmath ), we can infer the distribution\nfunction @xmath of the @xmath moment statistic @xmath , which is the\nfrequency (number of times to the total number of realizations) of a\ncertain value @xmath appearing in the sample @xmath . The expectation\nvalue of this distribution @xmath (the mean value of @xmath estimated\nfrom the K realizations) will be indicative of the @xmath -th moment\n@xmath of the generating Gaussian distribution function. The expectation\nvalue @xmath and the variance @xmath can be related to the moments\n@xmath of the generating function through approximate relations valid up\nto @xmath [ 202 ] . It can be shown that:\n\n  -- -------- -- -------\n     @xmath      (125)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (126)\n  -- -------- -- -------\n\nFor practical purposes we prefer to work in terms of cumulants @xmath ,\nthat are an equivalent set of numbers characterizing the generating\nfunction @xmath . The cumulants @xmath and the moments @xmath are\nrelated through Eq.\u00a0(3.33) in [ 202 ] . Let us consider the third order\nmoment-statistic @xmath , from Eq.\u00a0( 125 ) and Eq.\u00a0( 126 ) and using the\nrelation between moments and cumulants we have:\n\n  -- -------- -- -------\n     @xmath      (127)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (128)\n  -- -------- -- -------\n\nFor the Gaussian generating function we have considered @xmath , @xmath\n, @xmath and @xmath , consequently we obtain:\n\n  -- -------- -- -------\n     @xmath      (129)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (130)\n  -- -------- -- -------\n\nOn the other hand let us consider a sample of data generated from a\nnon-Gaussian random process. A general non-Gaussian random generating\nfunction can be constructed by using an Edgeworth expansion around the\nGaussian distribution defined by\n\n  -- -------- -- -------\n     @xmath      (131)\n  -- -------- -- -------\n\nwhere @xmath is given by Eq.\u00a0( 123 ), the @xmath are the Hermite\npolynomials and the cumulants @xmath are free parameters. It can be\nshown that Eq.\u00a0( 131 ) gives a good approximation to any distribution\nfunction provided all moments are defined and the higher order terms do\nnot dominate over the Gaussian one. We can limit the non-gaussianity to\nfirst order by imposing only the presence of a non vanishing skewness\n@xmath and kurtosis @xmath . In this case Eq.\u00a0( 125 ) and Eq.\u00a0( 126 )\nbecomes:\n\n  -- -------- -- -------\n     @xmath      (132)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (133)\n  -- -------- -- -------\n\nNote from Eq.\u00a0( 133 ) the kurtosis and the skewness can sum up in such a\nway that they cancel each other. In such a case the frequency\ndistributions of the third order moment-statistic @xmath inferred from\nthe @xmath realizations of the Gaussian and non-Gaussian process, @xmath\nand @xmath respectively, will have the same variance. This makes\ndifficult to establish whether the population of the data had been\ngenerated from a Gaussian or a non-Gaussian process by estimating @xmath\n.\n\nThis analysis is confirmed by the numerical simulations in which we\nsimulated two populations of data from two different random processes.\nThe Gaussian sample has been generated assuming the generating function\nEq.\u00a0( 123 ) with @xmath , @xmath , while the non-Gaussian population has\nbeen obtained assuming Eq.\u00a0( 131 ) with @xmath , @xmath , @xmath and\n@xmath . From these two populations we inferred the distribution\nfunctions of the third moment-statistic @xmath . The results are shown\nin figure 33 , where we plot @xmath ( red bars ) and @xmath ( blue bars\n). Note that @xmath is peaked at @xmath , while @xmath has a maximum at\n@xmath . Even so the variances of the two distributions are the same.\nThis naive argument shows that for some non-Gaussian models little\ninformation can be obtained using a frequentist approach when analysing\nthe third order statistics unless higher order moments of the CMB\nanisotropies fields are measured as well. Such simulations are necessary\nto take into account the systematic experimental sources of\nnon-gaussianity. However they make these tests computationally\nexpensive. Therefore it is important to have a theoretical prediction of\nthe amplitude of non-Gaussianity at least for known non-Gaussian\nanisotropies such as the secondary ones.\n\n### 27 Modelling localized non-Gaussian anisotropies\n\nLocalized patterns of anisotropies produce a non-Gaussian signature in\nthe CMB statistics. This is the case of secondary sources of\nanisotropies such as radio point sources or the Sunyaev-Zeldovich (SZ)\neffect caused by the interaction of the CMB photons with the hot gas\nassociated with clusters of galaxies [ 203 ] . Active sources of\nnon-Gaussianity include topological defects such as cosmic strings,\ndomain walls (see for a general review [ 204 ] ) or primordial bubble\nrelics of a first order phase transition during the inflationary era [\n205 , 206 ] . For these classes of models analytical formula of the\nhigher order correlation functions have been calculated in a number of\npapers [ 208 , 191 , 192 ] . As far as the non-Gaussianity arising from\nsecondary source of anisotropies is concerned, an analytical estimate of\nthe three point correlation function has been obtained in the case of\nthe Rees-Sciama effect [ 207 ] , while the value of the bispectrum\nproduced by the S-Z effect and extragalactic radio sources has been\nobtained in [ 209 ] , whilst the case of the Vishniac effect has been\nconsidered in [ 210 ] . In what follows we determine the spectrum and\nthe bispectrum for the case of a distribution of localized anisotropies\nin the CMB sky, using a formalism introduced in [ 208 ] .\n\n##### Power Spectrum\n\nLet us consider a nearly circular spot on the sky and perform the\nspherical harmonic decomposition in the frame where the @xmath -axis\ncoincides with the center of the spot. The brightness of the temperature\nfluctuation of the spot is @xmath , and @xmath is its angular profile.\nIn this frame, we can write the temperature fluctuation as @xmath ,\nexpanding it in spherical harmonics we find [ 208 ] :\n\n  -- -------- -- -------\n     @xmath      (134)\n  -- -------- -- -------\n\nwith\n\n  -- -------- -- -------\n     @xmath      (135)\n  -- -------- -- -------\n\nwhere @xmath is the Legendre polynomial and @xmath is a perturbation\ninduced by the irregularity of the spot. As a first approximation it can\nbe neglected, as the CMB measurements do not have the enough resolution\nto resolve its @xmath -angular structure. For a distribution of @xmath\nspots, performing a rotation to a general frame where the @xmath -th\nspot is at the angle @xmath and summing over all the spots we obtain:\n\n  -- -------- -- -------\n     @xmath      (136)\n  -- -------- -- -------\n\nwhere @xmath is the brightness of the @xmath -th spot and\n\n  -- -------- -- -------\n     @xmath      (137)\n  -- -------- -- -------\n\nis the Legendre transform of its temperature profile. We can now\ncalculate the power spectrum,\n\n  -- -------- -------- -------- -------- -------\n     @xmath   @xmath   @xmath            (138)\n                       @xmath   @xmath   \n                       @xmath   @xmath   \n  -- -------- -------- -------- -------- -------\n\nwhere we have used the completeness relation of the spherical harmonics\nand @xmath , with @xmath taking into account the possibility that the\nspots are uncorrelated ( @xmath ), as for a Poisson distribution, or\nthat are correlated two by two ( @xmath ). Therefore by expanding the\nsums we finally obtain:\n\n  -- -------- -- -------\n     @xmath      (139)\n  -- -------- -- -------\n\nWe assume now that the spots have about the same brightness and the same\ntemperature profile: @xmath and @xmath where the average is taken over\nthe ensemble of spots. Because the number of spots in a circular ring\ncentered on a single spot is proportional to the angular extension of\nthe ring we can substitute the sums over the number of spots with an\nintegral over the whole sky. Hence we can substitute the discrete\ncorrelation coefficient @xmath with the two-point angular correlation of\nthe spots, @xmath . If the spots correspond to radio sources or clusters\nof galaxies @xmath would be the angular correlation function estimated\nfrom large scale structure observations. The mean value over the spot\ndistribution of Eq.\u00a0( 139 ) becomes:\n\n  -- -------- -- -------\n     @xmath      (140)\n  -- -------- -- -------\n\nwhere @xmath is a normalization constant and\n\n  -- -------- -- -------\n     @xmath      (141)\n  -- -------- -- -------\n\nwith\n\n  -- -------- -- -------\n     @xmath      (142)\n  -- -------- -- -------\n\nFrom Eq.\u00a0( 140 ) we may note that the contribution to the anisotropy\npower spectrum from a localized distribution of spots increases with the\nbrightness @xmath . If the spots are uncorrelated the second term @xmath\ndrops from the equation and the only contribution is due to the\nprojection of the spot\u2019s signal in the multipole space @xmath . In\nparticular the largest contribution will occur in the range of\nmultipoles that correspond to the effective angular size of the spots.\nIf the spots are correlated, the overall contribution to the power\nspectrum will depend on the sign of @xmath .\n\n##### Bispectrum\n\nFollowing the same procedure as just described we calculate the angular\nbispectrum. Substituting Eq.\u00a0( 136 ) in Eq.\u00a0( 122 ) we have:\n\n  -- -------- -------- -------- -------- -------\n     @xmath   @xmath   @xmath            (143)\n                       @xmath   @xmath   \n                                @xmath   \n  -- -------- -------- -------- -------- -------\n\nwhere @xmath takes into account all the possible correlations between\nthe spots up to third order,\n\n  -- -------- -- -------\n     @xmath      (144)\n  -- -------- -- -------\n\nwith @xmath the correlation between three different spots. Using the\ndefinition of the Wigner 3J symbols in terms of an angular integral of\nthree spherical harmonics and the completeness relation of the spherical\nharmonics Eq.\u00a0( 143 ) becomes:\n\n  -- -------- -------- -------- -- -------\n     @xmath   @xmath               (145)\n                       @xmath      \n  -- -------- -------- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (146)\n     @xmath      (147)\n     @xmath      (148)\n     @xmath      (149)\n  -- -------- -- -------\n\nDue to the background isotropy of the space, we are free to choose\n@xmath . As consequence the integrals Eq.\u00a0( 147 - 149 ) become:\n\n  -- -------- -------- -------- -- -------\n     @xmath   @xmath   @xmath      (150)\n     @xmath   @xmath   @xmath      (151)\n     @xmath   @xmath   @xmath      (152)\n  -- -------- -------- -------- -- -------\n\nAs for the power spectrum, we can average over the ensemble of all the\nspots and substitute the sums over the spots with integrals over the\nwhole sky. In this case the discrete correlation coefficient @xmath and\n@xmath are replaced with the corresponding angular correlation function\n@xmath and @xmath . After tedious calculations we obtain:\n\n  -- -------- -- -------\n     @xmath      (153)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -- -------\n     @xmath      (154)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (155)\n  -- -------- -- -------\n\n  -- -------- -- -------\n     @xmath      (156)\n  -- -------- -- -------\n\nwith @xmath and @xmath defined by Eq.\u00a0( 137 ) and Eq.\u00a0( 141 )\nrespectively and @xmath defined by Eq.\u00a0( 142 ). As we can see from Eq.\u00a0(\n153 ) for a Poisson distribution @xmath and @xmath vanish, but the\nbispectrum remains non-vanishing due to the term @xmath that account for\nthe localized structure of the anisotropies.\n\n### 28 Discussion\n\nIn the previous section we presented a general formalism to calculate\nthe contribution to the power spectrum and the bispectrum of a\ndistribution of spots in the CMB sky. The formulae Eq.\u00a0( 140 ) and Eq.\u00a0(\n153 ) have to be considered as a starting point for further\ninvestigation. They take into account several effects, for instance the\nbrightness and the angular size of the signals contribute at zeroth\norder to the spectrum and the bispectrum. On the other hand the presence\nof internal correlations in the spot distribution, which are described\nby the angular correlation functions @xmath and @xmath , contribute as\nfirst and second order effects respectively. As a specific application,\nEq.\u00a0( 140 ) and Eq.\u00a0( 153 ) can be computed in the case of a\ndistribution of spots caused by the SZ effect of a cluster of galaxies.\nApproximating the shape of this signal with a Gaussian profile\ncharacterized by a given width, it will be possible to numerically\ncompute the integrals Eq.\u00a0( 137 ). Moreover without loss of generality\nthe angular correlation function @xmath can be assumed to be a power\nlaw. In such a case the integrals Eq.\u00a0( 141 ) can also be numerically\ncomputed. The resulting power spectrum can be compared with the\nprediction of numerical simulations. This will allow us to test how\ncrucial is the assumption that @xmath and @xmath . The next generation\nof CMB measurements will measure the bispectrum at very high multipoles,\ntherefore using Eq.\u00a0( 153 ) in a specific case such as the SZ effect\noffers an alternative way of inferring cosmological information.\n\n## Conclusion and prospects\n\nIn this thesis we have discussed various aspects of dark energy\ndominated cosmologies. In Chapter\u00a01 we have reviewed the observational\nevidence of the dark energy. We have seen that different cosmological\nmeasurements are consistent only if the dark energy accounts for most of\nthe matter content of the Universe. In Chapter\u00a02 we have discussed some\nof the proposed dark energy candidates and we have focused on the\nquintessence scenario. In spite of the theoretical difficulties of a\nviable quintessence model building, this scenario has a number of\ninteresting features that can be tested with cosmological measurements.\nIn particular in Chapter\u00a03 we reviewed the dynamics of scalar field\nperturbations for two different class of minimally coupled quintessence\nmodels. We have learnt that quintessence perturbations have no active\nrole during the structure formation. However their presence can lead to\ntime integrated effects in the evolution of the gravitational potential.\nTherefore they can leave a characteristic imprint in the Cosmic\nMicrowave Background anisotropy power spectrum through the Integrated\nSachs-Wolfe effect. In Chapter\u00a04 we have constrained with Sn Ia data and\nthe position of the CMB peaks a parameterized quintessence potential\nthat accounts for a large class of quintessence models. Using the\nproperties of the tracker regime we have been able to put upper limits\non the present value of the quintessence equation of state. We have\nfound that by the present time the scalar field is evolving in flat\nregion or close to a minimum of its potential. However the results of\nthis analysis clearly indicate that the possibility the quintessence\nequation of state was largely different from its present value cannot be\nexcluded. In this direction a lot of effort has been made to detect time\nvariation of the quintessence with cosmological distance measurements.\nIn Chapter 5 we reviewed some of the proposed methods and we pointed out\na number of potential problems. In particular the use of a constant\nequation of state to parameterize the dark energy leads to misleading\nconclusions. Using a very general argument we showed that if the dark\nenergy is time varying the constraints on a constant equation of state\nwill be pushed towards large negative values. Therefore all the results\nobtained using this approach have to be carefully interpreted. In\nparticular the fact that several data analysis found the equation of\nstate best fit value to be @xmath can be just a bias effect. On the\ncontrary we have proposed a time parameterization of the dark energy\nequation of state in terms of physical parameters. This accounts for\nmost of the proposed dark energy models and moreover is valid at all the\nredshifts. Hence this approach allows us to take into account in a model\nindependent way not only the effects dark energy has had on the\nexpansion rate of the Universe but also on the structure formation. In\nChapter\u00a05 we have applied this parameterization to study the dark energy\neffects in the CMB power spectrum. As conjectured in Chapter\u00a03 we have\nfound that the dark energy leaves a characteristic imprint through the\nISW effect. The amplitude of this signature selects the class of models\nwhich are distinguishable from the cosmological constant scenario. In\nparticular we have shown that using ideal CMB data, only models\ncharacterized by a rapid transition of the equation of state can be\ndistinguished from the @xmath case. In Chapter\u00a07 we have introduced an\nalternative cosmological test using higher order statistics of the CMB\nanisotropies. We have computed the spectrum and the bispectrum for a\ndistribution of localized non-Gaussian anisotropies. These can be\napplied to specific cases such as the SZ effect to constrain\ncosmological parameters through the non-gaussianity produced by the\nimprint of cluster of galaxies. We can find a number of directions where\nthe work so far reviewed can be further extended. Under some general\nassumptions it would be interesting to test the formulae developed in\nChapter\u00a07 with the predictions of the SZ effect from numerical\nsimulations of cluster galaxies [ 211 ] . A complete likelihood analysis\nof the parameterized dark energy equation of state is currently in\nprogress. We make use of the full cosmological data so far available. We\nintend to extend this analysis to the quasar clustering, that is a good\ncandidate for testing the dark energy [ 212 ] . An interesting issue\narises from the recent WMAP data. In fact it has been found that the\nquadrupole and octupole are suppressed in contrast with the prediction\nof @xmath CDM cosmologies [ 32 ] . The possibility that this is caused\nby a cancellation mechanism between the SW and ISW effects due to\nclustering properties of the dark energy needs further investigation [\n35 ] . At moment there are no final conclusions about the nature of the\ndark energy, luckily the upcoming and future cosmological data will\nprovide a new insight of the dark energy phenomenology. It has to be\nhoped that such measurements will help us to formulate the new paradigm\nof Cosmology that will allows us to correctly address the dark energy\nproblem. The history of science shows that no scientific activity is\npossible in subjects where no paradigms have been found. Therefore we\nshould ask ourself what direction will the cosmological investigation\ntake if the dark energy problem remains unsolved.","output":["In this thesis we study some observational consequences of dark energy\ndominated cosmologies. After reviewing the main characteristics of\nquintessential models of dark energy, by using the SN Ia data and the position\nof the CMB peaks we constrain a class of parameterized scalar field potentials.\nGoing beyond constraining specific classes models, we introduce a\nparameterization of the dark energy equation of state. Such an approach allows\nus to study in a model independent way the imprint dark energy leaves in the\nCMB power spectrum. Finally we develop a formalism to model localized CMB\nanisotropies and compute analytical formulae for the power spectrum and the\nbispectrum.","Cosmological observations suggest that the Universe is undergoing an\naccelerated phase of expansion driven by an unknown form of matter\ncalled dark energy. In the minimal standard cosmological model that best\nfits the observational data the dark energy is provided by a\ncosmological constant term. However there is currently no convincing\ntheoretical explanation for the origin and the nature of such an exotic\ncomponent. In an attempt to justify the existence of the dark energy\nwithin the framework of particle physics theories, several scenarios\nhave been considered. In this thesis we present and discuss the\nphenomenological aspects of some of these dark energy models. We start\nby reviewing the cosmological measurements that give direct and indirect\nevidence for the dark energy. Then we focus on a class of theoretical\nmodels where the role of the dark energy is played by a minimally\ncoupled scalar field called quintessence. For the sake of simplicity we\nplace special emphasis on two of these models, the Inverse Power Law\ntimes an Exponential potential and the Two Exponential potential. We\nthen consider the effect of scalar field fluctuations on the structure\nformation process in these two models. By making use of the cosmological\ndistance measurements such as the supernova luminosity distance and the\nposition of the acoustic peaks in the CMB power spectrum, we constrain\nthe shape of a general parameterized quintessence potential. We find\nthat by the present time the scalar field is evolving in a very flat\nregion or close to a minimum of its potential. In such a situation we\nare still unable to distinguish between a dynamical model of dark energy\nand the cosmological constant scenario. Going beyond constraining\nspecific classes of models, we develop a model independent approach that\nallows us to determine the physical properties of the dark energy\nwithout the need to refer to a particular model. We introduce a\nparameterization of the dark energy equation of state that can account\nfor most of the proposed quintessence models and for more general cases\nas well. Then we study the imprint that dark energy leaves on the CMB\nanisotropy power spectrum. We find that dynamical models of dark energy\nproduce a distinctive signature by means of the integrated Sachs-Wolfe\neffect. However only models characterized by a rapid transition of their\nequation of state can most likely be distinguished from the cosmological\nconstant case. By using a formalism to model localized non-Gaussian CMB\nanisotropies, we compute analytical formulae for the spectrum and the\nbispectrum. The use of these formulae in specific cases such as the SZ\nsignature of clusters of galaxies provide an alternative cosmological\ntest.\n"]}
{"input":"# Chapter 1 Introduction\n\nThe study of quantum many-body phenomena is of pivotal interest in\nmodern physics. Important areas of research, such as the\ncharacterization of exotic phases of quantum matter and of quantum phase\ntransitions (Sachdev, 1999 ) , or even the possible realization (Kitaev,\n2003 ; Nayak et\u00a0al., 2008 ) of a quantum computer, rely on our\nunderstanding of collective phenomena in quantum many-body systems.\nTheoretical progress in these research areas is hindered both by a\ngeneral lack of analytical results as well as the inadequacy of\nperturbation theory in the strongly interacting regime where the\ninteresting physics often lies. As a result, development of numerical\napproaches to probe such systems has become a flourishing research\nindustry. However, numerical methods are limited by staggering\ncomputational costs.\n\nThe number of parameters required to describe a generic quantum\nmany-body wavefunction on a lattice grows exponentially with the number\nof sites in the lattice. An immediate consequence is that exact\ndiagonalization can only be applied to small systems. In particular,\nthermodynamic properties often remain inaccessible by this method.\nConventional alternatives include Quantum Monte Carlo sampling\ntechniques. These are well established numerical methods that have been\nused extensively in several areas of Mathematics and Physics. Of\ninterest here is that these techniques have been applied (Prokofev\net\u00a0al., 1998 ; Evertz, 2003 ; Syljuasen and Sandvik, 2002 ; Sandvik,\n2005 ) successfully to several quantum lattice models. On the other\nhand, Quantum Monte Carlo techniques suffer from the notorious sign\nproblem (Loh and Gubernatis, 1990 ; Henelius and Sandvik, 2000 ) that\nhinders their application to certain systems of immense interest.\nNotable examples include systems of frustrated magnets and of\ninteracting fermions that are relevant in the context of quantum\nmagnetism and high temperature superconductivity (Anderson, 1987 ) .\n\nIn recent years, new approaches based on tensor networks have caught\nwidespread attention. Such approaches can be regarded as generalizations\nof the density matrix renormalization group (DMRG) method (White, 1992 ,\n1993 ; Schollwock, 2005a ; McCulloch, 2008 ) , which is highly\nsuccessful for one-dimensional systems. The potential of tensor network\nalgorithms relies on the fact that, as DMRG, they can address systems of\nfrustrated spins and interacting fermions but, unlike DMRG, they can\nalso be applied to two dimensional systems, both of large size and of\ninfinite size. The main impediment of such methods comes from the fact\nthat simulation costs increase rapidly with the amount of entanglement\nin the system. Consequently, tensor networks can only represent states\nwith a limited amount of entanglement. On the other hand, exploitation\nof symmetries has remained largely unexplored for a broad class of\ntensor networks algorithms.\n\nSymmetries, of fundamental importance in physics, require special\ntreatment in numerical studies. Unless explicitly preserved at the\nalgorithmic level, they are bound to be destroyed by the accumulation of\nsmall errors, in which case significant features of the system might be\nconcealed. On the other hand, when properly handled, the presence of a\nsymmetry can be exploited to reduce simulation costs.\n\nThe goal of this thesis is to extend the tensor network formalism to the\npresence of symmetries. We develop a generic framework that can be\napplied to adapt any given tensor network representation and algorithm\nto both numerically protect symmetries and exploit them for\ncomputational gain.\n\n### 1.1 Tensor network states and algorithms\n\nTensor networks are an efficient parameterization of low energy quantum\nmany-body states of lattice models. The degrees of freedom of the model\nare arranged on a lattice @xmath made of @xmath sites where each site is\ndescribed by a Hilbert space of dimension @xmath . As a result, the\nHilbert space dimension of @xmath grows exponentially with the number of\nsites @xmath . Thus, a generic quantum many-body state on the lattice is\nparameterized by exponentially many parameters. On the other hand, the\ndynamics of the system are typically governed by a local Hamiltonian\n@xmath , that is, @xmath decomposes as the sum of terms involving only a\nsmall number of sites, and whose strength decays with the distance\nbetween the sites. The locality of the dynamics often implies that only\na relatively small amount of entanglement is present in the ground\nstate. In such circumstances, tensor networks offer a good description\nof the ground state. Moreover, the description is efficient, in that the\ntotal number of parameters encoded into the tensor networks grows\nroughly linearly with @xmath .\n\nExamples of tensor network states for one dimensional systems include\nthe matrix product state (Fannes et\u00a0al., 1992 ; Ostlund and Rommer, 1995\n; Perez-Garcia et\u00a0al., 2007 ) (MPS), which results naturally from both\nWilson\u2019s numerical renormalization group (Wilson, 1975 ) and White\u2019s\nDMRG and is also used as a basis for simulation of time evolution, e.g.\nwith the time evolving block decimation (TEBD) (Vidal, 2003 , 2004 ,\n2007a ) algorithm and variations thereof, often collectively referred to\nas time-dependent DMRG (Vidal, 2003 , 2004 ; Daley et\u00a0al., 2004 ; White\nand Feiguin, 2004 ; Schollwock, 2005b ; Vidal, 2007a ) ; the tree tensor\nnetwork (Shi et\u00a0al., 2006 ) (TTN), which follows from coarse-graining\nschemes where the spins are blocked hierarchically; and the multi-scale\nentanglement renormalization ansatz (Vidal, 2007b , 2008 ; Evenbly and\nVidal, 2009a ; Giovannetti et\u00a0al., 2008 ; Pfeifer et\u00a0al., 2009 ; Vidal,\n2010 ) (MERA), which results from a renormalization group procedure\nknown as entanglement renormalization (Vidal, 2007b , 2010 ) . For two\ndimensional lattices there are generalizations of these three tensor\nnetwork states, namely projected entangled pair states (Verstraete and\nCirac, 2004 ; Sierra and Martin-Delgado, 1998 ; Nishino and Okunishi,\n1998 ; Nishio et\u00a0al., 2004 ; Murg et\u00a0al., 2007 ; Jordan et\u00a0al., 2008 ;\nGu et\u00a0al., 2008 ; Jiang et\u00a0al., 2008 ; Xie et\u00a0al., 2009 ; Murg et\u00a0al.,\n2009 ) (PEPS), 2D TTN, (Tagliacozzo et\u00a0al., 2009 ; Murg et\u00a0al., 2010 )\nand 2D MERA (Evenbly and Vidal, 2010a , b ; Aguado and Vidal, 2008 ;\nCincio et\u00a0al., 2008 ; Evenbly and Vidal, 2009b ; Konig et\u00a0al., 2009 )\nrespectively. As variational ans\u00e4tze, PEPS and 2D MERA are particularly\ninteresting since they can be used to address large two-dimensional\nlattices, including systems of frustrated spins (Murg et\u00a0al., 2009 ;\nEvenbly and Vidal, 2010a ) and interacting fermions, (Corboz and Vidal,\n2009 ; Kraus et\u00a0al., 2010 ; Pineda et\u00a0al., 2010 ; Corboz et\u00a0al., 2010a ;\nBarthel et\u00a0al., 2009 ; Shi et\u00a0al., 2009 ; Corboz et\u00a0al., 2010b ; Pizorn\nand Verstraete, 2010 ; Gu et\u00a0al., 2010 ) where Monte Carlo techniques\nfail due to the sign problem.\n\nSome popular tensor networks are summarized in table 1.1 .\n\n### 1.2 Symmetries\n\nThe presence of symmetries is a universal trait of physical theories.\nSymmetry has become one of the most powerful tools of theoretical\nphysics, as it has become evident that practically all laws of nature\noriginate in symmetries. The importance of symmetries in physical\ntheories was firmly grounded by the famous Noether\u2019s theorem , a\nrigorous result that links the presence of a symmetry to the\nconservation of a physical quantity.\n\nIn this thesis we will be concerned with symmetries exhibited in quantum\nlattice models. The many-body Hamiltonian @xmath may be invariant under\ncertain transformations, which form a group @xmath of symmetries\n(Cornwell, 1997 ) . Under the action of the symmetry transformation, the\nHilbert space of the theory is divided into symmetry sectors labeled by\nquantum numbers or conserved charges. The symmetry group @xmath may be\nAbelian or non-Abelian , depending on whether or not the total effect of\napplying two symmetry transformations depends on the order in which the\ntransformations are applied. The symmetry sectors associated with an\nAbelian symmetry correspond to one-dimensional invariant subspaces. In\ncontrast, the dimension of the symmetry sectors associated with a\nnon-Abelian symmetry may be larger than one.\n\nOn the lattice, one can distinguish between space symmetries, which\ncorrespond to some permutation of the sites of the lattice, and internal\nsymmetries, which act on the vector space of each site. An example of\nspace symmetry is invariance under translations by some unit cell, which\nleads to conservation of quasi-momentum. An example of internal symmetry\nis SU(2) invariance, e.g. spin isotropy in a quantum spin model. An\ninternal symmetry can in turn be global , if it transforms the space of\neach of the lattice sites according to the same transformation (e.g. a\nspin independent rotation); or local , if each lattice site is\ntransformed according to a different transformation (e.g. a\nspin-dependent rotation), as it is in the case of lattice gauge models.\nA global internal SU(2) symmetry gives rise to conservation of total\nspin. Table 1.2 lists some examples of Abelian and non-Abelian physical\nsymmetries.\n\nBy targeting a specific symmetry sector during a calculation,\ncomputational costs can often be significantly reduced while explicitly\npreserving the symmetry. It is therefore not surprising that symmetries\nplay an important role in numerical approaches.\n\n### 1.3 Incorporating symmetries into tensor network algorithms\n\nExploiting symmetries has been of great interest in numerical\napproaches, since it allows selection of a specific charge sector within\nthe kinematic Hilbert space, and leads to significant reduction of\ncomputational costs.\n\nIn the context of tensor network algorithms, benefits of exploiting the\nsymmetry have been extensively demonstrated especially in the context of\nMPS. Both space and internal symmetries, Abelian and non-Abelian, have\nbeen thoroughly incorporated into DMRG code and have been exploited to\nobtain computational gains (Ostlund and Rommer, 1995 ; White, 1992 ;\nSchollwock, 2005b ; Ramasesha et\u00a0al., 1996 ; Sierra and Nishino, 1997 ;\nTatsuaki, 2000 ; McCulloch and Gulacsi, 2002 ; Bergkvist et\u00a0al., 2006 ;\nPittel and Sandulescu, 2006 ; McCulloch, 2007 ; Perez-Garcia et\u00a0al.,\n2008 ; Sanz et\u00a0al., 2009 ) .\n\nSymmetries have also been used in more recent proposals to simulate time\nevolution with MPS (Vidal, 2004 ; Daley et\u00a0al., 2004 ; White and\nFeiguin, 2004 ; Schollwock, 2005b ; Vidal, 2007a ; Daley et\u00a0al., 2005 ;\nDanshita et\u00a0al., 2007 ; Muth et\u00a0al., 2010 ; Mishmash et\u00a0al., 2009 ;\nSingh et\u00a0al., 2010a ; Cai et\u00a0al., 2010 ) .\n\nFigure 1.1 is demonstrative of the colossal computational gain that has\nbeen obtained by exploiting the symmetry in the context of the MPS. (In\nFig. 6.14 we show an analogous comparison for exploiting symmetries in\nthe context of the MERA.)\n\nHowever, when considering symmetries, it is important to notice that an\nMPS is a trivalent tensor network. That is, in an MPS each tensor has at\nmost three indices. The Clebsch-Gordan coefficients (Cornwell, 1997 )\n(or coupling coefficients) of a symmetry group are also trivalent, and\nthis makes incorporating the symmetry into an MPS by considering\nsymmetric tensors particularly simple. In contrast, tensor network\nstates with a more elaborate network of tensors, such as MERA or PEPS,\nconsist of tensors having a larger number of indices. In this case a\nmore general formalism is required in order to exploit the symmetry.\n\nIn this thesis we will describe how to incorporate a global internal\nsymmetry, given by a compact and reducible group @xmath , into tensor\nnetwork algorithms. We will develop a generic strategy that is\nindependent of the details of the underlying tensor network. We will do\nthis by imposing the symmetry constraints at the level of individual\ntensors that constitute the tensor network. We will then also describe\nhow symmetric tensors are manipulated such that the symmetry is both\npreserved and exploited for computational gain. Having built a framework\nof symmetric tensors, we will adapt an arbitrary tensor network to the\npresence of symmetry by using symmetric tensors as building blocks for\nthe tensor network. The resulting tensor network represents a class of\nquantum many-body wavefunctions that are invariant (or more generally\ncovariant) under the symmetry transformation. Algorithms based on such\nsymmetric tensor networks will also be adapted to the presence of\nsymmetry. This will be achieved by expressing each step of an algorithm\nin terms of symmetric manipulations of the tensors.\n\nAs a concrete illustration, we will extensively describe the\nimplementation of U(1) and SU(2) symmetries into the MPS and MERA. With\nthese implementations at hand, we will demonstrate the colossal benefits\nof incorporating the symmetry into tensor network algorithms. These\ninclude addressing specific symmetry sectors of the Hilbert space,\ncompactification of the tensor network representation and computational\nspeedup in numerical simulations. For example, in a lattice spin model\nendowed with spin isotropy the ground state is constrained to the spin\nzero or singlet sector of the Hilbert space. Therefore, in a numerical\nprobing for the state, it is sufficient to restrict attention to the\nsinglet subspace. This can, in turn, potentially result in a substantial\nreduction of computational costs.\n\n### 1.4 Plan of the thesis\n\nThis thesis is comprised of three published papers corresponding to\nchapters 2,3 and 4 and additional chapters 5 and 6. The material in\nchapters 5 and 6 was under preparation for publication at the time of\nsubmitting this thesis. The following is a brief summary of all the\nchapters.\n\nIn Chapter 2 we dive straight into the core of the problem. We describe\nthe implementation of a non-Abelian symmetry for the case of the\nsimplest tensor network: the MPS. This will serve to illustrate the key\npoints that are required to be considered when implementing symmetries\ninto tensor network algorithms. In addition, this chapter also\ndemonstrates the benefits of exploiting symmetries in the case of MPS\nalgorithms. We adapt the infinite time evolving block decimation (iTEBD)\nalgorithm to the presence of a global SU(2) symmetry. This is of\ninterest in its own right since the iTEBD algorithm has been immensely\nsuccessful in simulations of infinite 1D quantum many-body systems. This\nis also the first implementation of a non-Abelian symmetry into the\niTEBD algorithm and has resulted in a significant enhancement of this\nalgorithm.\n\nIn Chapter 3 we go beyond the class of MPS algorithms. We describe the\ngeneral strategy to incorporate a wide spectrum of symmetries into more\ncomplex tensor network states and algorithms. We consider tensor\nnetworks made of symmetric tensors, that is, tensors that are invariant\nunder the action of the symmetry. We develop a formalism to characterize\nand manipulate symmetric tensors.\n\nIn Chapter 4 we implement the general formalism for the case of an\nAbelian symmetry. The implementation of an Abelian symmetry is\nsimplified by the fact that symmetric tensors are easier to\ncharacterize. In a basis labeled by the charges of the symmetry, a\nsymmetric tensor has a sparse block structure. We explain how this block\nstructure can be exploited for computational gain in a practical\nimplementation of the symmetry. The benefits of exploiting the symmetry\nare numerically demonstrated by exploiting U(1) symmetry in the context\nof the MERA.\n\nIn Chapters 5 and 6 we describe the implementation of a non-Abelian\nsymmetry. The details of implementing the symmetry are more involved,\nsince the structural tensors are highly non-trivial. However, the\ncomputational gain that results from exploiting a non-Abelian symmetry\nis significantly larger than that obtained by exploiting an Abelian\nsymmetry. Moreover, the practical scheme presented to implement a\nnon-Abelian symmetry can be readily extended to incorporate more exotic\nsymmetry constraints such as those corresponding to the presence of\nanyonic degrees of freedom. The benefits of exploiting a non-Abelian\nsymmetry are numerically demonstrated by means of our implementation of\nSU(2) symmetry in the context of the MERA.\n\nFinally, in Chapter 7 we draw conclusions and discuss potential\napplications and future directions of this work.\n\nNote on References: In addition to the references listed at the end of\nthe thesis, chapter wise references appear at the end of chapters 2, 3\nand 4 that correspond to published papers.\n\n## Chapter 2 Exploiting symmetries in MPS algorithms: An Example\n\nWe kick start the main discussion of the thesis by describing how to\nincorporate an SU(2) symmetry into a specific MPS algorithm: the iTEBD\nalgorithm. The iTEBD algorithm has been immensely successful in\nsimulations of infinite 1D quantum many-body systems.\n\nWe follow a straightforward implementation of the symmetry into the\nalgorithm. We consider an MPS that is made of trivalent SU(2) invariant\ntensors. A trivalent SU(2) invariant tensor decomposes into two pieces.\nOne piece contains the degrees of freedom whereas the other corresponds\nto the Clebsch-Gordan coefficients of SU(2). We describe how the iTEBD\nalgorithm can be enhanced by exploiting this decomposition of the MPS\ntensors. The resulting symmetric algorithm is obtained to be 300 times\nfaster (See Fig. 1.1 ). We use the symmetric algorithm for a numerical\nstudy of a critical quantum spin chain.\n\nThis chapter serves to illustrate the main conceptual ingredients that\nare required to incorporate symmetries into tensor network algorithms.\nIn the next chapter, we will generalize these ingredients by going\nbeyond the specific details of the SU(2) symmetry group and the MPS\nrepresentation.\n\nSee pages 2-13 of su2mps.pdf\n\n## Chapter 3 Tensor networks and symmetries: Theoretical formalism\n\nIn this chapter we develop a generic theoretical formalism to\nincorporate a symmetry into tensor network algorithms. We consider a\nwide class of symmetries that are described by a compact and reducible\ngroup @xmath that is multiplicity free, that is, the tensor product of\ntwo charges of the group does not contain multiple copies of a charge.\nOur strategy revolves around tensors that are invariant under the action\nof the symmetry. As a result, we formulate a framework of symmetric\ntensors.\n\nA symmetric tensor transforms covariantly (or remains invariant) under\nthe action of the symmetry. In a basis labeled by the symmetry charges,\nthe tensor decomposes into a set of degeneracy tensors and structural\ntensors . While the degeneracy tensors contain the degrees of freedom,\nthe components of the structural tensors are generalizations of the\ncoupling coefficients of the group, and are determined completely by the\nsymmetry. Moreover, any symmetry preserving manipulation of the tensor\ncan be performed in parts. For instance, a permutation of the indices of\na symmetric tensor breaks into the permutation of the corresponding\ndegeneracy indices and the permutation of the corresponding structural\nindices. Therefore, this canonical decomposition of a symmetric tensor\nallows for both a compact description of the tensor and a computational\nspeedup in numerical manipulations of it.\n\nWe also point out a numerical connection to the formalism of spin\nnetworks ( Penrose , 1971 ; Major , 1999 ) . A spin network is a\nmathematical object that appears, for example, in Loop Quantum Gravity\n(Rovelli, 1998 ) , where it is used (Rovelli and Smolin, 1995 ) to\nfacilitate a description of quantum spacetime. In our formalism, a\ntensor network made of symmetric tensors decomposes into a linear\nsuperposition of spin networks. Also, manipulating a symmetric tensor\nnetwork requires evaluating a spin network. Thus, our work highlights\nthe importance of spin networks in the context of tensor network\nalgorithms, thus setting the stage for cross-fertilization between these\ntwo areas of research.\n\nSee pages 1-4 of symTNpaper.pdf\n\n### 3.1 Errata\n\nThe following equations appear erroneously in the publication. They are\nto be corrected as follows.\n\nThe tensors @xmath and @xmath that appear in Eqs.11 and 12 do not carry\ndegeneracy indices and spin indices corresponding to the coupled charges\n@xmath and @xmath , since these indices are summed over in the\ndescription.\n\nIn Eq.\u00a011 the components of @xmath and @xmath read as @xmath and @xmath\nrespectively and the sum is only over different values of charge @xmath\n. The corrected equation reads,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn Eq.\u00a012 the components of @xmath and @xmath read as @xmath and @xmath\nrespectively and the sum is only over different values of charge @xmath\n. The corrected equation reads,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nA similar correction holds for Eq.\u00a015 which is a generalization of\nEqs.11 and 12. The sum is only over different values of the intermediate\ncharges @xmath . The corrected equation reads,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n## Chapter 4 Implementation of Abelian symmetries\n\nIn this chapter we specialize the general formalism to the case of\nAbelian symmetries. Abelian symmetries appear frequently in the context\nof lattice models with particles (bosons or fermions) as well as those\nwith spins. In the former, they include particle number conservation and\nparity conservation, whereas in the latter they appear as conservation\nof spin projection.\n\nThe analysis of exploiting an Abelian symmetry is made simple by the\nfact that the structural tensors in this case are trivial. On the other\nhand, an implementation of an Abelian symmetry serves to expose the\npractical difficulties that are encountered when incorporating\nsymmetries into complicated tensor networks. We pay special attention to\nsuch implementation level concerns. Certain operations in the algorithm\ndepend only on the symmetry and not on the components of the tensors\ninvolved. We exploit this fact to precompute the output of such\noperations and store their result in memory. This is particularly\nadvantageous in an iterative algorithm where tensor components are\nupdated or optimized by repeating a set of computations. The runtime\ncost of the iterative algorithm can be significantly reduced by reusing\nthe precomputed results from memory. By making use of precomputation we\nobtained a substantial computational gain from exploiting the symmetry\nin our MATLAB implementation. However, this was achieved at the expense\nof storing potentially large amounts of precomputed data.\n\nThe discussion is conducted in the specific context of U(1) symmetry\nassociated, for example, with conservation of particle number or of spin\nprojection. We describe how to implement elementary tensor manipulations\nsuch as permutation and reshape of indices in a U(1) symmetric way. We\nalso present a concrete implementation of the U(1) symmetry in the\ncontext of the MERA. We consider a MERA that is made of U(1) symmetric\ntensors. Then using the U(1) MERA we demonstrate the benefits of\nincluding symmetries into tensor networks.\n\nSee pages 1-22 of u1.pdf\n\n## Chapter 5 Implementation of non-Abelian symmetries \\@slowromancapi@\n\nIn this and the following chapter we will address the implementation of\nglobal non-Abelian symmetries into tensor network algorithms. We\nconsider the specific context of an internal SU(2) symmetry, that gives\nrise to spin isotropy. This is an extremely important symmetry that\nappears amply in lattice spin models.\n\nIn this chapter we will focus on the conceptual aspects of incorporating\nthe symmetry. The theoretic formalism developed in Chapter 3 will be\nadapted to the specific case of SU(2) symmetry. We consider tensors that\nare invariant under the action of SU(2). The structural tensors, that\nare part of the canonical decomposition, are highly non-trivial (and are\ngiven in terms of the Clebsch-Gordan coefficients). However, the key\nadvantage of the canonical decomposition is that it allows tensor\nmanipulations, such as reshape or permutation of indices, to be broken\ninto an independent manipulation of degeneracy tensors and of structural\ntensors.\n\nIn the context of numerical simulations the canonical decomposition\nleads to a computational gain. Computational cost is incurred only when\nmanipulating degeneracy tensors. One the other hand, structural tensors\nare manipulated algebraically by exploiting properties of the\nClebsch-Gordan coefficients. Manipulations of the structural tensors\nreduce to evaluating a spin network. This process involves integrating\nover the degrees of freedom associated with spin projection, which are\ntherefore suppressed in the outcome of the tensor manipulation, as is\nexpected in a spin isotropic description.\n\nIn Chapter 6 we will describe a specific implementation scheme of\nelementary manipulations of SU(2)-invariant tensors. We will address\nseveral concerns that are of importance in the practical implementations\nof the symmetry.\n\n### 5.1 Preparatory Review: Tensor network formalism\n\nIn this section we review the basic formalism of tensors and tensor\nnetworks. Even though we do not make any explicit reference to symmetry\nhere, our formalism is directed towards SU(2)-invariant tensors.\n\nWe begin by recalling the basic notion of a tensor. A tensor @xmath is a\nmultidimensional array of complex numbers @xmath . The rank of a tensor\nis the number @xmath of indices. The size of an index @xmath , denoted\n@xmath , is the number of values that the index takes, @xmath . The size\nof a tensor @xmath , denoted @xmath , is the number of complex numbers\nit contains, namely, @xmath .\n\n#### 5.1.1 Tensors as linear maps\n\nFor the purpose of this thesis we regard a rank- @xmath tensor as a\nlinear map. To this end, we first equip each index @xmath , of the\ntensor with a direction: \u2018in\u2019 or \u2018out\u2019, that is, either incoming into\nthe tensor or outgoing from the tensor respectively. We denote by @xmath\nthe directions associated with the indices of tensor @xmath , namely,\n@xmath \u2018in\u2019 if @xmath is an incoming index and @xmath \u2018out\u2019 if @xmath is\noutgoing.\n\nLet us also use index @xmath of the tensor to label a basis @xmath of a\ncomplex vector space @xmath of dimension @xmath . Then a rank-one (\n@xmath ) tensor with an outgoing index @xmath represents a vector in\n@xmath , a rank-two ( @xmath ) tensor @xmath with one incoming index\n@xmath and one outgoing index @xmath represents a matrix and so on.\n\nA tensor can be unambiguously regarded as a linear map from a vector\nspace to complex numbers @xmath . For instance, a vector can be regarded\nas a linear map from @xmath to @xmath , a matrix @xmath can be regarded\nas a linear map from @xmath to @xmath where @xmath is the dual of vector\nspace @xmath etc. More generally, we can use a rank- @xmath tensor\n@xmath to define a linear map from the tensor product of @xmath vector\nspaces to @xmath in the following way. Define a set @xmath , of @xmath\nspaces where\n\n  -- -------- -- -------\n     @xmath      (5.1)\n  -- -------- -- -------\n\nwhere the @xmath is the dual of vector space @xmath . Then tensor @xmath\ncan be regarded as a linear map from the product space @xmath to @xmath\n,\n\n  -- -------- -- -------\n     @xmath      (5.2)\n  -- -------- -- -------\n\nWe will find this viewpoint of tensors useful for subsequent\ngeneralization to SU(2)-invariant tensors.\n\nIt is convenient to use a graphical representation of tensors, as\nillustrated in Fig. 1, where a tensor is depicted as a \u201cblob\u201d (or by a\nshape e.g., circle, square etc.) and each of its indices is represented\nby a line emerging perpendicular from the boundary of the blob. In order\nto specify which index corresponds to which emerging line, we follow the\nprescription that the lines corresponding to indices @xmath emerge in\ncounterclockwise order. The first index corresponds to the line emerging\nclosest to a mark (black dot) inside the boundary of the blob (or the\nfirst line encountered while proceeding counterclockwise from nine\no\u2019clock in case the tensor is depicted as a circle without a mark). The\ndirection of an index is depicted by attaching an arrow to the line\ncorresponding to the index. We follow a convention that all arrows in a\ndiagram point downwards.\n\n#### 5.1.2 Elementary manipulations of a tensor\n\nA tensor can be transformed into another tensor in several elementary\nways. These include, reversing the direction of one or several of its\nindices, permuting its indices, and\/or reshaping its indices.\n\nReversing the direction of an index corresponds to mapping the vector\nspace that is associated with the index to its dual. For example, in\n\n  -- -------- -- -------\n     @xmath      (5.3)\n  -- -------- -- -------\n\nif index @xmath is associated to a vector space @xmath , then index\n@xmath that is obtained by reversing the direction of @xmath is\nassociated with the dual space @xmath . Since all arrows in a diagram\npoint downwards, reversing the direction of an index @xmath is depicted\n[Fig. 5.2 (i)] by \u2018bending\u2019 the line corresponding to @xmath upwards if\nit is an outgoing index or downwards if it is an incoming index. Since\ntensor @xmath is components wise equal to tensor @xmath arrows appear to\nbe irrelevant in the absence of the symmetry. However, arrows will play\nan important role when we consider SU(2)-invariant tensors since they\nspecify how the group acts on each index of a given tensor.\n\nA permutation of indices corresponds to creating a new tensor @xmath\nfrom @xmath by simply changing the order in which the indices appear,\ne.g.\n\n  -- -------- -- -------\n     @xmath      (5.4)\n  -- -------- -- -------\n\nPermutation of indices is depicted by intercrossing indices, as\nillustrated in Fig. 5.2 (ii). Note that when the permutation involves\nthe first index of the tensor the mark, that indicates the first index,\nis also shifted to a new location within the blob. It is useful to note\nthat an arbitrary permutation of the indices can be broken into a\nsequence of swaps of adjacent indices wherein the position of two\nindices are interchanged at a time.\n\nLast but not the least, a tensor @xmath can be reshaped into a new\ntensor @xmath by \u2018fusing\u2019 two adjacent indices into a single index\nand\/or \u2018splitting\u2019 an index into two indices. For instance, in\n\n  -- -------- -- -------\n     @xmath      (5.5)\n  -- -------- -- -------\n\ntensor @xmath is obtained from tensor @xmath by fusing indices @xmath\nand @xmath together into a single index @xmath of size @xmath that runs\nover all pairs of values of @xmath and @xmath , i.e. @xmath , whereas in\n\n  -- -------- -- -------\n     @xmath      (5.6)\n  -- -------- -- -------\n\ntensor @xmath is recovered from @xmath by splitting index @xmath of\n@xmath back into indices @xmath and @xmath . Reshape of the indices is\ndepicted as shown in Fig. 5.2 (iii).\n\n#### 5.1.3 Multiplication of two tensors\n\nGiven two matrices @xmath and @xmath with components @xmath and @xmath ,\nwe can multiply them together to obtain a new matrix @xmath , @xmath ,\nwith components\n\n  -- -------- -- -------\n     @xmath      (5.7)\n  -- -------- -- -------\n\nby summing over or contracting index @xmath . The multiplication of\nmatrices @xmath and @xmath is represented graphically by connecting\ntogether the emerging lines of @xmath and @xmath corresponding to the\ncontracted index, as shown in Fig. 5.3 (i).\n\nMatrix multiplication can be generalized to tensors, such that, an\nincoming index of one tensor is identified and contracted with an\noutgoing index of another. For instance, given tensor @xmath with\ncomponents @xmath and directions @xmath , and tensor @xmath with\ncomponents @xmath and directions @xmath , we can define a tensor @xmath\nwith components @xmath that are given by,\n\n  -- -------- -- -------\n     @xmath      (5.8)\n  -- -------- -- -------\n\nNote that each of the indices @xmath and @xmath , that are contracted,\nis incoming into one tensor and outgoing from the other. The\nmultiplication is represented graphically by connecting together the\nlines emerging from @xmath and @xmath corresponding to each of these\nindices, as shown in Fig. 5.3 (ii).\n\nMultiplication of two tensors can be broken down into a sequence of\nelementary steps by transforming the tensors into matrices, multiplying\nthe matrices together, and then transforming the resulting matrix back\ninto a tensor. Next we describe these steps for the contraction given in\nEq.\u00a0( 5.8 ). They are illustrated in Fig. 5.4 .\n\n1.   Reverse and Permute the indices of tensor @xmath in such a way that\n    the indices @xmath and @xmath that are contracted appear in the last\n    positions as outgoing indices and in a given order, e.g. @xmath ,\n    and the remaining indices @xmath and @xmath appear in the first\n    positions as incoming indices; similarly reverse and permute the\n    indices of @xmath so that the indices @xmath and @xmath appear in\n    the first positions as incoming indices and in the same order,\n    @xmath , and the remaining indices @xmath and @xmath appear in the\n    last positions as outgoing indices,\n\n      -- -------- -------- -- -------\n         @xmath   @xmath      \n         @xmath   @xmath      (5.9)\n      -- -------- -------- -- -------\n\n2.   Reshape tensor @xmath into a matrix @xmath by fusing into a single\n    index @xmath all the indices that are not contracted, @xmath , and\n    into a single index @xmath all indices that are contracted, @xmath ;\n    similarly reshape tensor @xmath into a matrix @xmath with indices\n    @xmath and @xmath (indices @xmath and @xmath are required to be\n    fused according to the same fusion sequence in the two tensors. A\n    possible fusion sequence may involve, for example, first fusing\n    @xmath and @xmath and then fusing the resulting index with @xmath ),\n\n      -- -------- -------- -- --------\n         @xmath   @xmath      \n         @xmath   @xmath      (5.10)\n      -- -------- -------- -- --------\n\n3.   Multiply matrices @xmath and @xmath to obtain a matrix @xmath with\n    components\n\n      -- -------- -- --------\n         @xmath      (5.11)\n      -- -------- -- --------\n\n4.   Reshape matrix @xmath into a tensor @xmath by splitting indices\n    @xmath and @xmath ,\n\n      -- -------- -- --------\n         @xmath      (5.12)\n      -- -------- -- --------\n\n5.   Reverse and Permute indices of tensor @xmath in the order in which\n    they appear in @xmath ,\n\n      -- -------- -- --------\n         @xmath      (5.13)\n      -- -------- -- --------\n\nThe contraction of Eq.\u00a0( 5.8 ) can be implemented at once, without\nbreaking the multiplication down into elementary steps. However, it is\noften more convenient to compose the above elementary steps since, for\ninstance, in this way one can use existing linear algebra libraries for\nmatrix multiplication. In addition, it can be seen that the leading\ncomputational cost in multiplying two large tensors is not changed when\ndecomposing the contraction in the above steps.\n\n#### 5.1.4 Factorization of a tensor\n\nA matrix @xmath can be factorized into the product of two (or more)\nmatrices in one of several canonical forms. For instance, the singular\nvalue decomposition\n\n  -- -------- -- --------\n     @xmath      (5.14)\n  -- -------- -- --------\n\nfactorizes @xmath into the product of two unitary matrices @xmath and\n@xmath , and a diagonal matrix @xmath with non-negative diagonal\nelements @xmath known as the singular values of @xmath [Fig. 5.5 (i)].\n\nOn the other hand, the eigenvalue or spectral decomposition of a square\nmatrix @xmath is of the form\n\n  -- -------- -- --------\n     @xmath      (5.15)\n  -- -------- -- --------\n\nwhere @xmath is an invertible matrix whose columns encode the\neigenvectors @xmath of @xmath ,\n\n  -- -------- -- --------\n     @xmath      (5.16)\n  -- -------- -- --------\n\n@xmath is the inverse of @xmath , and @xmath is a diagonal matrix, with\nthe eigenvalues @xmath on its diagonal. Other useful factorizations\ninclude the LU decomposition, the QR decomposition, etc. We refer to any\nsuch decomposition generically as a matrix factorization .\n\nA tensor @xmath with more than two indices can be converted into a\nmatrix in several ways by specifying how to join its indices into two\nsubsets. After specifying how tensor @xmath is to be regarded as a\nmatrix, we can factorize @xmath according to any of the above matrix\nfactorizations, as illustrated in Fig. 5.5 (ii) for a singular value\ndecomposition. This requires first reversing directions, permuting and\nreshaping the indices of @xmath to form a matrix, then decomposing the\nlatter, and finally restoring the open indices of the resulting matrices\ninto their original form by undoing the reshapes, permutations and\nreversal of directions.\n\n#### 5.1.5 Tensor networks and their manipulation\n\nA tensor network @xmath is a set of tensors whose indices are connected\naccording to a network pattern, e.g. Fig. 5.6 .\n\nGiven a tensor network @xmath , a single tensor @xmath can be obtained\nby contracting all the indices that connect the tensors in @xmath [Fig.\n5.6 (ii)]. Here, the indices of tensor @xmath correspond to the open\nindices of the tensor network @xmath . We then say that the tensor\nnetwork @xmath is a tensor network decomposition of @xmath . One way to\nobtain @xmath from @xmath is through a sequence of contractions\ninvolving two tensors at a time [Fig. 5.6 (iii)]. Notice how a tensor\nthat is obtained by contracting a region of a tensor network is\nconveniently depicted by a blob or shape that covers that region.\n\nFrom a tensor network decomposition @xmath for a tensor @xmath , another\ntensor network decomposition for the same tensor @xmath can be obtained\nin many ways. One possibility is to replace two tensors in @xmath with\nthe tensor resulting from contracting them together, as is done in each\nstep of Fig. 5.6 (iii). Another way is to replace a tensor in @xmath\nwith a decomposition of that tensor (e.g. with a singular value\ndecomposition). In this thesis, we will be concerned with manipulations\nof a tensor network that, as in the case of multiplying two tensors or\ndecomposing a tensor, can be broken down into a sequence of operations\nfrom the following list:\n\n1.  Reversal of direction of indices of a tensor, Eq.\u00a0( 5.3 ).\n\n2.  Permutation of the indices of a tensor, Eq.\u00a0( 5.4 ).\n\n3.  Reshape of the indices of a tensor, Eqs.\u00a0( 5.5 )-( 5.6 ).\n\n4.  Multiplication of two matrices, Eq.\u00a0( 5.7 ).\n\n5.  Factorization of a matrix (e.g. singular value decomposition Eq.\u00a0(\n    5.14 ) or spectral decomposition Eq.\u00a0( 5.15 ).\n\nThese operations constitute a set @xmath of primitive operations for\ntensor network manipulations (or, at least, for the type of\nmanipulations we will be concerned with). In Sec. 5.6 (and again in\nChapter 6) we discuss how this set @xmath of primitive operations can be\ngeneralized to tensors that are invariant under the action of the group\nSU(2).\n\nNext we review basic background material concerning the representation\ntheory of the group SU(2) without reference to tensor network states and\nalgorithms. This review is distributed over Sections 5.2 , 5.3 and 5.4 .\nWe refer the reader to (Cornwell, 1997 ) and Chapters 3 and 4 of\n(Sakurai, 1994 ) for additional supporting material for these sections.\n\n### 5.2 Representations of the group SU(2)\n\nIn this section we consider the action of SU(2) on a vector space that\nis an irreducible representation of the group, and then more generally\non a vector space @xmath that is a reducible representation, namely,\n@xmath decomposes as a direct sum of (possibly degenerate) irreducible\nrepresentations. We also characterize vectors belonging to @xmath and\nlinear operators acting on @xmath that are invariant under the action of\nSU(2).\n\nLet @xmath be a finite dimensional vector space on which SU(2) acts\nunitarily by means of transformations @xmath ,\n\n  -- -------- -- --------\n     @xmath      (5.17)\n  -- -------- -- --------\n\nHere @xmath parameterizes the group elements and @xmath ; @xmath and\n@xmath are traceless hermitian operators that are said to generate the\nrepresentation @xmath of SU(2). These operators close the lie algebra\nsu(2), namely,\n\n  -- -------- -- --------\n     @xmath      (5.18)\n  -- -------- -- --------\n\nwhere @xmath is the Levi-Civita symbol. The operators @xmath and @xmath\nare associated, for example, with the projection of angular momentum or\nspin along the three spatial directions @xmath and @xmath ,\nrespectively.\n\nIt follows that,\n\n  -- -------- -- --------\n     @xmath      (5.19)\n  -- -------- -- --------\n\n#### 5.2.1 Irreducible representations\n\nLet vector space @xmath transform as an irreducible representation (or\nirrep) of SU(2) with spin @xmath . Here @xmath can take values @xmath\nand @xmath has dimension @xmath . We choose an orthonormal basis @xmath\n, the spin basis , in @xmath that is a simultaneous eigenbasis of the\noperators @xmath and @xmath ,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.20)\n  -- -------- -------- -- --------\n\nHere @xmath is the magnitude of the spin projection along the @xmath\ndirection and can assume values in the range @xmath . In this basis, the\naction of the operators @xmath and @xmath on the space @xmath is\nconveniently described in terms of the raising operator @xmath and the\nlowering operator @xmath as\n\n  -- -------- -- --------\n     @xmath      (5.21)\n  -- -------- -- --------\n\nThe operator @xmath can be written as\n\n  -- -------- -- --------\n     @xmath      (5.22)\n  -- -------- -- --------\n\nwhere @xmath is the Identity acting on the irrep @xmath .\n\nExample 1: Consider that vector space @xmath is a spin @xmath irrep of\nSU(2). Then @xmath has dimension one, @xmath . The operators @xmath are\ntrivial, @xmath .\n\nExample 2: Consider a two-dimensional vector space @xmath that\ntransforms as an irrep @xmath . Then the orthogonal vectors (in column\nvector notation)\n\n  -- -------- -- --------\n     @xmath      (5.23)\n  -- -------- -- --------\n\nform a basis of @xmath . In this basis the operators @xmath and @xmath\nread as\n\n  -- -------- -- --------\n     @xmath      (5.24)\n  -- -------- -- --------\n\nIn terms of Pauli matrices @xmath we have\n\n  -- -------- -- --------\n     @xmath      (5.25)\n  -- -------- -- --------\n\nExample 3: Also consider a three-dimensional vector space @xmath that\ntransforms as an irrep @xmath . The orthogonal vectors\n\n  -- -------- -- --------\n     @xmath      (5.26)\n  -- -------- -- --------\n\nform a basis of @xmath . In this basis, operators @xmath and @xmath read\nas\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.27)\n  -- -------- -------- -- --------\n\n#### 5.2.2 Reducible representations\n\nMore generally, SU(2) can act on the vector space @xmath reducibly, in\nthat, @xmath may decompose as the direct sum of irreps of SU(2),\n\n  -- -------- -- --------\n     @xmath      (5.28)\n  -- -------- -- --------\n\nHere space @xmath accommodates a spin @xmath irrep of SU(2) and @xmath\nis the number of times @xmath occurs in @xmath . The decomposition can\nalso be re-written in terms of a @xmath dimensional space @xmath . We\nsay that irrep @xmath is @xmath -fold degenerate and that @xmath is the\ndegeneracy space. The total dimension of space @xmath is given by @xmath\n.\n\nLet @xmath label an orthonormal basis @xmath in the space @xmath . Then\na natural choice of basis of the space @xmath is the set of orthonormal\nvectors @xmath , where @xmath assumes various values that occur in the\ndirect sum decomposition, Eq.\u00a0( 5.28 ).\n\nIn this basis the action of SU(2) on @xmath is given by\n\n  -- -------- -- --------\n     @xmath      (5.29)\n  -- -------- -- --------\n\nas generated by the operators\n\n  -- -------- -- --------\n     @xmath      (5.30)\n  -- -------- -- --------\n\nHere @xmath is a @xmath Identity and operators @xmath generate the\nirreducible represention @xmath on space @xmath .\n\nThe operator @xmath takes the form\n\n  -- -------- -- --------\n     @xmath      (5.31)\n  -- -------- -- --------\n\nExample 4: Let vector space @xmath transform as an irrep @xmath with a\nfinite degeneracy @xmath . The space @xmath decomposes as @xmath where\n@xmath is a three-dimensional degeneracy space and @xmath corresponds to\nthe space of Example 1.\n\nThe total dimension of space @xmath is @xmath . The vectors\n\n  -- -------- -- --------\n     @xmath      (5.32)\n  -- -------- -- --------\n\nform a basis of @xmath . A basis of @xmath can be obtained as the\nproduct of the the basis ( 5.32 ) of @xmath and the basis ( 5.23 ) of\n@xmath . In this basis of the operators @xmath take the form of Eq.\u00a0(\n5.30 ). For instance,\n\n  -- -------- -- --------\n     @xmath      (5.33)\n  -- -------- -- --------\n\nSimilarly, operators @xmath and @xmath read as\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.34)\n  -- -------- -------- -- --------\n\nThe operator @xmath reads\n\n  -- -------- -- --------\n     @xmath      (5.35)\n  -- -------- -- --------\n\nExample 5: Consider a five-dimensional Hilbert space @xmath that\ndecomposes into two different irreps @xmath and @xmath with degeneracy\ndimensions @xmath and @xmath so that irrep @xmath is two-fold\ndegenerate. The space @xmath decomposes as @xmath , where @xmath is the\ntwo-dimensional degeneracy space of irrep @xmath and @xmath is the\none-dimensional degeneracy space of irrep @xmath .\n\nThe orthogonal vectors\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      \n     @xmath   @xmath      \n     @xmath   @xmath      \n     @xmath   @xmath      (5.36)\n  -- -------- -------- -- --------\n\nform a basis of @xmath . In this basis, the operators @xmath take the\nform\n\n  -- -------- -- --------\n     @xmath      (5.37)\n  -- -------- -- --------\n\nwhere @xmath and @xmath are the generators of irrep @xmath (Examples 1)\nand irrep @xmath (Examples 3) respectively. Operators @xmath and @xmath\nread as\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      \n     @xmath   @xmath      \n     @xmath   @xmath      (5.38)\n  -- -------- -------- -- --------\n\n#### 5.2.3 SU(2)-invariant states and operators\n\nWe are interested in states and operators that have a simple\ntransformation rule under the action of SU(2).\n\nA pure state @xmath with a well defined spin @xmath belongs to the\nsubspace @xmath . In the spin basis @xmath the state @xmath can be\nexpanded as\n\n  -- -------- -- --------\n     @xmath      (5.39)\n  -- -------- -- --------\n\nUnder the action of SU(2), @xmath transforms to another pure state\n@xmath , @xmath , within the same subspace @xmath . The components\n@xmath of @xmath are related to those of @xmath as\n\n  -- -------- -- --------\n     @xmath      (5.40)\n  -- -------- -- --------\n\nIn case of vanishing spin @xmath , the state @xmath transforms trivially\nunder the action of SU(2), @xmath . In this case Eq.\u00a0( 5.40 ) reduces\nto,\n\n  -- -------- -- --------\n     @xmath      (5.41)\n  -- -------- -- --------\n\nThat is, @xmath remains invariant under the action of SU(2).\nEquivalently, it is annihilated by the action of generators,\n\n  -- -------- -- --------\n     @xmath      (5.42)\n  -- -------- -- --------\n\nAn SU(2)-invariant state @xmath can be expanded in the basis @xmath of\nthe spin @xmath subspace, @xmath ,\n\n  -- -------- -- --------\n     @xmath      (5.43)\n  -- -------- -- --------\n\nwhere we have used @xmath as a shorthand for @xmath .\n\nA linear operator @xmath is SU(2)-invariant if it commutes with the\naction of the group,\n\n  -- -------- -- --------\n     @xmath      (5.44)\n  -- -------- -- --------\n\nor equivalently, if it commutes with the generators @xmath ,\n\n  -- -------- -- --------\n     @xmath      (5.45)\n  -- -------- -- --------\n\nNotice that the operator @xmath is SU(2)-invariant, Eq.\u00a0( 5.19 ).\n\nAn SU(2)-invariant operator @xmath decomposes as\n\n  -- -------- -- --------\n     @xmath      \n     @xmath      (5.46)\n  -- -------- -- --------\n\nwhere @xmath is a @xmath matrix that acts on the degeneracy space @xmath\n. This decomposition implies, for instance, that operator @xmath\ntransforms states with a well defined spin @xmath [such as @xmath of\nEq.\u00a0( 5.39 )] into states with the same spin @xmath . Thus,\nSU(2)-invariant operators conserve spin.\n\nExample 2 revisited: A generic state @xmath has the form,\n\n  -- -------- -- --------\n     @xmath      (5.47)\n  -- -------- -- --------\n\nand is an eigenstate of @xmath with eigenvalue @xmath .\n\nAccording to Schur\u2019s lemma, an SU(2)-invariant operator @xmath acting on\n@xmath must be proportional to the Identity,\n\n  -- -------- -- --------\n     @xmath      (5.48)\n  -- -------- -- --------\n\nExample 4 revisited: A generic state @xmath in the vector space @xmath\nof Example 3 has the form\n\n  -- -- -- --------\n           (5.49)\n  -- -- -- --------\n\nSimilar to the previous example, @xmath is an eigenstate of @xmath with\neigenvalue @xmath ..\n\nAn SU(2)-invariant operator @xmath must be of the form\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (5.50)\n  -- -------- -------- -- --------\n\nwhere we have used @xmath as a shorthand for @xmath . Notice that @xmath\nin Eq.\u00a0( 5.35 ) has this form.\n\nExample 5 revisited: A generic state @xmath has the form\n\n  -- -------- -- --------\n     @xmath      (5.51)\n  -- -------- -- --------\n\n(For simplicity we have omitted explicit labels in the subscripts.) In\ncontrast to the previous two examples, a generic state @xmath is not an\neigenstate of @xmath , that is, @xmath is generally not a state with a\nwell defined spin @xmath .\nAn SU(2)-invariant vector @xmath has the form\n\n  -- -------- -- --------\n     @xmath      (5.52)\n  -- -------- -- --------\n\nwith non-trivial components only in the spin @xmath subspace. Notice\nthat this state is annihilated by the action of the operators @xmath\n[Eq.\u00a0( 5.38 )] in accordance with Eq.\u00a0( 5.42 ).\n\nA state with a well defined spin @xmath must be of the form\n\n  -- -------- -- --------\n     @xmath      (5.53)\n  -- -------- -- --------\n\nwith non-trivial components only in the spin @xmath subspace.\n\nAn SU(2)-invariant operator @xmath e.g. @xmath in Eq.\u00a0( 5.38 ) has the\nform\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (5.54)\n  -- -------- -------- -- --------\n\nwhere @xmath .\n\nNotice that the SU(2)-invariant vector in Eq.\u00a0( 5.52 ) and the\nSU(2)-invariant matrices in Eqs.\u00a0( 5.48 ),( 5.50 ) and ( 5.54 ) have a\nsparse structure. In particular, the non-trivial components of an\nSU(2)-invariant matrix @xmath are organized into blocks @xmath . This\nblock structure can be exploited for computational gain. An\nSU(2)-invariant matrix can be stored compactly by storing the degeneracy\nblocks @xmath , while matrix multiplication and matrix factorizations\ncan be performed block-wise [Sec. 5.6 ] resulting in a significant\nspeedup [Fig. 5.26 ] for these operations.\n\n### 5.3 Tensor product of representations\n\nSo far we have described the action of SU(2) on a single vector space.\nLet us now consider the action of SU(2) on a space @xmath that is a\ntensor product of @xmath vector spaces,\n\n  -- -------- -- --------\n     @xmath      (5.55)\n  -- -------- -- --------\n\nwhere each vector space @xmath transforms as a finite dimensional\nrepresentation of SU(2) as generated by spin operators @xmath . We\nconsider the action of SU(2) on the space @xmath that is generated by\nthe total spin operators,\n\n  -- -------- -- --------\n     @xmath      (5.56)\n  -- -------- -- --------\n\n(each term in the sum acts as @xmath on site @xmath and the Identity on\nthe remaining sites) and which corresponds to the unitary\ntransformations,\n\n  -- -------- -- --------\n     @xmath      (5.57)\n  -- -------- -- --------\n\nAs a example consider two vector spaces @xmath and @xmath on which the\naction of SU(2) is generated by spin operators @xmath and @xmath\nrespectively. We can then consider the action of the group on the\nproduct space @xmath as generated by the total spin operators @xmath\nthat are given by\n\n  -- -------- -- --------\n     @xmath      (5.58)\n  -- -------- -- --------\n\nSimilarly, we can consider the action of SU(2) on the product of three\nvector spaces, @xmath and @xmath , that is generated by spin operators\n@xmath ,\n\n  -- -------- -- --------\n     @xmath      (5.59)\n  -- -------- -- --------\n\nwhere @xmath and @xmath are the spin operators that act on the three\nvector spaces.\n\nA basis of @xmath can be obtained in terms of the spin basis of each\nvector space in the product, Eq. 5.55 . However, it is convenient to\nintroduce a coupled basis: the simultaneous eigenbasis of the total spin\noperators @xmath and @xmath . In the coupled basis SU(2)-invariant\nstates @xmath ,\n\n  -- -------- -- --------\n     @xmath      (5.60)\n  -- -------- -- --------\n\nand SU(2)-invariant operators @xmath ,\n\n  -- -------- -- --------\n     @xmath      (5.61)\n  -- -------- -- --------\n\nhave a sparse structure, namely, @xmath has non-trivial components only\nin the spin zero sector of @xmath while @xmath is block-diagonal [Eq.\u00a0(\n5.46 )].\n\nIn the remainder of the section we focus on the tensor product of two\nrepresentations. We first discuss the case where the two sites transform\nas irreducible representations and then the more general case of\nreducible representations. The tensor product of several representations\ncan then be analyzed by considering a sequence of pairwise products.\n\n#### 5.3.1 Tensor product of two irreducible representations\n\nLet vector spaces @xmath and @xmath transform as irreps @xmath and\n@xmath respectively. The space @xmath is, in general, reducible and\ndecomposes as\n\n  -- -------- -- --------\n     @xmath      (5.62)\n  -- -------- -- --------\n\nwhere the total spin @xmath assumes all values in the range\n\n  -- -------- -- --------\n     @xmath      (5.63)\n  -- -------- -- --------\n\nLet @xmath and @xmath denote the spin basis of the respective vector\nspaces. Then the vectors\n\n  -- -------- -- --------\n     @xmath      (5.64)\n  -- -------- -- --------\n\nform a basis of @xmath . Introduce a coupled basis @xmath that fulfills\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.65)\n  -- -------- -------- -- --------\n\nThe coupled basis is related to the product basis ( 5.64 ) by means of\nthe transformation\n\n  -- -------- -- --------\n     @xmath      (5.66)\n  -- -------- -- --------\n\nHere\n\n  -- -------- -- --------\n     @xmath      (5.67)\n  -- -------- -- --------\n\nare the Clebsch-Gordan coefficients , which vanish unless @xmath and\n@xmath are compatible, that is, @xmath and @xmath fulfill\n\n  -- -------- -- --------\n     @xmath      (5.68)\n  -- -------- -- --------\n\nand @xmath and @xmath fulfill\n\n  -- -------- -- --------\n     @xmath      (5.69)\n  -- -------- -- --------\n\nThe product basis can be expressed in terms of the coupled basis as\n\n  -- -------- -- --------\n     @xmath      (5.70)\n  -- -------- -- --------\n\nwhere\n\n  -- -------- -- --------\n     @xmath      (5.71)\n  -- -------- -- --------\n\nWe graphically represent tensors @xmath and @xmath differently from\nusual tensors, as shown in Fig. 5.7 (i).\n\nTensor @xmath is depicted by means of two incoming lines and one\noutgoing line that emerge from a point. The outgoing line corresponds to\nthe spin index @xmath . The incoming lines that are encountered first\nand second when proceeding clockwise from the outgoing line correspond\nto the spin indices @xmath and @xmath respectively.\n\nAnalogously, tensor @xmath is depicted by means of one incoming line and\ntwo outgoing lines that emerge from a point. The spin index @xmath\ncorresponds to the incoming line in this case while spin indices @xmath\nand @xmath correspond to the outgoing lines in the order in which they\nare encountered when proceeding counterclockwise from the incoming line.\n\nTensor @xmath and tensor @xmath fulfill the orthogonality identities,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.72)\n  -- -------- -------- -- --------\n\nThe special graphical representations for these tensors allows one to\ndepict the above identities in an intuitive way, as shown in Fig. 5.7\n.(ii)-(iii).\n\nExample 6: Let both vector spaces @xmath and @xmath transform as a spin\n@xmath irrep, @xmath (Example 2). The space @xmath decomposes into a\ndirect sum of irreps,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (5.73)\n  -- -------- -------- -- --------\n\nA basis can be introduced in @xmath in terms of the spin basis [Eq.\u00a0(\n5.23 )] of @xmath and of @xmath . The coupled basis of @xmath ,\n\n  -- -------- --\n     @xmath   \n     @xmath   \n  -- -------- --\n\nis related to the product basis by means of the Clebsch-Gordan\ncoefficients,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (5.74)\n     @xmath   @xmath      (5.75)\n     @xmath   @xmath      \n              @xmath      (5.76)\n     @xmath   @xmath      (5.77)\n  -- -------- -------- -- --------\n\nFor completeness, we list below the numerical value of the\nClebsch-Gordan coefficients that appear in Eqs.\u00a0( 5.74 )-( 5.77 ),\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\n#### 5.3.2 Tensor product of two reducible representations\n\nLet us now consider that vector spaces @xmath and @xmath transform\nreducibly under the action of SU(2). We have\n\n  -- -------- -- --------\n     @xmath      (5.78)\n  -- -------- -- --------\n\nThe space @xmath decomposes into a direct sum of irreps,\n\n  -- -------- -- --------\n     @xmath      (5.79)\n  -- -------- -- --------\n\nwhere the total spin @xmath takes all values that are compatible with\nany pair of irreps @xmath and @xmath .\n\nLet @xmath and @xmath denote the spin basis of @xmath and @xmath\nrespectively. We introduce a coupled basis @xmath that fulfills,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.80)\n  -- -------- -------- -- --------\n\nand which is related to the product basis,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nby means of a transformation,\n\n  -- -------- -- --------\n     @xmath      (5.81)\n  -- -------- -- --------\n\nThe components @xmath can be expressed in terms of the Clebsch-Gordan\ncoefficients as\n\n  -- -------- -- --------\n     @xmath      (5.82)\n  -- -------- -- --------\n\nLet us explain how this expression is obtained. From the definition,\nEq.\u00a0( 5.81 ), we have\n\n  -- -------- -- --------\n     @xmath      (5.83)\n  -- -------- -- --------\n\nAccording to the direct sum decomposition, Eq.\u00a0( 5.79 ), each vector\n@xmath belongs to the subspace @xmath where it factorizes as\n\n  -- -------- -- --------\n     @xmath      (5.84)\n  -- -------- -- --------\n\nSimilarly, we can factorize vectors @xmath and @xmath . The expression\nEq.\u00a0( 5.82 ) can then be obtained by substituting these factorizations\ninto Eq.\u00a0( 5.83 ) and re-arranging the terms as shown below,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nwhere @xmath .\n\nHere @xmath is a one to one map that relates vectors @xmath to the\nvectors @xmath . It can be regarded as a rank- @xmath tensor such that\neach component of @xmath is either a zero or a one. We have,\n\n  -- -------- -- --------\n     @xmath      (5.85)\n  -- -------- -- --------\n\nThe product basis can, in turn, be expressed in terms of the coupled\nbasis,\n\n  -- -------- -- --------\n     @xmath      (5.86)\n  -- -------- -- --------\n\nwhere\n\n  -- -------- -- --------\n     @xmath      (5.87)\n  -- -------- -- --------\n\nand\n\n  -- -------- -- --------\n     @xmath      (5.88)\n  -- -------- -- --------\n\nWe refer to the tensors @xmath and @xmath as the fusing tensor and the\nsplitting tensor respectively, since they will play an instrumental role\nin fusing and splitting indices of an SU(2)-invariant tensor. The\nspecial graphical representation of these tensors and their\ndecomposition into @xmath and @xmath tensors is shown in Fig. 5.8 .\nTensors @xmath and @xmath are graphically represented by means of a\ncircle enclosing an arrow head and three lines emerging from the circle\ncorresponding to the three indices of the tensors. The three lines in\nthe diagrams of @xmath and @xmath correspond to the degeneracy indices\n@xmath and @xmath by using the same assignment rules that were\nintroduced for tensors @xmath and @xmath respectively. Other features of\nthe graphical representation include an arrow head that is placed within\nthe circle to indicate the direction of the fusion and a small\nrectangle, placed on the line carrying the coupled spins, that\nrepresents a permutation of basis elements.\n\nWe notice that tensor @xmath can be decomposed into two pieces. The\nfirst piece (depicted as the circle enclosing an arrow head) expresses a\nbasis @xmath of @xmath as the direct product of the basis @xmath of\n@xmath and the basis @xmath of @xmath . Note that this procedure does\nnot always lead to the set @xmath being ordered such that states\ncorresponding to the same total spin @xmath are adjacent to each other\nwithin the set. However, we require that the basis associated to an\nindex be maintained as such (this ensures, for example, that an\nSU(2)-invariant matrix is block diagonal when expressed in such a\nbasis). This ordering is achieved by means of the second piece (depicted\nas the small rectangle): a permutation of basis states @xmath that\nreorganizes them according to their total spin @xmath , so that they are\nidentified in an one-to-one correspondence with the coupled states\n@xmath . In particular, this description of the tensors @xmath and\n@xmath can be exploited to multiply together several such tensors, such\nas in Fig. 5.12 (iv), in a fast way.\n\nBy construction, a resolution of Identity can be obtained in terms of\ntensor @xmath and tensor @xmath , as shown in Fig. 5.8 (ii)-(iii).\n\nExample 7: Let vector spaces @xmath and @xmath correspond to the vector\nspace of Example 4, that is,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.89)\n  -- -------- -------- -- --------\n\nThe space @xmath decomposes as\n\n  -- -------- -- --------\n     @xmath      (5.90)\n  -- -------- -- --------\n\nwhere,\n\n  -- -------- -- --------\n     @xmath      (5.91)\n  -- -------- -- --------\n\nand\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (5.92)\n     @xmath   @xmath      (5.93)\n  -- -------- -------- -- --------\n\nRecall that the basis of the l.h.s. and r.h.s. of Eq.\u00a0( 5.91 ) are\nrelated by the transformations Eqs.\u00a0( 5.74 )-( 5.77 ). Let us now\nconsider how the basis of the l.h.s. and r.h.s. of Eq.\u00a0( 5.92 ) and of\nEq.\u00a0( 5.93 ) are related. In Eq.\u00a0( 5.92 ), for instance, the vectors\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nare related to the vectors\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nin straightforward way by associating the vectors in a one to one\nfashion in the order in which they appear in the respective basis. For\nexample, the change of basis maps the vector\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand the vector\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand so on. The basis of the l.h.s. and r.h.s. of Eq.\u00a0( 5.93 ) are\nrelated in a similar way. This one to one mapping can be encoded into\n@xmath by setting the numerical value of the following components equal\nto one,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nand\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nExample 8: As another example of the change of basis @xmath , consider\nthat @xmath and @xmath correspond to the vector spaces of Example 3 and\nExample 5 respectively. That is,\n\n  -- -------- -------- -- --------\n     @xmath               \n     @xmath   @xmath      (5.94)\n  -- -------- -------- -- --------\n\nThe space @xmath decomposes as\n\n  -- -------- -- --------\n     @xmath      (5.95)\n  -- -------- -- --------\n\nwhere\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (5.96)\n     @xmath   @xmath      (5.97)\n     @xmath   @xmath      (5.98)\n  -- -------- -------- -- --------\n\nThe transformation that relates the bases of l.h.s. and r.h.s. of Eq.\u00a0(\n5.96 ) and of Eq. 5.98 ) is straightforward, we set\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe basis of the l.h.s. and r.h.s. of Eq.\u00a0( 5.97 ) can be related by\nmapping the three vectors\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nin a one to one manner, to the two vectors\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand the vector\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis is encoded into @xmath by setting\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n### 5.4 Review: Fusion trees\n\nWhen considering the tensor product of more than two representations one\ncan obtain several coupled bases of the product space. These correspond\nto taking the product of the vector spaces according to different\nsequences of pairwise products. The spaces are linearly ordered in a\ngiven way and we only consider a pairwise product of \u2018adjacent\u2019 spaces\nin this linear ordering. For example, when considering the tensor\nproduct of three representations,\n\n  -- -------- -- --------\n     @xmath      (5.99)\n  -- -------- -- --------\n\none can consider either the pairwise products\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.100)\n  -- -------- -------- -- ---------\n\nor the pairwise products\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n     @xmath   @xmath      (5.101)\n  -- -------- -------- -- ---------\n\nConsidering the tensor product one way or the other leads to two\ndifferent coupled bases in @xmath .\n\nMore generally, there exist several choices of a coupled basis in the\ntensor product of @xmath representations, Eqs.\u00a0( 5.55 )-( 5.57 ). A\nuseful way to specify a particular sequence of pairwise products is by\nmeans of a fusion tree .\n\nA fusion tree, denoted @xmath , is a directed trivalent tree such that\neach node of the tree represents the tensor product of two incoming\nspaces into the outgoing space. The tree has a total of @xmath open\nlinks which correspond to the @xmath vector spaces @xmath and the\nproduct space @xmath . The internal links correspond to the intermediate\nproduct spaces that appear in a sequence of pairwise products. Figure\n5.10 illustrates two different fusions trees @xmath and @xmath that\ncorrespond to two different ways of considering the tensor product of\nthree and of four representations. The sequence of fusions proceeds from\ntop to bottom.\n\nA fusion tree can also be specified as a list of fusions. For example,\nthe fusion trees @xmath and @xmath depicted in Fig. 5.10 (i) can be\nspecified as\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nFusion trees play an important role in our discussion. In the present\ncontext, a fusion tree characterizes a coupled basis of a tensor product\nspace. In Sec. 5.5 fusion trees are also used to characterize different\ncanonical decompositions of an SU(2)-invariant tensor.\n\nIn the remainder of the section we consider coupled bases that are\nlabeled by different fusion trees. We define the unitary transformation\nthat relates two such coupled bases. This transformation is important\nsince it also relates two different canonical decompositions of an\nSU(2)-invariant tensor, as discussed in Sec. 5.5 . For purpose of\nillustration, we first characterize the coupled basis in the simple case\nof the tensor product of three representations before proceeding to the\ngeneric case of @xmath representations.\n\n#### 5.4.1 Tensor product of three irreps\n\nLet vector spaces @xmath and @xmath transform as irreps @xmath and\n@xmath respectively. The space @xmath is in general reducible, and may\ncontain several copies of an irrep @xmath . Let us first consider the\nsequence ( 5.100 ) of tensor products corresponding to a fusion tree\n@xmath . The vector spaces @xmath and @xmath decompose as\n\n  -- -------- -- ---------\n     @xmath      (5.102)\n  -- -------- -- ---------\n\nand\n\n  -- -------- -- ---------\n     @xmath      (5.103)\n  -- -------- -- ---------\n\nNotice that we can use the values of @xmath that appear on the r.h.s. of\nEq.\u00a0( 5.102 ) to label different copies of @xmath that appear on the\nr.h.s. of Eq.\u00a0( 5.103 ). Thus, a coupled basis of @xmath can be labeled\nas @xmath .\n\nLet @xmath denote the transformation from the product basis\n@xmath to the coupled basis @xmath . This change of basis can be\nexpressed in terms of Clebsch-Gordan coefficients as\n\n  -- -------- -- ---------\n     @xmath      (5.104)\n  -- -------- -- ---------\n\nwhere @xmath relates the basis @xmath to the intermediate basis @xmath ,\nand @xmath relates this intermediate basis to the coupled basis @xmath .\n\nAlternatively, we can first consider the tensor product @xmath\n(corresponding to the sequence ( 5.101 ) of tensor products\ncharacterized by another fusion tree @xmath ),\n\n  -- -------- -- ---------\n     @xmath      (5.105)\n  -- -------- -- ---------\n\nand use irrep @xmath to label another coupled basis @xmath of @xmath .\nDenote by @xmath the change of basis to this new coupled basis. In terms\nof Clebsch-Gordan coefficients we have\n\n  -- -------- -- ---------\n     @xmath      (5.106)\n  -- -------- -- ---------\n\nThe two coupled bases @xmath and @xmath are related by a transformation\nthat is given by a rank- @xmath tensor @xmath with components @xmath ,\n\n  -- -------- -- ---------\n     @xmath      (5.107)\n  -- -------- -- ---------\n\nHere @xmath are the recoupling coefficients ( Cornwell , 1997 ) of\nSU(2). By using Eqs.\u00a0( 5.104 ) and ( 5.106 ), the recoupling\ncoefficients can be explicitly expressed in terms of Clebsch-Gordan\ncoefficients,\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n              @xmath      \n              @xmath      (5.108)\n  -- -------- -------- -- ---------\n\nwhere @xmath . Notice that, since the @xmath \u2019s are summed over, the\nrecoupling coefficients depend only on the @xmath \u2019s. Also recall that\nthe recoupling coefficients are proportional to the 6-j symbols of the\ngroup,\n\n  -- -------- -- ---------\n     @xmath      (5.109)\n  -- -------- -- ---------\n\nwhere\n\n  -- -------- -- ---------\n     @xmath      (5.110)\n  -- -------- -- ---------\n\n#### 5.4.2 Tensor product of three reducible representations\n\nConsider the action of SU(2) on the space @xmath ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere @xmath and @xmath are reducible representations of SU(2). It\ninduces a decomposition\n\n  -- -------- -- ---------\n     @xmath      (5.111)\n  -- -------- -- ---------\n\nwhere @xmath takes all values that are compatible with any @xmath and\n@xmath .\n\nExtending the argument for irreps, we can relate the coupled basis of\n@xmath to the product basis by first considering the sequence ( 5.100 )\nof tensor products and using two @xmath tensors\n\n  -- -------- -- ---------\n     @xmath      (5.112)\n  -- -------- -- ---------\n\nto relate at each step the coupled basis with the product basis.\nAlternatively, we can consider the sequence ( 5.101 ) of tensor products\nand use the different set of fusing tensors\n\n  -- -------- -- ---------\n     @xmath      (5.113)\n  -- -------- -- ---------\n\nto relate the product basis to the coupled basis at each step. The\nrespective change of basis transformation for the two cases is depicted\nin Fig. 5.12 (i).\n\nThe two coupled bases, so obtained, are related by means of a matrix\n@xmath that decomposes, according to Schur\u2019s Lemma [Eq.\u00a0( 5.46 )] as\n\n  -- -------- -- ---------\n     @xmath      (5.114)\n  -- -------- -- ---------\n\nwhere the components of @xmath can be expressed in terms of recoupling\ncoefficients. This decomposition can be derived as follows.\n\nThe matrix @xmath is obtained by contracting the tensor network made of\ntensors @xmath and tensors @xmath that is shown in Fig. 5.12 (ii). This\ncontraction can be performed piecewise [Fig. 5.12 (iii)]. For fixed\nvalues of @xmath \u2019s on all links the tensor network factorizes into two\npieces since each constituent tensor @xmath and tensor @xmath factorizes\ninto a @xmath and a @xmath tensor. The tensor network made of @xmath\ntensors equates [Fig 5.11 (ii)] the Identity times the recoupling\ncoefficient @xmath . The matrix @xmath in Eq.\u00a0( 5.114 ) is then defined\nas\n\n  -- -------- -- ---------\n     @xmath      (5.115)\n  -- -------- -- ---------\n\nwhere @xmath denotes the matrix that is obtained by contracting together\nthe @xmath tensors. Here the sum is over all values of @xmath and @xmath\nthat are compatible with a given value of @xmath .\n\n#### 5.4.3 Tensor product of @xmath irreps\n\nIn a similar way, we can consider the tensor product of four irreps;\ndifferent choices of a coupled basis, corresponding to different fusion\ntrees, are related by the @xmath symbols and so on.\n\nMore generally, let us consider the tensor product of @xmath\nrepresentations, Eq.\u00a0( 5.55 ), where each space @xmath ( @xmath )\ntransforms as an irrep @xmath . A coupled basis can be labeled by a\nfusion tree @xmath and the set of intermediate irreps @xmath that are\nassigned to the internal links of @xmath . We denote by\n\n  -- -------- -- ---------\n     @xmath      (5.116)\n  -- -------- -- ---------\n\nsuch a basis. By attaching the appropriate Clebsch-Gordan tensor @xmath\nto each node of @xmath and contracting the resulting tree tensor network\nwe can obtain tensors\n\n  -- -------- -- ---------\n     @xmath      (5.117)\n  -- -------- -- ---------\n\nthat mediate the change from the product basis to this coupled basis.\n\nAnother coupled basis @xmath corresponding to a different fusion tree\n@xmath is related to the basis ( 5.116 ) by the transformation\n\n  -- -------- -- ---------\n     @xmath      (5.118)\n  -- -------- -- ---------\n\nwhere the coefficients @xmath can be expressed in terms of the\nrecoupling coefficients [Eq.\u00a0( 5.107 )].\n\nAs an example, consider two different ways of coupling four spins @xmath\nand @xmath according to the fusion trees @xmath and @xmath that are\nshown in Fig. 5.10 (ii). The two coupled bases are related by\ncoefficients @xmath that are defined according to the equality depicted\nin Fig. 5.13 . Note that the tensor network made of Clebsch-Gordan\ntensors, shown in Fig. 5.13 , is an instance of a spin network . In this\ncase, the spin network has two open links and can therefore be regarded\nas an SU(2)-invariant operator. The equality in the figure then simply\ndepicts that the spin network is proportional to the Identity. The\nnumerical value of the coefficient @xmath can be calculated without\ncontracting the spin network, but by instead following a procedure\ncalled evaluating a spin network. Section 5.7 illustrates with simple\nexamples the procedure to evaluate a spin network corresponding to a\ngeneric coefficient @xmath . For instance, it is shown that @xmath can\nbe expressed in terms of two recoupling coefficients,\n\n  -- -------- -- ---------\n     @xmath      (5.119)\n  -- -------- -- ---------\n\n#### 5.4.4 Tensor product of @xmath reducible representations\n\nFinally, consider the tensor product of @xmath reducible\nrepresentations. A coupled basis, labeled by a given fusion tree, is\nrelated to the product basis by means of a transformation that is\nobtained by attaching a tensor @xmath to each node of the fusion tree,\nand contracting the resulting tree tensor network.\n\nTwo different choices of a coupled basis, corresponding to two different\nfusion trees @xmath and @xmath , are related by a matrix @xmath . The\nmatrix @xmath is a generalization of the matrix with the same name that\nappears Eq.\u00a0( 5.114 ). This matrix is obtained by contracting a tensor\nnetwork [e.g. Fig. 5.14 ] made of tensors @xmath and tensors @xmath .\n\nFor a fixed value of the total spin @xmath , matrix @xmath decomposes in\nterms of degeneracy matrices @xmath . The components of the latter can\nbe expressed in terms of recoupling coefficients by generalizing Eq.\u00a0(\n5.115 ). We obtain,\n\n  -- -------- -- ---------\n     @xmath      (5.120)\n  -- -------- -- ---------\n\nwhere the sum runs over all spin labels but excluding @xmath .\n\n### 5.5 Block structure of SU(2)-invariant tensors\n\nIn this section we consider tensors that are invariant under the action\nof the symmetry. We explain how such tensors decompose into a compact\ncanonical form which exploits their symmetry. The canonical form can be\nunderstood as a block structure in the tensor components. In Sec. 5.6 we\nthen adapt the set @xmath of primitive tensor network manipulations to\nwork in this form. With the formalism of SU(2)-invariant tensors at hand\nwe then consider tensor network decompositions made of SU(2)-invariant\ntensors in Sec. 6.1 .\n\n#### 5.5.1 SU(2)-invariant tensors\n\nConsider a rank- @xmath tensor @xmath with indices @xmath and directions\n@xmath . Each index @xmath is associated with a vector space @xmath on\nwhich SU(2) acts by means of transformations @xmath .\n\nAlso consider the action of SU(2) on the space @xmath given by\n\n  -- -------- -- ---------\n     @xmath      (5.121)\n  -- -------- -- ---------\n\nwhere\n\n  -- -------- -- ---------\n     @xmath      (5.122)\n  -- -------- -- ---------\n\n( @xmath denotes the complex conjugate of @xmath .) That is, @xmath acts\ndifferently depending on whether index @xmath is an incoming or outgoing\nindex. We then say that tensor @xmath is SU(2) invariant if it is\ninvariant under the transformation of Eq.\u00a0( 5.121 ). In components we\nhave\n\n  -- -------- -- ---------\n     @xmath      (5.123)\n  -- -------- -- ---------\n\nfor all @xmath .\n\nIn the remainder of this section we explore the consequences of the\nconstraints in Eq.\u00a0( 5.123 ). The main result is as follows. By writing\neach index @xmath of the tensor in a spin basis, @xmath , the tensor is\nrevealed to have a block structure, namely, the non-trivial components\nare organized into blocks that are supported on orthogonal subspaces.\nFor a given value of spin @xmath , the index @xmath splits into a\ndegeneracy index @xmath and a spin index @xmath . An SU(2)-invariant\ntensor @xmath decomposes into a set of degeneracy tensors , denoted by\n@xmath and carrying all the degeneracy indices, and a set of structural\ntensors, denoted @xmath , carrying all the spin indices. The degeneracy\ntensors contain all the degrees of freedom and correspond to the\n\u2018blocks\u2019 alluded above. On the other hand, the structural tensors are\ncompletely determined by the symmetry since they can be factorized into\na trivalent tree tensor network made of Clebsch-Gordan coefficients.\nExamples of structural tensors include Eq.\u00a0( 5.117 ), however, a\nstructural tensor may not generally decompose according to a fusion\ntree. We refer to the decomposition @xmath as the canonical\ndecomposition or the canonical form of tensor @xmath . The main benefit\nof the canonical form lies in the fact that @xmath can be specified\ncompactly by means of only the degeneracy tensors.\n\nIn the ensuing discussion we describe the canonical decomposition of\nSU(2)-invariant tensors on a case by case basis. We explicitly describe\nthe canonical form of SU(2)-invariant tensors with one to three indices.\nThe canonical form in these cases is unique up to overall numerical\nfactors. On the other hand, an SU(2)-invariant tensor with four or more\nindices can be decomposed in several equivalent ways. We illustrate this\nwith examples without resorting to a complete theoretical\ncharacterization of the canonical form in all cases. A more rigorous\ncharacterization is developed Chapter 6 where we consider a special\ncanonical form of SU(2)-invariant tensors, namely, tree decompositions.\nA tree decomposition corresponds to decomposing both the degeneracy\ntensors and the structural tensors according to a fusion tree. We find\nthis decomposition more convenient from an implementation point of view.\nIn Chapter 6, we also describe how to construct a tree decomposition for\nany SU(2)-invariant tensor, how two different tree decompositions of the\nsame tensor are related to one another, and how primitive tensor\nmanipulations are adapted to tree decompositions.\n\n#### 5.5.2 One index\n\nAn SU(2)-invariant tensor @xmath with an outgoing index @xmath fulfills\nthe constraint [Fig. 5.15 (i)]\n\n  -- -------- -- ---------\n     @xmath      (5.124)\n  -- -------- -- ---------\n\nwhere @xmath is the representation of SU(2) on the vector space\nassociated to index @xmath .\n\nLet us now write index @xmath in the spin basis @xmath . Then we have\n\n  -- -------- -- ---------\n     @xmath      (5.125)\n  -- -------- -- ---------\n\nwhere @xmath , shorthand for @xmath , encodes the non-trivial components\nof @xmath . Since the only relevant irrep on the one index is @xmath the\nstructural tensors are trivial. Therefore, tensor @xmath can be stored\ncompactly as @xmath .\n\nOn the other hand, an SU(2)-invariant tensor @xmath with an incoming\nindex @xmath fulfills\n\n  -- -------- -- ---------\n     @xmath      (5.126)\n  -- -------- -- ---------\n\nor equivalently\n\n  -- -------- -- ---------\n     @xmath      (5.127)\n  -- -------- -- ---------\n\nwhere @xmath and @xmath are the complex conjugate and adjoint of @xmath\nrespectively. The canonical form of @xmath is the same as that stated as\nEq.\u00a0( 5.125 ).\n\n#### 5.5.3 Two indices\n\nAn SU(2)-invariant matrix @xmath , possibly rectangular, with indices\n@xmath and @xmath fulfills [Fig. 5.16 (i)]\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n              @xmath      (5.128)\n  -- -------- -------- -- ---------\n\nwhere @xmath and @xmath are the representations of SU(2) on the vector\nspace associated to index @xmath and @xmath respectively. Schur\u2019s Lemma\nestablishes that the matrix @xmath decomposes as\n\n  -- -------- -- ---------\n     @xmath      (5.129)\n  -- -------- -- ---------\n\nwhich can also be written in a block-diagonal form,\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n              @xmath      (5.130)\n  -- -------- -------- -- ---------\n\nHere the sum is over all values @xmath of spin @xmath that are equal to\na value of spin @xmath .\n\nA rank- @xmath SU(2)-invariant tensor @xmath with both incoming indices\n@xmath and @xmath is associated with fusing spins @xmath and @xmath into\na total spin 0. It fulfills [Fig. 5.16 (ii)]\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n              @xmath      (5.131)\n  -- -------- -------- -- ---------\n\nand decomposes as\n\n  -- -------- -- ---------\n     @xmath      (5.132)\n  -- -------- -- ---------\n\nSimilarly, a rank- @xmath SU(2)-invariant tensor with both outgoing\nindices @xmath and @xmath fulfills [Fig. 5.16 (iii)]\n\n  -- -------- -- ---------\n     @xmath      (5.133)\n  -- -------- -- ---------\n\nand decomposes as\n\n  -- -------- -- ---------\n     @xmath      (5.134)\n  -- -------- -- ---------\n\nBoth incoming (or both outgoing) spins @xmath and @xmath are compatible\nwith the total spin 0 only for values @xmath of spin @xmath such that\n@xmath and for values @xmath of @xmath such that @xmath . Therefore, we\ncan recast the canonical decompositions of Eqs.\u00a0( 5.132 )-( 5.134 ) in a\nblock-diagonal form,\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n              @xmath      (5.135)\n  -- -------- -------- -- ---------\n\nwhere @xmath is a @xmath reverse diagonal matrix with diagonal\ncomponents\n\n  -- -------- -- ---------\n     @xmath      (5.136)\n  -- -------- -- ---------\n\nTo summarize, the canonical form of a rank- @xmath SU(2)-invariant\ntensor reads\n\n  -- -------- -- ---------\n     @xmath      (5.137)\n  -- -------- -- ---------\n\nHere @xmath contains the degrees of freedom of @xmath that are not fixed\nby the symmetry, namely, @xmath transforms trivially under the action of\nthe SU(2), Eq.\u00a0( 5.29 ). On the other hand @xmath is determined by the\nsymmetry according to the directions @xmath of indices @xmath and @xmath\n,\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      (5.138)\n              @xmath      (5.139)\n  -- -------- -------- -- ---------\n\nThus, a rank- @xmath SU(2)-invariant tensor @xmath can be stored\ncompactly as\n\n  -- -------- -- ---------\n     @xmath      (5.140)\n  -- -------- -- ---------\n\nExample 10: Consider a rank- @xmath SU(2)-invariant tensor @xmath with\nboth outgoing indices and with each index associated to the vector space\n@xmath of Example 8, @xmath . Tensor @xmath has the canonical form\n\n  -- -------- -- ---------\n     @xmath      (5.141)\n  -- -------- -- ---------\n\nwhere\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n     @xmath   @xmath      \n     @xmath   @xmath      (5.142)\n  -- -------- -------- -- ---------\n\nThe total number of complex coefficients contained in tensor @xmath is\n@xmath . However, the tensor can be stored compactly as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere the total number of complex coefficients that are contained in\ntensors @xmath and @xmath is\n\n  -- -------- -- ---------\n     @xmath      (5.143)\n  -- -------- -- ---------\n\nTherefore, by exploiting the symmetry the number of coefficients that\nneed to be stored is twenty times smaller.\n\n#### 5.5.4 Three indices\n\nConsider a rank- @xmath SU(2)-invariant tensor @xmath with incoming\nindices @xmath and @xmath and outgoing index @xmath . It fulfills [Fig.\n5.17 (i)]\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n                          (5.144)\n  -- -------- -------- -- ---------\n\nwhere @xmath and @xmath are the representations of SU(2) on indices\n@xmath and @xmath respectively. The Wigner-Eckart theorem establishes\nthat @xmath decomposes as\n\n  -- -------- -- ---------\n     @xmath      (5.145)\n  -- -------- -- ---------\n\nThat is, for compatible values of the spins @xmath and @xmath , tensor\n@xmath factorizes into tensor @xmath containing degrees of freedom and a\nClebsch-Gordan tensor that mediates the fusion of spins @xmath and\n@xmath into spin @xmath .\n\nAn SU(2)-invariant tensor @xmath with another combination of incoming\nand outgoing indices has a canonical decomposition that differs in the\nClebsch-Gordan coefficients. For example, if @xmath is an\nSU(2)-invariant tensor with incoming indices @xmath and outgoing indices\n@xmath and @xmath then it fulfills\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n              @xmath      (5.146)\n  -- -------- -------- -- ---------\n\nand decomposes as\n\n  -- -------- -- ---------\n     @xmath      (5.147)\n  -- -------- -- ---------\n\nMore generally, a rank- @xmath SU(2)-invariant tensor with any\ncombination of incoming and outgoing indices decomposes as\n\n  -- -------- -- ---------\n     @xmath      \n     @xmath      (5.148)\n  -- -------- -- ---------\n\nThe block structure can be made more explicit by recasting Eq.\u00a0( 5.148 )\nas\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      \n              @xmath      (5.149)\n  -- -------- -------- -- ---------\n\nwhere we use the direct sum symbol @xmath to denote that the different\ntensors @xmath are supported on orthonormal subspaces of the tensor\nproduct of the spaces associated with indices @xmath and @xmath , and\nwhere the direct sum runs over all compatible values of @xmath and\n@xmath . The components @xmath are determined by the directions @xmath\nof the indices,\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      (5.150)\n     @xmath   @xmath      (5.151)\n     @xmath   @xmath      (5.152)\n     @xmath   @xmath      (5.153)\n     @xmath   @xmath      (5.154)\n     @xmath   @xmath      (5.155)\n     @xmath   @xmath      (5.156)\n     @xmath   @xmath      (5.157)\n  -- -------- -------- -- ---------\n\nwhere @xmath .\n\nTo summarize, a rank- @xmath SU(2)-invariant tensor @xmath can be stored\nin the most compact way as\n\n  -- -------- -- ---------\n     @xmath      (5.158)\n  -- -------- -- ---------\n\nwhere the indices @xmath and @xmath are specified in the spin basis,\n\n  -- -------- -- ---------\n     @xmath      (5.159)\n  -- -------- -- ---------\n\nExample 11: Consider a rank- @xmath SU(2)-invariant tensor @xmath such\nthat each index, @xmath and @xmath , is associated to the vector space\n@xmath of Example 8. Tensor @xmath can be stored by storing the\ndegeneracy tensors,\n\n  -- -------- --\n     @xmath   \n     @xmath   \n  -- -------- --\n\ncorresponding to all compatible values of @xmath and @xmath .\n\nThe total number of complex coefficients that are contained in the\ndegeneracy tensors is @xmath , whereas @xmath components; the reduction\nin the number of coefficients is seventy-five times, much greater than\nthat computed for rank- @xmath tensors in Example 10. In general, the\nsparsity of SU(2)-invariant tensors increases with increasing number of\nindices.\n\n#### 5.5.5 Four indices\n\nA rank- @xmath SU(2)-invariant tensor may be decomposed in several ways\nin terms of degeneracy tensors and structural tensors in correspondence\nwith the existence of different fusion trees for four spins.\n\nConsider a rank- @xmath SU(2)-invariant tensor @xmath with incoming\nindices @xmath and @xmath and outgoing index @xmath . It fulfills\n\n  -- -------- -- ---------\n     @xmath      (5.160)\n  -- -------- -- ---------\n\nwhere @xmath and @xmath are the representations of SU(2) on the indices\n@xmath and @xmath respectively.\n\nTensor @xmath decomposes as\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      (5.161)\n  -- -------- -------- -- ---------\n\nwhere the sum is over all values of the intermediate spin @xmath .\nThe coefficients @xmath [Eq.\u00a0( 5.104 )] mediate the fusion of the spins\n@xmath and @xmath into a total spin @xmath according to a fusion tree,\nfor example, first fusing @xmath and @xmath and then fusing the\nresulting spin with @xmath .\n\nAlternatively, tensor @xmath can be decomposed as\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      (5.162)\n  -- -------- -------- -- ---------\n\nin terms of different structural coefficients @xmath [Eq.\u00a0( 5.106 )]\nthat are associated with fusing the spins according to a different\nfusion tree, namely, fusing spin @xmath with the spin obtained by first\nfusing @xmath and @xmath .\n\nSince Eqs.\u00a0( 5.161 ) and ( 5.162 ) represent the same tensor @xmath ,\nthe tensors @xmath and @xmath are related by\n\n  -- -------- -- ---------\n     @xmath      (5.163)\n  -- -------- -- ---------\n\nwhere @xmath are the recoupling coefficients [Eq. 5.107 ].\n\n#### 5.5.6 @xmath indices\n\nFinally, consider a rank- @xmath SU(2)-invariant tensor @xmath with all\noutgoing indices and which fulfills Eq.\u00a0( 5.123 ). By writing each index\nin a spin basis, @xmath , tensor @xmath can be decomposed as\n\n  -- -------- -- ---------\n     @xmath      (5.164)\n  -- -------- -- ---------\n\nHere tensor @xmath [Eq.\u00a0( 5.117 )] is a transformation characterized by\na fusion tree @xmath whose internal links are decorated by the spins\n@xmath . Another canonical form of the tensor @xmath ,\n\n  -- -------- -- ---------\n     @xmath      (5.165)\n  -- -------- -- ---------\n\ncomprises of different degeneracy tensors @xmath and different\nstructural tensors @xmath where the latter is a transformation\ncharacterized by another fusion tree @xmath .\n\nThe two canonical forms, Eq.\u00a0( 5.164 ) and ( 5.165 ), are related as\n\n  -- -------- -- ---------\n     @xmath      (5.166)\n  -- -------- -- ---------\n\nwhere the coefficients @xmath are those which appear in Eq.\u00a0( 5.118 ).\n\nThus tensor @xmath can be compactly stored as\n\n  -- -------- -- ---------\n     @xmath      (5.167)\n  -- -------- -- ---------\n\nFor an arbitrary combination of incoming and outgoing indices of the\ntensor, the canonical decomposition is characterized by intermediate\nspins @xmath that are assigned to the links of a trivalent tree that is\nmore general than the fusion tree. Furthermore, two canonical\ndecompositions are related by means of more generic spin networks than\nthose considered (See Section 5.7 ) for evaluating the coefficients\n@xmath . A rigorous result is presented in Chapter 6 where we describe\nthe generic transformation that relates two tree decompositions of an\nSU(2)-invariant tensor.\n\n### 5.6 Manipulations of SU(2)-invariant tensors\n\nIn this section we consider manipulations of SU(2)-invariant tensors\nthat belong to the set @xmath [Sec. 5.1.5 ] of primitives: reversal of\nindices, permutation of indices, reshaping of indices and matrix\noperations (matrix multiplication and matrix factorizations). We will\nadapt these manipulations to the presence of the symmetry by\nimplementing them in such a way that the canonical form is maintained.\n\nOur approach will be to describe the basic transformations that are\ninstrumental in implementing the symmetric version of these\nmanipulations and demonstrate their use with simple examples. A more\nrigorous treatment of adapting the primitive tensor manipulations for\nSU(2)-invariant tensors is presented in Chapter 6. The basic\ntransformations are symmetry preserving and can be described by means of\nspecical SU(2)-invariant tensors. Consequently, a symmetric manipulation\ndecomposes into the manipulation of the degeneracy tensors and the\nmanipulation of the structural tensors. Computational cost is incurred\nonly by the manipulation of degeneracy tensors. On the other hand, the\nmanipulation of structural tensors can be performed algebraically by\napplying relevant properties of Clebsch-Gordan coefficients. This fact\nis responsible for obtaining computational speedup from exploiting the\nsymmetry.\n\n#### 5.6.1 Reversal of indices\n\nAn index @xmath of an SU(2)-invariant tensor can be reversed by means of\nthe \u2018cup\u2019 and \u2018cap\u2019 transformations. The cup transformation is given by\na rank- @xmath SU(2)-invariant tensor @xmath with both incoming indices.\nIt can be used to reverse an outgoing index. Analogously, the cap\ntransformation is given by a rank- @xmath SU(2)-invariant tensor @xmath\nwith both outgoing indices and can be used to reverse an incoming index.\n\nIn the canonical form, the cup and cap tensors read as block-diagonal\nmatrices,\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      (5.168)\n     @xmath   @xmath      (5.169)\n  -- -------- -------- -- ---------\n\nwhere @xmath and where\n\n  -- -------- -------- -- ---------\n     @xmath   @xmath      (5.170)\n     @xmath   @xmath      (5.171)\n  -- -------- -------- -- ---------\n\nHere @xmath is the tensor defined in Eq.\u00a0( 5.136 ). By definition, the\ncup transformation inverts the action of the cap transformation and\nvice-versa,\n\n  -- -------- -- ---------\n     @xmath      (5.172)\n  -- -------- -- ---------\n\nReversal of index @xmath of tensor @xmath can be decomposed into the\nreversal of the degeneracy index @xmath of the degeneracy tensors and\nreversal of the spin index @xmath of the structural tensors. Reversal of\nthe degeneracy index is trivial since the cup and cap transformations\nact as the Identity @xmath on it whereas the reversal of the spin index\nis mediated by transformations @xmath and @xmath .\n\nFigure 5.19 (i)-(ii) introduces a graphical representation of the cup\nand cap tensors. The cup tensor is depicted as a small circle with two\nincoming lines (forming a \u2018cup\u2019) whereas a cap tensor is depicted as a\nsmall circle with two outgoing lines (forming a \u2018cap\u2019) ( Baez, ;\nBiamonte et\u00a0al., 2010 ) .\n\nNext, we illustrate how an outgoing index of a tensor can be reversed by\nmeans of the cup transformation. A cap transformation can be used to\nreverse an incoming index in an analogous way.\n\nExample 12: Consider a rank- @xmath SU(2)-invariant tensor @xmath with\noutgoing indices\n@xmath and @xmath and which is given in the canonical form,\n\n  -- -------- -- ---------\n     @xmath      (5.173)\n  -- -------- -- ---------\n\nwhere @xmath assumes all values of @xmath that are equal to a value of\n@xmath . Consider reversing index @xmath of @xmath as shown in Fig. 5.20\n(i). The resulting tensor (or matrix) @xmath is obtained by multiplying\ntensor @xmath with a cup by contracting @xmath . We follow the\nconvention that multiplying with a cup corresponds to bending index\n@xmath upwards from the left in the graphical representation. The same\nindex can be bent upwards from the right by multiplying with the\ntranspose of the cup.\n\nThe resulting matrix @xmath has the canonical form\n\n  -- -------- -- ---------\n     @xmath      (5.174)\n  -- -------- -- ---------\n\nwhere\n\n  -- -------- -- ---------\n     @xmath      (5.175)\n  -- -------- -- ---------\n\nIn order to explain this expression consider Fig. 5.20 (ii) where the\nreversal is depicted as it is performed on the canonical form of @xmath\n. Reversal of the spin index equates to replacing the shaded region by a\nstraight line. This corresponds to applying the following algebraic\nidentity\n\n  -- -------- -- ---------\n     @xmath      (5.176)\n  -- -------- -- ---------\n\nThe factor @xmath is absorbed into the degeneracy tensor @xmath , Eq.\u00a0(\n5.175 ), to obtain the final canonical form.\n\nExample 13: Consider a rank- @xmath SU(2)-invariant tensor @xmath which\nis given in the canonical form,\n\n  -- -------- -- ---------\n     @xmath      (5.177)\n  -- -------- -- ---------\n\nConsider reversing index @xmath of tensor @xmath as shown in Fig. 5.20\n(iii) by multiplying @xmath with a cup such that @xmath is contracted.\nThe canonical form of @xmath reads\n\n  -- -------- -- ---------\n     @xmath      (5.178)\n  -- -------- -- ---------\n\nwhere\n\n  -- -------- -- ---------\n     @xmath      (5.179)\n  -- -------- -- ---------\n\nThe recoupling coefficient @xmath appears due to the reversal of the\nspin index @xmath , as shown in Fig. 5.20 (iv). The Clebsch-Gordan\ntensor and the cup within the shaded region are replaced with another\nClebsch-Gordan tensor and a recoupling coefficient. This is achieved by\napplying a resolution of Identity on spins @xmath and @xmath and\nsimplifying the resulting diagram by applying the equality shown in Fig.\n5.11 (ii).\n\nThe procedure of reversing the spin index illustrated in Example 13 can\nbe applied to reverse a spin index of a generic rank- @xmath\nSU(2)-invariant tensor. Recall that a structural tensor is maintained as\na trivalent tree of Clebsch-Gordan tensors. Reversal of the spin index\ncorresponds to multiplying a cup with a Clebsch-Gordan tensor within\nthis tree. Then, as in Example 13, we proceed by replacing the\nClebsch-Gordan tensor and the cup by another Clebsch-Gordan tensor and a\nrecoupling coefficient. The recoupling coefficient is absorbed into the\ndegeneracy tensor to obtain the canonical form of the resulting tensor.\nIn this way we can reverse an index of a generic rank- @xmath\nSU(2)-invariant tensor.\n\n#### 5.6.2 Permutation of indices\n\nLet us focus on the swap of two adjacent indices of an SU(2)-invariant\ntensor. As mentioned in Sec. 5.1.2 an arbitrary permutation of indices\ncan be applied as a sequence of a number of such swaps.\n\nConsider the swap e.g. Eq.\u00a0( 5.4 ) of two adjacent indices of a rank-\n@xmath SU(2)-invariant tensor @xmath that is given in the canonical\nform,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen tensor @xmath that is obtained as result of swapping indices @xmath\nand @xmath has the canonical form\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere\n\n  -- -------- -- ---------\n     @xmath      (5.180)\n  -- -------- -- ---------\n\nHere @xmath is a rank- @xmath SU(2)-invariant tensor with components\n@xmath ,\n\n  -- -------- -- ---------\n     @xmath      (5.181)\n  -- -------- -- ---------\n\nwhich mediates the swap of the spin indices @xmath and @xmath that fuse\ninto index @xmath , see Fig. 5.21 . That is,\n\n  -- -------- -- ---------\n     @xmath      (5.182)\n  -- -------- -- ---------\n\n(The same tensor @xmath also relates, in a similar way, tensor @xmath\nand tensor @xmath .)\n\nWhen swapping two adjacent indices of a generic rank- @xmath tensor the\ndegeneracy tensors @xmath and @xmath are also related directly by the\nswap tensor @xmath , such as in Eq.\u00a0( 5.180 ), if we work in a canonical\nform in which the indices that are swapped belong to the same node of\nthe trivalent tree that characterizes the canonical form.\n\nNotice how the canonical form of an SU(2)-invariant tensor facilitates a\ncomputational speedup for permutation of indices: permuting indices of\nthe tensor is reduced to permuting indices of the much smaller\ndegeneracy tensors. Figure 5.25 illustrates the computational speedup\ncorresponding to a permutation of indices performed using our reference\nimplementation MATLAB. In this implementation permutation of several\nindices is performed without necessarily breaking the permutation into\nswaps, see Sec. 6.0.4 in Chapter 6.\n\nOne can also consider manipulations that involve both reversing indices\nand permuting them. In this context it is useful to note that these\nmanipulations \u201ccommute\u201d with one another, as illustrated in Fig. 5.22 .\n\n#### 5.6.3 Reshape of indices\n\nThe transformation that implements the reshape of indices of an\nSU(2)-invariant tensor depends on the directions of the indices. We\nanalyze three distinct cases. First, we consider fusion of two outgoing\nindices into an outgoing index and splitting of an outgoing index into\ntwo outgoing indices. Second, we consider the analogous reshape of\nincoming indices. And third, we consider the fusion of an incoming index\nwith an outgoing index.\n\nLet us consider the fusion e.g. Eq.\u00a0( 5.5 ) of two outgoing indices of\nan SU(2)-invariant tensor @xmath . In order to obtain the reshaped\ntensor @xmath in a canonical form it is required that the fused index be\nmaintained in the spin basis. However, the direct product of indices\n@xmath may result in an index that does not label a spin basis.\nTherefore, we fuse indices by multiplying @xmath with the fusing tensor\n@xmath such that indices @xmath and @xmath are contracted [Fig.\u00a0( 5.23\n(i))],\n\n  -- -------- -- ---------\n     @xmath      (5.183)\n  -- -------- -- ---------\n\nor in the canonical form [Fig. 5.23 (ii)] ,\n\n  -- -------- -- ---------\n     @xmath      (5.184)\n  -- -------- -- ---------\n\nNotice that the fusion of the spin indices, here, is straightforward. We\nproceed by multiplying with tensor @xmath and replacing the resulting\n\u2018loop\u2019 in the figure with a straight line [Fig. 5.7 (ii)]. The fusion of\ntwo adjacent indices of a generic rank- @xmath SU(2)-invariant tensor\nfollows a straightforward generalization of Eq.\u00a0( 5.186 ). By working in\na canonical form that is characterized by a trivalent tree in which the\ntwo indices belong to the same node, the fusion of the spin indices\ninvolves a simple loop elimination, similar to the one illustrated in\nFig. 5.23 (ii).\n\nThe original tensor @xmath can be recovered from @xmath by splitting the\nindex @xmath back into indices @xmath and @xmath . This is achieved by\nmultiplying tensor @xmath with the splitting tensor @xmath such that\n@xmath is contracted [Fig. 5.23 (iii)],\n\n  -- -------- -- ---------\n     @xmath      (5.185)\n  -- -------- -- ---------\n\nor in the canonical form [Fig. 5.23 (iv)],\n\n  -- -------- -- ---------\n     @xmath      (5.186)\n  -- -------- -- ---------\n\nNotice that the sum in Eq.\u00a0( 5.186 ) implies that a reshaped tensor\n@xmath involves a linear combination of several tensors @xmath . Thus,\nperforming the fusion in the canonical form requires more work than\nreshaping regular indices which is a simple rearrangement of the tensor\ncomponents. As a result, fusing indices of SU(2)-invariant tensors can\nbe more expensive than fusing indices of regular tensors, as illustrated\nin Fig. 5.25 for a reshaping done in MATLAB.\n\nNext, let us consider fusing two incoming indices into a single incoming\nindex. This can be done in one of two equivalent ways. The first\ninvolves multiplying the tensor with a splitting tensor by contracting\nthe two incoming indices. Equivalently, if one prefers to use the fusing\ntensor , one can reverse the two indices, multiply with the fusing\ntensor, and finally reverse the fused index. The two approaches are\ndepicted in Fig. 5.24 (i). The fused index can be split back into the\noriginal indices by reverting the fusion. In the first approach this is\ndone by multiplying with a fusing tensor while in the second approach\nthis is done by multiplying with a splitting tensor and then reversing\nthe two indices [Fig. 5.24 (ii)].\n\nFinally, consider the fusion of an incoming index with an outgoing index\nto produce, say, an outgoing index. This can be achieved by reversing\nthe incoming index and then fusing the indices by means of a fusing\ntensor. The fused index should be split in a consistent manner by\nreverting this fusion procedure.\n\n#### 5.6.4 Multiplication of two matrices\n\nLet @xmath and @xmath be two SU(2)-invariant matrices given in the\ncanonical form\n\n  -- -------- -- ---------\n     @xmath      (5.187)\n  -- -------- -- ---------\n\nThen the SU(2)-invariant matrix @xmath obtained by multiplying together\nmatrices @xmath and @xmath has the canonical form\n\n  -- -------- -- ---------\n     @xmath      (5.188)\n  -- -------- -- ---------\n\nwhere @xmath is obtained by multiplying matrices @xmath and @xmath ,\n\n  -- -------- -- ---------\n     @xmath      (5.189)\n  -- -------- -- ---------\n\nClearly, computational gain is obtained as a result of performing the\nmultiplication @xmath block-wise. This is illustrated by the following\nexample.\n\nExample 13 : (Computational gain from blockwise multiplication) Consider\nvector space @xmath that decomposes as @xmath where @xmath assumes\nvalues @xmath and let @xmath . The dimension of the space @xmath is\n@xmath where @xmath .\n\nConsider an SU(2)-invariant matrix @xmath . Since there are @xmath\nblocks @xmath and each block has size @xmath , the SU(2)-invariant\nmatrix @xmath contains @xmath coefficients. For comparison, a regular\nmatrix of the same size contains @xmath coefficients, a number greater\nby a factor of @xmath .\n\nLet us now consider multiplying two such matrices. We use an algorithm\nthat requires @xmath computational time to multiply two matrices of size\n@xmath . The cost of performing @xmath multiplications of @xmath blocks\nin Eq. 5.189 scales as @xmath . In contrast the cost of multiplying two\nregular matrices of the same size scales as @xmath , requiring @xmath\ntimes more computational time. Figure 5.26 shows a comparison of the\ncomputation times when multiplying two matrices for both SU(2)-invariant\nand regular matrices.\n\n#### 5.6.5 Factorization of a matrix\n\nThe factorization of an SU(2)-invariant matrix @xmath can also benefit\nfrom the block-diagonal structure. Consider, for instance, the singular\nvalue decomposition (SVD), @xmath , where @xmath and @xmath are unitary\nmatrices and @xmath is a diagonal matrix with non-negative components.\nIf @xmath has the canonical form\n\n  -- -------- -- ---------\n     @xmath      (5.190)\n  -- -------- -- ---------\n\nwe can obtain the SU(2)-invariant matrices\n\n  -- -------- --\n     @xmath   \n     @xmath   \n     @xmath   \n  -- -------- --\n\nby performing SVD of each degeneracy matrix @xmath independently,\n\n  -- -------- -- ---------\n     @xmath      (5.191)\n  -- -------- -- ---------\n\nA different factorization of @xmath , such as spectral decomposition or\npolar decomposition, can be obtained by the analogous factorization of\nthe blocks @xmath . The computational savings are analogous to those\ndescribed in Example 13 for the multiplication of matrices. Figure 5.26\nshows a comparison of computation times required to perform a singular\nvalue decomposition on SU(2)-invariant and regular matrices using\nMATLAB.\n\n### 5.7 Supplement: Examples of evaluating a spin network\n\nLet us consider a spin network @xmath that is constructed by means of\ntwo fusion trees @xmath and @xmath in the following way. First obtain a\ntree tensor network @xmath by attaching a tensor @xmath to each node the\nfusion tree @xmath . A tensor @xmath mediates the fusion of the incoming\nspins into the outgoing spin. Next, obtain the splitting tree that is\ndual to @xmath . A splitting tree is obtained by reversing the direction\nof all links of a fusion tree. In the graphical representation this\ncorresponds to a horizontal reflection of the fusion tree. Then obtain a\ntree tensor network @xmath by attaching to each node of the splitting\ntree a tensor @xmath that mediates the splitting of the incoming spin\ninto outgoing spins. The spin network @xmath is obtained by connecting\nthe open links of the two tree tensor networks: @xmath and @xmath .\n\nSince the spin network @xmath has two open links it can be contracted to\nobtain an SU(2)-invariant matrix, which according to Schur\u2019s lemma is\nproportional to the Identity. An important property of @xmath is that\nthis proportionality factor can be evaluated algebraically without\ncontracting the spin network. This property can be exploited to suppress\nthe potentially high cost of contracting spin networks in numerical\nsimulations.\n\nThe spin network @xmath can be evaluated in terms of the values of basic\nspin networks that are shown in Fig. 5.7 (ii) and Fig. 5.11 (ii). The\nfirst step of the evaluation procedure generally involves expressing the\nspin network as a composition of these basic spin networks. This can be\nachieved by applying, possibly several times, a resolution of Identity,\nFig. 5.7 (i), on appropriate links of the spin network. Then one\nproceeds by recursively applying the equalities in Fig. 5.7 (ii) and\nFig. 5.11 (ii) to regions of the spin network, eventually replacing the\nspin network with a straight line and an overall numerical factor.\nFigure 5.27 (i) illustrates these steps for the simple case of\nevaluating the spin network of Fig. 5.13 in terms of two recoupling\ncoefficients.\n\nWe can also consider spin networks that have intercrossing lines such as\nthose which appear when applying permuting indices of an SU(2)-invariant\ntensor. Such a spin network can be evaluated in terms of recoupling\ncoefficients and swap factors, as illustrated in Fig. 5.27 (ii).\n\n## Chapter 6 Implementation of non-Abelian symmetries \\@slowromancapii@\n\nIn this chapter we will describe a specific scheme for implementing\nnon-Abelian symmetries. Our implementation is based on a special\ncanonical form, the tree decomposition , of symmetric tensors.\n\nA tree decomposition of a symmetric tensor corresponds to representing\nand storing the tensor as a tree tensor network made of two parts: (i) a\nsymmetric vector and (ii) possibly several splitting tensors @xmath . We\ndescribe how to implement the tensor manipulations within the set @xmath\nof primitive operations based on tree decompositions. In a tree\ndecomposition, reshape and permutation of indices take a very simple\nform. In order to obtain the vector of the output tensor, one needs to\nsimply multiply the vector of the initial tree decomposition with a\nmatrix @xmath [Fig 5.13 (ii)] that depends only on the permutation or\nreshape.\n\nThis approach offers several advantages. Reshapes and permutations can\nbe performed without breaking them into pairwise fusions and swaps, as\nwas described in the previous chapter. More importantly, one can\nprecompute (that is, compute before running the algorithm) the matrices\n@xmath since these do not depend on the actual components of the tensor\nbeing manipulated. This is of special advantage in the case of iterative\nalgorithms, where by pre-computing these matrices one also eliminates\nthe cost of evaluating spin networks at runtime, thus substantially\nreducing the computational costs.\n\n#### 6.0.1 Tree decompositions of SU(2)-invariant tensors\n\nConsider a rank- @xmath SU(2)-invariant tensor @xmath with indices\n@xmath and directions @xmath . Let us apply the following\ntransformations on tensor @xmath to obtain a vector. First reverse all\nincoming indices of @xmath to obtain another tensor @xmath . Then fuse\nthe indices of @xmath according to a given fusion tree @xmath to obtain\nan SU(2)-invariant vector @xmath . This gives rise to a decomposition of\ntensor @xmath in terms of the vector @xmath , a set of splitting tensors\nthat revert the fusion sequence @xmath , and a set of cup tensors that\nreverse the split indices that are identified with the incoming indices\nof @xmath . We refer to such a decomposition as a tree decomposition of\n@xmath and denote it as @xmath . It is completely specified by the\nfollowing list of elements:\n\n  -- -------- -- -------\n     @xmath      (6.1)\n  -- -------- -- -------\n\nHere the fusion tree @xmath determines the splitting tensors that are\npart of the decomposition while the directions @xmath indicate the\npresence or absence of a cup tensor on the open indices of the tree\ndecomposition.\n\nA tree decomposition of a rank- @xmath SU(2)-invariant tensor is shown\nin Fig. 6.1 . The tree decomposition in the diagram can be specified as,\n\n  -- -------- -- -------\n     @xmath      (6.2)\n  -- -------- -- -------\n\nwhere\n\n  -- -------- -------- --\n     @xmath   @xmath   \n  -- -------- -------- --\n\nIn the graphical representation of a tree decomposition @xmath the\nvector @xmath appears at the top of the tree, the \u2018body\u2019 of the tree\ncomprises of splitting tensors that are connected according to the\nfusion tree @xmath and the indices @xmath are associated, from left to\nright, to the open lines at the bottom of the tree. Some open indices\nare bent upwards by attaching cup tensors. A value @xmath indicates a\ncup tensor is attached to index @xmath while @xmath indicates its\nabsence. We additionally denote by @xmath that the transpose of a cup\ntensor is attached to index @xmath . In the graphical representation,\nthe values @xmath or @xmath correspond to bending the index @xmath\nupwards from the left or from the right respectively.\n\nThe vector @xmath is obtained by applying an resolution of Identity,\ndenoted @xmath , on tensor @xmath , as shown on the r.h.s. of Fig. 6.1 .\nThe resolution of Identity @xmath is given by a tensor network made of a\nset of fusing tensors, that fuse the indices of @xmath according to the\nfusion tree @xmath , and the corresponding set of splitting tensors that\ninverts the fusion. The vector @xmath is obtained by contracting @xmath\nwith the fusing tensors.\n\nWe emphasize that the cup tensors are stored as part of the tree\ndecomposition without consuming them into the tree. This is done to\nsimplify reshape and permutation of indices of a tree decomposition\nsince these operations can be performed without noticing the cup\ntensors. For instance, in order to permute the open indices of a tree\ndecomposition one may proceed by detaching any cup tensors from the\ntree, permuting the indices and re-attaching the cup tensors to the\nupdated tree, a direct application of the commutation property depicted\nin Fig. 5.22 . On the other hand, manipulations that involve summing\nover an index that is attached to a cup tensor are an exception. For\nexample, when multiplying two SU(2)-invariant matrices, each given as a\ntree decomposition, the cup tensor has to be properly considered to\nobtain the resultant matrix. This is discussed in Sec. 6.0.6 .\n\n#### 6.0.2 Mapping between tree decompositions\n\nThe same tensor @xmath may be expressed in different tree decompositions\ncorresponding to different choices of the fusion tree. Two different\nfusion trees @xmath and @xmath lead to two different tree decompositions\n@xmath and @xmath of the same tensor @xmath . As an example we show two\ndifferent but equivalent tree decompositions of a rank- @xmath tensor in\nFig. 6.2 (i). The two decompositions\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nare obtained by applying on the tensor the resolutions of Identity\n@xmath and @xmath respectively that are separately depicted in Fig. 6.2\n(ii).\n\nSuppose now that we have a tensor @xmath in a tree decomposition @xmath\nand we wish to transform it into another tree decomposition @xmath . We\nfind it convenient to obtain the vector @xmath in steps, as shown in\nFig. 6.3 . First detach all cup tensors from @xmath and apply the\nresolution of Identity @xmath on the open indices of the tree. Then\ncontract the splitting tensors in @xmath and the fusing tensors in\n@xmath to obtain a matrix @xmath . The new vector @xmath can be obtained\nby multiplying @xmath with the matrix @xmath ,\n\n  -- -------- -- -------\n     @xmath      (6.3)\n  -- -------- -- -------\n\nThus, the matrix @xmath can be used to map from one tree decomposition\nof an SU(2)-invariant tensor into another tree decomposition of the same\ntensor. Recall that the components of @xmath can be expressed in terms\nof recoupling coefficients [Fig. 5.14 , Eq.\u00a0( 5.120 )].\n\nTo summarize the above procedure we define a template routine NEWTREE\nthat takes as input a tree decomposition @xmath and a fusion tree @xmath\nand returns the tree decomposition @xmath of the tensor. The routine\nreads\n\n  -- -------- -- -------\n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      (6.4)\n  -- -------- -- -------\n\n(where @xmath denotes \u2018stored as\u2019.)\n\nRecall that the matrix @xmath is sparse [Eq.\u00a0( 5.115 )]. It can be shown\nthat the matrix-vector multiplication, Eq.\u00a0( 6.3 ), can be performed\nwith a cost that is @xmath by means of sparse multiplication.\n\nNext we describe how manipulations in the set @xmath of primitive tensor\nmanipulations [Sec. 5.1.5 ] are performed on tree decompositions.\nConsider an SU(2)-invariant tensor @xmath that has been given as a tree\ndecomposition @xmath ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nLet @xmath denote the SU(2)-invariant tensor that is obtained from\ntensor @xmath as a result of a manipulation in @xmath . Also, let @xmath\ndenote a tree decomposition of @xmath ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe will describe how the components of vector @xmath are determined\nsystematically in terms of components of the vector @xmath .\n\n#### 6.0.3 Reversal of indices\n\nReversal of an index of a tree decomposition is trivial since the cup\ntensors are stored as part of the tree decomposition. It corresponds to\nattaching a cup (or its transpose) to the corresponding open index of\nthe tree in case the index is outgoing or detaching the cup from the\nindex in case it is incoming. This simple procedure is summarized in the\nfollowing template routine which describes reversal of possibly several\nindices of tensor @xmath according to new directions @xmath provided as\ninput. No computation is involved in the procedure. Only information\npertaining to the directions of indices is updated,\n\n  -- -------- -- -------\n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n                 \n     @xmath      \n     @xmath      (6.5)\n  -- -------- -- -------\n\n#### 6.0.4 Permutation of indices\n\nThe procedure to permute indices of a tree decomposition is illustrated\nin Fig. 6.4 (i). We consider a rank- @xmath SU(2)-invariant tensor with\nindices @xmath and apply a permutation p ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe permutation is depicted by intercrossing index @xmath and index\n@xmath of the tree. This crossing can be \u2018absorbed\u2019 into the tree by\napplying the resolution of Identity @xmath on the tree. In order to\ndetermine the vector @xmath we contract the splitting tensors in @xmath\nand the fusing tensors in @xmath to obtain a matrix @xmath , which is\nthen multiplied with the initial vector @xmath ,\n\n  -- -------- -- -------\n     @xmath      (6.6)\n  -- -------- -- -------\n\nClearly, the above procedure can be employed to apply any permutation p\non the indices of a rank- @xmath SU(2)-invariant tensor. Matrix @xmath\nis a generalization of matrix @xmath [e.g. Fig. 5.14 ] in that it\nadditionally includes a permutation of indices. The latter can then be\nseen as a special instance of @xmath with a trivial permutation of\nindices. The components of the degeneracy part @xmath of matrix @xmath\nare given by Eq.\u00a0( 5.120 ) where coefficients @xmath can be expressed in\nterms of recoupling coefficients and swap factors (see Sec. 5.7 ).\n\nFinally, note that the cup tensors do not play any role in the\npermutation since reversal of indices commutes with a permutation of\nthem [Fig. 5.22 ]. In practice, all cup tensors can be detached from the\ntree before applying the permutation and then re-attached to the updated\ntree.\n\nThe procedure to permute indices of a tree decomposition is summarized\nin the following template routine:\n\n  -- -------- -- -------\n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      (6.7)\n  -- -------- -- -------\n\n#### 6.0.5 Reshape of indices\n\nConsider fusing a pair of adjacent indices @xmath and @xmath of the tree\ndecomposition @xmath . Let us suppose that indices @xmath and @xmath do\nnot carry cup tensors and also that they belong to the same node in\n@xmath . Indices @xmath and @xmath can be fused into an index @xmath by\napplying the tensor @xmath and using the equality shown in Fig. 5.9 (i)\nto immediately obtain the tree decomposition @xmath . This is\nillustrated in Fig. 6.5 (i). Note that the final vector @xmath is the\nsame as the initial vector @xmath . The updated fusion tree @xmath can\nbe obtained from @xmath by deleting the node @xmath from @xmath . We\ndenote this as,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe original tree decomposition may be recovered from @xmath by\nsplitting index @xmath back into indices @xmath and @xmath . This\noperation is again straightforward since it does not involve a\ncomputation of vector components, as illustrated in Fig. 6.5 (ii). The\noriginal fusion tree @xmath is recovered by concatenating a node to\n@xmath ,\n\n  -- -------- -- -------\n     @xmath      (6.8)\n  -- -------- -- -------\n\nNow let us consider fusing indices @xmath and @xmath that do not belong\nto the same node of @xmath . In this case one can first map @xmath into\nanother tree decomposition @xmath in which indices @xmath and @xmath\nbelong to the same node and then proceed with the fusion on the tree\n@xmath as described above. This can be done by applying the procedure\nNEWTREE ( 6.4 ) with inputs @xmath and the desired fusion tree.\n\nConsider the template routine FUSE that fuses indices according to a set\nof disjoint fusion trees @xmath where each fusion tree specifies fusion\nof a subset of adjacent indices @xmath :\n\n  -- -------- -- -------\n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      (6.9)\n  -- -------- -- -------\n\nNotice that here we essentially apply the total fusion at once by\nconcatenating the input fusion trees @xmath into a single tree and then\napplying the procedure NEWTREE. Consequently, the fusion is carried out\nby means of a single matrix-vector multiplication. Furthermore, the\ncomputational cost incurred by the procedure is dominated by the cost of\nthis step. As mentioned previously, this cost is @xmath .\n\nAlso consider the following routine to split indices @xmath of a tree\ndecomposition @xmath (typically the output of FUSE) by reversing the\nfusion sequence encoded in fusion trees @xmath :\n\n  -- -------- -- --------\n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      \n                 \n     @xmath      \n     @xmath      \n     @xmath      \n     @xmath      (6.10)\n  -- -------- -- --------\n\nNote that no computation of vector components is involved in this\nprocedure.\n\nLet us now describe how to reshape indices that may carry cup tensors.\nFirst consider the fusion of indices each of which carries a cup tensor.\nWe proceed by detaching the cup tensors from the indices, applying the\nprocedure FUSE and finally attaching a cup tensor to each of the fused\nindices. Analogously, an index that carries a cup tensor may be split\ninto two indices, by detaching the cup tensor, applying the procedure\nSPLIT and attaching a cup tensor to each of two indices so obtained.\n\nFinally, consider the fusion of an index that carries a cup tensor with\nan index that does not carry a cup tensor. The fusion proceeds by\ndetaching the cup tensor and then applying the procedure FUSE on the\nindices. The fusion is to be reversed in a consistent manner by first\napplying the procedure SPLIT on the fused index and then attaching a cup\ntensor to the originally incoming index.\n\n#### 6.0.6 Matrix multiplication and factorizations\n\nLet us consider how matrix operations are performed on tree\ndecompositions. Two SU(2)-invariant matrices, each given as a tree\ndecomposition, may be multiplied together by first obtaining the\nmatrices in a block-diagonal form (from the respective tree\ndecompositions), performing a block-wise multiplication (Sec. 5.6.4 )\nand recasting the resulting block-diagonal matrix into a tree\ndecomposition.\n\nAn SU(2)-invariant matrix may be factorized e.g. singular value\ndecomposed in a similar way. One proceeds by obtaining the matrix in a\nblock-diagonal form, performing block-wise factorization (Sec. 5.6.5 ),\nand recasting each of the factor block-diagonal matrices into a tree\ndecomposition.\n\nIn the remainder of the section we explain how a block-diagonal form is\nobtained from a tree decomposition and vice-versa.\n\n##### 6.0.6.1 Block-diagonal matrix from the tree decomposition\n\nConsider a tree decomposition @xmath of an SU(2)-invariant matrix @xmath\n. The decomposition @xmath comprises of a vector @xmath , a splitting\ntensor @xmath and a cup tensor @xmath . We wish to obtain, from @xmath ,\nthe corresponding block diagonal matrix,\n\n  -- -------- -- --------\n     @xmath      (6.11)\n  -- -------- -- --------\n\nThis can be achieved by multiplying together the vector, the splitting\ntensor and the cup tensor. We perform this multiplication in two simple\nsteps as shown in Fig. 6.6 . We first multiply @xmath with @xmath to\nobtain an intermediate SU(2)-invariant tensor @xmath that takes the\ncanonical form,\n\n  -- -------- -- --------\n     @xmath      (6.12)\n  -- -------- -- --------\n\nwhere the components @xmath of @xmath are given by\n\n  -- -------- -- --------\n     @xmath      (6.13)\n  -- -------- -- --------\n\nWe then multiply (algebraically) tensor @xmath with the cup tensor to\nobtain the block-diagonal matrix @xmath to obtain\n\n  -- -------- -- --------\n     @xmath      (6.14)\n  -- -------- -- --------\n\n##### 6.0.6.2 Tree decomposition from the block-diagonal matrix\n\nThe tree decomposition @xmath can be obtained from the block-diagonal\nform ( 6.11 ) in a straightforward manner by reverting the previous\nprocedure. We first multiply @xmath with a cap tensor to obtain tensor\n@xmath . Once again, the outcome of this multiplication follows\nalgebraically. We obtain\n\n  -- -------- -- --------\n     @xmath      (6.15)\n  -- -------- -- --------\n\nWe then fuse the indices of @xmath to obtain a vector @xmath ,\n\n  -- -------- -- --------\n     @xmath      (6.16)\n  -- -------- -- --------\n\nThe tree decomposition @xmath comprises of vector @xmath , the splitting\ntensor @xmath that reverts the fusion in Eq.\u00a0( 6.16 ) and a cup tensor.\n\n#### 6.0.7 Multiplication of two tensors\n\nWe can now consider the multiplication of two SU(2)-invariant tensors by\nbreaking it into a sequence of five elementary steps consisting of\nreversals, permutes, reshapes and matrix multiplication, as was\nexemplified in Sec. 5.1.3 and Fig. 5.4 . Here the elementary steps are\nperformed on the tree decompositions of tensors. Figure 6.7 illustrates\nthe five steps of the tensor multiplication, Eq.\u00a0( 5.8 ), as adapted to\ntree decompositions. For simplicity, we have not shown the tree\ndecompositions in the figure and the circle that depicts a tensor can be\nimagined to mask the tree decomposition of the tensor.\n\n#### 6.0.8 Discussion on computational performance\n\nThe core of obtaining computational gain from exploiting the symmetry\nlies in block-wise matrix operations [Fig. 5.26 ] while permutation and\nreshape of indices are applied mainly to obtain block-diagonal matrices\nfrom tensors. As has been illustrated in Fig. 5.25 the cost of\nreshaping, for instance, SU(2)-invariant tensors can be significantly\nlarger than that incurred in reshaping regular tensors, and in some case\ncan lead to a severe degradation of the overall gain obtained by\nexploiting the symmetry. Let us analyze the cost associated to reshape\nand permutation of indices of an SU(2)-invariant tensor.\n\nWe have described that by working on tree decompositions reshape and\npermutation of indices equates to multiplying a matrix @xmath with a\nvector. The computation of @xmath may be costly since it generally\ninvolve evaluating many spin networks, see Fig. 6.8 . Consequently, the\ncost of reshaping or permuting tensors with a large number of indices\nmay become significant. This is more so the case for iterative\nalgorithms where a fixed set of manipulations repeat many times. For\nexample, one may optimize tensors iteratively in a variational algorithm\nsuch that the components of the tensor are updated in the current\niteration and used as an input to the subsequent iteration. Note that\neach iteration involves evaluating a large number of spin networks,\nalbeit the same spin networks are evaluated in each iteration. This fact\ncan be exploited to pre-compute the transformations @xmath once, say in\nthe first iteration of the algorithm, and storing them in memory for\nreuse in subsequent iterations. By precomputation of these matrices the\ncost of evaluating many spin networks is suppressed from the runtime\ncosts.\n\nIn our MATLAB implementation the use of such a precomputation scheme\nresulted in a significant speed-up of simulations at the cost of storing\nadditional amounts of precomputed data. In the passing we also remark\nthat since all computations have been reduced to matrix operations,\ncomputational performance can also be potentially enhanced by\nparallelizing and vectorizing the underlying matrix operations.\n\n### 6.1 Tensor networks with SU(2) symmetry: A practical demonstration\n\nConsider a lattice @xmath made of @xmath sites where each site @xmath is\ndescribed by a vector space @xmath that transforms as a finite\ndimensional representation of SU(2). The vector space @xmath of the\nlattice is given as\n\n  -- -------- -- --------\n     @xmath      (6.17)\n  -- -------- -- --------\n\nConsider a state @xmath that is invariant, Eq. 5.60 , under the action\nof SU(2) on the vector space @xmath . We describe @xmath by means of a\ntensor network made of SU(2)-invariant tensors.\n\nIt readily follows that the tensor obtained by contracting such a tensor\nnetwork is SU(2)-invariant, as illustrated in Fig. 6.9 .\n\nOn the one hand, by storing each constituent tensor of the tensor\nnetwork in a canonical form we can ensure a compact tensor network\ndescription of @xmath . On the other, computational speedup can be\nobtained by exploiting the sparse canonical form of the tensors when\nperforming manipulations of individual tensors in a tensor network\nalgorithm.\n\nIn the remainder of the section we illustrate the implementation of\nSU(2) symmetry in tensor network algorithms with practical examples. We\ndo so in the context of the Multi-scale Entanglement Renormalization\nAnsatz, or MERA, and present numerical results from our reference\nimplementation of SU(2) symmetry in MATLAB.\n\n#### 6.1.1 Multi-scale entanglement renormalization ansatz\n\nFigure 6.10 shows a MERA that represent states @xmath of a lattice\n@xmath made of @xmath sites. Recall that the MERA is made of layers of\nisometric tensors, known as disentanglers @xmath and isometries @xmath ,\nthat implement a coarse-graining transformation. In this particular\nscheme, isometries map three sites into one and the coarse-graining\ntransformation reduces the @xmath sites of @xmath into two sites using\ntwo layers of tensors. A collection of states on these two sites is then\nencoded in a top tensor @xmath , whose upper index @xmath is used to\nlabel @xmath states @xmath . This particular arrangement of tensors\ncorresponds to the 3:1 MERA described in (Evenbly and Vidal, 2009a ) .\nWe will consider a MERA analogous to that of Fig. 6.10 but with @xmath\nlayers of disentanglers and isometries, which we will use to describe\nstates on a lattice @xmath made of @xmath sites.\n\nWe will use the MERA as a variational ansatz for ground states and\nexcited states of quantum spin models described by a local Hamiltonian\n@xmath . In order to find an approximation to the ground state of @xmath\n, we set @xmath and optimize the tensors in the MERA so as to minimize\nthe expectation value\n\n  -- -------- -- --------\n     @xmath      (6.18)\n  -- -------- -- --------\n\nwhere @xmath is the pure state represented by the MERA. In order to find\nan approximation to the @xmath eigenstates of @xmath with lowest\nenergies, we optimize the tensors in the MERA so as to minimize the\nexpectation value\n\n  -- -------- -- --------\n     @xmath      (6.19)\n  -- -------- -- --------\n\nThe optimization is carried out using the MERA algorithm described in\n(Evenbly and Vidal, 2009a ) , which requires contracting tensor networks\n(by sequentially multiplying pairs of tensors) and performing singular\nvalue decompositions.\n\n#### 6.1.2 MERA with SU(2) symmetry\n\nAn SU(2)-invariant version of the MERA, or SU(2) MERA for short, is\nobtained by simply considering SU(2)-invariant versions of all of the\nisometric tensors, namely the disentanglers @xmath , isometries @xmath ,\nand the top tensor @xmath . This requires assigning a spin operator to\neach index of the MERA. We can characterize the spin operator by two\nvectors, @xmath and @xmath : a list of the different values the spin\ntakes and the degeneracy associated with each such spin, respectively.\nFor instance, an index characterized by @xmath and @xmath is associated\nto a vector space @xmath that decomposes as @xmath with @xmath and\n@xmath .\n\nLet us explain how a spin operator is assigned to each link of the MERA.\nEach open index of the first layer of disentanglers corresponds to one\nsite of @xmath . The spin operator on any such index is therefore given\nby the quantum spin model under consideration. For example, a lattice\nwith a spin- @xmath associated to each site corresponds to assigning\nspin- @xmath operators [Eq.\u00a0( 5.24 )] to each of the open indices.\n\nFor the open index of the tensor @xmath at the very top the MERA, the\nassignment of spins will depend on spin sector @xmath that one is\ninterested in. For instance, in order to find an approximation to the\nground state and first seven excited states of the quantum spin model\nwithin the spin sector @xmath , we choose @xmath and @xmath .\n\nFor each of the remaining indices of the MERA, the assignment of the\npair @xmath needs careful consideration and a final choice may only be\npossible after numerically testing several options and selecting the one\nwhich produces the lowest expectation value of the energy.\n\nFor demonstrative purposes, we will use the SU(2) MERA as a variational\nansatz to obtain the ground state and excited states of the spin- @xmath\nantiferromagnetic quantum Heisenberg chain that is given by,\n\n  -- -------- -- --------\n     @xmath      (6.20)\n  -- -------- -- --------\n\nwhere\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (6.21)\n  -- -------- -------- -- --------\n\n@xmath and @xmath are the spin- @xmath operators [Eq.\u00a0( 5.24 )]. The\nmodel has a global SU(2) symmetry, since the Hamiltonian commutes with\nthe spin operators acting on the lattice @xmath . This follows from the\nfact that each local term @xmath in the Hamiltonian commutes with the\ntwo site spin operators,\n\n  -- -------- -- --------\n     @xmath      (6.22)\n  -- -------- -- --------\n\nEach spin- @xmath degree of freedom of the Heisenberg chain is described\nby a vector space @xmath that is spanned by two orthonormal states\n[Eq.\u00a0( 5.23 )],\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor computational convenience, we will consider a lattice @xmath where\neach site contains two spins. Therefore each site of @xmath is described\nby a space @xmath , where @xmath and @xmath , also discussed in Example\n6. This corresponds to the assignment @xmath and @xmath at the open legs\nat the bottom of the MERA. Thus, a lattice @xmath made of @xmath sites\ncorresponds to a chain of @xmath spins.\n\nTable 6.1 lists some of the spin and degeneracy dimensions assignment\n(for the internal links of the MERA) that we have used in the numerical\ncomputations for @xmath (or 108 spins). For a given value of @xmath and\n@xmath the corresponding dimension @xmath can be obtained as,\n\n  -- -------- -- --------\n     @xmath      (6.23)\n  -- -------- -- --------\n\nFigure 6.11 shows the error in the ground state energy of the Heisenberg\nchain as a function of the bond dimension @xmath , for the assignments\nof @xmath and @xmath that are listed in Table 6.1 . For the choice of\nspin assignments listed in the table the error is seen to decay\npolynomially with @xmath , indicating increasingly accurate\napproximations to the ground state.\n\n#### 6.1.3 Advantages of exploiting the symmetry\n\nWe now discuss some of the advantages of using the SU(2) MERA.\n\n##### 6.1.3.1 Selection of spin sector\n\nAn important advantage of the SU(2) MERA is that it exactly preserves\nthe SU(2) symmetry. In other words, the states resulting from a\nnumerical optimization are exact eigenvectors of the total spin operator\n@xmath . In addition, the total spin @xmath can be pre-selected at the\nonset of optimization by specifying it in the open index of the top\ntensor @xmath .\n\nFigure 6.12 shows the low energy spectrum of the Heisenberg model @xmath\nfor a periodic system of @xmath sites (or @xmath spins), including the\nground state and several excited states in the spin sectors @xmath . The\nstates have been organized according to spin projection @xmath . We see\nthat states with different spin projections @xmath (for a given @xmath )\nare obtained to be exactly degenerate, as implied by the symmetry.\n\nSimilar computations can be performed with the regular MERA. However,\nthe regular MERA cannot guarantee that the states obtained in this way\nare exact eigenvectors of @xmath . Instead the resulting states are\nlikely to have total spin fluctuations. This is shown in inset of Fig.\n6.12 , which corresponds to the zoom in of the region in the plot that\nis enclosed within the box. The inset shows (black asterix points) the\ncorresponding energies obtained for the enclosed two-fold degenerate\n@xmath states using the regular MERA. We see that the states\ncorresponding to different values of @xmath are obtained with different\nenergies.\n\nAlso note that by using the SU(2) MERA, the three sectors @xmath and\n@xmath can be addressed with independent computations. This implies, for\ninstance, that finding the gap between the first singlet ( @xmath ) and\nthe first @xmath state, can be addressed with two independent\ncomputations by respectively setting @xmath and @xmath on the open index\nof the top tensor @xmath . However, in order to capture the first @xmath\nstate using the regular MERA, we would need to consider at least @xmath\n(at a larger computational cost and possibly lower accuracy), since this\nstate has only the @xmath ^(th) lowest energy overall.\n\n##### 6.1.3.2 Reduction in memory and computational costs\n\nThe use of SU(2)-invariant tensors in the MERA also results in a\nreduction of computational costs. We compared the memory and\ncomputational costs associated with using the regular MERA and the SU(2)\nMERA. We also found it instructive to compare the analogous costs\nassociated with a MERA that is made of tensors that remain invariant\nunder only a subgroup U(1) of the symmetry group. This entails\nintroducing the spin projection operators @xmath on the links of the\nMERA and imposing the invariance of constituent tensors under the action\nof these operators. For such a U(1)-MERA, imposing such constraints\ncorresponds to conservation of the total spin projection @xmath , while\nthe total spin may fluctuate. (The explicit construction of the\nU(1)-MERA was discussed in Chapter 4).\n\nFigure 6.13 shows a comparison of the total number of complex\ncoefficients that are required to be stored for @xmath sites\n(corresponding to 108 spins) in the three cases: regular MERA, U(1) MERA\nand the SU(2) MERA. U(1)-invariant tensors (see Chapter 4) have a block\nstructure in the eigenbasis of @xmath operators on each index of the\ntensor, and therefore they incur a smaller memory cost in comparison to\nregular tensors. For example, it can be seen that for the same memory\nrequired to store a regular MERA with @xmath , one can instead consider\nstoring a U(1)-MERA with @xmath . On the other hand, SU(2)-invariant\ntensors are substantially more sparse. When written in the canonical\nform, SU(2)-invariant tensors are not only block-sparse but each block,\nin turn, decomposes into a degeneracy part and a structural part such\nthat the structural part need not be stored in memory. With the same\namount of memory that is required to store, for example, a @xmath\nregular MERA, one can already store a @xmath SU(2) MERA.\n\nIn Fig. 6.14 we show an analogous comparison of the computational\nperformance in the three cases. We plot the computational time required\nfor one iteration of the energy minimization algorithm of (Evenbly and\nVidal, 2009a ) (during which all tensors in the MERA are updated once),\nas a function of the total bond dimension @xmath for the cases of\nregular MERA, U(1) MERA and SU(2) MERA. We see that for sufficiently\nlarge @xmath , using SU(2)-invariant tensors leads to a shorter time per\niteration of the optimization algorithm. In the case of symmetric\ntensors we considered pre-computation of repeated operations, see Sec.\n6.0.8 .\n\n## Chapter 7 Conclusions and Outlook\n\nIn this thesis we have described how to incorporate global internal\nsymmetries into tensor network states and algorithms.\n\nOn the theoretical side we developed a framework to characterize and\nmanipulate symmetric tensors. Any given tensor network can be adapted to\nthe presence of a symmetry by imposing the constituent tensors to be\nsymmetric. Symmetric tensors are very sparse objects. Their judicious\nuse and careful manipulation can lead to an enormous computational gain\nin numerical simulations. This has been extensively demonstrated in this\nthesis by means of our reference MATLAB implementation.\n\nOn the implementation side, we have described a practical scheme for\nprotecting and exploiting the symmetry in numerical simulations. We\nproposed the use of tree decompositions of a symmetric tensor. Several\nadvantages of this scheme were discussed, not excluding the overall\nsimplicity and elegance of the method. We hope to have provided a\nsuitable implementation framework for researchers who are familiar with\nthe theoretical aspects of incorporating the symmetries into tensor\nnetwork algorithm but nonetheless find the practical implementation\nchallenging.\n\nIn implementing symmetries we have gone beyond the case of MPS, which\nbeing a trivalent tensor network is simpler to handle. We described the\nconstruction of the U(1) and SU(2) symmetric versions of the MERA. Our\nAbelian implementation led to computational gains measuring up to an\nincrease of ten to twenty times. The analogous gain from the non-Abelian\nimplementation was much larger, measuring up to an increase of forty to\nfifty times. These gains may be used either to reduce overall\ncomputation time or to permit substantial increases in the MERA bond\ndimension @xmath , and consequently in the accuracy of the results\nobtained. Therefore the exploitation of symmetries, especially\nnon-Abelian symmetries, can be an invaluable tool for numerically\nchallenging systems. This is more so the case in two dimensional lattice\nmodels where simulation costs are much more severe. An example of a\npotential application is to a system of interacting fermions that\nappears in the context of high temperature conductivity. Here even\nthough symmetries are present in the model, they have not been throughly\nexploited in the context of tensor network algorithms.\n\nAlthough we have given special attention to specific symmetry groups,\nU(1) and SU(2), the formalism presented in this thesis may equally well\nbe applied to any reducible compact non-Abelian group that is\nmultiplicity free. In particular, one can consider composite symmetries\nsuch as SU(2) @xmath U(1), corresponding to spin isotropy and particle\nnumber conservation and SU(2) @xmath SU(2) corresponding to conservation\nof spin and isospin etc. Such a symmetry is characterized by a set of\ncharges @xmath ; when fusing two such sets of charges @xmath and @xmath\n, each charge @xmath is combined with its counterpart @xmath according\nto the relevant fusion rule. Once again, this behaviour may be encoded\ninto a single fusing tensor @xmath .\n\nOur implementation scheme can also be readily extended to incorporate\nmore general symmetry constraints such as those associated with\nconservation of total fermionic and anyonic charge. One proceeds by\ndefining the following tensors for the relevant charges,\n\n-   the fusing tensor @xmath that encodes the fusion of two charges,\n\n-   the recoupling coefficients @xmath that relate various ways of\n    fusing three charges, and\n\n-   the swap tensor @xmath that encodes the swap behaviour of two\n    charges.\n\nNote that within our specific implementation framework, one may instead\njust define the linear maps @xmath that mediate tensor manipulations for\nthe respective charges.\n\nAs an example, consider fermionic constraints where the relevant charge,\n@xmath , is the parity of fermion particle number. Charge @xmath takes\ntwo values, @xmath and @xmath corresponding to even or odd number of\nfermions. The fusing tensor @xmath encodes the fusion rules that specify\nhow charges @xmath and @xmath fuse together to obtain a charge @xmath .\nThese correspond to the fusion rules for the group @xmath , given as,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nThe recoupling coefficients @xmath , associated with the fusion of three\ncharges @xmath and @xmath are simple in this case owing to the Abelian\nfusion rules. They take a value @xmath for all values of intermediate\ncharges @xmath and @xmath that appear when fusing the three charges one\nway or the other.\n\nThe final ingredient is the tensor @xmath , which in this case is\ndefined as,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nIn a similar way, one can encode the corresponding fusion rules for\nanyonic charges into the fusing tensor @xmath . In the case of anyons,\nthe recoupling coefficients @xmath are obtained as solutions to the\npentagon equations whereas the tensors @xmath are replaced with the\nanyonic braid operators that are obtained as solutions to the hexagon\nequations , see (Trebst et\u00a0al., 2008 ; Feiguin et\u00a0al., 2007 ; Pfeifer\net\u00a0al., 2010 ) . Thus, having defined these tensors for the relevant\ncharges, the formalism and the implementation framework presented in\nthis thesis can be readily adapted to incorporate the constraints\ncorresponding to the presence of fermionic or anyonic charges.\n\nIn a different context, preservation of symmetry can be crucial even\nwithout demanding a computational gain. Recently, a novel classification\nof symmetric phases in 1D gapped spin systems was undertaken in (Chen\net\u00a0al., 2011 ) . In the absence of any symmetry, in this classification\nall states are equivalent to trivial product states. However, by\npreserving certain symmetries many phases were reported to exist with a\ndifferent symmetry protected topological order . As an alternative, such\na classification could potentially be addressed with the symmetric\nversion of the MERA, since the MERA is adept at characterizing fixed\npoints of the renormalization group flow which correspond to different\nphases.\n\nSymmetries are a fundamental aspect of nature. Nearly all physical\nphenomenon can be explained by the presence or the absence of a\nsymmetry. In numerical methods, the preservation of symmetries may well\nbe a necessary requirement for simulating certain aspects of the system.\nAs a computational aid, symmetries will play a crucial role in pushing\nforward the frontiers of tensor network algorithms in the coming years.","output":["In this thesis we extend the formalism of tensor network algorithms to\nincorporate global internal symmetries. We describe how to both numerically\nprotect the symmetry and exploit it for computational gain in tensor network\nsimulations. Our formalism is independent of the details of a specific tensor\nnetwork decomposition since the symmetry constraints are imposed at the level\nof individual tensors. Moreover, the formalism can be applied to a wide\nspectrum of physical symmetries described by any discrete or continuous group\nthat is compact and reducible. We describe in detail the implementation of the\nconservation of total particle number (U(1) symmetry) and of total angular\nmomentum (SU(2) symmetry). Our formalism can also be readily generalized to\nincorporate more exotic symmetries such as conservation of total charge in\nanyonic systems.","Understanding and classifying phases of matter is a vast and important\narea of research in modern physics. Of special interest are phases at\nlow temperatures where quantum effects are dominant. Theoretical\nprogress is thwarted by a general lack of analytical solutions for\nquantum many-body systems. Moreover, perturbation theory is often\ninadequate in the strongly interacting regime. As a result, numerical\napproaches have become an indispensable tool to address such problems.\nIn recent times, numerical approaches based on tensor networks have\ncaught widespread attention. Tensor network algorithms draw on insights\nfrom Quantum Information theory to take advantage of special\nentanglement properties of low energy quantum many-body states of\nlattice models. Examples of popular tensor networks include Matrix\nProduct States, Tree tensor Network, Multi-scale Entanglement\nRenormalization Ansatz and Projected Entangled Pair States. The main\nimpediment of these methods comes from the fact that they can only\nrepresent states with a limited amount of entanglement. On the other\nhand, exploitation of symmetries, a powerful asset for numerical\nmethods, has remained largely unexplored for a broad class of tensor\nnetworks algorithms.\n\nIn this thesis we extend the formalism of tensor network algorithms to\nincorporate global internal symmetries. We describe how to both\nnumerically protect the symmetry and exploit it for computational gain\nin tensor network simulations. Our formalism is generic. It can readily\nbe adapted to specific tensor network representations and to a wide\nspectrum of physical symmetries. The latter includes conservation of\ntotal particle number (U(1) symmetry) and of total angular momentum\n(SU(2) symmetry), and also more exotic symmetries (anyonic systems). The\ngenerality of the formalism is due to the fact that the symmetry\nconstraints are imposed at the level of individual tensors, in a way\nthat is independent of the details of the tensor network. As a result,\nwe are led to a framework of symmetric tensors. Such tensors are then\nused as building blocks for tensor network representations of\nquantum-many states in the presence of symmetry.\n\nFor a long time several physical problems of immense interest have\nremained elusive to numerical methods mostly owing to extremely high\nsimulation costs. These include systems of frustrated magnets and\ninteracting fermions that are relevant in the context of quantum\nmagnetism and high temperature superconductivity. With symmetry now as a\npotent ally, tensor network algorithms may finally be used to draw\npositive insights about such systems.\n"]}
{"input":"##### Contents\n\n-    1 Introduction\n    -    1.1 Background\n    -    1.2 Overview\n    -    1.3 Main results\n-    2 Higher-rank graphs\n    -    2.1 Basic category theory\n    -    2.2 Definitions and notation\n    -    2.3 Graph morphisms\n-    3 Twisted relative Cuntz-Krieger algebras\n    -    3.1 Toeplitz-Cuntz-Krieger @xmath -families\n    -    3.2 The twisted Toeplitz algebra\n    -    3.3 Relative Cuntz-Krieger @xmath -families\n    -    3.4 Gap projections and boundary paths\n-    4 Analysis of the core\n    -    4.1 Group actions and faithful conditional expectations\n    -    4.2 The gauge action\n    -    4.3 Orthogonalising range projections\n    -    4.4 Matrix units for the core\n    -    4.5 Isomorphisms of the core\n    -    4.6 The gauge-invariant uniqueness theorem\n-    5 Gauge-invariant ideals\n    -    5.1 From ideals to hereditary sets\n    -    5.2 Quotients of twisted relative Cuntz-Krieger algebras\n    -    5.3 Gauge-invariant ideals of the twisted relative\n        Cuntz-Krieger algebras\n\n## Chapter 1 Introduction\n\n### 1.1 Background\n\nA directed graph @xmath consists of a set @xmath of vertices, a set\n@xmath of edges and maps @xmath . We visualise the vertices as dots or\npoints and the edges @xmath as arrows pointing from @xmath , called its\nsource, to @xmath , called its range. A @xmath -algebra is a closed\nsubspace of the bounded linear operators on a Hilbert space that is\nclosed under multiplication and adjoints. We construct a @xmath -algebra\nin the set of bounded linear operators on a Hilbert space @xmath from\n@xmath as follows. To vertices @xmath we associate projections @xmath of\n@xmath onto mutually orthogonal subspaces @xmath . To every edge @xmath\nwe associate a partial isometry @xmath that takes @xmath isometrically\ninto @xmath and vanishes on @xmath . We require that whenever @xmath is\nnonempty and finite, the subspaces @xmath with @xmath are mutually\northogonal and span @xmath . Such a collection @xmath is called a\nCuntz-Krieger @xmath -family. By taking the closure of all linear\ncombinations of all finite products of @xmath and @xmath and their\nadjoints, we generate a @xmath -subalgebra of the bounded linear\noperators on @xmath .\n\nEvery Cuntz-Krieger @xmath -family generates a @xmath -algebra.\nDifferent Cuntz-Krieger @xmath -families can generate nonisomorphic\n@xmath -algebras, but there is a unique universal @xmath -algebra @xmath\ngenerated by a universal Cuntz-Krieger @xmath -family @xmath . Loosely\nspeaking, by \u201cuniversal\u201d we mean that @xmath is biggest @xmath -algebra\ngenerated by a Cuntz-Krieger @xmath -family: @xmath contains all the\ncomplexities of any other @xmath -algebra generated by a Cuntz-Krieger\n@xmath -family. One can use the universal property to show that there is\na group action @xmath of the unit circle @xmath on @xmath such that\n@xmath and @xmath for each @xmath , @xmath and @xmath . This action is\ncalled the gauge action.\n\nKumjian, Pask, Raeburn and Renault introduce Cuntz-Krieger algebras of\ndirected graphs, also known as graph algebras, in [ 9 ] following on\nfrom the seminal work of Cuntz and Krieger in [ 3 ] and Enomoto and\nWatatani in [ 5 ] . The sustained interest in graph algebras is\nmotivated by the elegant relationships that exist between the\nconnectivity and loop structure of the graph and the structure of the\nresulting graph algebra. For example, the ideals of @xmath that are\ninvariant for the gauge action @xmath can be described in terms of\nsubsets of @xmath : Bates, Hong, Raeburn and Szyma\u0144ski in [ 1 ] describe\nsets @xmath of vertices, which they call saturated hereditary sets. They\nshow that for each such @xmath , the elements @xmath generate a\ngauge-invariant ideal @xmath of @xmath . Using a version of an Huef and\nRaeburn\u2019s gauge-invariant uniqueness theorem ( [ 6 ] , Theorem 2.3),\nthey show that @xmath is canonically isomorphic to the Cuntz-Krieger\nalgebra of what they call the quotient graph @xmath . They then show\nthat the gauge-invariant ideals of the Cuntz-Krieger algebra are indexed\nby pairs @xmath , where @xmath is a saturated hereditary set and @xmath\nis a collection of so-called breaking vertices.\n\nRobertson and Steger [ 17 ] introduce a class of higher-rank\nCuntz-Krieger algebras arising from actions of @xmath on buildings. In [\n7 ] , Kumjian and Pask introduce higher-rank graphs and their\nCuntz-Krieger algebra as a common generalisation of both Robertson and\nSteger\u2019s higher-rank Cuntz-Krieger algebras and graph algebras. Kumjian\nand Pask focus on Cuntz-Krieger algebras arising from row-finite\nhigher-rank graphs with no sources: these are the higher-rank analogue\nof graphs in which a nonzero, finite number of edges enters every\nvertex. Raeburn, Sims and Yeend [ 16 ] extend the analysis of Kumjian\nand Pask by associating Cuntz-Krieger algebras to finitely aligned\nhigher-rank graphs, a more general class than row-finite higher-rank\ngraphs with no sources.\n\nIn [ 18 ] , Sims defines a class of relative Cuntz-Krieger algebras ( [\n18 ] , Definition 3.2) associated to a finitely aligned higher-rank\ngraph, which includes the usual Cuntz-Krieger algebras as a special\ncase. As in [ 1 ] , Sims identifies pairs of saturated hereditary sets\nand satiated ( [ 18 ] , Definition 4.1) sets, and associates to each\nsuch pair a gauge-invariant ideal. Due the complex combinatorial nature\nof higher-rank graphs, it is no longer clear how to realise the quotient\nof the Cuntz-Krieger algebra as the Cuntz-Krieger algebra of a quotient\ngraph. Instead, Sims shows that the quotient of the Cuntz-Krieger\nalgebra by a gauge-invariant ideal associated to a saturated hereditary\nand satiated pair is canonically isomorphic to a relative Cuntz-Krieger\nalgebra of a subgraph ( [ 19 ] , Corollary 5.2). Using this observation,\nSims generalises the results of [ 1 ] for graph algebras to\nCuntz-Krieger algebras of finitely aligned higher-rank graphs; that is,\nhe classifies all the gauge-invariant ideals in the Cuntz-Krieger\nalgebra of a higher-rank graph ( [ 18 ] , Theorem 5.5).\n\nIn [ 8 ] and [ 10 ] , Kumjian, Pask and Sims introduce a cohomology\ntheory for higher-rank graphs. They show how to twist the defining\nrelations for a higher-rank graph @xmath -algebra by a circle valued\n2-cocycle ( [ 10 ] , Definition 5.2). They use this to define the\ntwisted Cuntz-Krieger algebra @xmath ( [ 10 ] , Proposition 5.3)\nassociated to a higher-rank graph and a @xmath -valued 2-cocycle @xmath\n. The class of twisted Cuntz-Krieger algebras contains many interesting\nexamples, including all of the noncommutative tori ( [ 8 ] , Example\n7.9) and the quantum spheres of [ 2 ] . Both [ 8 ] and [ 10 ] , consider\nrow-finite locally convex ( [ 15 ] , Definition 3.9) higher-rank graphs,\nrather than arbitrary finitely aligned higher-rank graphs. Kumjian, Pask\nand Sims produce a gauge-invariant uniqueness theorem ( [ 10 ] ,\nCorollary 7.7) using groupoid methods, and provide a criterion for\nsimplicity ( [ 10 ] , Corollary 8.2), but they do not address the\nbroader question of ideal structure.\n\nIn this thesis we avoid groupoid methods in preference for a more\nelementary and direct analysis, similar to that of [ 16 ] . This direct\napproach leads to sharper and more general results with cleaner\narguments. Theorem 5.5 in [ 19 ] gives a complete description of\ngauge-invariant structure of the Cuntz-Krieger algebra associated to a\nfinitely aligned higher-rank graph. The aim of this thesis is to extend\nthis result to all twisted relative Cuntz-Krieger algebras: this is a\nnew result even for the untwisted case. This aim is achieved with\nTheorem 5.3.2 .\n\n### 1.2 Overview\n\nThis section gives a detailed account of the material contained in this\nthesis. We highlight definitions and results contained in each chapter,\ndiscuss their importance and connect them with the previous work of\nothers.\n\nIn Chapter 2 we recall the definition of a @xmath -graph (higher-rank\ngraph) and develop the standard notation to deal with them. Each path\n@xmath in a @xmath -graph @xmath has a source @xmath and a range @xmath\nin @xmath , the set of vertices. Unlike directed graphs, a @xmath -graph\n@xmath not only consists of edges and vertices but all possible paths in\nthe graph. There is a natural partial multiplication on @xmath given by\nconcatenation; given paths @xmath in @xmath such that @xmath , @xmath is\nanother path in @xmath . Each path @xmath has degree, or shape, @xmath ,\nwhere @xmath is the @xmath in @xmath -graph; degree is a\nhigher-dimensional analogue of length. Each @xmath -graph satisfies the\nfactorisation property: if @xmath has degree @xmath , then there exist\nunique paths @xmath and @xmath in @xmath such that @xmath , @xmath and\n@xmath . If @xmath is a directed graph, then the set @xmath of all paths\nin @xmath is a @xmath -graph where the degree function @xmath measures\nthe length of a path. Note that the factorisation property for @xmath\n-graphs is automatic. So @xmath -graphs generalise the notion of a\ndirected graph.\n\nGiven a finitely aligned @xmath -graph @xmath , each finite collection\n@xmath of paths with a common range determines a \u201cgap projection\u201d @xmath\nin the twisted Toeplitz algebra (see Section 3.4 ) of @xmath . Each\ntwisted relative Cuntz-Krieger algebra of @xmath is a quotient of the\ntwisted Toeplitz algebra by an ideal generated by such gap projections;\nso in each twisted relative Cuntz-Krieger algebra some, but typically\nnot all, of the gap projections are zero. In Chapter 3 we construct a\nspatial representation of the twisted Toeplitz algebra, and use it to\ncharacterise exactly which gap projections are nonzero in any given\nrelative Cuntz-Krieger algebra.\n\nIn Section 3.1 , for a finitely aligned @xmath -graph @xmath , we define\na @xmath -valued 2-cocycle and the associated twisted Toeplitz algebra.\nA 2-cocycle is a map\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthat satisfies:\n\n1.  @xmath whenever @xmath and @xmath ; and\n\n2.  @xmath for all @xmath .\n\nThe first relation is called the 2-cocycle identity. We write @xmath for\nthe set of all @xmath -valued 2-cocycles. The inspiration for this\ndefinition comes from the work of Kumjian, Pask and Sims in [ 8 ] and [\n10 ] in developing a cohomology theory for @xmath -graphs and their\ndefinition of a Cuntz-Krieger @xmath -family ( [ 10 ] , Definition 5.2),\nwhere @xmath is a 2-cocycle in the cohomology theory. Kumjian, Pask and\nSims show there is a universal @xmath -algebra @xmath , called the\ntwisted Cuntz-Krieger algebra, generated by a Cuntz-Krieger @xmath\n-family @xmath . This @xmath -algebra is said to be \u2018twisted\u2019 due to the\n2-cocycle appearing in the relation\n\n  -- -------- -- -------\n     @xmath      (1.1)\n  -- -------- -- -------\n\nwhenever @xmath . The 2-cocycle identity guarantees that the\nmultiplication in ( 1.1 ) is associative.\n\nWe wish to extend the analysis of Kumjian, Pask and Sims to finitely\naligned @xmath -graphs. A Toeplitz-Cuntz-Krieger @xmath -family is a\ncollection @xmath of partial isometries in a @xmath -algebra satisfying:\n\n1.  @xmath is a set of mutually orthogonal projections;\n\n2.  @xmath whenever @xmath ;\n\n3.  @xmath for all @xmath ; and\n\n4.  @xmath .\n\nIn Definition 2.5 of [ 16 ] , Raeburn, Sims and Yeend define a\nCuntz-Krieger @xmath -family for a finitely aligned @xmath -graph @xmath\n. Here we note how our definition of a Toeplitz-Cuntz-Krieger @xmath\n-family differs from a Cuntz-Krieger @xmath -family of [ 16 ] and how\nthe 2-cocycle is incorporated. Relation (TCK1) already appears in\nDefinition 2.5 of [ 16 ] . Relation (ii) in Definition 2.5 of [ 16 ] is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhenever @xmath . Relation (TCK2) incorporates the 2-cocycle into the\nabove relation, as in ( 1.1 ). Relation (iii) in Definition 2.5 of [ 16\n] is\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor all @xmath . It turns out that the equivalent relation in the\n2-cocycle setting is\n\n  -- -------- -- -------\n     @xmath      (1.2)\n  -- -------- -- -------\n\nfor all @xmath . Since it is unclear why this is the correct relation,\nwe remove it from the definition of a Toeplitz-Cuntz-Krieger @xmath\n-family. We replace it by the familiar relations (TCK3), seen in Lemma\n2.7 of [ 16 ] , and (TCK4), seen in Remark 2.6 of [ 16 ] . Lemma 3.1.5\nshows that replacing (TCK3) and (TCK4) by ( 1.2 ) would give us an\nequivalent definition of a Toeplitz-Cuntz-Krieger @xmath -family.\nRelation (iv) in Definition 2.5 of [ 16 ] ,\n\n  -- -------- -- -------\n     @xmath      (1.3)\n  -- -------- -- -------\n\ndoes not appear in the definition of Toeplitz-Cuntz-Krieger @xmath\n-family, as in Definition 3.1.1 of [ 20 ] . The reason for this is\nexplained below in the overview of Section 3.3 .\n\nIn Section 3.2 we show that there is a unique universal @xmath -algebra\ngenerated by a Toeplitz-Cuntz-Krieger @xmath -family @xmath (Theorem\n3.2.3 ), we call this @xmath -algebra the twisted Toeplitz algebra of\n@xmath and denoted it @xmath . Universal means that if @xmath is any\nother Toeplitz-Cuntz-Krieger @xmath -family in a @xmath -algebra @xmath\n, then there is a homomorphism @xmath such that @xmath for each @xmath .\nIn Proposition 3.1.7 we show there is a Toeplitz-Cuntz-Krieger @xmath\n-family @xmath in @xmath . The universal property of @xmath determines a\nhomomorphism @xmath satisfying @xmath for each @xmath . This\nrepresentation @xmath of the twisted Toeplitz algebra on @xmath will be\nan invaluable tool throughout the thesis.\n\nIn Section 3.3 , for a vertex @xmath and finite @xmath , we define the\ngap projection\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n(Definition 3.3.2 ). Relation (TCK4) implies that the range projections\n@xmath pairwise commute, so that the gap projection @xmath is\nwell-defined (Lemma 3.1.3 (2)). Definition 3.3.1 defines the collection\n@xmath of finite exhaustive sets of @xmath , as in Definition 2.4 of [\n16 ] . Each element @xmath is finite and every path has a common range\nvertex @xmath , so that @xmath . Similar to Definition 3.2 of [ 18 ] ,\ngiven @xmath we define a relative Cuntz-Krieger @xmath -family to be a\nToeplitz-Cuntz-Krieger @xmath -family @xmath that satisfies\n\n1.  @xmath for all @xmath\n\nRelation (CK) can be thought of as weaker version of ( 1.3 ). We call a\nrelative Cuntz-Krieger @xmath -family a Cuntz-Krieger @xmath -family.\nThe map\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\ngiven by @xmath for @xmath is a @xmath -valued 2-cocycle. The relative\nCuntz-Krieger @xmath -families are precisely the Cuntz-Krieger @xmath\n-families of ( [ 16 ] , Definition 2.5). When @xmath is row-finite and\nlocally convex, these are precisely the Cuntz-Krieger @xmath -families\nof [ 7 ] . This assertion is nontrivial: we refer the reader to Appendix\nA of [ 16 ] for a detailed explanation of Cuntz-Krieger relations\nassociated to different classes higher-rank graphs and their\nequivalence.\n\nGiven @xmath , Theorem 3.3.7 shows that there is a unique universal\n@xmath -algebra @xmath generated by a relative Cuntz-Krieger @xmath\n-family @xmath . By definition, @xmath and @xmath for each @xmath ,\nwhere @xmath is the smallest closed ideal containing the collection of\ngap projections\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe reason for using relative Cuntz-Krieger @xmath -families will become\napparent when we classify the gauge-invariant structure of @xmath .\n\nIn Section 3.4 we establish two results concerning @xmath . Firstly, we\nshow that the projections associated to vertices are all nonzero; that\nis, @xmath for each @xmath . Secondly, we identity the collection @xmath\nof finite exhaustive sets containing @xmath and such that for @xmath ,\n\n  -- -------- -- -------\n     @xmath      (1.4)\n  -- -------- -- -------\n\nThe collection @xmath is called the satiation of @xmath , and is, by\ndefinition, the smallest satiated set containing @xmath (see Definition\n4.1 and Definition 5.1 of [ 18 ] ). Theorem 3.4.16 establishes ( 1.4 ).\nThis result is needed throughout the thesis, including in the proof of\nthe gauge-invariant uniqueness theorem (Theorem 4.6.1 ). In [ 18 ] ,\nSims outlines a method for constructing the satiation @xmath of @xmath .\nIn doing so, proves the \u201conly if\u201d direction of ( 1.4 ) in ( [ 18 ] ,\nCorollary\u00a05.6). In this thesis we adopt the same method (Proposition\n3.4.8 ). The \u201cif\u201d direction of\u00a0( 1.4 ) is much more involved. In\nDefinition 4.3 of [ 18 ] , Sims defines the collection @xmath of @xmath\n-compatible boundary paths; such paths are analogues of infinite paths\nin a @xmath -graph with a range but no source, which satisfy a property\nrelating to @xmath . In [ 18 ] , Sims proves the \u201cif\u201d direction of ( 1.4\n) in Corollary 4.9 of [ 18 ] using a concrete representation @xmath ( [\n18 ] , Definition\u00a04.5) of @xmath on @xmath . It seems that this\nrepresentation cannot be extended to general twisted relative\nCuntz-Krieger algebras. Each of the @xmath in [ 18 ] are determined by\n\n  -- -------- -- -------\n     @xmath      (1.5)\n  -- -------- -- -------\n\nwhere @xmath denotes an @xmath -compatible boundary path and @xmath\ndenotes the canonical basis for @xmath . The reader should compare ( 1.5\n) with the representation of @xmath on @xmath given in Definition 3.1.7\n. In order for the family @xmath to satisfy (TCK2) and be a\nrepresentation of @xmath , we would need to make sense of a 2-cocycle\nevaluated at an @xmath -compatible boundary path. There seems to be no\ncanonical way to do this. Instead, to prove ( 1.4 ) we need a different\nanalysis.\n\nAs we do not have a concrete representation of @xmath , we analyse the\nstructure of the ideals @xmath in order to understand the quotients\n@xmath . By analysing these ideals, we distinguish between those gap\nprojections associated to @xmath and those associated to @xmath . Using\nthis, we show the \u201cif\u201d direction of ( 1.4 ) in Theorem 3.4.16 .\n\nChapter 4 contains an analysis of the fixed point algebra of the\ngauge-action, called the core of @xmath and denoted @xmath . The\ngauge-action is a strongly continuous group action @xmath determined by\n\n  -- -------- -- -------\n     @xmath      (1.6)\n  -- -------- -- -------\n\nwhere @xmath . To see there is an action, given @xmath note that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a relative Cuntz-Krieger @xmath -family. Thus the universal property\nimplies that there is a homomorphism @xmath satisfying ( 1.6 ). One\nchecks that @xmath is an inverse for @xmath , so that each @xmath is an\nautomorphism.\n\nThe main result of Chapter 4 is the gauge-invariant uniqueness theorem\n(Theorem 4.6.1 ). If @xmath be a relative Cuntz-Krieger @xmath -family,\nthis theorem characterises when the homomorphism @xmath given by the\nuniversal property is injective.\n\nSection 4.1 outlines standard results in the literature concerning\nstrongly continuous group actions and faithful conditional expectations.\nSection 4.2 constructs the gauge action determined by equation ( 1.6 ).\nWe prove several standard results concerning the gauge action. For\nexample, in Lemma 4.2.2 we show the gauge-action is strongly continuous\nand in Lemma 4.2.3 we prove that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nDue to this characterisation of the core, it has become standard in the\ncontext of graph algebras to study the subalgebra\n\n  -- -------- -- -------\n     @xmath      (1.7)\n  -- -------- -- -------\n\nof @xmath . Given another relative Cuntz-Krieger @xmath -family @xmath ,\nwe want to establish conditions under which\n\n  -- -------- -- -------\n     @xmath      (1.8)\n  -- -------- -- -------\n\nThe idea is to show that ( 1.7 ) is an increasing union of\nfinite-dimensional subalgebras of the form @xmath where @xmath is\nfinite. We do this in Sections 4.3 and 4.4 . Almost all the content of\nthese sections is taken from the work of Raeburn and Sims in [ 14 ] and\nRaeburn, Sims and Yeend in [ 16 ] . Most of the proofs are changed only\nby the presence of the 2-cocycle. In Section 4.5 , we give conditions\nunder which ( 1.8 ) holds; even when @xmath is a relative Cuntz-Krieger\n@xmath -family, for a 2-cocycle @xmath , possibly with @xmath .\n\nSection 4.6 gives a statement of the gauge-invariant uniqueness theorem.\nThis theorem says that if @xmath is injective and @xmath carries a group\naction @xmath that behaves similar to the gauge-action, then @xmath is\ninjective. This theorem is the main tool used to classify the\ngauge-invariant ideals in @xmath .\n\nChapter 5 concerns the gauge-invariant ideal structure of @xmath .\nSection 5.1 starts with the definition of a hereditary and relatively\nsaturated set @xmath of vertices. The definition of hereditary is\nstandard, see Definition 3.1 in [ 19 ] . The notion of a relatively\nsaturated set, rather than the standard saturated set, is needed as we\nwant to classify the gauge-invariant ideals of all twisted relative\nCuntz-Krieger algebras, not just the twisted Cuntz-Krieger algebras. In\nSection 5.1 given an ideal @xmath , we find a relatively saturated and\nhereditary set @xmath and a satiated set @xmath . In Section 5.2 , given\na relatively saturated and hereditary subset @xmath and a satiated set\n@xmath , we construct a gauge-invariant ideal @xmath . We show that the\nquotient @xmath is canonically isomorphic to a twisted relative\nCuntz-Krieger algebra of a subgraph of @xmath . In Section 5.3 we show\nthat every gauge-invariant ideal has the form @xmath ; that is, we give\na complete graph-theoretic description of the gauge-invariant ideals in\n@xmath .\n\n### 1.3 Main results\n\nThe first major result, as was mentioned in ( 1.4 ), is Theorem 3.4.16 :\nfor @xmath we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nLet @xmath . If @xmath is a relative Cuntz-Krieger @xmath -family and if\n@xmath is a relative Cuntz-Krieger @xmath -family. Then Theorem 4.5.9\ngives us conditions under which\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis Theorem is crucial in the proof of the gauge-invariant uniqueness\ntheorem, although in the proof we only need the situation where @xmath\nare @xmath are identical. The case where @xmath has found application in\ncomputing the @xmath -theory of twisted Cuntz-Krieger algebras\nassociated to @xmath -graphs [ 11 ] .\n\nTheorem 4.6.1 is a version of an Huef and Raeburn\u2019s gauge-invariant\nuniqueness theorem for twisted relative Cuntz-Krieger algebras. It is an\nessential tool in giving a graph-theoretic description of the\ngauge-invariant ideals of twisted relative Cuntz-Krieger algebras. The\nproof of this theorem for relative algebras is more difficult than the\nnon-relative case (see [ 18 ] ), and even more so in the twisted\nrelative case. The main technical result needed is Theorem 3.4.16\ndiscussed above.\n\nIn Chapter 5 we present our main result, a complete graph-theoretic\ndescription of the gauge-invariant ideal structure of each twisted\nrelative Cuntz-Krieger algebra. This result extends the corresponding\nresult of ( [ 19 ] , Theorem 5.5) for the Cuntz-Krieger algebra in two\nways: here we consider all relative Cuntz-Krieger algebras, which\nincludes the Cuntz-Krieger algebra; and we also incorporate the\n2-cocycle.\n\n## Chapter 2 Higher-rank graphs\n\nIn this chapter we recall the definition of a @xmath -graph (higher-rank\ngraph). We establish the standard notation for dealing with @xmath\n-graphs.\n\n### 2.1 Basic category theory\n\nHigher-rank graphs are defined using the language of categories. The\nfollowing two definitions are taken from [ 12 ] .\n\n###### Definition 2.1.1.\n\nA small category @xmath is a sextuple @xmath consisting of:\n\n-    sets @xmath and @xmath , called the object and morphism sets;\n\n-    the domain and codomain functions @xmath ;\n\n-    the identity function @xmath ; and\n\n-    the composition function @xmath , where @xmath is the set of\n    composable pairs in @xmath ;\n\nand satisfying\n\n-   @xmath for all @xmath ;\n\n-   @xmath and @xmath for all @xmath ;\n\n-    the unit law , @xmath for all @xmath ; and\n\n-   associativity , @xmath .\n\nWe say the category @xmath is countable if @xmath is countable.\n\nSince the unit law implies that @xmath and @xmath are surjective, if\n@xmath is countable, then @xmath is also countable.\n\n###### Definition 2.1.2.\n\nA covariant functor @xmath from a category @xmath to a category @xmath\nis a pair of functions (both denoted @xmath ); an object function @xmath\n, and a morphism function @xmath satisfying:\n\n-   @xmath and @xmath for all @xmath ;\n\n-   @xmath for all @xmath ; and\n\n-   @xmath for all @xmath .\n\nWe regard the morphisms of a category as arrows connecting their domain\nobject to their codomain object. Composition of morphisms then becomes\nconcatenation of arrows. Informally, a covariant functor is a map\nbetween the arrows of one category to the arrows of another category\nthat preserves connectivity. There is also a notion of a contravariant\nfunctor . Here we will only be dealing with covariant functors, and so\nwe will just refer to them as functors .\n\nThroughout this thesis @xmath denotes the set @xmath . We will write\n@xmath for the usual set of natural numbers. If @xmath and @xmath are\nsets, we write @xmath if each element of @xmath is a member of @xmath ;\nwe write @xmath if @xmath is strictly contained in @xmath .\n\n###### Example 2.1.3.\n\nA monoid @xmath can be regarded as the morphisms of a category @xmath\nwith a single object @xmath ; that is @xmath , @xmath , @xmath for all\n@xmath , @xmath , and @xmath for all @xmath . For us, the most important\ncategory arising from a monoid is @xmath under addition for @xmath .\n\n### 2.2 Definitions and notation\n\nIn this section we recall the definition of a @xmath -graph (higher-rank\ngraph) and establish the standard notation for dealing with them.\n\nWe regard @xmath as a monoid under addition, with additive identity\n@xmath . We define a partial order @xmath by @xmath if and only if\n@xmath . We write @xmath if @xmath . Fix @xmath . We write @xmath for\nthe @xmath coordinate of @xmath . We write @xmath for the coordinate\nmaximum of @xmath and @xmath and @xmath for there coordinate minimum;\nthat is, @xmath and @xmath .\n\n###### Definition 2.2.1 ([7], Definition 1.1).\n\nA @xmath -graph (or higher-rank graph) is a pair @xmath that consists of\na countable category @xmath and a functor @xmath , which satisfies the\nfactorisation property : for every @xmath and @xmath with @xmath , there\nare unique elements @xmath such that @xmath and @xmath , @xmath .\n\nSuppose @xmath and @xmath . If @xmath , then two applications of the\nfactorisation property ensure there are unique morphisms @xmath such\nthat @xmath and @xmath , @xmath , @xmath . We write @xmath for @xmath ,\n@xmath for @xmath and @xmath for @xmath .\n\nLet @xmath be a @xmath -graph. We claim that\n\n  -- -------- -- -------\n     @xmath      (2.1)\n  -- -------- -- -------\n\nTo see this, recall that @xmath is a functor and @xmath has just one\nobject @xmath . Thus, for each @xmath we have @xmath . This shows the\n@xmath containment in ( 2.1 ). Fix @xmath with @xmath . Write @xmath for\n@xmath . As @xmath , the factorisation property implies that there exist\nunique morphisms @xmath such that @xmath and @xmath . Both @xmath ,\n@xmath and @xmath , @xmath provide such factorisations. The uniqueness\nof factorisations implies that @xmath , showing the @xmath containment\nin ( 2.1 ).\n\nDue to ( 2.1 ), we regard @xmath as a subset of @xmath and we regard\n@xmath as consisting entirely of its morphisms; that is, we write @xmath\nfor @xmath\n\nFor @xmath , we write\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIn particular, @xmath , which we regard as the collection of vertices\nvia ( 2.1 ). We write @xmath for the domain function @xmath , and @xmath\nfor the codomain function @xmath . Given @xmath , we call @xmath the\nsource of @xmath and @xmath the range of @xmath . For @xmath and @xmath\n, we write @xmath for @xmath and @xmath for @xmath . We generally\nreserve lower-case Greek letters @xmath for paths in @xmath . Notable\nexceptions include: @xmath , which we use for the Kronecker delta;\n@xmath , which we use for basis elements of Hilbert spaces; and @xmath ,\nwhich we use for the gauge-action (see Section 4.2 ). Lower-case English\nletters @xmath typically denote elements of @xmath .\n\n###### Definition 2.2.2.\n\nLet @xmath be a @xmath -graph. For @xmath we define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nA @xmath -graph @xmath is said to be finitely aligned if the set @xmath\nis finite for each @xmath .\n\n###### Definition 2.2.3.\n\nLet @xmath be a @xmath -graph. For @xmath , define the set of minimal\ncommon extensions of @xmath and @xmath , denoted @xmath , to be\ncollection of @xmath such that @xmath for some @xmath with @xmath . If\nthe @xmath -graph @xmath is clear from context, we write @xmath for\n@xmath . Fix @xmath . For @xmath and @xmath we define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proposition 2.2.4.\n\nLet @xmath be a finitely aligned @xmath -graph and suppose @xmath . The\nmap\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\ngiven by @xmath is a bijection. In particular, @xmath is finite for all\n@xmath .\n\n###### Proof.\n\nFix @xmath . Let @xmath . Then @xmath , and @xmath . So @xmath is\nsurjective. To see that it is injective suppose @xmath . The\nfactorisation property implies that @xmath . Now as @xmath , another\napplication of the factorisation property shows that @xmath . So @xmath\nis injective and hence a bijection. Since @xmath is finitely aligned,\n@xmath for all @xmath . \u220e\n\n### 2.3 Graph morphisms\n\nFor each @xmath , we define a @xmath -graph @xmath . For a @xmath -graph\n@xmath , we define graph morphisms @xmath , which we regard as\npotentially-infinite paths in @xmath . We use such paths for our\nanalysis of the ideal structure of @xmath in Section 3.4 .\n\n###### Example 2.3.1 ([7], Examples 1.7(ii)).\n\nLet @xmath and @xmath . Define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor @xmath , we define @xmath and @xmath . Then @xmath is a countable\ncategory. Define @xmath . The pair @xmath is a @xmath -graph.\n\n###### Definition 2.3.2.\n\nLet @xmath and @xmath be a @xmath -graphs. A graph morphism is a functor\n@xmath such that @xmath . We define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor @xmath , we write @xmath for @xmath and @xmath for @xmath .\n\nFor @xmath , there is a bijection between @xmath and the set of graph\nmorphisms @xmath : if @xmath , set @xmath (see the paragraph following\nDefinition 2.2.1 ). The uniqueness clause in factorisation property\nimplies that @xmath well-defined. If @xmath contains some infinite\ncoordinates, then graph morphisms @xmath are thought of as partially\ninfinite paths in @xmath .\n\n## Chapter 3 Twisted relative Cuntz-Krieger algebras\n\nFor each finitely aligned @xmath -graph @xmath and each @xmath -valued\n2-cocycle @xmath on @xmath , we investigate collections of partial\nisometries indexed by @xmath called Toeplitz-Cuntz-Krieger @xmath\n-families. We show that there is a universal @xmath -algebra @xmath ,\ncalled the twisted Toeplitz algebra, generated by a\nToeplitz-Cuntz-Krieger @xmath -family @xmath . For each finite\nexhaustive set @xmath , where @xmath , we define the associated gap\nprojection @xmath in @xmath . For a collection @xmath of finite\nexhaustive sets, we investigate the associated twisted relative\nCuntz-Krieger algebra @xmath . By definition, @xmath is the quotient of\n@xmath by the smallest closed ideal @xmath containing all the gap\nprojections associated to elements of @xmath . We define relative\nCuntz-Krieger @xmath -families, which are Toeplitz-Cuntz-Krieger @xmath\n-families satisfying an additional relation, and show that @xmath is\nuniversal for such a family @xmath . The gap projections associated to\nelements of @xmath are, by definition of @xmath , zero in @xmath . Using\na concrete representation of @xmath on @xmath , we determine for which\n@xmath the converse is true; that is, for which @xmath we have if @xmath\nthen @xmath .\n\n### 3.1 Toeplitz-Cuntz-Krieger @xmath-families\n\nWe recall the notion of a @xmath -valued 2-cocycle on a @xmath -graph\n@xmath . We identity collections of partial isometries indexed by @xmath\ncalled Toeplitz-Cuntz-Krieger @xmath -families, and study their basic\nproperties. We construct a Toeplitz-Cuntz-Krieger @xmath -family in\n@xmath .\n\n###### Definition 3.1.1.\n\nLet @xmath be a @xmath -graph. A @xmath -valued 2-cocycle on @xmath is a\nmap\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthat satisfies:\n\n1.  @xmath whenever @xmath and @xmath ; and\n\n2.  @xmath for all @xmath .\n\nWe call @xmath the 2-cocycle identity . We write @xmath for the set of\nall @xmath -valued 2-cocycles on @xmath .\n\n###### Definition 3.1.2.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . A subset\n@xmath of a @xmath -algebra is a Toeplitz-Cuntz-Krieger @xmath -family\nif:\n\n1.  @xmath is a set of mutually orthogonal projections;\n\n2.  @xmath whenever @xmath ;\n\n3.  @xmath for all @xmath ; and\n\n4.  @xmath for all @xmath .\n\nThe following lemma lists some direct consequences of Definition 3.1.2 .\n\n###### Lemma 3.1.3.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Suppose\nthat @xmath is a Toeplitz-Cuntz-Krieger @xmath -family. Then:\n\n1.  @xmath for all @xmath ;\n\n2.   the range projections @xmath pairwise commute;\n\n3.   if @xmath then @xmath ;\n\n4.   if @xmath and @xmath then\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n5.  @xmath\n\n6.  @xmath is a set of mutually orthogonal projections for each @xmath ;\n    and\n\n7.   For @xmath , @xmath if and only if @xmath .\n\n###### Proof.\n\nFor @xmath , fix @xmath . We calculate\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince @xmath for all @xmath , statement @xmath is a consequence of\n(TCK4). For (3), fix @xmath such that @xmath . It follows from (TCK1)\nthat @xmath , giving (3).\n\nFor @xmath , fix @xmath such that @xmath and @xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nWe now show (5). We have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand so it suffices to prove that @xmath is a @xmath -algebra. For this\nwe need only prove that @xmath is closed under multiplication and taking\nadjoints. Since @xmath for each @xmath , the subspace @xmath is closed\nunder adjoints. Part (4) implies that @xmath is closed under\nmultiplication.\n\nFix @xmath . We have @xmath , so @xmath is a projection. So for (6), it\nsuffices to show that for each @xmath the projections @xmath , @xmath\nare mutually orthogonal. Fix @xmath . Suppose that @xmath . We show that\n@xmath if @xmath and @xmath otherwise. To see this suppose @xmath .\nThere exist @xmath such that @xmath . Since @xmath we have @xmath . The\nfactorisation property therefore implies that @xmath , so @xmath as\nclaimed. Now (TCK4) gives @xmath . For (7), the @xmath -identity implies\nthat for @xmath\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo for @xmath , @xmath if and only if @xmath . \u220e\n\n###### Remark 3.1.4.\n\nIf @xmath is a Toeplitz-Cuntz-Krieger @xmath -family, then @xmath if and\nonly if @xmath and @xmath . To see this we first need a calculation.\nSuppose that @xmath , two applications of the @xmath -identity gives\n\n  -- -------- -- -------\n     @xmath      (3.1)\n  -- -------- -- -------\n\nSuppose @xmath . Lemma 3.1.3 (3) implies that @xmath . Equation\u00a0( 3.1 )\nimplies that @xmath , and so @xmath by Lemma 3.1.3 (7). Suppose @xmath\nand @xmath . Lemma 3.1.3 (7) implies that @xmath . Equation 3.1 implies\nthat @xmath .\n\nThe following Lemma shows that replacing (TCK3) and (TCK4) in Definition\n3.1.2 by the relation in Lemma 3.1.3 (1) would result in an equivalent\ndefinition of a Toeplitz-Cuntz-Krieger @xmath -family.\n\n###### Lemma 3.1.5.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Suppose\nthat @xmath is a collection of partial isometries in a @xmath -algebra\nsatisfying (TCK1) and (TCK2). Then @xmath is a Toeplitz-Cuntz-Krieger\n@xmath -family if and only if\n\n  -- -------- -- -------\n     @xmath      (3.2)\n  -- -------- -- -------\n\nfor all @xmath .\n\n###### Proof.\n\nSuppose that @xmath is a Toeplitz-Cuntz-Krieger @xmath -family. Relation\n( 3.2 ) follows from Lemma 3.1.3 (1). Suppose that ( 3.2 ) holds. We\nshow (TCK3). Fix @xmath . Equation\u00a0( 3.2 ) implies that\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath satisfies (TCK3). We now show (TCK4). Fix @xmath Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath satisfies (TCK4), and hence is a Toeplitz-Cuntz-Krieger @xmath\n-family. \u220e\n\nTo construct a Toeplitz-Cuntz-Krieger @xmath -family in @xmath , we need\na technical lemma.\n\n###### Lemma 3.1.6.\n\nLet @xmath be a separable Hilbert space with basis @xmath . Suppose\n@xmath and that @xmath is linear and satisfies @xmath for all @xmath .\nThen @xmath is bounded with @xmath , and the unique extension of @xmath\nto @xmath is @xmath , the adjoint of @xmath .\n\n###### Proof.\n\nFix @xmath and @xmath . There is finite @xmath such that @xmath . We\ncalculate\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      \n              @xmath      \n              @xmath      \n              @xmath      \n              @xmath      (3.3)\n  -- -------- -------- -- -------\n\nHence\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath is bounded with @xmath . Denote the unique extension of @xmath\nto @xmath by @xmath . Now ( 3.3 ) gives\n\n  -- -------- -- -------\n     @xmath      (3.4)\n  -- -------- -- -------\n\nFor fixed @xmath , the maps @xmath and @xmath on @xmath are continuous,\nand by ( 3.4 ) agree on a dense subset of @xmath . Therefore they agree\non all of @xmath ; that is, @xmath . By the uniqueness of adjoints we\nhave @xmath . \u220e\n\n###### Proposition 3.1.7.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . For\n@xmath , let @xmath be the point mass function for @xmath . Consider the\nHilbert space @xmath with the usual inner product. For each @xmath ,\nthere is a unique bounded linear operator @xmath on @xmath such that\n\n  -- -------- -- -------\n     @xmath      (3.5)\n  -- -------- -- -------\n\nfor all @xmath . The set @xmath is a Toeplitz-Cuntz-Krieger @xmath\n-family in @xmath .\n\n###### Proof.\n\nTo see that ( 3.5 ) defines a bounded linear operator @xmath on @xmath\nfor each @xmath , we will show that @xmath is a partial isometry and\nhence @xmath . Fix @xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo if @xmath we have @xmath . So if @xmath then,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nIf @xmath then @xmath . So @xmath is a partial isometry and is bounded\nwith @xmath . The calculation @xmath shows that @xmath . By continuity,\n@xmath extends uniquely to a partial isometry in @xmath .\n\nWe now will show that for each @xmath the unique linear extension @xmath\nof\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nextends by continuity to the adjoint of @xmath . By Lemma 3.1.6 it\nsuffices to show that @xmath for all @xmath . That is,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFix @xmath and we calculate,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nNow we will establish the relations (TCK1)-(TCK4) for @xmath . By\nlinearity and continuity it suffices to check these relations on basis\nvectors. For (TCK1) we show that @xmath and @xmath for each @xmath with\n@xmath , so that @xmath is a set of mutually orthogonal projections. Fix\n@xmath . Since @xmath for all @xmath ,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nand\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath            \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath is a set of projections. To see that they are mutually\northogonal fix @xmath with @xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nThis establishes (TCK1). For (TCK2) we must show that @xmath for all\n@xmath with @xmath . Fix @xmath with @xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nThis establishes (TCK2). For (TCK3) we must show @xmath for all @xmath .\nFix @xmath . Using (C1), we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nThis establishes (TCK3). For (TCK4) we must show that @xmath for all\n@xmath . It will be helpful to consider the following calculation. Fix\n@xmath . Then\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      (3.6)\n              @xmath      \n              @xmath      \n  -- -------- -------- -- -------\n\nWe will now show that for any @xmath , @xmath for all @xmath and hence\n@xmath . Fix @xmath . Using ( 3.6 ) we have,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nIf @xmath for some @xmath then the factorisation property ensures that\nthere is exactly one such @xmath . So\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nestablishing (TCK4).\n\n\u220e\n\n### 3.2 The twisted Toeplitz algebra\n\nWe show there is a unique universal @xmath -algebra @xmath , called the\ntwisted Toeplitz algebra, generated by a Toeplitz-Cuntz-Krieger @xmath\n-family @xmath in Theorem 3.2.3 . First we need some technical results.\n\n###### Lemma 3.2.1.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7\n. Then @xmath are linearly independent.\n\n###### Proof.\n\nLet @xmath be a finite subset of @xmath . Let @xmath be the usual basis\nof @xmath . We show that @xmath are linearly independent. The proof is\nby induction on @xmath . Suppose that @xmath for all @xmath . If @xmath\n, let @xmath be the unique pair such that @xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nHence @xmath . As an inductive hypothesis suppose that @xmath is\nlinearly independent whenever @xmath . Suppose @xmath . Fix @xmath such\nthat @xmath for all @xmath . There is such a pair @xmath since @xmath is\nfinite. Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nAs the @xmath are linearly independent with have @xmath for each @xmath\n. Let\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy the inductive hypothesis @xmath is linearly independent. So\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nimplies that @xmath for all @xmath . Thus @xmath for all @xmath . \u220e\n\n###### Proposition 3.2.2.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath and let @xmath be the complex vector space @xmath under pointwise\naddition and scalar multiplication. For each @xmath , let @xmath be the\npoint mass function for @xmath . There is a unique multiplication on\n@xmath satisfying\n\n  -- -------- -- -------\n     @xmath      (3.7)\n  -- -------- -- -------\n\nfor all @xmath . There is an involution @xmath given by @xmath . Under\nthese operations @xmath is a *-algebra.\n\n###### Proof.\n\nWe check:\n\n1.  that @xmath determines a self-inverse conjugate-linear map;\n\n2.  that the multiplication uniquely extends bilinearly to all of @xmath\n    ;\n\n3.  that this multiplication is associative and commutes with scalar\n    multiplication; and\n\n4.  that @xmath for all @xmath .\n\nFor (1), fix @xmath , @xmath and @xmath . We calculate.\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath is conjugate linear. The map @xmath is self-inverse since\ncomplex conjugation is, establishing (1). The @xmath are linearly\nindependent and span @xmath , so each @xmath has the unique expression\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor (2), the formula\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      \n              @xmath      \n              @xmath      (3.8)\n  -- -------- -------- -- -------\n\nextends multiplication to all of @xmath . Multiplication is bilinear as\nthe vector space operations are pointwise, establishing (2).\n\nFor (3), it suffices to check @xmath and that @xmath for all @xmath and\n@xmath , the latter follows from ( 3.7 ).\n\nFix @xmath . To show associativity, we use our Toeplitz-Cuntz-Krieger\n@xmath -family @xmath in @xmath and Lemma 3.2.1 . Define @xmath by\n@xmath . This is well-defined since the @xmath are linearly independent.\nThe map @xmath is linear by definition of the vector space operations in\n@xmath and @xmath . We claim that @xmath also preserves multiplication.\nAs @xmath is linear and multiplication is bilinear, it suffices to show\nthat @xmath . We have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nWe also claim that @xmath is injective. Fix @xmath . Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nLemma 3.2.1 implies that @xmath for all @xmath . Hence @xmath . We can\nnow use the map @xmath to show that the multiplication in @xmath is\nassociative. As multiplication in @xmath is associative, we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince @xmath is injective we have @xmath , establishing (3). For (4), it\nsuffices to check that @xmath for all @xmath . Fix @xmath . We have\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\nWe can now construct the twisted Toeplitz algebra @xmath .\n\n###### Theorem 3.2.3.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . There\nexists a @xmath -algebra @xmath generated by a Toeplitz-Cuntz-Krieger\n@xmath -family @xmath that is universal in the sense that for each\nToeplitz-Cuntz-Krieger @xmath -family @xmath in a @xmath -algebra @xmath\n, there exists a homomorphism @xmath such that @xmath for all @xmath .\nThe @xmath -algebra @xmath is unique in the sense that if @xmath is a\n@xmath -algebra generated by a Toeplitz-Cuntz-Krieger @xmath -family\n@xmath satisfying the universal property, then there is an isomorphism\nof @xmath onto @xmath such that @xmath for all @xmath . We call @xmath\nthe twisted Toeplitz algebra of @xmath .\n\n###### Proof.\n\nFor this proof, we abbreviate Toeplitz-Cuntz-Krieger by TCK and write\n@xmath is a TCK @xmath -family for @xmath is a TCK @xmath -family.\n\nFirst we show that each TCK @xmath -family induces a homomorphism of\n@xmath . Fix a TCK @xmath -family t. Define a map @xmath by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe claim @xmath is a homomorphism. One easily checks that @xmath is\nlinear. Fix @xmath . There are finite @xmath such that @xmath and @xmath\n. Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nand\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath is a homomorphism.\n\nFor each @xmath , we claim that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis bounded. Fix @xmath and a TCK @xmath -family @xmath . There is finite\n@xmath such that @xmath . For each @xmath , we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nAs @xmath is a projection it has norm @xmath or @xmath , and the same is\ntrue of @xmath . We have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nwhich establishes our claim.\n\nFor each @xmath , define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe function @xmath is a *-algebra seminorm on @xmath since it is\ndefined as the supremum of a collection of seminorms. For each TCK\n@xmath -family @xmath , the kernel of @xmath is a two-sided *-ideal in\n@xmath . So\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis also a two-sided *-ideal in @xmath . Let @xmath . Define @xmath by\n@xmath ; this is well defined. To see this suppose that @xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nThe calculations\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nand\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nshow that @xmath is a Banach *-algebra norm and satisfies the @xmath\n-identity. Denote the completion of @xmath by @xmath , which is a @xmath\n-algebra by construction.\n\nFor @xmath , define @xmath . We claim that @xmath is a TCK @xmath\n-family that generates @xmath . If @xmath , then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath with @xmath then @xmath . This gives (TCK1). If @xmath with\n@xmath , then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nestablishing (TCK2). For @xmath , we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nThis gives (TCK3). For (TCK4), fix @xmath . We have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nThis gives (TCK4). If @xmath with @xmath , then as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthe TCK @xmath -family @xmath generates @xmath . We must now check that\n@xmath and @xmath have the universal property. Fix a TCK @xmath -family\n@xmath . For @xmath , we have\n\n  -- -------- -- -------\n     @xmath      (3.9)\n  -- -------- -- -------\n\nHence if @xmath then @xmath , and so @xmath . Hence there is a\nwell-defined linear map @xmath given by @xmath . This @xmath is a\nhomomorphism by definition of the operations in the quotient @xmath and\nbecause @xmath is homomorphism. Equation\u00a0( 3.9 ) implies that for @xmath\n, we have @xmath . So the homomorphism @xmath is continuous, and hence\nextends to the desired homomorphism @xmath .\n\nFor the final statement, suppose @xmath is a @xmath -algebra generated\nby TCK @xmath -family @xmath satisfying the universal property. As\n@xmath is universal there is a homomorphism @xmath such that @xmath for\neach @xmath . As @xmath is universal there is a homomorphism @xmath such\nthat @xmath for each @xmath . Since @xmath and @xmath are the identity\nmaps on the generators of @xmath and @xmath respectively, @xmath and\n@xmath are mutually inverse and hence isomorphisms. \u220e\n\n### 3.3 Relative Cuntz-Krieger @xmath-families\n\nThis section introduces the twisted relative Cuntz-Krieger algebras\nassociated to finitely aligned @xmath -graph @xmath . For each @xmath\nand each collection @xmath of finite exhaustive sets, the twisted\nrelative Cuntz-Krieger algebra @xmath is the universal @xmath -algebra\ngenerated by a Toeplitz-Cuntz-Krieger @xmath -family @xmath satisfying\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhenever @xmath . When @xmath , the associated twisted relative\nCuntz-Krieger algebra @xmath is the Toeplitz algebra @xmath studied in\nthe last section. When @xmath denotes the identity 2-cocycle, we obtain\nthe relative Cuntz-Krieger algebra @xmath studied in [ 18 ] . When\n@xmath is the collection of all finite exhaustive sets @xmath [ 16 ] ,\nwe obtain the twisted Cuntz-Krieger algebra @xmath . The twisted\nrelative Cuntz-Krieger algebras @xmath interpolate between the Toeplitz\nalgebra @xmath , and the Cuntz-Krieger algebra @xmath . More precisely,\nfor each @xmath there is an ideal @xmath such that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand, in particular, there is @xmath such that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Definition 3.3.1 ([16], Definition 2.4).\n\nLet @xmath be a @xmath -graph and let @xmath . A subset @xmath is said\nto be exhaustive if for every @xmath there exists a @xmath such that\n@xmath . Define @xmath .\n\n###### Definition 3.3.2.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Suppose that @xmath\nand that @xmath is nonempty and finite. We write @xmath for the unique\n@xmath such that @xmath . We call the product\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthe gap projection of @xmath associated to @xmath .\n\n###### Remark 3.3.3.\n\nThe product\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis well-defined as the projections @xmath pairwise commute. Hence for\n@xmath and @xmath ,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nAn induction argument over @xmath therefore shows that @xmath is\nindependent of the order of multiplication.\n\nThe following definition is ( [ 18 ] , Definition 3.2) but with the\n2-cocycle incorporated.\n\n###### Definition 3.3.4.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . A relative Cuntz-Krieger @xmath -family is a\nToeplitz-Cuntz-Krieger @xmath -family @xmath that satisfies\n\n  -- -------- -- ------\n     @xmath      (CK)\n  -- -------- -- ------\n\nWhen @xmath , we call the resulting relative Cuntz-Krieger @xmath\n-family a Cuntz-Krieger @xmath -family .\n\nNote that every Toeplitz-Cuntz-Krieger @xmath -family is a relative\nCuntz-Krieger @xmath -family and every relative Cuntz-Krieger @xmath\n-family is a Toeplitz-Cuntz-Krieger @xmath -family.\n\n###### Definition 3.3.5.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Define @xmath to be the intersection of all closed ideals\ncontaining\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Lemma 3.3.6.\n\nLet @xmath be @xmath -algebras and let @xmath . Let @xmath denote the\nintersection of all closed ideals containing @xmath . Then @xmath is the\nsmallest ideal containing @xmath and\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe call @xmath the ideal generated by @xmath . Suppose @xmath is a\nhomomorphism such that @xmath for all @xmath . Then @xmath for all\n@xmath . There is a unique homomorphism @xmath satisfying @xmath for all\n@xmath .\n\n###### Proof.\n\nIt is routine to check that an arbitrary intersection of closed ideals\ncontaining @xmath is a closed ideal containing @xmath . The ideal @xmath\nis the intersection of all closed ideals containing @xmath and hence the\nsmallest closed ideal containing @xmath . The set @xmath is a closed\nideal. Let @xmath be an approximate identity for @xmath . Then @xmath\nfor each @xmath . So @xmath contains @xmath . Since every closed ideal\nthat contains @xmath must contain @xmath , we have @xmath . Since @xmath\nis the smallest closed ideal containing @xmath , we have @xmath .\nSuppose that @xmath and that @xmath . We have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath for all @xmath . By continuity, we have @xmath for all @xmath\n.\n\nTo see that the map @xmath is well-defined, suppose that @xmath . Then\n@xmath for some @xmath , and so @xmath . Since a closed ideal in a\n@xmath -algebra is automatically self-adjoint, there is a well-defined\ninvolution @xmath satisfying @xmath for all @xmath . That @xmath is a\nhomomorphism then follows from the definitions of the operations in the\nquotient @xmath and that @xmath is a homomorphism. \u220e\n\n###### Theorem 3.3.7.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . There exists a @xmath -algebra @xmath generated by a relative\nCuntz-Krieger @xmath -family @xmath that is universal in the sense that\nif @xmath is a relative Cuntz-Krieger @xmath -family in a @xmath\n-algebra @xmath , then there exists a homomorphism @xmath such that\n@xmath for all @xmath . The @xmath -algebra @xmath is unique in the\nsense that, if @xmath is a @xmath -algebra generated by a relative\nCuntz-Krieger @xmath -family @xmath satisfying the universal property,\nthere is an isomorphism of @xmath onto @xmath such that @xmath for all\n@xmath . We call @xmath the twisted relative Cuntz-Krieger algebra of\n@xmath .\n\n###### Proof.\n\nLet @xmath and let @xmath . To prove that @xmath is a relative\nCuntz-Krieger @xmath -family, we only need to show that @xmath for each\n@xmath . If @xmath , then @xmath by definition, so @xmath .\n\nWe will now construct the homomorphism @xmath . Fix a relative\nCuntz-Krieger @xmath -family @xmath in a @xmath algebra @xmath . Let\n@xmath be the homomorphism from Theorem 3.2.3 . If @xmath , then\n\n  -- -------- -- --------\n     @xmath      (3.10)\n  -- -------- -- --------\n\nLemma 3.3.6 implies that @xmath for all @xmath , and that there is a\nhomomorphism @xmath satisfying @xmath for all @xmath . Fix @xmath . Then\n@xmath . The proof that @xmath is unique is identical to the proof that\n@xmath is unique in Theorem 3.2.3 . \u220e\n\n### 3.4 Gap projections and boundary paths\n\nFor a collection @xmath , we recall the definition of the satiation\n@xmath of @xmath from [ 18 ] in Definition 3.4.7 . We show that for each\ncollection @xmath , the gap projection @xmath in @xmath associated to a\nfinite exhaustive set @xmath is zero if and only if @xmath .\n\nFor @xmath , we wish to know precisely which finite subsets @xmath of\n@xmath satisfy\n\n  -- -------- -- --------\n     @xmath      (3.11)\n  -- -------- -- --------\n\nThe following remark says that if @xmath then @xmath . If @xmath is not\nexhaustive, Lemma 3.4.2 implies that @xmath . So in order to find out\nprecisely which finite subsets @xmath of @xmath satisfy\u00a0( 3.11 ), we\nonly need to consider the case when @xmath is exhaustive; that is,\n@xmath .\n\n###### Remark 3.4.1.\n\nSuppose that @xmath is finite and that @xmath . Then since @xmath , we\nhave\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor all Toeplitz-Cuntz-Krieger @xmath -families @xmath .\n\n###### Lemma 3.4.2.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath and suppose that @xmath is a Toeplitz-Cuntz-Krieger @xmath\n-family. Suppose that @xmath is finite and is not exhaustive. Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhenever @xmath is nonzero for all @xmath .\n\n###### Proof.\n\nSince @xmath is not exhaustive there exists @xmath such that for all\n@xmath we have @xmath . By (TCK4) we have @xmath for all @xmath . As\n@xmath is a projection @xmath . Since @xmath commutes with @xmath for\neach @xmath , we have\n\n  -- -- -------- --\n        @xmath   \n        @xmath   \n        @xmath   \n        @xmath   \n  -- -- -------- --\n\nSince @xmath , Remark 3.1.4 implies that @xmath , and so @xmath . \u220e\n\nThe next lemma shows that in the twisted Toeplitz algebra the gap\nprojections associated to @xmath are all nonzero.\n\n###### Lemma 3.4.3.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7\n. For all @xmath and all finite @xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe same is true for the family @xmath .\n\n###### Proof.\n\nFix @xmath and finite @xmath . We prove by induction on @xmath that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath , say @xmath , then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSuppose @xmath whenever @xmath . Then for @xmath and any @xmath , we\nhave\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nHence by induction @xmath for all finite @xmath . In particular @xmath .\nBy Theorem 3.2.3 there is a unique homomorphism @xmath satisfying @xmath\nfor all @xmath . Hence @xmath \u220e\n\nThe next few Lemmas involve technical calculations concerning the\nalgebraic manipulation of gap projections. Recall from Definition 2.2.3\n, that for @xmath and @xmath , we may form the collection @xmath .\n\n###### Lemma 3.4.4.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath . Then for\n@xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nSuppose that @xmath . Since @xmath is a partial isometry,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nApplying (TCK2) and (TCK4) gives\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nFactorising gives\n\n  -- -------- -- --\n     @xmath      \n  -- -------- -- --\n\nFor each @xmath such that there is @xmath with @xmath we have @xmath .\nLemma 3.1.3 (6) implies that @xmath is a set of mutually orthogonal\nprojections. Hence\n\n  -- -------- -------- --\n     @xmath   @xmath   \n  -- -------- -------- --\n\nUsing the definition of @xmath and (TCK3) we have\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Lemma 3.4.5.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Suppose that @xmath ,\nthat @xmath and that @xmath is finite. Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nAs @xmath for all @xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor all @xmath . The range projections pairwise commute by Lemma 3.1.3\n(2). Since @xmath is finite, it follows that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince @xmath is a projection, we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nsince @xmath \u220e\n\n###### Lemma 3.4.6.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Then:\n\n1.   if @xmath and @xmath is finite with @xmath , then @xmath ;\n\n2.   if @xmath with @xmath and if @xmath , then @xmath ;\n\n3.   if @xmath , @xmath for each @xmath and @xmath , then @xmath .\n\n###### Proof.\n\nFor (1), suppose that @xmath and that @xmath is finite with @xmath . The\nrange projections @xmath pairwise commute by Lemma 3.1.3 (2). It follows\nthat @xmath .\n\nFor (2), suppose that @xmath satisfies @xmath and that @xmath . Lemma\n3.4.4 implies that @xmath . Multiplying both sides on the left by @xmath\ngives\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor (3), suppose that @xmath and that @xmath for each @xmath . Set\n@xmath . Since\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor all @xmath . It follows that @xmath \u220e\n\nGiven a collection @xmath , we recall the definition of @xmath , the\nsatiation of @xmath , from [ 18 ] .\n\n###### Definition 3.4.7 ([18], Definition 4.1).\n\nLet @xmath be a finitely aligned @xmath -graph. We say that a subset\n@xmath of @xmath is satiated if it satisfies:\n\n1.   if @xmath and @xmath is finite with @xmath then @xmath ;\n\n2.   if @xmath with @xmath and if @xmath then @xmath ;\n\n3.   if @xmath and @xmath for each @xmath , then @xmath ; and\n\n4.   if @xmath and @xmath for each @xmath , then @xmath .\n\nThe smallest collection of subsets of @xmath which contains @xmath and\nsatisfies (S1)-(S4) is denoted @xmath and called the satiation of @xmath\n.\n\nLet @xmath be a finitely aligned @xmath -graph and @xmath .\nDefinition\u00a05.2 of [ 18 ] defines maps @xmath given by\n\n  -- -------- -------- --\n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n     @xmath   @xmath   \n  -- -------- -------- --\n\nNote that Lemma\u00a05.3 of [ 18 ] implies that @xmath for each @xmath\n\nThe following summarises some properties of @xmath .\n\n###### Lemma 3.4.8.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be a relative Cuntz-Krieger @xmath -family. Then:\n\n1.   the satiation @xmath of @xmath is a subset of @xmath ;\n\n2.   if @xmath then @xmath ; and\n\n3.   the ideals @xmath and @xmath of @xmath are equal.\n\nMoreover, @xmath .\n\n###### Proof.\n\nPart (1): Let @xmath . Fix @xmath . Lemma 5.3 of [ 18 ] implies that\n@xmath . Write @xmath for\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe have @xmath . Proposition 5.5 of [ 18 ] implies that @xmath . This\ngives part (1).\n\nPart (2): Since @xmath and since @xmath for all @xmath and @xmath , by\ninduction it suffices to show that if @xmath for all @xmath , where\n@xmath then @xmath for all @xmath for each @xmath\n\nFix @xmath such that @xmath for all @xmath . We consider the cases\n@xmath separately. Suppose that @xmath . Fix @xmath . Then @xmath for\nsome @xmath . Lemma 3.4.6 implies that @xmath . Suppose that @xmath .\nFix @xmath . Then @xmath for some @xmath and @xmath . Lemma 3.4.6\nimplies that @xmath . Suppose that @xmath . Fix @xmath . Then @xmath for\nsome @xmath where @xmath for each @xmath . Lemma 3.4.6 implies that\n@xmath . Suppose that @xmath . Fix @xmath . Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor some @xmath , @xmath and @xmath for each @xmath . Lemma 3.4.5\nimplies that for each @xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nFor part (3), since @xmath it suffices to show the reverse containment.\nSuppose @xmath . By part (2), we have @xmath . Hence @xmath . So @xmath\ncontains all the generators of @xmath , hence @xmath . \u220e\n\nThe main goal for the rest of this chapter is to show that the converse\nof Lemma 3.4.8 (2) holds in the @xmath -algebra @xmath ; that is, for\n@xmath , @xmath implies that @xmath . This is achieved with Theorem\n3.4.16 . First we need several technical lemmas on boundary paths and\nthe structure of the ideals @xmath .\n\n###### Lemma 3.4.9.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath . Suppose\n@xmath . Then:\n\n1.   if @xmath then\n\n      -- -------- -- --------\n         @xmath      (3.12)\n      -- -------- -- --------\n\n2.   if @xmath then\n\n      -- -------- -- --------\n         @xmath      (3.13)\n      -- -------- -- --------\n\n###### Proof.\n\nSuppose that @xmath . There exists @xmath and @xmath such that @xmath .\nThen @xmath and hence @xmath . As @xmath , Lemma 3.4.4 implies that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nsince @xmath . Suppose @xmath . Then as @xmath , using (TCK1) we have,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (3.14)\n              @xmath      \n              @xmath      \n  -- -------- -------- -- --------\n\nHence if @xmath then @xmath , establishing part (1) of the Lemma. Part\n(2) is Lemma 3.4.4 . \u220e\n\nWe can now write down spanning elements for the ideals @xmath .\n\n###### Lemma 3.4.10.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath . Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nLet\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFix @xmath and @xmath such that @xmath and @xmath . We calculate,\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (3.15)\n              @xmath      \n              @xmath      \n              @xmath      \n              @xmath      \n              @xmath      \n              @xmath      \n              @xmath      \n  -- -------- -------- -- --------\n\nSince @xmath is satiated, each @xmath , and hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSuppose that @xmath and @xmath . Since multiplication is bilinear,\nequation ( 3.15 ) implies that @xmath . Taking adjoints of both sides of\n( 3.15 ) shows that @xmath . We show that @xmath is an ideal. Fix @xmath\nand @xmath . By Lemma 3.1.3 (5) there is a sequence @xmath such that\n@xmath as @xmath . Similarly, there is a sequence @xmath such that\n@xmath as @xmath . As multiplication in a @xmath -algebra is jointly\ncontinuous we have @xmath and @xmath as @xmath . The above argument\nshows that @xmath for each @xmath and hence @xmath . Hence @xmath is a\nclosed ideal in @xmath . Since @xmath and @xmath is closed, @xmath . The\nset @xmath contains all the gap projections associated to @xmath . As\n@xmath is the smallest closed ideal that contains all the gap\nprojections associated to @xmath , we have @xmath . \u220e\n\nFor a @xmath -graph @xmath , recall from Definition 2.3.2 the collection\n@xmath of graph morphisms @xmath .\n\n###### Definition 3.4.11 ([18], Definition 4.3).\n\nLet @xmath be a finitely aligned @xmath -graph, and let @xmath be a\nsubset of @xmath . We say that @xmath is an @xmath - relative boundary\npath of @xmath if for every @xmath such that @xmath , and every @xmath\nsuch that @xmath , there exists @xmath such that @xmath . We denote the\ncollection of all @xmath -relative boundary paths of @xmath by @xmath .\n\nLet @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition\n3.1.7 . The next few technical lemmas use @xmath -relative boundary\npaths to characterise when, for @xmath , the gap projection @xmath\nbelongs to the @xmath -algebra @xmath . This charactisation enables us\nto prove Theorem 3.4.16 , the main result of this section.\n\n###### Lemma 3.4.12.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of\nProposition 3.1.7 . Suppose that @xmath and that @xmath satisfy @xmath .\nIf @xmath satisfies @xmath , then there exists @xmath with @xmath such\nthat @xmath for all @xmath such that @xmath .\n\n###### Proof.\n\nWe consider two cases: @xmath and then @xmath . Suppose first that\n@xmath . Fix @xmath . Then @xmath , so @xmath does not have the form\n@xmath . Hence @xmath . So @xmath does the job.\n\nSuppose that @xmath . First suppose that @xmath . Fix @xmath . The\nfactorisation property implies that @xmath does not have the form @xmath\n. So @xmath does the job.\n\nNow suppose that @xmath and @xmath . Set @xmath . As @xmath is an @xmath\n-relative boundary path and @xmath , there exists @xmath such that\n@xmath . Put @xmath and fix @xmath such that @xmath Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nHence\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Lemma 3.4.13.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of\nProposition 3.1.7 . For each @xmath there exists @xmath with @xmath such\nthat @xmath whenever @xmath .\n\n###### Proof.\n\nFix @xmath , say, @xmath where @xmath , @xmath and @xmath for each\n@xmath . For each @xmath , Lemma 3.4.12 implies that there exists @xmath\nsuch that @xmath for all @xmath . Put @xmath . Then @xmath for all\n@xmath . \u220e\n\n###### Lemma 3.4.14.\n\nLet @xmath be a finitely aligned @xmath -graph, @xmath and @xmath . Let\n@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7\n. For all @xmath , if @xmath then @xmath .\n\n###### Proof.\n\nFix @xmath and @xmath . There exists @xmath such that @xmath . By Lemma\n3.4.10 , there exists\n\n  -- -- --\n        \n  -- -- --\n\nsuch that @xmath . Since @xmath is a homomorphism\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy Lemma 3.4.13 there exists @xmath such that whenever @xmath we have\n@xmath . Then whenever @xmath we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince homomorphisms between @xmath -algebras are norm decreasing, we\nhave\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nHence @xmath \u220e\n\nRecall from Lemma\u00a04.7 of [ 18 ] that if @xmath is a finitely aligned\n@xmath -graph, @xmath , and @xmath , then for each @xmath , both @xmath\nand @xmath are nonempty.\n\n###### Lemma 3.4.15.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of\nProposition 3.1.7 . If @xmath , there exists @xmath such that @xmath for\nall @xmath .\n\n###### Proof.\n\nBy ( [ 18 ] , Lemma 4.7), there exists @xmath . Fix @xmath and @xmath .\nWe have @xmath . By the factorisation property @xmath for any @xmath .\nHence\n\n  -- -------- -------- --\n     @xmath   @xmath   \n  -- -------- -------- --\n\nHence @xmath . \u220e\n\n###### Theorem 3.4.16.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath . We have\n\n1.  @xmath for all @xmath ; and\n\n2.   for @xmath , @xmath if and only if @xmath .\n\n###### Proof.\n\nFor (1), fix @xmath . By ( [ 18 ] , Lemma 4.7) there exists @xmath . Let\n@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7\n. For any @xmath we have @xmath . Lemma 3.4.14 implies that @xmath .\nSince @xmath by Lemma 3.4.8 , we have @xmath and thus @xmath . For (2),\nsuppose that @xmath . By Lemma 3.4.15 there is @xmath such that @xmath .\nLemma 3.4.14 implies that @xmath . Hence @xmath and thus @xmath . If\n@xmath then @xmath . So @xmath . \u220e\n\n## Chapter 4 Analysis of the core\n\nIn this chapter we establish the existence of a strongly continuous\ngroup action @xmath of @xmath on @xmath . We call @xmath the gauge\naction. Averaging over @xmath gives a faithful conditional expectation\nof @xmath onto the fixed point algebra for @xmath , which we call the\ncore. We show that the core @xmath is the closed linear span of elements\nof the form @xmath where @xmath . We show that @xmath is AF. If @xmath\nis a relative Cuntz-Krieger @xmath -family, we provide conditions under\nwhich\n\n  -- -- --\n        \n  -- -- --\n\nIf @xmath and there is an action @xmath such that @xmath is equivariant\nfor @xmath and @xmath , we show that @xmath is injective. This\ngeneralisation of an Huef and Raeburn\u2019s gauge-invariant uniqueness\ntheorem is the main result of the chapter.\n\n### 4.1 Group actions and faithful conditional expectations\n\nThis section presents standard results associated to groups actions and\nfaithful conditional expectations. These results may be recovered,\nsomewhat nontrivially, from [ 4 ] . Many can also be found in [ 21 ] .\nFor the most part, we do not give proofs, but just recall the results we\nwill need later.\n\n###### Definition 4.1.1.\n\nLet @xmath be a @xmath -algebra and let @xmath a compact abelian group.\nA group action is a homomorphism\n\n  -- -------- -------- --\n     @xmath   @xmath   \n  -- -------- -------- --\n\nthat is strongly continuous; that is, whenever @xmath as @xmath in\n@xmath we have @xmath as @xmath in @xmath for each @xmath .\n\n###### Definition 4.1.2.\n\nLet @xmath be a @xmath -algebra and let @xmath a compact abelian group.\nWe write @xmath for the dual group of @xmath ; that is, the group of\nhomomorphisms @xmath with pointwise multiplication. We define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand for @xmath we define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNote that @xmath where @xmath is given by @xmath for all @xmath .\n\n###### Lemma 4.1.3.\n\nLet @xmath be a @xmath -algebra, let @xmath a compact abelian group and\nlet @xmath be a group action. Then:\n\n1.  @xmath is a closed subspace for each @xmath ;\n\n2.  @xmath is a @xmath -subalgebra of @xmath ;\n\n3.  @xmath ; and\n\n4.  @xmath for all @xmath .\n\n###### Definition 4.1.4.\n\nLet @xmath be a @xmath -algebra and let @xmath be a @xmath -subalgebra\nof @xmath . A map @xmath is called a faithful conditional expectation\nif:\n\n1.  @xmath is linear;\n\n2.  @xmath is bounded with @xmath ;\n\n3.  @xmath ; and\n\n4.  @xmath .\n\n###### Lemma 4.1.5.\n\nLet @xmath and @xmath be @xmath -algebras and let @xmath be a\nhomomorphism. Let @xmath and @xmath be @xmath -subalgebras of @xmath and\n@xmath respectively. Suppose there are a faithful conditional\nexpectation @xmath and a linear map @xmath such that the diagram\n\n[]\n\ncommutes. Then @xmath is injective if and only if @xmath is injective.\n\n###### Proof.\n\nLet @xmath . If @xmath is injective then so is @xmath . Suppose @xmath\nis injective. Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nAs @xmath is linear it follows that @xmath is injective. \u220e\n\n###### Lemma 4.1.6.\n\nLet @xmath be a @xmath -algebra, let @xmath a compact abelian group and\nlet @xmath be a group action. Let @xmath denote the normalised Haar\nmeasure on @xmath . Then @xmath given by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a faithful conditional expectation onto @xmath . Moreover,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n### 4.2 The gauge action\n\nThis section establishes the existence of the gauge action. We show that\nthe gauge action is strongly continuous and study its fixed point\nalgebra. We study properties of the faithful conditional expectation\nobtained by averaging over the gauge action.\n\nLet @xmath be a finitely aligned @xmath -graph. For @xmath and @xmath ,\ndefine\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Lemma 4.2.1.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a subset of @xmath . Fix @xmath . There is an automorphism\n@xmath of @xmath such that @xmath for all @xmath\n\n###### Proof.\n\nWe show that\n\n  -- -------- -- -------\n     @xmath      (4.1)\n  -- -------- -- -------\n\nis a Cuntz-Krieger @xmath -family in @xmath . Theorem 3.3.7 will then\nimply that there is a homomorphism @xmath such that @xmath for all\n@xmath . Then we show that @xmath so that @xmath is an automorphism.\n\nFirst we show (TCK1). Fix @xmath . Since @xmath , we have @xmath . So\n(TCK1) for @xmath follows from (TCK1) for @xmath .\n\nFor each @xmath , @xmath and @xmath . So (TCK3), (TCK4) and (CK) for\n@xmath follows from (TCK3), (TCK4) and (CK) for @xmath . So it remains\nto show (TCK2). Fix @xmath such that @xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nwhich establishes (TCK2). So @xmath is a Cuntz-Krieger @xmath -family in\n@xmath .\n\nBy Theorem 3.3.7 there is a homomorphism @xmath such that @xmath for all\n@xmath . Fix @xmath . We have\n\n  -- -------- -------- --\n     @xmath            \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nBy Theorem 3.3.7 the collection @xmath generates @xmath . Since @xmath\nis a homomorphism, we have @xmath . The same calculation but with @xmath\nreplaced with @xmath gives @xmath . So @xmath is an automorphism. \u220e\n\n###### Lemma 4.2.2.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a subset of @xmath . Then @xmath is a homomorphism from @xmath\nto @xmath . This homomorphism is strongly continuous in the sense that\nif @xmath as @xmath in @xmath then @xmath as @xmath in @xmath for every\n@xmath . The map @xmath is called the gauge action.\n\n###### Proof.\n\nFirst we show that @xmath is a homomorphism from @xmath to @xmath . For\neach @xmath , Lemma 4.2.1 implies that @xmath is an automorphism. So it\nsuffices to show that @xmath is a homomorphism. To see this, fix @xmath\nand @xmath . Since @xmath and @xmath are homomorphisms we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince @xmath and @xmath are homomorphisms, we deduce that @xmath is a\nhomomorphism.\n\nWe will now show that this homomorphism is strongly continuous. Fix\n@xmath , @xmath , @xmath and a sequence @xmath in @xmath such that\n@xmath as @xmath . The case where @xmath is trivial since @xmath for all\n@xmath , so we assume that @xmath . Since\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthere is nonempty and finite @xmath and @xmath with @xmath where @xmath\nfor all @xmath . Now\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nFor @xmath , the map @xmath is continuous for each @xmath . Hence @xmath\nas @xmath in @xmath . So for each @xmath , there is @xmath such that if\n@xmath then @xmath . So whenever @xmath , the above calculation shows\nthat\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince homomorphisms of @xmath -algebras are norm decreasing, when we\nhave @xmath\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath as @xmath in @xmath for every @xmath . \u220e\n\n###### Lemma 4.2.3.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a subset of @xmath . Let @xmath be a relative Cuntz-Krieger\n@xmath -family generating a @xmath -algebra @xmath . Suppose that there\nis an action @xmath such that @xmath for all @xmath . We have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nWe claim that\n\n  -- -------- -- -------\n     @xmath      (4.2)\n  -- -------- -- -------\n\nfor all @xmath , where @xmath denotes the Kronecker delta function.\nRecall that each @xmath determines a character @xmath by @xmath for each\n@xmath : in fact, @xmath is isomorphism, although we do not need this.\nFix @xmath . If @xmath , then @xmath . Now suppose @xmath . There exists\n@xmath such that @xmath . Fix @xmath such that @xmath , and define\n@xmath by @xmath and @xmath for @xmath . Then @xmath , demonstrating\nthat @xmath . To show\u00a0( 4.2 ), it now suffices by Lemma 4.1.6 to show\nthat @xmath for each @xmath . For this, we calculate\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nestablishing\u00a0( 4.2 ). Lemma 4.1.6 implies that @xmath . This, together\nwith\u00a0( 4.2 ), gives\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Definition 4.2.4.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Applying Lemma 4.2.3 to the gauge-action @xmath on @xmath we\nobtain\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwe call this the core of @xmath\n\n###### Proposition 4.2.5.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be the gauge action. Suppose that @xmath is a\nrelative Cuntz-Krieger @xmath -family in a @xmath -algebra @xmath and\nthat there exists a group action @xmath such that @xmath for all @xmath\nand @xmath . Write @xmath for the homomorphism @xmath given by the\nuniversal property. If @xmath is injective then @xmath is injective.\n\n###### Proof.\n\nBy Lemma 4.1.6 there are faithful conditional expectations @xmath and\n@xmath . By Lemma 4.2.3 , @xmath and @xmath satisfy\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath satisfy @xmath , then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath restricts to a homomorphism from @xmath to @xmath by linearity\nand continuity. We have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath on the spanning elements of @xmath and hence on all of @xmath\n. Thus, the diagram\n\n[]\n\ncommutes. Lemma 4.1.5 implies that if @xmath is injective then @xmath is\ninjective. \u220e\n\n### 4.3 Orthogonalising range projections\n\nWe want to establish conditions under which the canonical homomorphism\n@xmath determined by a relative Cuntz-Krieger @xmath -family @xmath\nrestricts to an isomorphism of the core. Our strategy is to show that\n@xmath is an increasing union of finite-dimensional subalgebras. To find\nmatrix units for these finite dimensional subalgebras, we first\n\u201corthogonalise\u201d the generators of @xmath . We begin by concentrating on\nthe \u201cdiagonal\u201d subalgebra @xmath .\n\n###### Definition 4.3.1.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Suppose that @xmath\nis a finite subset of @xmath . For @xmath , we define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Remark 4.3.2.\n\n1.   Lemma 3.1.3  (2) shows that for a finite set @xmath , the product\n    @xmath is both well-defined and a projection for each @xmath .\n\n2.   By convention, when a formal product in a @xmath -algebra @xmath is\n    indexed by the empty set, it is taken to be equal to the unit of the\n    multiplier algebra of @xmath . In particular, if @xmath is such that\n    there exists no @xmath with @xmath , then @xmath\n\n###### Definition 4.3.3.\n\nLet @xmath be a finitely aligned @xmath -graph. A subset @xmath of\n@xmath is said to be closed under minimal common extensions if\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe main result of this section is the following Proposition.\n\n###### Proposition 4.3.4 (cf. [16], Proposition 3.5).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a\nfinite subset of @xmath that is closed under minimal common extensions.\nThen @xmath is a collection of mutually orthogonal (possibly zero)\nprojections such that\n\n  -- -------- -- -------\n     @xmath      (4.3)\n  -- -------- -- -------\n\nfor each @xmath\n\nIn order to prove Proposition 4.3.4 we reduce to the case where @xmath\nfor some @xmath , and @xmath contains @xmath .\n\n###### Lemma 4.3.5.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath . Suppose\nthat @xmath is a finite subset of @xmath , that @xmath and that @xmath\nis closed under minimal common extensions. Then @xmath is a collection\nof mutually orthogonal (possibly zero) projections such that\n\n  -- -------- -- -------\n     @xmath      (4.4)\n  -- -------- -- -------\n\nUsing Lemma 4.3.5 we prove Proposition 4.3.4 .\n\n###### Proof of Proposition\u00a04.3.4.\n\nThe following argument is taken from the work of Raeburn, Sims and Yeend\nin [ 16 ] . The difference here being that we must account for the\n2-cocycle, but it turns out that this plays little r\u00f4le.\n\nRemark 4.3.2 shows that @xmath is projection for each @xmath . Then\nsince each @xmath is a projection for each @xmath , equation ( 4.4 )\nshows that they are mutually orthogonal. So we are left to prove ( 4.3\n).\n\nFirst, suppose that @xmath is closed under minimal common extensions.\nThe case where @xmath is exactly Lemma 4.3.5 , so suppose that @xmath .\nWe must show that @xmath satisfies ( 4.3 ). Let @xmath . Since @xmath\nfor each @xmath , the set @xmath is closed under minimal common\nextensions, contains @xmath and is a subset of @xmath . Hence Lemma\n4.3.5 gives\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nNow suppose @xmath is finite and closed under minimal common extensions.\nFix @xmath . We will show that @xmath and @xmath satisfy ( 4.3 ). Notice\nthat for all @xmath with @xmath ,\n\n  -- -------- -- -------\n     @xmath      (4.5)\n  -- -------- -- -------\n\nLet @xmath . Then @xmath is finite and if @xmath then @xmath ; that is,\n@xmath is closed under minimal common extensions. It follows from ( 4.5\n) and the previously considered special case that\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\nThe rest of this section is devoted to establishing Lemma 4.3.5 . We\ntherefore fix, for the duration of this section, a finitely aligned\n@xmath -graph @xmath ; a 2-cocycle @xmath ; a Toeplitz-Cuntz-Krieger\n@xmath -family @xmath ; @xmath ; and a finite subset @xmath of @xmath .\n\n###### Definition 4.3.6.\n\nGiven @xmath , we define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand @xmath .\n\nThe next two Lemmas are from [ 14 ] .\n\n###### Lemma 4.3.7 ([14], Lemma 8.4).\n\nIf @xmath then:\n\n1.  @xmath ;\n\n2.  @xmath is finite;\n\n3.  @xmath implies that @xmath ; and\n\n4.  @xmath implies that @xmath .\n\n###### Lemma 4.3.8 ([14], Lemma 8.7).\n\nSuppose that @xmath , @xmath and @xmath . Then for each @xmath , there\nexists a unique @xmath such that\n\n1.  @xmath and @xmath ; and\n\n2.  @xmath and @xmath imply @xmath .\n\nFurthermore, @xmath for each @xmath .\n\n###### Lemma 4.3.9 ([14], Lemma 8.8).\n\nSuppose that @xmath , @xmath and @xmath . Let @xmath and @xmath be the\nmaximal subpath of @xmath provided by Lemma 4.3.8 . Then\n\n  -- -------- -- -------\n     @xmath      (4.6)\n  -- -------- -- -------\n\n###### Proof.\n\nFirst we show that @xmath Since @xmath , we have @xmath . Hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe will show that @xmath whenever @xmath with @xmath . Fix @xmath with\n@xmath . Then\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      \n              @xmath      \n              @xmath      (4.7)\n  -- -------- -------- -- -------\n\nNow suppose that @xmath . We claim @xmath and @xmath . We have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand so Lemma 4.3.8 (2) shows that @xmath Hence @xmath , so @xmath . We\nhave @xmath and @xmath by assumption, so @xmath by Lemma 4.3.7 (4).\nEstablishing our claim. Thus, each term in ( 4.7 ) is a factor in @xmath\n, so\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nNext we show that if @xmath with @xmath , then @xmath Fix @xmath with\n@xmath . The last statement in Lemma 4.3.8 implies that @xmath and\n@xmath . Since @xmath we have @xmath , and so @xmath . Since @xmath ,\nLemma 4.3.8 (2) implies that @xmath . Hence @xmath for some @xmath with\n@xmath . Since @xmath , we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nwhich vanishes since @xmath .\n\nSince @xmath and @xmath with @xmath implies that @xmath , we have\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Proof of Lemma\u00a04.3.5.\n\nFix @xmath and finite @xmath that is closed under minimal common\nextensions. Suppose that @xmath . As @xmath is closed under minimal\ncommon extensions, induction on @xmath shows that @xmath implies that\n@xmath . Hence @xmath . Lemma 4.3.7 (1) implies that @xmath . Therefore\nit suffices to show that @xmath for all @xmath , and that @xmath .\n\nFix @xmath with @xmath . Suppose that @xmath . We @xmath and @xmath .\nLemma 3.1.3 (2) implies that @xmath . Lemma 3.1.3 (6) implies that\n@xmath , giving @xmath .\n\nNow suppose that @xmath . Then @xmath is strictly larger than one of\n@xmath or @xmath ; say @xmath . Hence @xmath implies that @xmath and\n@xmath . Then\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n                       \n              @xmath   \n  -- -------- -------- --\n\nIt remains to show that @xmath . We proceed by induction on @xmath .\nSuppose that @xmath . Since @xmath , we have @xmath . We have @xmath ,\ngiving the base case.\n\nNow suppose that @xmath and that the result holds whenever @xmath Since\n@xmath , there exists @xmath . Set @xmath . Fix @xmath . We have\n\n  -- -------- -------- -- -------\n     @xmath   @xmath      \n              @xmath      (4.8)\n  -- -------- -------- -- -------\n\nSuppose that @xmath and @xmath . Lemma 4.3.8 (2) ensures that @xmath for\nsome @xmath with @xmath . Since @xmath , the projection @xmath is a\nfactor in @xmath . Since @xmath , we have @xmath Equation\u00a0( 4.8 ) then\nimplies that\n\n  -- -------- -- -------\n     @xmath      (4.9)\n  -- -------- -- -------\n\nLemma 4.3.8 ensures that if @xmath , then @xmath ; in particular, when\n@xmath , we have @xmath . Hence if @xmath satisfy @xmath , then @xmath .\nLemma 3.1.3 (6) implies that @xmath . So\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nEquation\u00a0( 4.9 ) implies that for all @xmath , we have\n\n  -- -------- -- --------\n     @xmath      (4.10)\n  -- -------- -- --------\n\nSubstituting\u00a0( 4.10 ) for those terms in @xmath for which @xmath belongs\nto @xmath , we obtain\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (4.11)\n  -- -------- -------- -- --------\n\nLemma 4.3.8 ensures that for @xmath , the path @xmath is uniquely\ndetermined by @xmath . Hence we can rewrite \u00a0( 4.11 ) as\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nLemma 4.3.9 allows us to replace each @xmath with @xmath , yielding\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nBy the inductive hypothesis, we have @xmath . \u220e\n\n###### Corollary 4.3.10 ([16], Corollary 3.7).\n\nIf @xmath is closed under minimal common extensions then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nLet @xmath . By Proposition 4.3.4 , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath implies that @xmath , we need only show that:\n\n1.  @xmath ; and\n\n2.  @xmath for all @xmath .\n\nSince @xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis establishes (1).\n\nFor (2), fix @xmath . If @xmath , then @xmath , by (TCK4). If @xmath ,\nthen @xmath , and\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      \n              @xmath      (4.12)\n  -- -------- -------- -- --------\n\nFix @xmath . Since @xmath is closed under minimal common extensions, we\nhave @xmath and, since @xmath , @xmath . Hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nApplying this to each term in\u00a0( 4.12 ) gives (2). \u220e\n\n### 4.4 Matrix units for the core\n\nLet @xmath be a relative Cuntz-Krieger @xmath -family. For each finite\n@xmath , we identify a finite-dimensional subalgebra @xmath of @xmath We\ndescribe matrix units for @xmath .\n\nLemma 4.4.1 and Corollary 4.4.2 can be deduced from Appendix A of [ 13 ]\n.\n\n###### Lemma 4.4.1.\n\nLet @xmath be a @xmath -algebra. Let @xmath a finite set. Suppose that\n@xmath satisfies:\n\n1.  @xmath for all @xmath ; and\n\n2.  @xmath for all @xmath .\n\nSuppose that @xmath for each @xmath . Then @xmath is a @xmath\n-subalgebra of @xmath that is universal in the sense that if @xmath is a\n@xmath -algebra and @xmath satisfies @xmath and @xmath then there exists\na homomorphism @xmath such that @xmath .\n\nIf @xmath satisfy (M1) and (M2), we call the @xmath a matrix units.\n\n###### Corollary 4.4.2.\n\nLet @xmath and @xmath be @xmath -algebras. Let @xmath be a finite set.\nSuppose that @xmath and @xmath both satisfy @xmath and @xmath . If\n@xmath and @xmath for all @xmath , then there is an isomorphism\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\ntaking @xmath to @xmath for each @xmath .\n\nLet @xmath be a finite set. Let @xmath . For @xmath , define @xmath by\n@xmath and @xmath . These operations mimic the usual adjoint and\nmultiplication of matrices. Each @xmath determines a linear map @xmath\nby\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nDefine @xmath to be the operator norm of @xmath with respect to the\n@xmath norm on @xmath . With this norm @xmath becomes a @xmath -algebra.\nFor each @xmath , define @xmath by @xmath for all @xmath , where @xmath\ndenotes the Kronecker delta. Then @xmath is a collection of nonzero\nmatrix units and @xmath . Corollary 4.4.2 implies that if @xmath is a\ncollection of nonzero matrix units in a @xmath -algebra @xmath , then\n@xmath .\n\n###### Definition 4.4.3.\n\nLet @xmath be a finitely aligned @xmath -graph. For a subset @xmath of\n@xmath we define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Given a finite @xmath\n, we show there is a finite @xmath such that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis closed under multiplication, and hence is a finite-dimensional @xmath\n-subalgebra of\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Lemma 4.4.4 ([16], Lemma 3.2).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite.\nThere exists a finite set @xmath that contains @xmath and satisfies\n\n  -- -------- -- --------\n     @xmath      (4.13)\n  -- -------- -- --------\n\nMoreover, for any finite @xmath that contains @xmath and satisfies (\n4.13 ),\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a finite-dimensional @xmath -subalgebra of @xmath .\n\n###### Proof.\n\nThe first statement is the first statement of Lemma 3.2 in [ 16 ] . For\nthe second statement, suppose that @xmath is finite contains @xmath and\nsatisfies ( 4.13 ). Then @xmath is a finite-dimensional, and hence\nnorm-closed, subspace of @xmath , which is closed under adjoints. It\nremains to show that @xmath is closed under multiplication. Let @xmath\nand @xmath be generators of @xmath . Then @xmath and @xmath . By Lemma\n3.1.3 part (4) we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nAs @xmath satisfies ( 4.13 ) we have @xmath for each @xmath and hence\n@xmath . The result then follows since multiplication is bilinear. \u220e\n\nThe intersection of all sets containing @xmath and satisfying ( 4.13 )\nalso contains @xmath and satisfies ( 4.13 ), and so we make the\nfollowing definition.\n\n###### Definition 4.4.5.\n\nLet @xmath be a finitely aligned @xmath -graph. Let @xmath be finite.\nDefine\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe following properties of @xmath will be important.\n\n###### Lemma 4.4.6 ([16], Remark 3.4).\n\nLet @xmath be a finitely aligned @xmath -graph. Let @xmath be finite.\nThen\n\n1.  @xmath is finite;\n\n2.   for @xmath with @xmath and @xmath , and for all @xmath ,\n\n      -- -------- --\n         @xmath   \n      -- -------- --\n\n3.  @xmath is closed under minimal common extensions.\n\n###### Proof.\n\nFor (1), the set @xmath is an intersection of finite sets and hence is\nfinite itself. For (2), the \u201cif\u201d direction follows from ( 4.13 ) with\n@xmath , @xmath , and @xmath . The \u201conly if\u201d directions follows from (\n4.13 ) with @xmath , @xmath , and @xmath . For (3), suppose that @xmath\nand that @xmath . Then ( 4.13 ) with @xmath and @xmath gives @xmath ;\nthat is, @xmath is closed under minimal common extensions. \u220e\n\n###### Definition 4.4.7.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a\nfinite subset of @xmath . For @xmath , define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proposition 4.4.8 (cf. [16], Proposition 3.9).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a\nfinite subset of @xmath . The set\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a collection of matrix units for @xmath .\n\nBefore we prove Proposition 4.4.8 we need the following Lemma.\n\n###### Lemma 4.4.9 (cf. [16], Lemma 3.10 and 3.11).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a\nfinite subset of @xmath . If @xmath then:\n\n  -- -------- -------- -- --------\n     @xmath   @xmath      (4.14)\n     @xmath   @xmath      (4.15)\n  -- -------- -------- -- --------\n\n###### Proof.\n\nFor equation ( 4.14 ) we calculate\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nThis establishes the first equality. For the second equality in equation\n( 4.14 ), we continue to calculate\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nFor equation ( 4.15 ) we calculate\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nFor each @xmath we have @xmath , since @xmath . So\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath            \n              @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Proof of Proposition\u00a04.4.8.\n\nBy equation ( 4.15 ) the @xmath span @xmath . Fix @xmath . We need to\nshow that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath is a projection we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath            \n              @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Proposition 4.4.10 (cf. [16], Proposition 3.13).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite.\nSuppose that @xmath for every @xmath and suppose that @xmath . If @xmath\nis not exhaustive, then @xmath . Otherwise, if @xmath is exhaustive,\nthen @xmath if and only if\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nFirst suppose that @xmath for every @xmath , @xmath and that @xmath is\nnot exhaustive. There exists @xmath such that @xmath for all @xmath . So\nfor each @xmath we have,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nHence\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince @xmath by Lemma 3.1.3 (7), we have @xmath . Since the 2-cocycle\ntakes values in the unit circle, we have @xmath .\n\nNow suppose that @xmath is exhaustive. By Lemma 4.4.9 we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand the final assertion follows. \u220e\n\n### 4.5 Isomorphisms of the core\n\nIn this section we show how each finite-dimensional subalgebra @xmath\ndecomposes into a direct sum of matrix algebras. For @xmath , we write\ndown the inclusion map @xmath . If @xmath is a relative Cuntz-Krieger\n@xmath -family and @xmath is a relative Cuntz-Krieger @xmath -family, we\nprovide conditions under which\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Definition 4.5.1 ([20], Definition 3.6.1).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite\nand suppose that @xmath and that @xmath are such that @xmath . Define\n@xmath to be the subalgebra\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nof @xmath . Define @xmath to be the set\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nof nontrivial tails which extend paths in @xmath to larger elements of\n@xmath .\n\n###### Lemma 4.5.2 ([20], Lemma 3.6.2).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite.\nThen\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor fixed @xmath and @xmath ,\n\n  -- -------- -- --------\n     @xmath      (4.16)\n  -- -------- -- --------\n\n###### Proof.\n\nSuppose that @xmath . Then @xmath and @xmath and so @xmath . Also @xmath\nwhenever @xmath or @xmath . Hence each of the spanning elements @xmath\nof @xmath belong to exactly one of the matrix algebras @xmath . Suppose\nthat @xmath , say @xmath , @xmath and @xmath , @xmath . If\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nthen @xmath by Proposition 4.4.8 , and hence @xmath and @xmath . So if\n@xmath or @xmath then @xmath Hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe will now prove ( 4.16 ). Fix @xmath and @xmath . Suppose that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen Proposition 4.4.10 implies that @xmath for all @xmath . Hence\n@xmath . Now suppose that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen Proposition 4.4.8 and Proposition 4.4.10 imply that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis family of nonzero matrix units which span @xmath . Lemma 4.4.1\ntherefore implies that @xmath . \u220e\n\n###### Lemma 4.5.3 (cf. Lemma 3.6.3, [20]).\n\nLet @xmath be a finitely aligned @xmath -graph, and let @xmath be\nfinite. Suppose that @xmath and that there exists @xmath such that\n@xmath . Then there is a unique path @xmath such that:\n\n1.  @xmath ; and\n\n2.   if @xmath and @xmath , then @xmath .\n\n###### Proof.\n\nLet @xmath and let @xmath . Then @xmath because @xmath is closed under\nminimal common extensions. We have @xmath by definition. If @xmath and\n@xmath , then @xmath by definition. \u220e\n\n###### Definition 4.5.4 (cf. [20], Definition 3.6.4).\n\nLet @xmath be a finitely aligned @xmath -graph, and let @xmath be a\nfinite subset of @xmath . For those @xmath such there exists @xmath for\nwhich @xmath , the path @xmath is defined by Lemma 4.5.3 . For all other\n@xmath , we define @xmath . For @xmath , we define @xmath\n\nLemma 4.5.3 and Definition 4.5.4 are similar to Lemma 3.6.3 and\nDefinition 3.6.4 in [ 20 ] . The difference is that here @xmath is\ndefined for all @xmath , whereas in [ 20 ] it is only defined for @xmath\nwhere @xmath is finite and @xmath . That @xmath is defined for all\n@xmath is crucial in the statement of Proposition 4.5.11 and in the\nproof of Lemma 4.5.12 .\n\n###### Lemma 4.5.5 (cf. [20], Lemma 3.6.5).\n\nLet @xmath be a finitely aligned @xmath -graph, and let @xmath be finite\nwith @xmath . Suppose that @xmath , that @xmath and that @xmath . Then\n@xmath and @xmath .\n\n###### Proof.\n\nSince @xmath , we have @xmath by Lemma 4.4.6 (2). Suppose for\ncontradiction that @xmath . Since @xmath and @xmath , Lemma 4.5.3 (2)\nensures that @xmath for some @xmath . Lemma 4.4.6 (2) implies that\n@xmath . Since @xmath , we have @xmath Since @xmath , we have @xmath ,\nand the factorisation property implies that @xmath for some @xmath .\nAnother application of the factorisation property gives @xmath . We have\nshown that @xmath , that @xmath , and that @xmath . This contradicts\nLemma 4.5.3 (2). \u220e\n\n###### Lemma 4.5.6 (cf. [20], Lemma 3.6.6).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite\nwith @xmath . Then for each @xmath ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nWe first show that\n\n  -- -------- -- --------\n     @xmath      (4.17)\n  -- -------- -- --------\n\nFirst suppose that @xmath . We consider two cases:\n\nCase 1: suppose that @xmath . Then @xmath implies that @xmath . For each\n@xmath , @xmath is a factor in @xmath . Hence\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nCase 2: suppose that @xmath . Since @xmath , Lemma 4.5.3 (2) implies\nthat @xmath where @xmath . In particular @xmath , and so\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nAs @xmath is an initial segment of @xmath , we have @xmath . So (TCK4)\ngives\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nWe have established that @xmath implies that @xmath . Now suppose that\n@xmath . Then\n\n  -- -------- -- --------\n     @xmath      (4.18)\n  -- -------- -- --------\n\nSuppose that @xmath with @xmath . Since @xmath , the maximality of\n@xmath implies that @xmath . So @xmath implies that @xmath . Fix @xmath\n. Then @xmath is a factor @xmath . Hence @xmath . Since @xmath , we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSince @xmath , we conclude that @xmath . Applying this to each factor on\nthe right-hand side of ( 4.18 ) gives @xmath . We have established\u00a0(\n4.17 ).\n\nFix @xmath . We have @xmath . An application of Corollary 4.3.10 gives\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nApplying ( 4.17 ) to each term in this sum gives\n\n  -- -------- -- --------\n     @xmath      (4.19)\n  -- -------- -- --------\n\nFix @xmath with @xmath . Since @xmath ,\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Definition 4.5.7 ([20], Definition 3.6.7).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite\nwith @xmath . Suppose that @xmath and that @xmath are such that @xmath\nis nontrivial. We define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor @xmath , we write @xmath for @xmath for convenience.\n\n###### Corollary 4.5.8 (cf. [20], Corollary 3.6.8).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite\nwith @xmath . The inclusion map @xmath is given by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Proof.\n\nThe result is a direct consequence of Lemma 4.5.2 and Lemma 4.5.6 . \u220e\n\n###### Theorem 4.5.9.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath be a subset of @xmath . Suppose that @xmath is a relative\nCuntz-Krieger @xmath -family and that @xmath is a relative Cuntz-Krieger\n@xmath -family. Suppose that\n\n1.  @xmath and @xmath for all @xmath , and that\n\n2.  @xmath .\n\nThen there is an isomorphism @xmath satisfying @xmath for all @xmath .\nIf @xmath , then @xmath for all @xmath with @xmath . We have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBefore proving Theorem 4.5.9 , we need to establish several technical\nresults.\n\n###### Lemma 4.5.10.\n\nLet @xmath be a finite set. Let @xmath be a set of matrix units in a\n@xmath -algebra @xmath . Let @xmath satisfy:\n\n1.  @xmath for all @xmath ; and\n\n2.  @xmath for all @xmath .\n\nThen @xmath is a collection of matrix units and\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nMoreover, if @xmath satisfies properties @xmath and @xmath , then @xmath\ndefined by @xmath for all @xmath also satisfies @xmath and @xmath .\n\n###### Proof.\n\nFix @xmath . We show that @xmath and @xmath . This shows @xmath and\n@xmath . Firstly, (T1) and then (M1) imply that\n\n  -- -------- -------- --\n     @xmath   @xmath   \n  -- -------- -------- --\n\nand secondly, (M2) and then (T2) give\n\n  -- -------- -------- --\n     @xmath   @xmath   \n  -- -------- -------- --\n\nSo @xmath is a collection of matrix units. It is clear that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nsince @xmath takes values in the circle. For the final statement, let\n@xmath satisfy @xmath and @xmath . Then for @xmath we have,\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nand\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath satisfies (T1) and (T2). \u220e\n\n###### Proposition 4.5.11.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite\nwith @xmath , @xmath and let @xmath . Then @xmath defined by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nsatisfy @xmath and @xmath . If @xmath satisfies @xmath and @xmath then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a collection of matrix units which span @xmath .\n\n###### Proof.\n\nFor @xmath , the calculations\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nshow that @xmath satisfies (T1) and (T2). A similar calculation shows\nthat @xmath also satisfies (T1) and (T2). By Proposition 4.4.8\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a collection of matrix units which span @xmath . The last statement\nis then a direct consequence of Lemma 4.5.10 . \u220e\n\nSince @xmath is countable, we can write @xmath . Put @xmath . Then\n@xmath for each @xmath and @xmath . So there exists a family @xmath of\nfinite subsets of @xmath such that @xmath for each @xmath and @xmath .\n\n###### Lemma 4.5.12.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath be a subset of @xmath . Let @xmath be a relative Cuntz-Krieger\n@xmath -family and let @xmath be a relative Cuntz-Krieger @xmath -family\nsuch that:\n\n1.  @xmath and @xmath for all @xmath ; and\n\n2.  @xmath .\n\nFix a family @xmath of finite subsets of @xmath such that @xmath for\neach @xmath and @xmath . For each @xmath and each @xmath , let @xmath\nand let @xmath as in Definition 4.5.4 . Define @xmath by\n\n  -- -------- -- --------\n     @xmath      (4.20)\n  -- -------- -- --------\n\nfor all @xmath . For each @xmath define @xmath by\n\n  -- -------- -- --------\n     @xmath      (4.21)\n  -- -------- -- --------\n\nfor all @xmath . Then for each @xmath there is a unique isomorphism\n@xmath satisfying\n\n  -- -------- -- --------\n     @xmath      (4.22)\n  -- -------- -- --------\n\nfor each @xmath . The diagram\n\n  -- -- --\n        \n  -- -- --\n\ncommutes, where the inclusion maps @xmath and @xmath for @xmath are\ngiven by Lemma 4.5.8 .\n\n###### Proof.\n\nWe claim that @xmath satisfies (T1) and (T2) for each @xmath . We\nproceed by induction. The map @xmath satisfies (T1) and (T2) because\n@xmath for each @xmath . Suppose that @xmath satisfies (T1) and (T2).\nThen\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nProposition 4.5.11 implies that @xmath also satisfies (T1) and (T2).\n\nWe will now construct the maps @xmath . Fix @xmath . By Lemma 4.5.2 we\nhave\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nwhere each @xmath is spanned by the elements\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThe same holds for the family @xmath . Hence there is at most one linear\nmap @xmath satisfying ( 4.22 ).\n\nFix @xmath and @xmath . We claim @xmath if and only if @xmath . We\nconsider the three cases:\n\n1.  @xmath\n\n2.  @xmath ; and\n\n3.  @xmath .\n\nFor case (1), suppose that @xmath . Then @xmath and @xmath by (CK) and\nLemma 3.4.8 . For (2), suppose that @xmath . Then @xmath and @xmath by\nhypothesis. For case (3), suppose that @xmath . Since @xmath by\ndefinition, and since @xmath , Lemma 3.4.2 implies that both @xmath and\n@xmath are nonzero.\n\nLemma 4.5.2 implies that @xmath if @xmath and @xmath if @xmath . It\nfollows from Proposition 4.5.11 that whenever @xmath ,\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nare collections of nonzero matrix units which span @xmath and @xmath\nrespectively. By Corollary 4.4.2 there is an isomorphism @xmath taking\n@xmath for each @xmath such that @xmath . For each @xmath with @xmath ,\n@xmath is an isomorphism. Define\n\n  -- -------- -- --------\n     @xmath      (4.23)\n  -- -------- -- --------\n\nWe now check that for each @xmath the diagram\n\n  -- -- --\n        \n  -- -- --\n\ncommutes so that the diagram ( 4.5.12 ) commutes. Fix @xmath and @xmath\n. Applying the inclusion map given by Lemma 4.5.6 we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nBy definition of @xmath , we have @xmath implies that @xmath and @xmath\n. Then Lemma 4.5.5 implies that @xmath and @xmath . Using ( 4.23 ), we\nhave\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince each @xmath takes @xmath to @xmath whenever @xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nApplying ( 4.21 ) gives\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nWe continue,\n\n  -- -------- -------- -------- --\n     @xmath   @xmath            \n              @xmath            \n              @xmath   @xmath   \n  -- -------- -------- -------- --\n\n###### Proof of Theorem\u00a04.5.9.\n\nPick a family @xmath of finite subsets of @xmath such that @xmath for\neach @xmath and @xmath . By Lemma 4.4.4 we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor each @xmath , let @xmath be the isomorphism given by Lemma 4.5.12 ,\nwhich satisfies @xmath for each @xmath . Since the diagram\u00a0( 4.5.12 )\ncommutes, there is a well-defined homomorphism @xmath such that @xmath .\nAs each @xmath is injective on the @xmath -algebra @xmath , each @xmath\nisometric. Hence @xmath is isometric on @xmath . By continuity @xmath\nextends to an isometric homomorphism on @xmath . Since @xmath is a\nhomomorphism between the @xmath -algebras @xmath and @xmath , the image\n@xmath is closed. Since @xmath is dense in @xmath , the homomorphism\n@xmath surjective and hence an isomorphism.\n\nWe claim that for all @xmath there is @xmath such that\n\n  -- -------- -- --------\n     @xmath      (4.24)\n  -- -------- -- --------\n\nTo see this, fix @xmath . Choose @xmath such that @xmath . By\u00a0( 4.15 )\nwe have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSince @xmath , we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n  -- -------- -------- --\n\nas claimed. Now fix @xmath . Condition (T1) of Lemma 4.5.10 implies that\n@xmath for all @xmath . Hence equation\u00a0( 4.24 ) implies that\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nFix @xmath and suppose that @xmath . Then @xmath for all @xmath .\nHence\u00a0( 4.24 ) gives\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nBy Theorem 3.4.16 , we have @xmath \u220e\n\n### 4.6 The gauge-invariant uniqueness theorem\n\nWe state the main result of this chapter.\n\n###### Theorem 4.6.1 (an Huef and Raeburn\u2019s gauge-invariant uniqueness\ntheorem).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Suppose that @xmath is a relative Cuntz-Krieger @xmath -family.\nThe homomorphism\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nsatisfying @xmath for all @xmath is injective on @xmath if and only if\n\n1.  @xmath for each @xmath ; and\n\n2.  @xmath for all @xmath .\n\nFurthermore, @xmath is injective on @xmath if and only if both (1) and\n(2) hold and additionally,\n\n1.   there exists a group action @xmath satisfying @xmath for all @xmath\n    .\n\n###### Proof.\n\nSuppose that @xmath is injective on @xmath . Then (1) and (2) follow\nfrom Theorem 3.4.16 . Now suppose that (1) and (2) hold. Then Lemma\n3.4.8 shows that for @xmath we have @xmath if and only in @xmath . So by\nTheorem 3.4.16 we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTheorem 3.4.16 implies that @xmath for each @xmath , and so by Theorem\n4.5.9 , @xmath is injective on @xmath .\n\nNow suppose that @xmath is injective on @xmath . Then setting @xmath\nestablishes (3) and Theorem 3.4.16 implies both (1) and (2). Finally,\nsuppose that (1), (2) and (3) hold. Then @xmath is injective on @xmath\nby the preceding paragraph. It then follows from Proposition 4.2.5 and\n(3) that @xmath is injective on @xmath . \u220e\n\n###### Corollary 4.6.2.\n\nLet @xmath be a finitely aligned @xmath -graph. Let @xmath be the\nToeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7 . Then @xmath\nis injective on @xmath .\n\n###### Proof.\n\nFix @xmath . The calculation @xmath shows that @xmath . We have @xmath\nfor all @xmath by Lemma 3.4.3 . The result then follows from Theorem\n4.6.1 . \u220e\n\n## Chapter 5 Gauge-invariant ideals\n\nIn this chapter we provide a graph-theoretic description of the\ngauge-invariant ideal structure of @xmath .\n\n### 5.1 From ideals to hereditary sets\n\nFor each ideal @xmath , we construct a hereditary and relatively\nsaturated subset @xmath of vertices and a satiated subset @xmath of a\nsubgraph @xmath .\n\n###### Definition 5.1.1.\n\nLet @xmath be a finitely aligned @xmath -graph. Let @xmath . Define a\nrelation @xmath on @xmath by @xmath if and only if @xmath .\n\n1.   A set @xmath is hereditary if @xmath , @xmath and @xmath imply\n    @xmath .\n\n2.   A set @xmath is saturated relative to @xmath if @xmath and @xmath\n    implies that @xmath .\n\n###### Lemma 5.1.2 (cf. [19], Lemma 3.3).\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Suppose that @xmath is an ideal. Define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThen @xmath is hereditary and saturated relative to @xmath .\n\n###### Proof.\n\nTo see that @xmath is hereditary suppose that @xmath and @xmath with\n@xmath . There is @xmath such that @xmath and @xmath . As @xmath , we\nhave\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath is hereditary.\n\nTo see that @xmath is saturated relative to @xmath , suppose that @xmath\nsatisfies @xmath . We will show that @xmath . The set @xmath is finite\nand satisfies @xmath by Lemma 4.3.7 . So @xmath by (S1). By Lemma 3.4.8\nwe have @xmath . As @xmath is closed under minimal common extensions, by\nDefinition 4.3.6 , it follows from Proposition 4.3.4 that\n\n  -- -------- -- -------\n     @xmath      (5.1)\n  -- -------- -- -------\n\nSince @xmath is an ideal, it suffices to show that @xmath implies @xmath\n. Fix @xmath . Then @xmath for some @xmath and hence @xmath . Since\n@xmath is hereditary and @xmath , it follows that @xmath . So @xmath\nThen\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nbelongs to @xmath . Now ( 5.1 ) implies that @xmath . \u220e\n\n###### Lemma 5.1.3 ([19], Lemma 4.1).\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath be hereditary. Then @xmath is a finitely aligned @xmath -graph.\n\n###### Proof.\n\nFirst we check the factorisation property for @xmath . Fix @xmath and\nsuppose that @xmath . By the factorisation property for @xmath , there\nare unique @xmath such that @xmath , @xmath and @xmath . Since @xmath we\nhave @xmath . As @xmath is hereditary and @xmath we have @xmath . But\n@xmath , which implies that @xmath . Hence @xmath has the factorisation\nproperty. To see that the @xmath -graph @xmath is finitely aligned note\nthat @xmath for all @xmath . \u220e\n\n###### Definition 5.1.4.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath and @xmath be an ideal. Define\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nand\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\n###### Lemma 5.1.5.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Suppose that @xmath is hereditary and saturated relative to\n@xmath . Then @xmath .\n\n###### Proof.\n\nSuppose that @xmath . Since @xmath , there exists @xmath such that\n@xmath and @xmath . We need to show that @xmath . Since @xmath is\nsaturated relative to @xmath , we have @xmath , which implies that\n@xmath . Fix @xmath . We will show that @xmath .\n\nWe claim @xmath . If @xmath , then @xmath for some @xmath where @xmath\nand @xmath . As @xmath is hereditary and @xmath , we have @xmath . Hence\n@xmath , and so @xmath . For the reverse containment, suppose @xmath .\nThen @xmath for some @xmath where @xmath and @xmath . As @xmath is\nhereditary and @xmath , we have @xmath . Hence @xmath , and so @xmath .\n\nSo it suffices to show @xmath . If @xmath , then @xmath , and so @xmath\n. So suppose @xmath . By (S2), we have @xmath , and @xmath . Since\n@xmath is saturated relative to @xmath and @xmath , we have @xmath ;\nthat is, there is @xmath with @xmath . Hence @xmath . \u220e\n\n###### Lemma 5.1.6.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Suppose that @xmath is an ideal. Then @xmath is satiated.\n\n###### Proof.\n\nLet @xmath . To see that @xmath is satiated we will repeatedly apply\nLemma 3.4.6 and use that @xmath is an ideal. For (S1), suppose that\n@xmath and @xmath is finite with @xmath . Then as @xmath , we have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath . For (S2), suppose that @xmath with @xmath and @xmath . Lemma\n3.4.6 implies that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath . For (S3), suppose that @xmath , @xmath for each @xmath . Set\n@xmath . Then Lemma 3.4.6 implies that @xmath . Hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nSo @xmath For (S4), suppose that @xmath , @xmath and @xmath for each\n@xmath . Put @xmath . We need to show that @xmath . Lemma 3.4.5 implies\nthat for each @xmath , we have\n\n  -- -------- -- -------\n     @xmath      (5.2)\n  -- -------- -- -------\n\nLet @xmath be the quotient map. For each @xmath we have @xmath and so\n@xmath . Applying the quotient map to ( 5.2 ) gives\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nfor each @xmath . The definition of @xmath implies that\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nsince @xmath . So @xmath and hence @xmath . \u220e\n\n###### Lemma 5.1.7.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Suppose that @xmath is an ideal. Then @xmath .\n\n###### Proof.\n\nSuppose that @xmath . By Lemma 5.1.5 we have @xmath , and so it suffices\nto show that @xmath . By definition of @xmath , there is @xmath such\nthat @xmath and @xmath . Since @xmath we have @xmath , and so\n\n  -- -------- -- -------\n     @xmath      (5.3)\n  -- -------- -- -------\n\nLet @xmath be the quotient map. Note that @xmath implies @xmath , which\nin turn implies that @xmath , by definition of @xmath . Hence for @xmath\nwe have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nApplying the quotient map @xmath to ( 5.3 ) we have\n\n  -- -------- -------- --\n     @xmath   @xmath   \n              @xmath   \n              @xmath   \n              @xmath   \n  -- -------- -------- --\n\nSo @xmath . \u220e\n\n### 5.2 Quotients of twisted relative Cuntz-Krieger algebras\n\nGiven a hereditary and relatively saturated subset @xmath and a satiated\nsubset @xmath , we construct a gauge-invariant ideal @xmath . Using the\ngauge-invariant uniqueness theorem, we show that @xmath is a canonically\nisomorphic to a twisted relative Cuntz-Krieger algebra of a subgraph.\n\n###### Definition 5.2.1.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be hereditary and let @xmath . We define @xmath to\nbe the ideal in @xmath generated by\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nObserve that if @xmath is a @xmath -subgraph of @xmath and if @xmath ,\nthen @xmath is a 2-cocycle for @xmath , where @xmath ; that is, @xmath .\nFor convenience we write @xmath for @xmath .\n\n###### Lemma 5.2.2.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be hereditary and saturated relative to @xmath .\nSuppose that @xmath is satiated and satisfies @xmath . Suppose that\n@xmath is a relative Cuntz-Krieger @xmath -family. For @xmath , let\n@xmath , and for @xmath , let @xmath . Then @xmath is a relative\nCuntz-Krieger @xmath -family. There is a unique homomorphism @xmath\ndetermined by\n\n  -- -------- -- -------\n     @xmath      (5.4)\n  -- -------- -- -------\n\nWe then have\n\n  -- -------- -- -------\n     @xmath      (5.5)\n     @xmath      (5.6)\n  -- -------- -- -------\n\n###### Proof.\n\nWe check axioms (TCK1) to (TCK4) and (CK) for @xmath . The set\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nis a collection of mutually orthogonal projections and @xmath is a\nprojection satisfying @xmath for any @xmath . So @xmath is a collection\nof mutually orthogonal projections. This gives\u00a0(TCK1).\n\nFor (TCK2) we show\n\n  -- -------- -- -------\n     @xmath      (5.7)\n  -- -------- -- -------\n\nFix @xmath satisfying @xmath . If @xmath then both sides of ( 5.7 ) are\nzero. So suppose @xmath . Since @xmath is hereditary and @xmath we have\n@xmath . So\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nFor (TCK3), if @xmath then @xmath . If @xmath then @xmath . Thus, @xmath\n.\n\nFor (TCK4) we must check that @xmath for each @xmath . Suppose that\n@xmath or that @xmath . Then @xmath . As @xmath is hereditary, @xmath\nimplies @xmath . Hence @xmath . Now suppose that @xmath . Then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nThis gives (TCK4).\n\nWe check (CK). Suppose that @xmath ; we must show that @xmath . If\n@xmath , then @xmath So suppose that @xmath . Then\n\n  -- -------- -- -------\n     @xmath      (5.8)\n  -- -------- -- -------\n\nSince @xmath , ( 5.8 ) implies that @xmath .\n\nWe now show there is a unique homomorphism @xmath satisfying ( 5.4 ).\nWrite @xmath for the universal generating family of @xmath . For @xmath\n, let @xmath , and for @xmath , let @xmath . The first part of the Lemma\nimplies that @xmath is a relative Cuntz-Krieger @xmath -family. By the\nuniversal property for @xmath there is a unique homomorphism\n\n  -- -- --\n        \n  -- -- --\n\nsatisfying @xmath for each @xmath . So the homomorphism @xmath satisfies\n( 5.4 ). We now check\u00a0( 5.5 ). If @xmath then @xmath by ( 5.4 ).\nConversely, if @xmath then Theorem 3.4.16 implies that @xmath . We now\ncheck ( 5.6 ). If @xmath then\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nTheorem 3.4.16 implies that for @xmath we have @xmath if and only if\n@xmath , and ( 5.6 ) follows. \u220e\n\n###### Lemma 5.2.3.\n\nLet @xmath be a @xmath -algebra and let @xmath . Let @xmath denote the\nideal generated by @xmath , as in Lemma 3.3.6 . Suppose that @xmath is a\ncompact abelian group and that @xmath is a group action. If @xmath for\nall @xmath and @xmath , then @xmath for each @xmath ; that is, @xmath is\n@xmath -invariant.\n\n###### Proof.\n\nBy Lemma 3.3.6 @xmath . For any @xmath , @xmath and @xmath , we have\n@xmath . Since @xmath is linear and continuous, we have @xmath for each\n@xmath . Since @xmath , we have @xmath . \u220e\n\n###### Theorem 5.2.4.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . Let @xmath be hereditary and saturated relative to @xmath .\nSuppose that @xmath is satiated and that @xmath . Then @xmath is a\nrelative Cuntz-Krieger @xmath -family in @xmath . The canonical\nhomomorphism\n\n  -- -- --\n        \n  -- -- --\n\nis an isomorphism.\n\n###### Proof.\n\nFirst we check axioms (TCK1) to (TCK4) and (CK) for @xmath . Relations\n(TCK1),(TCK2) and (TCK3) follow immediately since the quotient map\n@xmath is a homomorphism. For (TCK4), fix @xmath . We have\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIf @xmath then @xmath . So @xmath , which implies that @xmath . Hence\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nIt remains to check (CK). If @xmath then @xmath . Hence @xmath . We have\nshown that @xmath is a relative Cuntz-Krieger @xmath -family in @xmath .\nWe now aim to use the gauge-invariant uniqueness theorem, Theorem 4.6.1\n, to see that @xmath is an isomorphism.\n\nLet @xmath denote the gauge action on @xmath . For @xmath and @xmath ,\nwe have @xmath and @xmath for each @xmath . Lemma 5.2.3 implies that\n@xmath is invariant under the gauge action. Hence there exists an action\n@xmath of @xmath on @xmath satisfying @xmath for each @xmath . We claim\nthat\n\n1.  @xmath\n\n2.  @xmath\n\nLet @xmath be the homomorphism from Lemma 5.2.2 . Equations ( 5.5 ) and\n( 5.6 ) imply that\n\n  -- -------- --\n     @xmath   \n  -- -------- --\n\nLemma 3.3.6 implies @xmath . If @xmath , then ( 5.4 ) and ( 5.5 ) imply\nthat @xmath . If @xmath then ( 5.4 ) and ( 5.6 ) imply that @xmath .\n\nSince @xmath is satiated, the gauge-invariant uniqueness theorem,\nTheorem 4.6.1 , implies that @xmath is an isomorphism. \u220e\n\n### 5.3 Gauge-invariant ideals of the twisted relative Cuntz-Krieger\nalgebras\n\n###### Definition 5.3.1.\n\nLet @xmath be a finitely aligned @xmath -graph and let @xmath . Let\n@xmath be set of all pairs @xmath where @xmath is hereditary and\nsaturated relative to @xmath , and @xmath is satiated with @xmath .\n\n###### Theorem 5.3.2.\n\nLet @xmath be a finitely aligned @xmath -graph, let @xmath and let\n@xmath . The map @xmath is a bijection between @xmath and the\ngauge-invariant ideals of @xmath .\n\n###### Proof.\n\nFirst we check that @xmath is surjective. Fix a gauge-invariant ideal\n@xmath . We claim @xmath . We have @xmath by definition. Hence there is\na well-defined homomorphism @xmath from @xmath onto @xmath such that\n@xmath for each @xmath . The set @xmath is hereditary and saturated\nrelative to @xmath by Lemma 5.1.2 . The set @xmath is satiated by Lemma\n5.1.6 and satisfies @xmath by Lemma 5.1.7 . Theorem 5.2.4 implies that\n@xmath is an isomorphism. Since\n\n  -- -- -- -------\n           (5.9)\n  -- -- -- -------\n\nfor each @xmath , @xmath is a relative Cuntz-Krieger @xmath -family. The\nuniqueness clause in Theorem 3.3.7 implies that @xmath\n\nSuppose @xmath satisfies @xmath . Then @xmath and so @xmath by\ndefinition. Thus, @xmath implies @xmath . Suppose @xmath satisfies\n@xmath . Then @xmath and so @xmath by definition. Hence, @xmath implies\n@xmath .\n\nSince @xmath is gauge-invariant, there exists an action @xmath on @xmath\nsatisfying @xmath for each @xmath and @xmath . The gauge-invariant\nuniqueness theorem, Theorem 4.6.1 implies that @xmath is an isomorphism.\nHence @xmath is an isomorphism and the diagram\n\n  -- -- --\n        \n  -- -- --\n\ncommutes, where @xmath and @xmath denote the quotient maps. If @xmath\nthen @xmath . So @xmath . A similar calculation shows the reverse\ncontainment. So @xmath .\n\nNow we check that @xmath is injective. Fix @xmath . We will show that\n@xmath and @xmath . The containments @xmath and @xmath follow by\ndefinition.\n\nIf @xmath then @xmath . The map @xmath is an isomorphism by Theorem\n5.2.4 . It follows that @xmath . Since @xmath is satiated Theorem 3.4.16\nimplies @xmath for all @xmath . Hence @xmath . So @xmath .\n\nNow suppose that @xmath . Then @xmath . We have @xmath . As @xmath is\ninjective @xmath . Since @xmath is satiated, Theorem 3.4.16 implies that\n@xmath . So @xmath . \u220e","output":["To each finitely aligned higher-rank graph $\\Lambda$ and each\n$\\mathbb{T}$-valued 2-cocycle on $\\Lambda$, we associate a family of twisted\nrelative Cuntz-Krieger algebras. We show that each of these algebras carries a\ngauge action, and prove a gauge-invariant uniqueness theorem. We describe an\nisomorphism between the fixed point algebras for the gauge actions on the\ntwisted and untwisted relative Cuntz-Krieger algebras. We show that the\nquotient of a twisted relative Cuntz-Krieger algebra by a gauge-invariant ideal\nis canonically isomorphic to a twisted relative Cuntz-Krieger algebra\nassociated to a subgraph. We use this to provide a complete graph-theoretic\ndescription of the gauge-invariant ideal structure of each twisted relative\nCuntz-Krieger algebra.","To each finitely aligned higher-rank graph @xmath and each @xmath\n-valued 2-cocycle on @xmath , we associate a family of twisted relative\nCuntz-Krieger algebras. We show that each of these algebras carries a\ngauge action, and prove a gauge-invariant uniqueness theorem. We\ndescribe an isomorphism between the fixed point algebras for the gauge\nactions on the twisted and untwisted relative Cuntz-Krieger algebras. We\nshow that the quotient of a twisted relative Cuntz-Krieger algebra by a\ngauge-invariant ideal is canonically isomorphic to a twisted relative\nCuntz-Krieger algebra associated to a subgraph. We use this to provide a\ncomplete graph-theoretic description of the gauge-invariant ideal\nstructure of each twisted relative Cuntz-Krieger algebra.\n"]}
